[0m09:53:37.877220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa456aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2adb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36f8fd0>]}


============================== 09:53:37.880290 | 9f16e4ff-4299-4c87-8f12-36f7151ca8a5 ==============================
[0m09:53:37.880290 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:53:37.880643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:53:37.951321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46b0c70>]}
[0m09:53:37.973750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa417fb50>]}
[0m09:53:37.974347 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:53:37.982832 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:53:37.983657 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:53:37.983972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45c0220>]}
[0m09:53:38.432211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa198bfa0>]}
[0m09:53:38.496047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ac2280>]}
[0m09:53:38.496407 [info ] [MainThread]: Found 1 model, 423 macros
[0m09:53:38.496645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41570d0>]}
[0m09:53:38.497360 [info ] [MainThread]: 
[0m09:53:38.497733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:38.498292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m09:53:38.520068 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m09:53:38.520400 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m09:53:38.520591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:38.525463 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:53:38.526234 [debug] [ThreadPool]: On list_dw: Close
[0m09:53:38.527033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m09:53:38.530724 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:53:38.531006 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m09:53:38.531205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:38.533743 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m09:53:38.534014 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:53:38.534249 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:53:38.536434 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m09:53:38.537135 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m09:53:38.537433 [debug] [ThreadPool]: On list_dw_public: Close
[0m09:53:38.539896 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:38.540156 [debug] [MainThread]: On master: BEGIN
[0m09:53:38.540359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:38.542627 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:53:38.542899 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:38.543157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:38.544594 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m09:53:38.545205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1aedb80>]}
[0m09:53:38.545492 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:38.545767 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:38.545986 [debug] [MainThread]: On master: BEGIN
[0m09:53:38.546320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:53:38.546543 [debug] [MainThread]: On master: COMMIT
[0m09:53:38.546750 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:38.546985 [debug] [MainThread]: On master: COMMIT
[0m09:53:38.547267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:38.547478 [debug] [MainThread]: On master: Close
[0m09:53:38.547772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:38.548067 [info ] [MainThread]: 
[0m09:53:38.551723 [debug] [Thread-1  ]: Began running node model.my_dbt_project.sample
[0m09:53:38.552100 [info ] [Thread-1  ]: 1 of 1 START sql table model public.sample ..................................... [RUN]
[0m09:53:38.552386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.sample)
[0m09:53:38.552629 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.sample
[0m09:53:38.556569 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.sample"
[0m09:53:38.558115 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.sample
[0m09:53:38.577214 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.sample"
[0m09:53:38.578377 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m09:53:38.578614 [debug] [Thread-1  ]: On model.my_dbt_project.sample: BEGIN
[0m09:53:38.578848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:38.581604 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m09:53:38.581880 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m09:53:38.582116 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */

  
    

  create  table "dw"."public"."sample__dbt_tmp"
  
  
    as
  
  (
    

SELECT 1 AS id, 'hello' AS message
UNION ALL
SELECT 2 AS id, 'world' AS message
  );
  
[0m09:53:38.590727 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.008 seconds
[0m09:53:38.594192 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m09:53:38.594451 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample__dbt_tmp" rename to "sample"
[0m09:53:38.594834 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:53:38.603522 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m09:53:38.603926 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m09:53:38.604243 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m09:53:38.605097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m09:53:38.609889 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."sample__dbt_backup"
[0m09:53:38.613375 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m09:53:38.613665 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
drop table if exists "dw"."public"."sample__dbt_backup" cascade
[0m09:53:38.614335 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m09:53:38.615860 [debug] [Thread-1  ]: On model.my_dbt_project.sample: Close
[0m09:53:38.616959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f16e4ff-4299-4c87-8f12-36f7151ca8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa116bf70>]}
[0m09:53:38.617511 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.sample ................................ [[32mSELECT 2[0m in 0.06s]
[0m09:53:38.617981 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.sample
[0m09:53:38.618879 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:38.619179 [debug] [MainThread]: On master: BEGIN
[0m09:53:38.619453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:38.623148 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:53:38.623511 [debug] [MainThread]: On master: COMMIT
[0m09:53:38.623762 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:38.624055 [debug] [MainThread]: On master: COMMIT
[0m09:53:38.624423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:38.624660 [debug] [MainThread]: On master: Close
[0m09:53:38.625078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:38.625364 [debug] [MainThread]: Connection 'model.my_dbt_project.sample' was properly closed.
[0m09:53:38.625694 [info ] [MainThread]: 
[0m09:53:38.626060 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m09:53:38.626556 [debug] [MainThread]: Command end result
[0m09:53:38.668748 [info ] [MainThread]: 
[0m09:53:38.669220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:38.669486 [info ] [MainThread]: 
[0m09:53:38.669751 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:53:38.670634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.81762147, "process_user_time": 1.262585, "process_kernel_time": 0.184085, "process_mem_max_rss": "104156", "process_out_blocks": "2385", "process_in_blocks": "0"}
[0m09:53:38.670953 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:38.670903 after 0.82 seconds
[0m09:53:38.671327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa456aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa413f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36a8130>]}
[0m09:53:38.671618 [debug] [MainThread]: Flushing usage events
[0m11:40:31.431495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11128b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11128bb50>]}


============================== 11:40:31.434017 | b72103a7-0c4f-43de-a7a8-673f604945b1 ==============================
[0m11:40:31.434017 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:40:31.434311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:40:31.481803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b72103a7-0c4f-43de-a7a8-673f604945b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784e6a0>]}
[0m11:40:31.490663 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:40:31.491073 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:40:31.661329 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2642374, "process_user_time": 0.59151, "process_kernel_time": 0.072691, "process_mem_max_rss": "94175232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:40:31.661728 [debug] [MainThread]: Command `cli deps` succeeded at 11:40:31.661597 after 0.26 seconds
[0m11:40:31.662203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111493040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784e6a0>]}
[0m11:40:31.662690 [debug] [MainThread]: Flushing usage events
[0m11:41:47.250860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106177220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106177af0>]}


============================== 11:41:47.253309 | 00cad47b-04bb-41e1-9520-34f94527d6ef ==============================
[0m11:41:47.253309 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:41:47.253602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:41:47.292264 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m11:41:47.293701 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.07342208, "process_user_time": 0.573204, "process_kernel_time": 0.063408, "process_mem_max_rss": "92979200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:41:47.293907 [debug] [MainThread]: Command `cli deps` failed at 11:41:47.293863 after 0.07 seconds
[0m11:41:47.294078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe4d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e69490>]}
[0m11:41:47.294253 [debug] [MainThread]: Flushing usage events
[0m11:42:50.566574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104410220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104410af0>]}


============================== 11:42:50.569199 | d84086b7-30ff-4615-8a74-f8570b13f548 ==============================
[0m11:42:50.569199 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:42:50.569506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:42:50.577049 [info ] [MainThread]: dbt version: 1.8.0
[0m11:42:50.577259 [info ] [MainThread]: python version: 3.9.2
[0m11:42:50.577421 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m11:42:50.577571 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m11:42:50.608103 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m11:42:50.608353 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m11:42:50.608514 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m11:42:50.608776 [info ] [MainThread]: adapter type: postgres
[0m11:42:50.608925 [info ] [MainThread]: adapter version: 1.9.0
[0m11:42:50.645679 [info ] [MainThread]: Configuration:
[0m11:42:50.645925 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:42:50.646091 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m11:42:50.646240 [info ] [MainThread]: Required dependencies:
[0m11:42:50.646457 [debug] [MainThread]: Executing "git --help"
[0m11:42:50.655802 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:42:50.656221 [debug] [MainThread]: STDERR: "b''"
[0m11:42:50.656394 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:42:50.656557 [info ] [MainThread]: Connection:
[0m11:42:50.656781 [info ] [MainThread]:   host: postgres
[0m11:42:50.656987 [info ] [MainThread]:   port: 5432
[0m11:42:50.657132 [info ] [MainThread]:   user: dw_user
[0m11:42:50.657269 [info ] [MainThread]:   database: dw
[0m11:42:50.657402 [info ] [MainThread]:   schema: public
[0m11:42:50.657534 [info ] [MainThread]:   connect_timeout: 10
[0m11:42:50.657667 [info ] [MainThread]:   role: None
[0m11:42:50.657797 [info ] [MainThread]:   search_path: None
[0m11:42:50.657928 [info ] [MainThread]:   keepalives_idle: 0
[0m11:42:50.658058 [info ] [MainThread]:   sslmode: None
[0m11:42:50.658189 [info ] [MainThread]:   sslcert: None
[0m11:42:50.658319 [info ] [MainThread]:   sslkey: None
[0m11:42:50.658450 [info ] [MainThread]:   sslrootcert: None
[0m11:42:50.658580 [info ] [MainThread]:   application_name: dbt
[0m11:42:50.658708 [info ] [MainThread]:   retries: 1
[0m11:42:50.659015 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:42:50.703805 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:42:50.723789 [debug] [MainThread]: Using postgres connection "debug"
[0m11:42:50.723992 [debug] [MainThread]: On debug: select 1 as id
[0m11:42:50.724125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:50.889407 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m11:42:50.892525 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:42:50.892736 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:42:50.892952 [debug] [MainThread]: On debug: No close available on handle
[0m11:42:50.893155 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:42:50.893419 [info ] [MainThread]: [31m2 checks failed:[0m
[0m11:42:50.893648 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml


[0m11:42:50.893879 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:42:50.895412 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3635941, "process_user_time": 0.65106, "process_kernel_time": 0.095838, "process_mem_max_rss": "102170624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:42:50.895733 [debug] [MainThread]: Command `cli debug` failed at 11:42:50.895660 after 0.36 seconds
[0m11:42:50.895962 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:42:50.896192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047caa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104804310>]}
[0m11:42:50.896447 [debug] [MainThread]: Flushing usage events
[0m11:43:15.235454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106664220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106664b20>]}


============================== 11:43:15.237576 | d77e6396-6106-4731-813e-d377c23bed9a ==============================
[0m11:43:15.237576 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:43:15.237862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:15.276211 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m11:43:15.277479 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.07168896, "process_user_time": 0.590832, "process_kernel_time": 0.061182, "process_mem_max_rss": "91947008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:43:15.277692 [debug] [MainThread]: Command `cli deps` failed at 11:43:15.277645 after 0.07 seconds
[0m11:43:15.277866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105347730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674f430>]}
[0m11:43:15.278032 [debug] [MainThread]: Flushing usage events
[0m11:45:54.396919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108597220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108597a30>]}


============================== 11:45:54.400076 | 8e8a8f86-924d-40f6-99bb-fd8dd1e1356b ==============================
[0m11:45:54.400076 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:45:54.400488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:45:54.443183 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m11:45:54.444508 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.08418671, "process_user_time": 0.635385, "process_kernel_time": 0.056529, "process_mem_max_rss": "93487104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:45:54.444791 [debug] [MainThread]: Command `cli deps` failed at 11:45:54.444734 after 0.08 seconds
[0m11:45:54.444961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108682b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086827c0>]}
[0m11:45:54.445130 [debug] [MainThread]: Flushing usage events
[0m11:48:54.919585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778ba00>]}


============================== 11:48:54.922129 | 40667ab0-3b7d-48ef-a410-c8ec5f187d91 ==============================
[0m11:48:54.922129 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:48:54.922424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:48:54.961207 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m11:48:54.962486 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.07561571, "process_user_time": 0.589971, "process_kernel_time": 0.067274, "process_mem_max_rss": "93552640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:48:54.962725 [debug] [MainThread]: Command `cli deps` failed at 11:48:54.962682 after 0.08 seconds
[0m11:48:54.962912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107876a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078766d0>]}
[0m11:48:54.963075 [debug] [MainThread]: Flushing usage events
[0m11:52:05.300438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764b9d0>]}


============================== 11:52:05.303475 | 69ffbb51-0eaa-4f74-97a4-43c322cd2b61 ==============================
[0m11:52:05.303475 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:52:05.303821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:05.367997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69ffbb51-0eaa-4f74-97a4-43c322cd2b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624b7c0>]}
[0m11:52:05.376758 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-ewfcorjc'
[0m11:52:05.377023 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:52:05.748013 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:52:05.749903 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:52:05.819342 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:52:05.829686 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.7.1, =0.7.1
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m11:52:05.834258 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/main.py", line 446, in deps
    results = task.run()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/registry.py", line 127, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.7.1, =0.7.1
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m11:52:05.837276 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.5700705, "process_user_time": 0.622068, "process_kernel_time": 0.082713, "process_mem_max_rss": "97468416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:52:05.838011 [debug] [MainThread]: Command `cli deps` failed at 11:52:05.837870 after 0.57 seconds
[0m11:52:05.838544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b17f0>]}
[0m11:52:05.839041 [debug] [MainThread]: Flushing usage events
[0m11:54:59.525413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106413550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110391280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110391ca0>]}


============================== 11:54:59.528322 | 2b2e7f05-9cd1-4e6b-b05b-03c15367c735 ==============================
[0m11:54:59.528322 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:54:59.528675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:59.621041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b2e7f05-9cd1-4e6b-b05b-03c15367c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103412b0>]}
[0m11:54:59.645702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b2e7f05-9cd1-4e6b-b05b-03c15367c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e42b0>]}
[0m11:54:59.646264 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:54:59.691337 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 6 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m11:54:59.692370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2005237, "process_user_time": 0.66518, "process_kernel_time": 0.086652, "process_mem_max_rss": "96894976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:59.692587 [debug] [MainThread]: Command `cli run` failed at 11:54:59.692541 after 0.20 seconds
[0m11:54:59.692781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106413550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103061c0>]}
[0m11:54:59.692958 [debug] [MainThread]: Flushing usage events
[0m16:39:27.061362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f8f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710cb20>]}


============================== 16:39:27.063821 | c4ea075b-33f6-4176-9de2-d126fb97c7a8 ==============================
[0m16:39:27.063821 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:39:27.064148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:27.113467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4ea075b-33f6-4176-9de2-d126fb97c7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e6970>]}
[0m16:39:27.121336 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:39:27.122032 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:39:27.130965 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.106171794, "process_user_time": 0.657505, "process_kernel_time": 0.06058, "process_mem_max_rss": "92995584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:39:27.131309 [debug] [MainThread]: Command `cli deps` succeeded at 16:39:27.131253 after 0.11 seconds
[0m16:39:27.131508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f8f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fa8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723d070>]}
[0m16:39:27.131706 [debug] [MainThread]: Flushing usage events
[0m16:40:45.012767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185ce250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185cef10>]}


============================== 16:40:45.015164 | f56abf4a-2afc-49b5-9e1c-d12df16494c6 ==============================
[0m16:40:45.015164 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:40:45.015456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:40:45.087317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f56abf4a-2afc-49b5-9e1c-d12df16494c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11858e490>]}
[0m16:40:45.109777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f56abf4a-2afc-49b5-9e1c-d12df16494c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184377f0>]}
[0m16:40:45.110353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:45.159861 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m16:40:45.194971 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:40:45.195228 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m16:40:45.195416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f56abf4a-2afc-49b5-9e1c-d12df16494c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c6f10>]}
[0m16:40:45.625408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f56abf4a-2afc-49b5-9e1c-d12df16494c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183bc2e0>]}
[0m16:40:45.669930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f56abf4a-2afc-49b5-9e1c-d12df16494c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f09250>]}
[0m16:40:45.670197 [info ] [MainThread]: Found 1 model, 429 macros
[0m16:40:45.670799 [info ] [MainThread]: 
[0m16:40:45.671071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:45.671482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m16:40:45.695146 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m16:40:45.695345 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:40:45.695479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:45.698496 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m16:40:45.700707 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:40:45.700856 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:40:45.701027 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:40:45.701154 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:40:45.701303 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m16:40:45.701628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:45.701807 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m16:40:45.701964 [info ] [MainThread]: 
[0m16:40:45.702138 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m16:40:45.702382 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  
[0m16:40:45.703408 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.72148794, "process_user_time": 1.171255, "process_kernel_time": 0.106087, "process_mem_max_rss": "113311744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:40:45.703676 [debug] [MainThread]: Command `cli build` failed at 16:40:45.703622 after 0.72 seconds
[0m16:40:45.703880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119292be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192926a0>]}
[0m16:40:45.704084 [debug] [MainThread]: Flushing usage events
[0m15:41:27.677996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad9a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894efac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8987ac10>]}


============================== 15:41:27.681180 | 35343c19-acf8-4861-8373-e19cc7ad5d8f ==============================
[0m15:41:27.681180 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:41:27.681505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:27.744513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a53dbb0>]}
[0m15:41:27.766614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895239a0>]}
[0m15:41:27.766993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:41:27.774611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:41:27.810127 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:41:27.810472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ed60d0>]}
[0m15:41:28.253466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882cc040>]}
[0m15:41:28.293853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae66340>]}
[0m15:41:28.294167 [info ] [MainThread]: Found 1 model, 423 macros
[0m15:41:28.294376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881628b0>]}
[0m15:41:28.295020 [info ] [MainThread]: 
[0m15:41:28.295324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:28.295872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m15:41:28.315374 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m15:41:28.315679 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:41:28.315876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:28.320149 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m15:41:28.320833 [debug] [ThreadPool]: On list_dw: Close
[0m15:41:28.321575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m15:41:28.324996 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:41:28.325193 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:41:28.325349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:28.327638 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:41:28.327854 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:41:28.328058 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:41:28.329614 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:41:28.330176 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:41:28.330389 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:41:28.332628 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:28.332860 [debug] [MainThread]: On master: BEGIN
[0m15:41:28.333074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:28.335563 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:41:28.335769 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:28.335994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:28.338162 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:41:28.338727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881d07f0>]}
[0m15:41:28.338962 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:28.339173 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:28.339338 [debug] [MainThread]: On master: BEGIN
[0m15:41:28.339626 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:41:28.339818 [debug] [MainThread]: On master: COMMIT
[0m15:41:28.339981 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:28.340141 [debug] [MainThread]: On master: COMMIT
[0m15:41:28.340335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:41:28.340556 [debug] [MainThread]: On master: Close
[0m15:41:28.340826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:28.341076 [info ] [MainThread]: 
[0m15:41:28.344885 [debug] [Thread-1  ]: Began running node model.my_dbt_project.sample
[0m15:41:28.345212 [info ] [Thread-1  ]: 1 of 1 START sql table model public.sample ..................................... [RUN]
[0m15:41:28.345585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.sample)
[0m15:41:28.345806 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.sample
[0m15:41:28.349709 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.sample"
[0m15:41:28.350373 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.sample
[0m15:41:28.369948 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.sample"
[0m15:41:28.370724 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:41:28.370934 [debug] [Thread-1  ]: On model.my_dbt_project.sample: BEGIN
[0m15:41:28.371140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:28.373785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m15:41:28.373999 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:41:28.374201 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */

  
    

  create  table "dw"."public"."sample__dbt_tmp"
  
  
    as
  
  (
    

SELECT 1 AS id, 'hello' AS message
UNION ALL
SELECT 2 AS id, 'world' AS message
  );
  
[0m15:41:28.377784 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m15:41:28.380996 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:41:28.381205 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample" rename to "sample__dbt_backup"
[0m15:41:28.381805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:41:28.384397 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:41:28.384678 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample__dbt_tmp" rename to "sample"
[0m15:41:28.384992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:41:28.394165 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m15:41:28.394372 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:41:28.394592 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m15:41:28.395813 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m15:41:28.399260 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."sample__dbt_backup"
[0m15:41:28.401535 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:41:28.401766 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
drop table if exists "dw"."public"."sample__dbt_backup" cascade
[0m15:41:28.405715 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m15:41:28.406968 [debug] [Thread-1  ]: On model.my_dbt_project.sample: Close
[0m15:41:28.407759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35343c19-acf8-4861-8373-e19cc7ad5d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8791fc40>]}
[0m15:41:28.408141 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.sample ................................ [[32mSELECT 2[0m in 0.06s]
[0m15:41:28.408500 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.sample
[0m15:41:28.409192 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:28.409394 [debug] [MainThread]: On master: BEGIN
[0m15:41:28.409593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:28.412084 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:41:28.412315 [debug] [MainThread]: On master: COMMIT
[0m15:41:28.412505 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:28.412681 [debug] [MainThread]: On master: COMMIT
[0m15:41:28.412898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:41:28.413052 [debug] [MainThread]: On master: Close
[0m15:41:28.413281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:28.413465 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m15:41:28.413649 [debug] [MainThread]: Connection 'model.my_dbt_project.sample' was properly closed.
[0m15:41:28.413858 [info ] [MainThread]: 
[0m15:41:28.414063 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m15:41:28.414404 [debug] [MainThread]: Command end result
[0m15:41:28.432301 [info ] [MainThread]: 
[0m15:41:28.432669 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:28.432874 [info ] [MainThread]: 
[0m15:41:28.433069 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:41:28.433627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7787633, "process_user_time": 1.209186, "process_kernel_time": 0.129448, "process_mem_max_rss": "104752", "process_out_blocks": "2386", "process_in_blocks": "0"}
[0m15:41:28.433884 [debug] [MainThread]: Command `dbt run` succeeded at 15:41:28.433842 after 0.78 seconds
[0m15:41:28.434125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad9a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ed61f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895239a0>]}
[0m15:41:28.434353 [debug] [MainThread]: Flushing usage events
[0m15:47:27.774447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc3d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1fdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1fd760>]}


============================== 15:47:27.778084 | 769ed50b-3724-4b44-9d4d-3e95546f9b54 ==============================
[0m15:47:27.778084 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:47:27.778430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:47:27.840629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce05a90>]}
[0m15:47:27.862793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be13160>]}
[0m15:47:27.863204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:47:27.871104 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:47:27.905754 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:47:27.906093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bdf21c0>]}
[0m15:47:28.350817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1c81c0>]}
[0m15:47:28.391225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b228400>]}
[0m15:47:28.391553 [info ] [MainThread]: Found 1 model, 423 macros
[0m15:47:28.391770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a062340>]}
[0m15:47:28.392429 [info ] [MainThread]: 
[0m15:47:28.392768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:28.393310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m15:47:28.411721 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m15:47:28.411990 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:47:28.412194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:28.415969 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m15:47:28.416597 [debug] [ThreadPool]: On list_dw: Close
[0m15:47:28.417304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m15:47:28.420548 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:47:28.420752 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:47:28.420949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:28.423326 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:47:28.423563 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:47:28.423794 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:47:28.425635 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:47:28.426233 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:47:28.426498 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:47:28.428747 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.428971 [debug] [MainThread]: On master: BEGIN
[0m15:47:28.429158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:28.431447 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:47:28.431675 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.431905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:28.433615 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m15:47:28.434169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1b9f70>]}
[0m15:47:28.434422 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:28.434688 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.434872 [debug] [MainThread]: On master: BEGIN
[0m15:47:28.435186 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:28.435385 [debug] [MainThread]: On master: COMMIT
[0m15:47:28.435556 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.435749 [debug] [MainThread]: On master: COMMIT
[0m15:47:28.435994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:28.436183 [debug] [MainThread]: On master: Close
[0m15:47:28.436446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:28.436690 [info ] [MainThread]: 
[0m15:47:28.441119 [debug] [Thread-1  ]: Began running node model.my_dbt_project.sample
[0m15:47:28.441429 [info ] [Thread-1  ]: 1 of 1 START sql table model public.sample ..................................... [RUN]
[0m15:47:28.441782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.sample)
[0m15:47:28.441989 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.sample
[0m15:47:28.445771 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.sample"
[0m15:47:28.446335 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.sample
[0m15:47:28.465699 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.sample"
[0m15:47:28.466367 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:47:28.466614 [debug] [Thread-1  ]: On model.my_dbt_project.sample: BEGIN
[0m15:47:28.466829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:28.469465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m15:47:28.469715 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:47:28.469917 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */

  
    

  create  table "dw"."public"."sample__dbt_tmp"
  
  
    as
  
  (
    

SELECT 1 AS id, 'hello' AS message
UNION ALL
SELECT 2 AS id, 'world' AS message
  );
  
[0m15:47:28.473058 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m15:47:28.476299 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:47:28.476519 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample" rename to "sample__dbt_backup"
[0m15:47:28.476941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:28.479228 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:47:28.479515 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample__dbt_tmp" rename to "sample"
[0m15:47:28.479832 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:28.488850 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m15:47:28.489079 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:47:28.489288 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m15:47:28.489811 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m15:47:28.492670 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."sample__dbt_backup"
[0m15:47:28.494718 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m15:47:28.494942 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
drop table if exists "dw"."public"."sample__dbt_backup" cascade
[0m15:47:28.496885 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m15:47:28.498160 [debug] [Thread-1  ]: On model.my_dbt_project.sample: Close
[0m15:47:28.499056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '769ed50b-3724-4b44-9d4d-3e95546f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99866c70>]}
[0m15:47:28.499460 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.sample ................................ [[32mSELECT 2[0m in 0.06s]
[0m15:47:28.499808 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.sample
[0m15:47:28.500454 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.500674 [debug] [MainThread]: On master: BEGIN
[0m15:47:28.500841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:28.503335 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:47:28.503557 [debug] [MainThread]: On master: COMMIT
[0m15:47:28.503737 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.503905 [debug] [MainThread]: On master: COMMIT
[0m15:47:28.504140 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:28.504354 [debug] [MainThread]: On master: Close
[0m15:47:28.504618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:28.504806 [debug] [MainThread]: Connection 'model.my_dbt_project.sample' was properly closed.
[0m15:47:28.505026 [info ] [MainThread]: 
[0m15:47:28.505237 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m15:47:28.505601 [debug] [MainThread]: Command end result
[0m15:47:28.523485 [info ] [MainThread]: 
[0m15:47:28.523854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:28.524054 [info ] [MainThread]: 
[0m15:47:28.524253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:47:28.524754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.77241564, "process_user_time": 1.198009, "process_kernel_time": 0.097, "process_mem_max_rss": "104684", "process_out_blocks": "2386", "process_in_blocks": "0"}
[0m15:47:28.525022 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:28.524978 after 0.77 seconds
[0m15:47:28.525260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc3d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be13160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9957beb0>]}
[0m15:47:28.525497 [debug] [MainThread]: Flushing usage events
[0m16:49:18.053435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a13520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a91250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a91e20>]}


============================== 16:49:18.055908 | 1e74a17f-0939-495a-a1d5-d814a5ccd716 ==============================
[0m16:49:18.055908 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:49:18.056237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:18.136758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e74a17f-0939-495a-a1d5-d814a5ccd716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e506a0>]}
[0m16:49:18.159286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e74a17f-0939-495a-a1d5-d814a5ccd716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b69b50>]}
[0m16:49:18.159781 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:49:18.208113 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m16:49:18.243616 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:49:18.243859 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m16:49:18.244059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e74a17f-0939-495a-a1d5-d814a5ccd716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b40c70>]}
[0m16:49:18.674029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e74a17f-0939-495a-a1d5-d814a5ccd716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107383e80>]}
[0m16:49:18.719014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e74a17f-0939-495a-a1d5-d814a5ccd716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9d60>]}
[0m16:49:18.719282 [info ] [MainThread]: Found 1 model, 429 macros
[0m16:49:18.720055 [info ] [MainThread]: 
[0m16:49:18.720333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:18.720740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m16:49:18.744513 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m16:49:18.744722 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:49:18.744852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:18.749317 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m16:49:18.751575 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:49:18.751721 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:49:18.751875 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:49:18.752008 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:49:18.752139 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m16:49:18.752443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:18.752585 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m16:49:18.752727 [info ] [MainThread]: 
[0m16:49:18.752883 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m16:49:18.753128 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  
[0m16:49:18.754014 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.7319873, "process_user_time": 1.165392, "process_kernel_time": 0.10472, "process_mem_max_rss": "114507776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:18.754214 [debug] [MainThread]: Command `cli build` failed at 16:49:18.754176 after 0.73 seconds
[0m16:49:18.754375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a13520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e3eb0>]}
[0m16:49:18.754537 [debug] [MainThread]: Flushing usage events
[0m16:49:35.640009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d11220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d11d90>]}


============================== 16:49:35.642250 | 6fa0aaac-fd31-406d-802a-efefcbd73b48 ==============================
[0m16:49:35.642250 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:49:35.642535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:35.727214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fa0aaac-fd31-406d-802a-efefcbd73b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104e400>]}
[0m16:49:35.749769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fa0aaac-fd31-406d-802a-efefcbd73b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba86d0>]}
[0m16:49:35.750337 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:49:35.798562 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m16:49:35.848563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:35.848785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:35.862355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fa0aaac-fd31-406d-802a-efefcbd73b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111683130>]}
[0m16:49:35.909763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fa0aaac-fd31-406d-802a-efefcbd73b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ac520>]}
[0m16:49:35.910042 [info ] [MainThread]: Found 1 model, 429 macros
[0m16:49:35.910826 [info ] [MainThread]: 
[0m16:49:35.911132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:35.911563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m16:49:35.935310 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m16:49:35.935536 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:49:35.935676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:35.938390 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m16:49:35.940749 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:49:35.940891 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:49:35.941038 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:49:35.941163 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:49:35.941298 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m16:49:35.941583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:35.941721 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m16:49:35.941868 [info ] [MainThread]: 
[0m16:49:35.942031 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m16:49:35.942278 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  
[0m16:49:35.943182 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.33301634, "process_user_time": 0.771812, "process_kernel_time": 0.095265, "process_mem_max_rss": "110133248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:35.943386 [debug] [MainThread]: Command `cli build` failed at 16:49:35.943344 after 0.33 seconds
[0m16:49:35.943562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11168b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116892e0>]}
[0m16:49:35.943735 [debug] [MainThread]: Flushing usage events
[0m16:54:33.939441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061eb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061eba00>]}


============================== 16:54:33.941741 | 55048c1a-3f55-4e01-a802-3a6fc6bf1c6e ==============================
[0m16:54:33.941741 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:54:33.942048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:54:33.986517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55048c1a-3f55-4e01-a802-3a6fc6bf1c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c64c0>]}
[0m16:54:33.992928 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:54:33.993594 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:54:33.994639 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08762983, "process_user_time": 0.558463, "process_kernel_time": 0.045466, "process_mem_max_rss": "92536832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:33.994881 [debug] [MainThread]: Command `cli deps` succeeded at 16:54:33.994832 after 0.09 seconds
[0m16:54:33.995083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106300430>]}
[0m16:54:33.995280 [debug] [MainThread]: Flushing usage events
[0m16:54:46.979414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fcb50>]}


============================== 16:54:46.981901 | 540104bc-ef85-4c14-b075-e01bdb2402ad ==============================
[0m16:54:46.981901 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:54:46.982199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:54:47.029254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540104bc-ef85-4c14-b075-e01bdb2402ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106598370>]}
[0m16:54:47.036291 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:54:47.036776 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:54:47.037727 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.093433335, "process_user_time": 0.619691, "process_kernel_time": 0.051627, "process_mem_max_rss": "93913088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:47.037952 [debug] [MainThread]: Command `cli deps` succeeded at 16:54:47.037901 after 0.09 seconds
[0m16:54:47.038130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067000a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc06a0>]}
[0m16:54:47.038320 [debug] [MainThread]: Flushing usage events
[0m16:57:31.152447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb7b50>]}


============================== 16:57:31.155103 | 11c956b5-c7ab-4767-a284-a66eed736a94 ==============================
[0m16:57:31.155103 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:57:31.155399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:31.161437 [info ] [MainThread]: dbt version: 1.8.0
[0m16:57:31.161612 [info ] [MainThread]: python version: 3.9.2
[0m16:57:31.161760 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m16:57:31.161906 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m16:57:31.191679 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m16:57:31.191931 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m16:57:31.192098 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m16:57:31.192372 [info ] [MainThread]: adapter type: postgres
[0m16:57:31.192553 [info ] [MainThread]: adapter version: 1.9.0
[0m16:57:31.230662 [info ] [MainThread]: Configuration:
[0m16:57:31.230937 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:57:31.231097 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:57:31.231244 [info ] [MainThread]: Required dependencies:
[0m16:57:31.231471 [debug] [MainThread]: Executing "git --help"
[0m16:57:31.240193 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:57:31.240610 [debug] [MainThread]: STDERR: "b''"
[0m16:57:31.240773 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:57:31.240937 [info ] [MainThread]: Connection:
[0m16:57:31.241126 [info ] [MainThread]:   host: postgres
[0m16:57:31.241268 [info ] [MainThread]:   port: 5432
[0m16:57:31.241404 [info ] [MainThread]:   user: dw_user
[0m16:57:31.241538 [info ] [MainThread]:   database: dw
[0m16:57:31.241673 [info ] [MainThread]:   schema: public
[0m16:57:31.241808 [info ] [MainThread]:   connect_timeout: 10
[0m16:57:31.241942 [info ] [MainThread]:   role: None
[0m16:57:31.242077 [info ] [MainThread]:   search_path: None
[0m16:57:31.242212 [info ] [MainThread]:   keepalives_idle: 0
[0m16:57:31.242347 [info ] [MainThread]:   sslmode: None
[0m16:57:31.242480 [info ] [MainThread]:   sslcert: None
[0m16:57:31.242613 [info ] [MainThread]:   sslkey: None
[0m16:57:31.242745 [info ] [MainThread]:   sslrootcert: None
[0m16:57:31.242877 [info ] [MainThread]:   application_name: dbt
[0m16:57:31.243010 [info ] [MainThread]:   retries: 1
[0m16:57:31.243333 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:57:31.287281 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:57:31.306997 [debug] [MainThread]: Using postgres connection "debug"
[0m16:57:31.307222 [debug] [MainThread]: On debug: select 1 as id
[0m16:57:31.307375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:31.310798 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m16:57:31.312606 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m16:57:31.312778 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m16:57:31.312938 [debug] [MainThread]: On debug: No close available on handle
[0m16:57:31.313087 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:57:31.313243 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:57:31.313402 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:57:31.314343 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.19298042, "process_user_time": 0.651512, "process_kernel_time": 0.097276, "process_mem_max_rss": "102400000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:31.314574 [debug] [MainThread]: Command `cli debug` failed at 16:57:31.314527 after 0.19 seconds
[0m16:57:31.314742 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:57:31.314903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f324f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6c6d0>]}
[0m16:57:31.315088 [debug] [MainThread]: Flushing usage events
[0m17:03:46.143046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102903550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436fbb0>]}


============================== 17:03:46.145655 | e8840c57-d4b1-4870-aace-ac65f3b02dfc ==============================
[0m17:03:46.145655 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:03:46.145948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:03:46.204840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8840c57-d4b1-4870-aace-ac65f3b02dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434a580>]}
[0m17:03:46.213259 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:03:46.214309 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:03:46.215211 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10300858, "process_user_time": 0.582952, "process_kernel_time": 0.070267, "process_mem_max_rss": "92913664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:46.215436 [debug] [MainThread]: Command `cli deps` succeeded at 17:03:46.215386 after 0.10 seconds
[0m17:03:46.215603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102903550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434a580>]}
[0m17:03:46.215763 [debug] [MainThread]: Flushing usage events
[0m21:03:35.620453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025d7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104044250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104044a90>]}


============================== 21:03:35.623110 | 8552d316-cf8f-4750-a22e-a7cc3b3f7563 ==============================
[0m21:03:35.623110 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:35.623414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:35.681583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8552d316-cf8f-4750-a22e-a7cc3b3f7563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d44760>]}
[0m21:03:35.690345 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:03:35.690839 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:03:35.691893 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.104992956, "process_user_time": 0.579198, "process_kernel_time": 0.075203, "process_mem_max_rss": "94273536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:35.692091 [debug] [MainThread]: Command `cli deps` succeeded at 21:03:35.692049 after 0.11 seconds
[0m21:03:35.692254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025d7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a1d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104157490>]}
[0m21:03:35.692415 [debug] [MainThread]: Flushing usage events
[0m21:06:04.368763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ab4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e18250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e18b50>]}


============================== 21:06:04.371882 | 85bbda40-ec56-4131-ae3b-d393d009d6e7 ==============================
[0m21:06:04.371882 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:06:04.372170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:06:04.417935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85bbda40-ec56-4131-ae3b-d393d009d6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daab80>]}
[0m21:06:04.425996 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:06:04.426453 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:06:04.427336 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09578487, "process_user_time": 0.57767, "process_kernel_time": 0.068352, "process_mem_max_rss": "93061120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:06:04.427560 [debug] [MainThread]: Command `cli deps` succeeded at 21:06:04.427515 after 0.10 seconds
[0m21:06:04.427725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ab4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f06ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daab80>]}
[0m21:06:04.427880 [debug] [MainThread]: Flushing usage events
[0m21:07:01.820290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbfbb0>]}


============================== 21:07:01.822823 | a57a86e8-de13-47a5-aa3e-0fb46dc9acc2 ==============================
[0m21:07:01.822823 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:07:01.823118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:07:01.868815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a57a86e8-de13-47a5-aa3e-0fb46dc9acc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9b580>]}
[0m21:07:01.877316 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:07:01.877841 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:07:01.878744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08785983, "process_user_time": 0.582524, "process_kernel_time": 0.065905, "process_mem_max_rss": "94224384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:07:01.878965 [debug] [MainThread]: Command `cli deps` succeeded at 21:07:01.878915 after 0.09 seconds
[0m21:07:01.879131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ae730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9b580>]}
[0m21:07:01.879293 [debug] [MainThread]: Flushing usage events
[0m21:07:26.426577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eac220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eacaf0>]}


============================== 21:07:26.429252 | 896156a0-5908-4879-8d37-6118449058fa ==============================
[0m21:07:26.429252 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:07:26.429553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:07:26.468157 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m21:07:26.469324 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.072646916, "process_user_time": 0.581074, "process_kernel_time": 0.06215, "process_mem_max_rss": "92815360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:07:26.469584 [debug] [MainThread]: Command `cli deps` failed at 21:07:26.469537 after 0.07 seconds
[0m21:07:26.469766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d18d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9bb80>]}
[0m21:07:26.469944 [debug] [MainThread]: Flushing usage events
[0m21:08:00.144428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023604f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dcc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dccb20>]}


============================== 21:08:00.146811 | a417ab67-f871-4a71-ad82-385daad72e8f ==============================
[0m21:08:00.146811 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:00.147094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:08:00.197478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a417ab67-f871-4a71-ad82-385daad72e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da7580>]}
[0m21:08:00.206111 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-266qkavc'
[0m21:08:00.206390 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:08:00.498319 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:08:00.500047 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:08:00.555307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:08:00.563159 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.7.1, =0.7.1
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m21:08:00.566890 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/main.py", line 446, in deps
    results = task.run()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/registry.py", line 127, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.7.1, =0.7.1
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m21:08:00.569332 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.4558935, "process_user_time": 0.616043, "process_kernel_time": 0.07217, "process_mem_max_rss": "96190464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:08:00.569857 [debug] [MainThread]: Command `cli deps` failed at 21:08:00.569744 after 0.46 seconds
[0m21:08:00.570289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023604f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f29820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f29a00>]}
[0m21:08:00.570726 [debug] [MainThread]: Flushing usage events
[0m21:15:17.130626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccd0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccd0b20>]}


============================== 21:15:17.133208 | 0da1cb41-7a65-412e-bafb-376775bb1c38 ==============================
[0m21:15:17.133208 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:15:17.133504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:15:17.171916 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True, 'unrendered': {'package': 'brooklyn-data/dbt_artifacts', 'version': '1.2.0', 'install-prerelease': True}} is not valid under any of the given schemas
  

Error encountered in /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m21:15:17.173327 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.08372533, "process_user_time": 0.570441, "process_kernel_time": 0.068933, "process_mem_max_rss": "93503488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:15:17.173560 [debug] [MainThread]: Command `cli deps` failed at 21:15:17.173514 after 0.08 seconds
[0m21:15:17.173732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107faf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cdbc430>]}
[0m21:15:17.173903 [debug] [MainThread]: Flushing usage events
[0m21:16:05.103105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a53490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bfac0>]}


============================== 21:16:05.105571 | 387588d8-a9b9-4807-a362-74225a6e9af7 ==============================
[0m21:16:05.105571 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:16:05.105865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:05.168727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '387588d8-a9b9-4807-a362-74225a6e9af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c846a0>]}
[0m21:16:05.178129 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-fhug7sk9'
[0m21:16:05.178444 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:16:05.363005 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:16:05.363967 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/snowplow.json
[0m21:16:05.647040 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/snowplow.json 200
[0m21:16:05.659358 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:16:06.292791 [debug] [MainThread]: STDOUT: "b''"
[0m21:16:06.293521 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m21:16:06.293955 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m21:16:06.294183 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:16:06.300085 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m21:16:06.300531 [debug] [MainThread]: STDERR: "b''"
[0m21:16:06.300761 [debug] [MainThread]: Checking out revision 0.9.2.
[0m21:16:06.300968 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m21:16:06.310786 [debug] [MainThread]: STDOUT: "b''"
[0m21:16:06.311241 [debug] [MainThread]: STDERR: "b''"
[0m21:16:06.311429 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m21:16:07.020858 [debug] [MainThread]: STDOUT: "b''"
[0m21:16:07.021442 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n * [new tag]         1.1.1      -> 1.1.1\n * [new tag]         1.2.0      -> 1.2.0\n * [new tag]         1.2.0-rc1  -> 1.2.0-rc1\n * [new tag]         1.3.0      -> 1.3.0\n'"
[0m21:16:07.021731 [debug] [MainThread]: Executing "git tag --list"
[0m21:16:07.027736 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n'"
[0m21:16:07.028118 [debug] [MainThread]: STDERR: "b''"
[0m21:16:07.028296 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m21:16:07.051943 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:16:07.052326 [debug] [MainThread]: STDERR: "b''"
[0m21:16:07.052487 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:16:07.056654 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:16:07.056927 [debug] [MainThread]: STDERR: "b''"
[0m21:16:07.057079 [debug] [MainThread]: Checked out at 064c2ab.
[0m21:16:07.057220 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:16:07.060841 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:16:07.061150 [debug] [MainThread]: STDERR: "b''"
[0m21:16:07.062042 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /opt/dbt/redshift/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:16:07.063149 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.9892503, "process_user_time": 0.618934, "process_kernel_time": 0.080478, "process_mem_max_rss": "95977472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:16:07.063376 [debug] [MainThread]: Command `cli deps` failed at 21:16:07.063333 after 1.99 seconds
[0m21:16:07.063580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a53490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103197c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104612c40>]}
[0m21:16:07.063774 [debug] [MainThread]: Flushing usage events
[0m21:17:07.089417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f1a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988b80>]}


============================== 21:17:07.092050 | d6610b40-ed98-418b-940e-bb1e21bf7343 ==============================
[0m21:17:07.092050 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:17:07.092354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:17:07.142735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6610b40-ed98-418b-940e-bb1e21bf7343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103138bb0>]}
[0m21:17:07.151817 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-jgj8xh3e'
[0m21:17:07.152114 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:17:07.203897 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:17:07.204269 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/snowplow.json
[0m21:17:07.410746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/snowplow.json 200
[0m21:17:07.419935 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:17:08.026722 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:08.027281 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m21:17:08.027639 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m21:17:08.027849 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:08.033296 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m21:17:08.033724 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.033945 [debug] [MainThread]: Checking out revision 0.9.2.
[0m21:17:08.034138 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m21:17:08.041167 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:08.041556 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.041739 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m21:17:08.734095 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:08.734626 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n * [new tag]         1.1.1      -> 1.1.1\n * [new tag]         1.2.0      -> 1.2.0\n * [new tag]         1.2.0-rc1  -> 1.2.0-rc1\n * [new tag]         1.3.0      -> 1.3.0\n'"
[0m21:17:08.734905 [debug] [MainThread]: Executing "git tag --list"
[0m21:17:08.740466 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n'"
[0m21:17:08.740799 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.740974 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m21:17:08.764841 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:17:08.765182 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.765354 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:08.769185 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:08.769447 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.769607 [debug] [MainThread]: Checked out at 064c2ab.
[0m21:17:08.769750 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:08.773183 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:08.773453 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.775189 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:17:08.778870 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:08.779157 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m21:17:08.779291 [debug] [MainThread]: command return code=128
[0m21:17:08.779761 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m21:17:08.779898 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:08.783227 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:08.783544 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.783688 [debug] [MainThread]: Checking out revision 0.9.2.
[0m21:17:08.783818 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m21:17:08.789944 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:08.790203 [debug] [MainThread]: STDERR: "b''"
[0m21:17:08.790340 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m21:17:09.280260 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:09.280826 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n'"
[0m21:17:09.281078 [debug] [MainThread]: Executing "git tag --list"
[0m21:17:09.287931 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n'"
[0m21:17:09.288308 [debug] [MainThread]: STDERR: "b''"
[0m21:17:09.288512 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m21:17:09.303504 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:17:09.303911 [debug] [MainThread]: STDERR: "b''"
[0m21:17:09.304106 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:09.308210 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:09.308538 [debug] [MainThread]: STDERR: "b''"
[0m21:17:09.308723 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m21:17:09.308888 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:09.312679 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:09.312980 [debug] [MainThread]: STDERR: "b''"
[0m21:17:09.338637 [info ] [MainThread]: Updating lock file in file path: /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/package-lock.yml
[0m21:17:09.340243 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-8y1bieoo'
[0m21:17:09.341552 [info ] [MainThread]: Installing dbt-labs/snowplow
[0m21:17:09.711623 [info ] [MainThread]: Installed from version 0.7.0
[0m21:17:09.711991 [info ] [MainThread]: Updated version available: 0.15.1
[0m21:17:09.712376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6610b40-ed98-418b-940e-bb1e21bf7343', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b11580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b11c10>]}
[0m21:17:09.712728 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m21:17:09.712989 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:17:10.265596 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:10.266244 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m21:17:10.266512 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m21:17:10.266716 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:10.272493 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m21:17:10.272897 [debug] [MainThread]: STDERR: "b''"
[0m21:17:10.273121 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m21:17:10.273317 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:17:10.950424 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:10.950995 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m21:17:10.951226 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:17:10.976903 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:17:10.977292 [debug] [MainThread]: STDERR: "b''"
[0m21:17:10.977474 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:10.981758 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:10.982076 [debug] [MainThread]: STDERR: "b''"
[0m21:17:10.982272 [debug] [MainThread]: Checked out at 064c2ab.
[0m21:17:10.982432 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:10.986077 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:10.986392 [debug] [MainThread]: STDERR: "b''"
[0m21:17:10.987039 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:17:10.990694 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:10.991005 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m21:17:10.991131 [debug] [MainThread]: command return code=128
[0m21:17:10.991513 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m21:17:10.991644 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:10.995136 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:10.995419 [debug] [MainThread]: STDERR: "b''"
[0m21:17:10.995572 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m21:17:10.995706 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:17:11.544624 [debug] [MainThread]: STDOUT: "b''"
[0m21:17:11.545168 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m21:17:11.545395 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:17:11.561257 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:17:11.561789 [debug] [MainThread]: STDERR: "b''"
[0m21:17:11.561989 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:17:11.567281 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:17:11.567694 [debug] [MainThread]: STDERR: "b''"
[0m21:17:11.567880 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m21:17:11.568184 [info ] [MainThread]: Installed from revision 064c2abee80816ea855de32e66e54e96d9916677
[0m21:17:11.568534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6610b40-ed98-418b-940e-bb1e21bf7343', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b114f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b11dc0>]}
[0m21:17:11.568910 [info ] [MainThread]: 
[0m21:17:11.569191 [info ] [MainThread]: Updates available for packages: ['dbt-labs/snowplow']                 
Update your versions in packages.yml, then run dbt deps
[0m21:17:11.571351 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.5123067, "process_user_time": 0.664056, "process_kernel_time": 0.154333, "process_mem_max_rss": "97665024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:11.571658 [debug] [MainThread]: Command `cli deps` succeeded at 21:17:11.571600 after 4.51 seconds
[0m21:17:11.571873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f1a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a27490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b114f0>]}
[0m21:17:11.572053 [debug] [MainThread]: Flushing usage events
[0m21:17:40.184800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b54250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b54b20>]}


============================== 21:17:40.187272 | 81eddf46-209e-4cc5-b3b3-e482a55d71a6 ==============================
[0m21:17:40.187272 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:17:40.187568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:40.194063 [info ] [MainThread]: dbt version: 1.8.0
[0m21:17:40.194285 [info ] [MainThread]: python version: 3.9.2
[0m21:17:40.194440 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m21:17:40.194587 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m21:17:40.230814 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m21:17:40.231101 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m21:17:40.231265 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m21:17:40.231695 [info ] [MainThread]: adapter type: postgres
[0m21:17:40.231844 [info ] [MainThread]: adapter version: 1.9.0
[0m21:17:40.274157 [info ] [MainThread]: Configuration:
[0m21:17:40.274406 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:17:40.274578 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:17:40.274739 [info ] [MainThread]: Required dependencies:
[0m21:17:40.274941 [debug] [MainThread]: Executing "git --help"
[0m21:17:40.295879 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:17:40.296387 [debug] [MainThread]: STDERR: "b''"
[0m21:17:40.296591 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:17:40.296778 [info ] [MainThread]: Connection:
[0m21:17:40.297026 [info ] [MainThread]:   host: localshost
[0m21:17:40.297177 [info ] [MainThread]:   port: 5432
[0m21:17:40.297329 [info ] [MainThread]:   user: dw_user
[0m21:17:40.297478 [info ] [MainThread]:   database: dw
[0m21:17:40.297632 [info ] [MainThread]:   schema: public
[0m21:17:40.297790 [info ] [MainThread]:   connect_timeout: 10
[0m21:17:40.297943 [info ] [MainThread]:   role: None
[0m21:17:40.298092 [info ] [MainThread]:   search_path: None
[0m21:17:40.298240 [info ] [MainThread]:   keepalives_idle: 0
[0m21:17:40.298389 [info ] [MainThread]:   sslmode: None
[0m21:17:40.298522 [info ] [MainThread]:   sslcert: None
[0m21:17:40.298655 [info ] [MainThread]:   sslkey: None
[0m21:17:40.298787 [info ] [MainThread]:   sslrootcert: None
[0m21:17:40.298919 [info ] [MainThread]:   application_name: dbt
[0m21:17:40.299053 [info ] [MainThread]:   retries: 1
[0m21:17:40.299377 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:17:40.344337 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:17:40.364752 [debug] [MainThread]: Using postgres connection "debug"
[0m21:17:40.364978 [debug] [MainThread]: On debug: select 1 as id
[0m21:17:40.365118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:40.383499 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "localshost" to address: nodename nor servname provided, or not known

[0m21:17:40.385979 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m21:17:40.386133 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m21:17:40.386286 [debug] [MainThread]: On debug: No close available on handle
[0m21:17:40.386435 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:17:40.386593 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:17:40.386753 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "localshost" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:17:40.387752 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.23295054, "process_user_time": 0.648398, "process_kernel_time": 0.096665, "process_mem_max_rss": "102350848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:40.387980 [debug] [MainThread]: Command `cli debug` failed at 21:17:40.387930 after 0.23 seconds
[0m21:17:40.388152 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:17:40.388317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b54880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e096d0>]}
[0m21:17:40.388506 [debug] [MainThread]: Flushing usage events
[0m21:18:07.394597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107087430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af4a60>]}


============================== 21:18:07.397030 | 320213ea-ecdb-4d01-93f8-60dc029e9f04 ==============================
[0m21:18:07.397030 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:18:07.397322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:07.402851 [info ] [MainThread]: dbt version: 1.8.0
[0m21:18:07.403026 [info ] [MainThread]: python version: 3.9.2
[0m21:18:07.403174 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m21:18:07.403448 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m21:18:07.431935 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m21:18:07.432198 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m21:18:07.432362 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m21:18:07.432634 [info ] [MainThread]: adapter type: postgres
[0m21:18:07.432809 [info ] [MainThread]: adapter version: 1.9.0
[0m21:18:07.474638 [info ] [MainThread]: Configuration:
[0m21:18:07.474892 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:18:07.475066 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:18:07.475303 [info ] [MainThread]: Required dependencies:
[0m21:18:07.475528 [debug] [MainThread]: Executing "git --help"
[0m21:18:07.485790 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:18:07.488763 [debug] [MainThread]: STDERR: "b''"
[0m21:18:07.488993 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:18:07.489192 [info ] [MainThread]: Connection:
[0m21:18:07.489434 [info ] [MainThread]:   host: localhost
[0m21:18:07.489579 [info ] [MainThread]:   port: 5432
[0m21:18:07.489704 [info ] [MainThread]:   user: dw_user
[0m21:18:07.489821 [info ] [MainThread]:   database: dw
[0m21:18:07.489938 [info ] [MainThread]:   schema: public
[0m21:18:07.490057 [info ] [MainThread]:   connect_timeout: 10
[0m21:18:07.490172 [info ] [MainThread]:   role: None
[0m21:18:07.490290 [info ] [MainThread]:   search_path: None
[0m21:18:07.490408 [info ] [MainThread]:   keepalives_idle: 0
[0m21:18:07.490527 [info ] [MainThread]:   sslmode: None
[0m21:18:07.490658 [info ] [MainThread]:   sslcert: None
[0m21:18:07.490788 [info ] [MainThread]:   sslkey: None
[0m21:18:07.490918 [info ] [MainThread]:   sslrootcert: None
[0m21:18:07.491050 [info ] [MainThread]:   application_name: dbt
[0m21:18:07.491180 [info ] [MainThread]:   retries: 1
[0m21:18:07.491596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:18:07.537066 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:18:07.554885 [debug] [MainThread]: Using postgres connection "debug"
[0m21:18:07.555113 [debug] [MainThread]: On debug: select 1 as id
[0m21:18:07.555265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:07.643168 [debug] [MainThread]: SQL status: SELECT 1 in 0.088 seconds
[0m21:18:07.643735 [debug] [MainThread]: On debug: Close
[0m21:18:07.643926 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:18:07.644112 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:18:07.645176 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28005046, "process_user_time": 0.651976, "process_kernel_time": 0.090912, "process_mem_max_rss": "109101056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:18:07.645506 [debug] [MainThread]: Command `cli debug` succeeded at 21:18:07.645442 after 0.28 seconds
[0m21:18:07.645716 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:18:07.645928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107087430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a83520>]}
[0m21:18:07.646162 [debug] [MainThread]: Flushing usage events
[0m21:18:53.515200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428dd30>]}


============================== 21:18:53.517543 | 64ce004f-e771-4712-a1e1-4e5b72054bab ==============================
[0m21:18:53.517543 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:18:53.517833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:18:53.609452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ce004f-e771-4712-a1e1-4e5b72054bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eb5e0>]}
[0m21:18:53.633773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64ce004f-e771-4712-a1e1-4e5b72054bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10369c250>]}
[0m21:18:53.634385 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:18:53.686894 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:18:53.687198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64ce004f-e771-4712-a1e1-4e5b72054bab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cc760>]}
[0m21:18:53.687455 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:18:53.687631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64ce004f-e771-4712-a1e1-4e5b72054bab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ccd60>]}
[0m21:18:53.688998 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:18:53.724765 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:18:53.725016 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:18:53.725175 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:18:53.725340 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m21:18:53.725508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64ce004f-e771-4712-a1e1-4e5b72054bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f82940>]}
[0m21:18:54.325965 [error] [MainThread]: Encountered an error:
Compilation Error in model snowplow_web_events_time (models/page_views/snowplow_web_events_time.sql)
  The "adapter_macro" macro has been deprecated. Instead, use the `adapter.dispatch` method to find a macro and call the result.  For more information, see: https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch) adapter_macro was called for: snowplow.snowplow_web_events_time
  
  > in macro snowplow_web_events_time (macros/adapters/default/page_views/snowplow_web_events_time.sql)
  > called by model snowplow_web_events_time (models/page_views/snowplow_web_events_time.sql)
[0m21:18:54.326965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.84344006, "process_user_time": 1.286827, "process_kernel_time": 0.101545, "process_mem_max_rss": "105644032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:18:54.327162 [debug] [MainThread]: Command `cli run` failed at 21:18:54.327122 after 0.84 seconds
[0m21:18:54.327337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b805e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b347c0>]}
[0m21:18:54.327503 [debug] [MainThread]: Flushing usage events
[0m21:19:36.495848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105576550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107510250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107510bb0>]}


============================== 21:19:36.498256 | 0b1bed93-b808-4ddc-88d4-f9ed06e986c0 ==============================
[0m21:19:36.498256 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:19:36.498543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:19:36.504851 [info ] [MainThread]: dbt version: 1.8.0
[0m21:19:36.505074 [info ] [MainThread]: python version: 3.9.2
[0m21:19:36.505227 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m21:19:36.505373 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m21:19:36.534074 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m21:19:36.534331 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m21:19:36.534494 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m21:19:36.534757 [info ] [MainThread]: adapter type: postgres
[0m21:19:36.534943 [info ] [MainThread]: adapter version: 1.9.0
[0m21:19:36.575318 [info ] [MainThread]: Configuration:
[0m21:19:36.575574 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:19:36.575753 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:19:36.575921 [info ] [MainThread]: Required dependencies:
[0m21:19:36.576120 [debug] [MainThread]: Executing "git --help"
[0m21:19:36.586563 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:19:36.587005 [debug] [MainThread]: STDERR: "b''"
[0m21:19:36.587168 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:19:36.587338 [info ] [MainThread]: Connection:
[0m21:19:36.587543 [info ] [MainThread]:   host: localhost
[0m21:19:36.587681 [info ] [MainThread]:   port: 5432
[0m21:19:36.587816 [info ] [MainThread]:   user: dw_user
[0m21:19:36.587951 [info ] [MainThread]:   database: dw
[0m21:19:36.588085 [info ] [MainThread]:   schema: public
[0m21:19:36.588218 [info ] [MainThread]:   connect_timeout: 10
[0m21:19:36.588352 [info ] [MainThread]:   role: None
[0m21:19:36.588484 [info ] [MainThread]:   search_path: None
[0m21:19:36.588617 [info ] [MainThread]:   keepalives_idle: 0
[0m21:19:36.588750 [info ] [MainThread]:   sslmode: None
[0m21:19:36.588882 [info ] [MainThread]:   sslcert: None
[0m21:19:36.589014 [info ] [MainThread]:   sslkey: None
[0m21:19:36.589148 [info ] [MainThread]:   sslrootcert: None
[0m21:19:36.589392 [info ] [MainThread]:   application_name: dbt
[0m21:19:36.589553 [info ] [MainThread]:   retries: 1
[0m21:19:36.589881 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:19:36.635392 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:19:36.655824 [debug] [MainThread]: Using postgres connection "debug"
[0m21:19:36.656048 [debug] [MainThread]: On debug: select 1 as id
[0m21:19:36.656185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:36.685209 [debug] [MainThread]: SQL status: SELECT 1 in 0.029 seconds
[0m21:19:36.685806 [debug] [MainThread]: On debug: Close
[0m21:19:36.685979 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:19:36.686145 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:19:36.687140 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.22110587, "process_user_time": 0.658359, "process_kernel_time": 0.0953, "process_mem_max_rss": "107921408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:19:36.687361 [debug] [MainThread]: Command `cli debug` succeeded at 21:19:36.687315 after 0.22 seconds
[0m21:19:36.687523 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:19:36.687686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105576550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8e880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067280d0>]}
[0m21:19:36.687867 [debug] [MainThread]: Flushing usage events
[0m21:19:49.710855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f50520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bcb50>]}


============================== 21:19:49.712978 | fa000954-a561-4076-8c49-d38b45c76f13 ==============================
[0m21:19:49.712978 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:19:49.713271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:19:49.765965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa000954-a561-4076-8c49-d38b45c76f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517f6a0>]}
[0m21:19:49.777306 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-lmnj40du'
[0m21:19:49.777670 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:19:50.372437 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:50.372970 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m21:19:50.373340 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m21:19:50.373551 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:50.378518 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m21:19:50.378894 [debug] [MainThread]: STDERR: "b''"
[0m21:19:50.379109 [debug] [MainThread]: Checking out revision 0.9.2.
[0m21:19:50.379297 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m21:19:50.386141 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:50.386467 [debug] [MainThread]: STDERR: "b''"
[0m21:19:50.386634 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m21:19:51.063656 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:51.064264 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n * [new tag]         1.1.1      -> 1.1.1\n * [new tag]         1.2.0      -> 1.2.0\n * [new tag]         1.2.0-rc1  -> 1.2.0-rc1\n * [new tag]         1.3.0      -> 1.3.0\n'"
[0m21:19:51.064578 [debug] [MainThread]: Executing "git tag --list"
[0m21:19:51.069804 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n'"
[0m21:19:51.070179 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.070349 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m21:19:51.094755 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:19:51.095159 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.095321 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:51.099267 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:51.099550 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.099701 [debug] [MainThread]: Checked out at 064c2ab.
[0m21:19:51.099839 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:51.103170 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:51.103444 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.104128 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:19:51.107586 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:51.107923 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m21:19:51.108076 [debug] [MainThread]: command return code=128
[0m21:19:51.108674 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m21:19:51.108836 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:51.112508 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:51.112809 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.112948 [debug] [MainThread]: Checking out revision 0.9.2.
[0m21:19:51.113078 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m21:19:51.118757 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:51.119041 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.119176 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m21:19:51.617199 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:51.617827 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n'"
[0m21:19:51.618093 [debug] [MainThread]: Executing "git tag --list"
[0m21:19:51.624783 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0\n1.2.0-rc1\n1.3.0\n'"
[0m21:19:51.625240 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.625467 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m21:19:51.639100 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:19:51.639524 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.639711 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:51.643937 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:51.644356 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.644558 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m21:19:51.644733 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:51.648729 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:51.649085 [debug] [MainThread]: STDERR: "b''"
[0m21:19:51.672920 [info ] [MainThread]: Updating lock file in file path: /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/package-lock.yml
[0m21:19:51.711210 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-6w_cxez1'
[0m21:19:51.711599 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m21:19:51.711801 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:19:52.275173 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:52.275685 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m21:19:52.275928 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m21:19:52.276119 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:52.280993 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m21:19:52.281327 [debug] [MainThread]: STDERR: "b''"
[0m21:19:52.281513 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m21:19:52.281695 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:19:52.960257 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:52.960884 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m21:19:52.961111 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:19:52.988492 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:19:52.988909 [debug] [MainThread]: STDERR: "b''"
[0m21:19:52.989087 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:52.993684 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:52.994046 [debug] [MainThread]: STDERR: "b''"
[0m21:19:52.994236 [debug] [MainThread]: Checked out at 064c2ab.
[0m21:19:52.994398 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:52.998603 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:52.998979 [debug] [MainThread]: STDERR: "b''"
[0m21:19:52.999652 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m21:19:53.003684 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:53.004026 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m21:19:53.004170 [debug] [MainThread]: command return code=128
[0m21:19:53.004585 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m21:19:53.004730 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:53.008668 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:53.009616 [debug] [MainThread]: STDERR: "b''"
[0m21:19:53.009798 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m21:19:53.009956 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:19:53.693026 [debug] [MainThread]: STDOUT: "b''"
[0m21:19:53.693791 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m21:19:53.694087 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m21:19:53.710932 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m21:19:53.711368 [debug] [MainThread]: STDERR: "b''"
[0m21:19:53.711569 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m21:19:53.715778 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m21:19:53.716111 [debug] [MainThread]: STDERR: "b''"
[0m21:19:53.716294 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m21:19:53.716592 [info ] [MainThread]: Installed from revision 064c2abee80816ea855de32e66e54e96d9916677
[0m21:19:53.716943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa000954-a561-4076-8c49-d38b45c76f13', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b19b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b19e80>]}
[0m21:19:53.718356 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.036961, "process_user_time": 0.608808, "process_kernel_time": 0.134292, "process_mem_max_rss": "92930048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:19:53.718664 [debug] [MainThread]: Command `cli deps` succeeded at 21:19:53.718600 after 4.04 seconds
[0m21:19:53.718928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f50520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b19dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b19df0>]}
[0m21:19:53.719119 [debug] [MainThread]: Flushing usage events
[0m00:12:33.062251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8ab970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9208520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a05d90>]}


============================== 00:12:33.066035 | 88c202fa-5a1f-48c3-800d-2914ebcfc311 ==============================
[0m00:12:33.066035 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:12:33.066361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:33.136842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88c202fa-5a1f-48c3-800d-2914ebcfc311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba63a3d0>]}
[0m00:12:33.159422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88c202fa-5a1f-48c3-800d-2914ebcfc311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8da38b0>]}
[0m00:12:33.159848 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:12:33.171296 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:12:33.218985 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:12:33.219295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88c202fa-5a1f-48c3-800d-2914ebcfc311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99e3100>]}
[0m00:12:33.933210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88c202fa-5a1f-48c3-800d-2914ebcfc311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78c54f0>]}
[0m00:12:33.987356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88c202fa-5a1f-48c3-800d-2914ebcfc311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb786f640>]}
[0m00:12:33.987676 [info ] [MainThread]: Found 1 model, 3 seeds, 620 macros
[0m00:12:33.987913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88c202fa-5a1f-48c3-800d-2914ebcfc311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78c75e0>]}
[0m00:12:33.988607 [info ] [MainThread]: 
[0m00:12:33.988962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:33.989476 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m00:12:34.009708 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m00:12:34.009949 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:12:34.010119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:34.012221 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:12:34.012577 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:12:34.012760 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:12:34.012953 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:12:34.013120 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:12:34.013279 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m00:12:34.013627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:34.013821 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m00:12:34.013995 [info ] [MainThread]: 
[0m00:12:34.014199 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m00:12:34.014463 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:12:34.015105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.97488225, "process_user_time": 1.530197, "process_kernel_time": 0.159332, "process_mem_max_rss": "105496", "process_out_blocks": "2365", "command_success": false, "process_in_blocks": "0"}
[0m00:12:34.015350 [debug] [MainThread]: Command `dbt run` failed at 00:12:34.015306 after 0.98 seconds
[0m00:12:34.015546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8ab970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75ca760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7851e50>]}
[0m00:12:34.015745 [debug] [MainThread]: Flushing usage events
[0m19:38:59.669940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850da90>]}


============================== 19:38:59.672504 | 9af6e110-8978-482a-af9c-a3e4bfe20247 ==============================
[0m19:38:59.672504 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:38:59.672818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:38:59.728464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9af6e110-8978-482a-af9c-a3e4bfe20247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e79d0>]}
[0m19:38:59.758054 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-kbwfvsrz'
[0m19:38:59.758337 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m19:38:59.758589 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m19:39:00.335907 [debug] [MainThread]: STDOUT: "b''"
[0m19:39:00.336436 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m19:39:00.336776 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m19:39:00.336970 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:39:00.341904 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m19:39:00.342293 [debug] [MainThread]: STDERR: "b''"
[0m19:39:00.342498 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m19:39:00.342680 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:39:01.050917 [debug] [MainThread]: STDOUT: "b''"
[0m19:39:01.051454 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m19:39:01.051688 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:39:01.078780 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m19:39:01.079201 [debug] [MainThread]: STDERR: "b''"
[0m19:39:01.079374 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:39:01.083690 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:39:01.084019 [debug] [MainThread]: STDERR: "b''"
[0m19:39:01.084186 [debug] [MainThread]: Checked out at 064c2ab.
[0m19:39:01.084342 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:39:01.087807 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:39:01.088083 [debug] [MainThread]: STDERR: "b''"
[0m19:39:01.088692 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m19:39:01.092244 [debug] [MainThread]: STDOUT: "b''"
[0m19:39:01.092506 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m19:39:01.092637 [debug] [MainThread]: command return code=128
[0m19:39:01.093147 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m19:39:01.093288 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:39:01.096494 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:39:01.096766 [debug] [MainThread]: STDERR: "b''"
[0m19:39:01.096918 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m19:39:01.097060 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:39:01.639381 [debug] [MainThread]: STDOUT: "b''"
[0m19:39:01.639967 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m19:39:01.640228 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:39:01.653594 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m19:39:01.654052 [debug] [MainThread]: STDERR: "b''"
[0m19:39:01.654251 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:39:01.658383 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:39:01.658739 [debug] [MainThread]: STDERR: "b''"
[0m19:39:01.658935 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m19:39:01.659216 [info ] [MainThread]: Installed from revision 064c2abee80816ea855de32e66e54e96d9916677
[0m19:39:01.659541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9af6e110-8978-482a-af9c-a3e4bfe20247', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108674ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086746d0>]}
[0m19:39:01.660848 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.0315173, "process_user_time": 0.608664, "process_kernel_time": 0.098081, "process_mem_max_rss": "93634560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:39:01.661142 [debug] [MainThread]: Command `cli deps` succeeded at 19:39:01.661084 after 2.03 seconds
[0m19:39:01.661370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108674fa0>]}
[0m19:39:01.661571 [debug] [MainThread]: Flushing usage events
[0m19:39:16.254621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720db50>]}


============================== 19:39:16.257064 | 0ae84658-c762-4a2c-8f6e-ff802f7dfc2b ==============================
[0m19:39:16.257064 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:39:16.257354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:39:16.263052 [info ] [MainThread]: dbt version: 1.8.0
[0m19:39:16.263223 [info ] [MainThread]: python version: 3.9.2
[0m19:39:16.263375 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m19:39:16.263518 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m19:39:16.292078 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m19:39:16.292339 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m19:39:16.292501 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m19:39:16.292776 [info ] [MainThread]: adapter type: postgres
[0m19:39:16.292924 [info ] [MainThread]: adapter version: 1.9.0
[0m19:39:16.333866 [info ] [MainThread]: Configuration:
[0m19:39:16.334133 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:39:16.334302 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:39:16.334477 [info ] [MainThread]: Required dependencies:
[0m19:39:16.334692 [debug] [MainThread]: Executing "git --help"
[0m19:39:16.342791 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:39:16.343200 [debug] [MainThread]: STDERR: "b''"
[0m19:39:16.343366 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:39:16.343531 [info ] [MainThread]: Connection:
[0m19:39:16.343722 [info ] [MainThread]:   host: localhost
[0m19:39:16.343861 [info ] [MainThread]:   port: 5432
[0m19:39:16.343997 [info ] [MainThread]:   user: dw_user
[0m19:39:16.344133 [info ] [MainThread]:   database: dw
[0m19:39:16.344267 [info ] [MainThread]:   schema: public
[0m19:39:16.344403 [info ] [MainThread]:   connect_timeout: 10
[0m19:39:16.344537 [info ] [MainThread]:   role: None
[0m19:39:16.344672 [info ] [MainThread]:   search_path: None
[0m19:39:16.344808 [info ] [MainThread]:   keepalives_idle: 0
[0m19:39:16.344941 [info ] [MainThread]:   sslmode: None
[0m19:39:16.345071 [info ] [MainThread]:   sslcert: None
[0m19:39:16.345204 [info ] [MainThread]:   sslkey: None
[0m19:39:16.345337 [info ] [MainThread]:   sslrootcert: None
[0m19:39:16.345471 [info ] [MainThread]:   application_name: dbt
[0m19:39:16.345605 [info ] [MainThread]:   retries: 1
[0m19:39:16.345924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:39:16.390316 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:39:16.410497 [debug] [MainThread]: Using postgres connection "debug"
[0m19:39:16.410708 [debug] [MainThread]: On debug: select 1 as id
[0m19:39:16.410842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:16.506973 [debug] [MainThread]: SQL status: SELECT 1 in 0.096 seconds
[0m19:39:16.507747 [debug] [MainThread]: On debug: Close
[0m19:39:16.507990 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:39:16.508203 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:39:16.509470 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28464243, "process_user_time": 0.663025, "process_kernel_time": 0.099024, "process_mem_max_rss": "108478464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:39:16.509805 [debug] [MainThread]: Command `cli debug` succeeded at 19:39:16.509738 after 0.29 seconds
[0m19:39:16.510023 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:39:16.510253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055be6a0>]}
[0m19:39:16.510503 [debug] [MainThread]: Flushing usage events
[0m19:49:42.359773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10384e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d1dc0>]}


============================== 19:49:42.362432 | 62c9847a-31d4-45f9-bf27-c1c48e9d6236 ==============================
[0m19:49:42.362432 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:49:42.362749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:42.453604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105697b50>]}
[0m19:49:42.477090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056823a0>]}
[0m19:49:42.477739 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:49:42.529925 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m19:49:42.575660 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:49:42.575939 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m19:49:42.576139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c6f10>]}
[0m19:49:43.227752 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- seeds.my_dbt_project.payments
- seeds.my_dbt_project.customers
- seeds.my_dbt_project.orders
[0m19:49:43.230706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062aa130>]}
[0m19:49:43.283263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f7580>]}
[0m19:49:43.283546 [info ] [MainThread]: Found 1 model, 6 seeds, 626 macros
[0m19:49:43.283718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062aac40>]}
[0m19:49:43.284283 [info ] [MainThread]: 
[0m19:49:43.284567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:43.285001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:49:43.329915 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:49:43.330149 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:49:43.330323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:43.350708 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m19:49:43.351440 [debug] [ThreadPool]: On list_dw: Close
[0m19:49:43.353967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m19:49:43.357452 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:49:43.357636 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:49:43.357781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:43.365757 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m19:49:43.366102 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:49:43.366275 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:49:43.369170 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m19:49:43.369856 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:49:43.370417 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:49:43.373649 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:43.373851 [debug] [MainThread]: On master: BEGIN
[0m19:49:43.373983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:43.380932 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:49:43.381142 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:43.381321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:43.386257 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:49:43.386838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c88b0>]}
[0m19:49:43.387052 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:43.387456 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:43.387600 [debug] [MainThread]: On master: BEGIN
[0m19:49:43.388235 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:49:43.388419 [debug] [MainThread]: On master: COMMIT
[0m19:49:43.388571 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:43.388703 [debug] [MainThread]: On master: COMMIT
[0m19:49:43.389078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:43.389226 [debug] [MainThread]: On master: Close
[0m19:49:43.389456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:49:43.389615 [info ] [MainThread]: 
[0m19:49:43.390877 [debug] [Thread-1  ]: Began running node model.my_dbt_project.sample
[0m19:49:43.391145 [info ] [Thread-1  ]: 1 of 1 START sql table model public.sample ..................................... [RUN]
[0m19:49:43.391378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.sample)
[0m19:49:43.391552 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.sample
[0m19:49:43.395846 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.sample"
[0m19:49:43.396909 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.sample
[0m19:49:43.416641 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.sample"
[0m19:49:43.417462 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:43.417655 [debug] [Thread-1  ]: On model.my_dbt_project.sample: BEGIN
[0m19:49:43.417810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:49:43.427402 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m19:49:43.427643 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:43.427828 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */

  
    

  create  table "dw"."public"."sample__dbt_tmp"
  
  
    as
  
  (
    

SELECT 1 AS id, 'hello' AS message
UNION ALL
SELECT 2 AS id, 'world' AS message
  );
  
[0m19:49:43.432844 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.005 seconds
[0m19:49:43.436582 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:43.436767 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample" rename to "sample__dbt_backup"
[0m19:49:43.437533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:43.439220 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:43.439379 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample__dbt_tmp" rename to "sample"
[0m19:49:43.439837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:43.449316 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m19:49:43.449481 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:43.449626 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m19:49:43.450361 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:49:43.453946 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."sample__dbt_backup"
[0m19:49:43.455885 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:43.456042 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
drop table if exists "dw"."public"."sample__dbt_backup" cascade
[0m19:49:43.459706 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m19:49:43.460877 [debug] [Thread-1  ]: On model.my_dbt_project.sample: Close
[0m19:49:43.461615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c9847a-31d4-45f9-bf27-c1c48e9d6236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a6b610>]}
[0m19:49:43.461940 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.sample ................................ [[32mSELECT 2[0m in 0.07s]
[0m19:49:43.462230 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.sample
[0m19:49:43.462837 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:43.463012 [debug] [MainThread]: On master: BEGIN
[0m19:49:43.463156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:43.468881 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:49:43.469081 [debug] [MainThread]: On master: COMMIT
[0m19:49:43.469231 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:43.469358 [debug] [MainThread]: On master: COMMIT
[0m19:49:43.469728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:43.469881 [debug] [MainThread]: On master: Close
[0m19:49:43.470083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:43.470217 [debug] [MainThread]: Connection 'model.my_dbt_project.sample' was properly closed.
[0m19:49:43.470372 [info ] [MainThread]: 
[0m19:49:43.470539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m19:49:43.470865 [debug] [MainThread]: Command end result
[0m19:49:43.489529 [info ] [MainThread]: 
[0m19:49:43.489771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:43.489927 [info ] [MainThread]: 
[0m19:49:43.490088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:49:43.491164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1632757, "process_user_time": 1.522961, "process_kernel_time": 0.117606, "process_mem_max_rss": "124993536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:43.491344 [debug] [MainThread]: Command `cli run` succeeded at 19:49:43.491309 after 1.16 seconds
[0m19:49:43.491516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10384e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bacb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105697b50>]}
[0m19:49:43.491673 [debug] [MainThread]: Flushing usage events
[0m19:49:56.605509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12134e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b11250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b11d60>]}


============================== 19:49:56.607974 | 68381869-ef75-45e2-9efe-fe457d3dbf75 ==============================
[0m19:49:56.607974 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:49:56.608282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:56.682457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ad76d0>]}
[0m19:49:56.705657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126eab820>]}
[0m19:49:56.706939 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:49:56.758238 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m19:49:56.827440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:56.827677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:56.830782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- seeds.my_dbt_project.orders
- seeds.my_dbt_project.payments
- seeds.my_dbt_project.customers
[0m19:49:56.847806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127523130>]}
[0m19:49:56.899441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12753e9d0>]}
[0m19:49:56.899726 [info ] [MainThread]: Found 1 model, 6 seeds, 626 macros
[0m19:49:56.899907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127532f10>]}
[0m19:49:56.900506 [info ] [MainThread]: 
[0m19:49:56.900795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:56.901231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:49:56.924211 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:49:56.924412 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:49:56.924553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:56.943576 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m19:49:56.944259 [debug] [ThreadPool]: On list_dw: Close
[0m19:49:56.946574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m19:49:56.949652 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:49:56.949813 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:49:56.949942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:56.959102 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:49:56.959274 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:49:56.959428 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:49:56.963513 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:49:56.964098 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:49:56.964886 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:49:56.967545 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:56.967711 [debug] [MainThread]: On master: BEGIN
[0m19:49:56.967836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:56.975577 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m19:49:56.975779 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:56.975986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:56.979629 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m19:49:56.980297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12753eaf0>]}
[0m19:49:56.980541 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:56.981185 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:56.981332 [debug] [MainThread]: On master: BEGIN
[0m19:49:56.982233 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:49:56.982370 [debug] [MainThread]: On master: COMMIT
[0m19:49:56.982495 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:56.982617 [debug] [MainThread]: On master: COMMIT
[0m19:49:56.983111 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:56.983252 [debug] [MainThread]: On master: Close
[0m19:49:56.983470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:49:56.983628 [info ] [MainThread]: 
[0m19:49:56.984667 [debug] [Thread-1  ]: Began running node model.my_dbt_project.sample
[0m19:49:56.984936 [info ] [Thread-1  ]: 1 of 1 START sql table model public.sample ..................................... [RUN]
[0m19:49:56.985169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.sample)
[0m19:49:56.985347 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.sample
[0m19:49:56.989861 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.sample"
[0m19:49:56.990211 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.sample
[0m19:49:57.009809 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.sample"
[0m19:49:57.010274 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:57.010434 [debug] [Thread-1  ]: On model.my_dbt_project.sample: BEGIN
[0m19:49:57.010579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:49:57.018531 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:49:57.018720 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:57.018905 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */

  
    

  create  table "dw"."public"."sample__dbt_tmp"
  
  
    as
  
  (
    

SELECT 1 AS id, 'hello' AS message
UNION ALL
SELECT 2 AS id, 'world' AS message
  );
  
[0m19:49:57.022709 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.004 seconds
[0m19:49:57.026073 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:57.026247 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample" rename to "sample__dbt_backup"
[0m19:49:57.027280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:57.029004 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:57.029192 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample__dbt_tmp" rename to "sample"
[0m19:49:57.029912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:57.039353 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m19:49:57.039523 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:57.039670 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m19:49:57.041700 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m19:49:57.044622 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."sample__dbt_backup"
[0m19:49:57.046557 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m19:49:57.046714 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
drop table if exists "dw"."public"."sample__dbt_backup" cascade
[0m19:49:57.049454 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m19:49:57.050574 [debug] [Thread-1  ]: On model.my_dbt_project.sample: Close
[0m19:49:57.051235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68381869-ef75-45e2-9efe-fe457d3dbf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a53730>]}
[0m19:49:57.051505 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.sample ................................ [[32mSELECT 2[0m in 0.07s]
[0m19:49:57.051784 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.sample
[0m19:49:57.052309 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:57.052464 [debug] [MainThread]: On master: BEGIN
[0m19:49:57.052595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:57.059145 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:49:57.059329 [debug] [MainThread]: On master: COMMIT
[0m19:49:57.059475 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:57.059611 [debug] [MainThread]: On master: COMMIT
[0m19:49:57.060107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:57.060281 [debug] [MainThread]: On master: Close
[0m19:49:57.060495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:57.060654 [debug] [MainThread]: Connection 'model.my_dbt_project.sample' was properly closed.
[0m19:49:57.060815 [info ] [MainThread]: 
[0m19:49:57.061025 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m19:49:57.061406 [debug] [MainThread]: Command end result
[0m19:49:57.099312 [info ] [MainThread]: 
[0m19:49:57.099570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:57.099731 [info ] [MainThread]: 
[0m19:49:57.099892 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:49:57.100837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.52483547, "process_user_time": 0.914785, "process_kernel_time": 0.103498, "process_mem_max_rss": "116703232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:57.101036 [debug] [MainThread]: Command `cli run` succeeded at 19:49:57.100995 after 0.53 seconds
[0m19:49:57.101227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12134e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218c92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279e5c10>]}
[0m19:49:57.101409 [debug] [MainThread]: Flushing usage events
[0m19:59:24.574197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12568c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12568c9a0>]}


============================== 19:59:24.577091 | 144505ee-0cc0-447f-a88c-61a6c170982b ==============================
[0m19:59:24.577091 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:59:24.577387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:24.643488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '144505ee-0cc0-447f-a88c-61a6c170982b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12566e3a0>]}
[0m19:59:24.686730 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-b51mgxb_'
[0m19:59:24.687030 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m19:59:24.687287 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m19:59:25.295103 [debug] [MainThread]: STDOUT: "b''"
[0m19:59:25.295591 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m19:59:25.295935 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m19:59:25.296126 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:59:25.301082 [debug] [MainThread]: STDOUT: "b'22855099135cd4de445bed45601f11cb1caabb24\n'"
[0m19:59:25.301465 [debug] [MainThread]: STDERR: "b''"
[0m19:59:25.301668 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m19:59:25.301851 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:59:25.974391 [debug] [MainThread]: STDOUT: "b''"
[0m19:59:25.975033 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m19:59:25.975313 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:59:26.006008 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m19:59:26.006496 [debug] [MainThread]: STDERR: "b''"
[0m19:59:26.006691 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:59:26.011117 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:59:26.011469 [debug] [MainThread]: STDERR: "b''"
[0m19:59:26.011652 [debug] [MainThread]: Checked out at 064c2ab.
[0m19:59:26.011809 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:59:26.015618 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:59:26.015986 [debug] [MainThread]: STDERR: "b''"
[0m19:59:26.016662 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m19:59:26.020428 [debug] [MainThread]: STDOUT: "b''"
[0m19:59:26.020751 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m19:59:26.020885 [debug] [MainThread]: command return code=128
[0m19:59:26.021415 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m19:59:26.021564 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:59:26.026365 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:59:26.026724 [debug] [MainThread]: STDERR: "b''"
[0m19:59:26.026883 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m19:59:26.027028 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:59:26.529656 [debug] [MainThread]: STDOUT: "b''"
[0m19:59:26.530402 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m19:59:26.530710 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m19:59:26.541592 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m19:59:26.542073 [debug] [MainThread]: STDERR: "b''"
[0m19:59:26.542311 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:59:26.547039 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m19:59:26.547491 [debug] [MainThread]: STDERR: "b''"
[0m19:59:26.547723 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m19:59:26.548047 [info ] [MainThread]: Installed from revision 064c2abee80816ea855de32e66e54e96d9916677
[0m19:59:26.548395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '144505ee-0cc0-447f-a88c-61a6c170982b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257f4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257f42e0>]}
[0m19:59:26.549929 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.0099058, "process_user_time": 0.608421, "process_kernel_time": 0.108635, "process_mem_max_rss": "94486528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:59:26.550251 [debug] [MainThread]: Command `dbt deps` succeeded at 19:59:26.550189 after 2.01 seconds
[0m19:59:26.550523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257def40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257f4100>]}
[0m19:59:26.550734 [debug] [MainThread]: Flushing usage events
[0m20:00:50.723994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11098c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11098c940>]}


============================== 20:00:50.726477 | c2586b61-02e6-40ef-99a7-6a4859e67e29 ==============================
[0m20:00:50.726477 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:00:50.726770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:50.761122 [error] [MainThread]: Encountered an error:
'version'
[0m20:00:50.762636 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 234, in wrapper
    project = load_project(
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/config/runtime.py", line 51, in load_project
    project = Project.from_project_root(
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/config/project.py", line 766, in from_project_root
    return partial.render(renderer)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/config/project.py", line 335, in render
    return self.create_project(rendered)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/config/project.py", line 482, in create_project
    packages: PackageConfig = package_config_from_data(
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/config/project.py", line 150, in package_config_from_data
    PackageConfig.validate(packages_data)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/contracts/project.py", line 119, in validate
    if not package["version"]:
KeyError: 'version'

[0m20:00:50.763678 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.07245358, "process_user_time": 0.576713, "process_kernel_time": 0.069701, "process_mem_max_rss": "92143616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:00:50.763876 [debug] [MainThread]: Command `dbt deps` failed at 20:00:50.763834 after 0.07 seconds
[0m20:00:50.764040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a76d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a76e20>]}
[0m20:00:50.764200 [debug] [MainThread]: Flushing usage events
[0m20:01:00.471761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ef460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605ca00>]}


============================== 20:01:00.474145 | e4cd24d7-92ec-4dd2-b56a-123b4a08a6a8 ==============================
[0m20:01:00.474145 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:01:00.474440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:01:00.537932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4cd24d7-92ec-4dd2-b56a-123b4a08a6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480f940>]}
[0m20:01:00.549397 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-63ptz6xh'
[0m20:01:00.549679 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:01:00.940028 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:01:00.940852 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt-utils was not found in the package index
[0m20:01:00.944157 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/main.py", line 446, in deps
    results = task.run()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 225, in run
    self.lock()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/registry.py", line 101, in resolved
    self._check_in_index()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/registry.py", line 80, in _check_in_index
    raise PackageNotFoundError(self.package)
dbt.exceptions.PackageNotFoundError: Package dbt-labs/dbt-utils was not found in the package index

[0m20:01:00.945599 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.51377344, "process_user_time": 0.600804, "process_kernel_time": 0.068525, "process_mem_max_rss": "95797248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:01:00.946010 [debug] [MainThread]: Command `dbt deps` failed at 20:01:00.945918 after 0.51 seconds
[0m20:01:00.946369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ef460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106024400>]}
[0m20:01:00.946718 [debug] [MainThread]: Flushing usage events
[0m20:03:18.330426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e551c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e55ac0>]}


============================== 20:03:18.332824 | 757d1aff-1eb6-46d6-9de7-99febdb741a3 ==============================
[0m20:03:18.332824 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:03:18.333125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:03:18.395878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '757d1aff-1eb6-46d6-9de7-99febdb741a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2ff10>]}
[0m20:03:18.406711 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-2qdnxrov'
[0m20:03:18.406976 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:03:18.694187 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:03:18.694714 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt-utils was not found in the package index
[0m20:03:18.696669 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/cli/main.py", line 446, in deps
    results = task.run()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 225, in run
    self.lock()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/registry.py", line 101, in resolved
    self._check_in_index()
  File "/Users/fehmmialiti/.pyenv/versions/3.9.2/lib/python3.9/site-packages/dbt/deps/registry.py", line 80, in _check_in_index
    raise PackageNotFoundError(self.package)
dbt.exceptions.PackageNotFoundError: Package dbt-labs/dbt-utils was not found in the package index

[0m20:03:18.698144 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.39849862, "process_user_time": 0.593663, "process_kernel_time": 0.067285, "process_mem_max_rss": "96108544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:03:18.698461 [debug] [MainThread]: Command `dbt deps` failed at 20:03:18.698394 after 0.40 seconds
[0m20:03:18.698692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dec220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb8520>]}
[0m20:03:18.698930 [debug] [MainThread]: Flushing usage events
[0m20:04:06.690546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dcc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dcc940>]}


============================== 20:04:06.692918 | 373c292e-4626-4d29-b8e7-663637438870 ==============================
[0m20:04:06.692918 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:04:06.693198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:04:06.757084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373c292e-4626-4d29-b8e7-663637438870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7bd30>]}
[0m20:04:06.767407 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-ak5lixpj'
[0m20:04:06.767653 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:04:06.840434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:04:06.840938 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:04:06.907274 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:04:06.916398 [info ] [MainThread]: Updating lock file in file path: /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/package-lock.yml
[0m20:04:06.945299 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-b7h5f_f2'
[0m20:04:06.947594 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:04:07.239896 [info ] [MainThread]: Installed from version 1.3.0
[0m20:04:07.240195 [info ] [MainThread]: Up to date!
[0m20:04:07.240434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '373c292e-4626-4d29-b8e7-663637438870', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e3100>]}
[0m20:04:07.241785 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58177364, "process_user_time": 0.659523, "process_kernel_time": 0.129384, "process_mem_max_rss": "97206272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:04:07.242107 [debug] [MainThread]: Command `dbt deps` succeeded at 20:04:07.242042 after 0.58 seconds
[0m20:04:07.242335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110650d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110bbb50>]}
[0m20:04:07.242556 [debug] [MainThread]: Flushing usage events
[0m21:09:08.510846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111abe5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11394f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11394ff10>]}


============================== 21:09:08.513291 | ddb36472-cedf-4805-967b-37138d0ddcc6 ==============================
[0m21:09:08.513291 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:09:08.513575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:09:08.590317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b92a00>]}
[0m21:09:08.613705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e197c0>]}
[0m21:09:08.614412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:09:08.664684 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:09:08.709372 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:09:08.709639 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:09:08.709848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112446f10>]}
[0m21:09:09.305234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_dbt_project.staging
- seeds.my_dbt_project.payments
- seeds.my_dbt_project.orders
- seeds.my_dbt_project.customers
[0m21:09:09.308039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114757130>]}
[0m21:09:09.363207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147dc070>]}
[0m21:09:09.363481 [info ] [MainThread]: Found 1 model, 6 seeds, 545 macros
[0m21:09:09.364119 [info ] [MainThread]: 
[0m21:09:09.364398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:09:09.364831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:09:09.386473 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:09:09.386677 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:09:09.386813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:09.406043 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m21:09:09.406874 [debug] [ThreadPool]: On list_dw: Close
[0m21:09:09.409285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m21:09:09.412358 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:09:09.412508 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:09:09.412634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:09.423424 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m21:09:09.423610 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:09:09.423762 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:09:09.429194 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:09:09.429842 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:09:09.430422 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:09:09.433510 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:09.433703 [debug] [MainThread]: On master: BEGIN
[0m21:09:09.433845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:09.440848 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:09:09.441063 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:09.441262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:09:09.443539 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m21:09:09.444141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a388b0>]}
[0m21:09:09.444380 [debug] [MainThread]: On master: ROLLBACK
[0m21:09:09.444855 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:09.445020 [debug] [MainThread]: On master: BEGIN
[0m21:09:09.446490 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:09:09.446625 [debug] [MainThread]: On master: COMMIT
[0m21:09:09.446753 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:09.446873 [debug] [MainThread]: On master: COMMIT
[0m21:09:09.447422 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:09.447553 [debug] [MainThread]: On master: Close
[0m21:09:09.447753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:09:09.447908 [info ] [MainThread]: 
[0m21:09:09.449281 [debug] [Thread-1  ]: Began running node model.my_dbt_project.sample
[0m21:09:09.449531 [info ] [Thread-1  ]: 1 of 1 START sql table model public.sample ..................................... [RUN]
[0m21:09:09.449778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.sample)
[0m21:09:09.449955 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.sample
[0m21:09:09.454116 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.sample"
[0m21:09:09.454474 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.sample
[0m21:09:09.473603 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.sample"
[0m21:09:09.474039 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m21:09:09.474196 [debug] [Thread-1  ]: On model.my_dbt_project.sample: BEGIN
[0m21:09:09.474343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:09:09.483872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:09:09.484034 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m21:09:09.484189 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */

  
    

  create  table "dw"."public"."sample__dbt_tmp"
  
  
    as
  
  (
    

SELECT 1 AS id, 'hello' AS message
UNION ALL
SELECT 2 AS id, 'world' AS message
  );
  
[0m21:09:09.491034 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.007 seconds
[0m21:09:09.517117 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m21:09:09.517348 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample" rename to "sample__dbt_backup"
[0m21:09:09.519055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:09:09.520604 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m21:09:09.520771 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
alter table "dw"."public"."sample__dbt_tmp" rename to "sample"
[0m21:09:09.521707 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:09.530919 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m21:09:09.531090 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m21:09:09.531236 [debug] [Thread-1  ]: On model.my_dbt_project.sample: COMMIT
[0m21:09:09.533369 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:09:09.536236 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."sample__dbt_backup"
[0m21:09:09.538313 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.sample"
[0m21:09:09.538474 [debug] [Thread-1  ]: On model.my_dbt_project.sample: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.sample"} */
drop table if exists "dw"."public"."sample__dbt_backup" cascade
[0m21:09:09.544836 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m21:09:09.545983 [debug] [Thread-1  ]: On model.my_dbt_project.sample: Close
[0m21:09:09.546646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb36472-cedf-4805-967b-37138d0ddcc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dfb610>]}
[0m21:09:09.546920 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.sample ................................ [[32mSELECT 2[0m in 0.10s]
[0m21:09:09.547206 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.sample
[0m21:09:09.547723 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:09.547871 [debug] [MainThread]: On master: BEGIN
[0m21:09:09.547996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:09:09.556039 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m21:09:09.556188 [debug] [MainThread]: On master: COMMIT
[0m21:09:09.556316 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:09.556441 [debug] [MainThread]: On master: COMMIT
[0m21:09:09.556921 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:09.557053 [debug] [MainThread]: On master: Close
[0m21:09:09.557222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:09.557342 [debug] [MainThread]: Connection 'model.my_dbt_project.sample' was properly closed.
[0m21:09:09.557476 [info ] [MainThread]: 
[0m21:09:09.557632 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m21:09:09.557985 [debug] [MainThread]: Command end result
[0m21:09:09.575525 [info ] [MainThread]: 
[0m21:09:09.575781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:09.575942 [info ] [MainThread]: 
[0m21:09:09.576107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:09:09.577154 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0977137, "process_user_time": 1.491713, "process_kernel_time": 0.106849, "process_mem_max_rss": "125992960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:09:09.577331 [debug] [MainThread]: Command `cli build` succeeded at 21:09:09.577296 after 1.10 seconds
[0m21:09:09.577505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111abe5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132252b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b348e0>]}
[0m21:09:09.577663 [debug] [MainThread]: Flushing usage events
[0m21:16:49.803611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108177430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00cb20>]}


============================== 21:16:49.806325 | fd5a107a-39d4-4979-b508-c3ef9ad75cd0 ==============================
[0m21:16:49.806325 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:16:49.806621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:49.901464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb29d0>]}
[0m21:16:49.925100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc6100>]}
[0m21:16:49.925653 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:16:49.976887 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:16:50.022309 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:16:50.022579 [debug] [MainThread]: previous checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, current checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511
[0m21:16:50.022762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c4a60>]}
[0m21:16:50.630020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_dbt_project.staging
- seeds.my_dbt_project.orders
- seeds.my_dbt_project.payments
- seeds.my_dbt_project.customers
[0m21:16:50.633012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3b130>]}
[0m21:16:50.683104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3b730>]}
[0m21:16:50.683387 [info ] [MainThread]: Found 1 model, 6 seeds, 545 macros
[0m21:16:50.683557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac70670>]}
[0m21:16:50.684459 [info ] [MainThread]: 
[0m21:16:50.684722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:50.686835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:16:50.711351 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:16:50.711566 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:16:50.711699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:50.732571 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m21:16:50.733250 [debug] [ThreadPool]: On list_dw: Close
[0m21:16:50.733982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m21:16:50.737203 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:16:50.737349 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:16:50.737471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:50.744001 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:16:50.744213 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:16:50.744356 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:16:50.746951 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m21:16:50.747537 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:16:50.747997 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:16:50.750614 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:50.750769 [debug] [MainThread]: On master: BEGIN
[0m21:16:50.750892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:50.757319 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:16:50.757470 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:50.757650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:50.760710 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m21:16:50.761347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e3d00>]}
[0m21:16:50.761598 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:50.762080 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:50.762246 [debug] [MainThread]: On master: BEGIN
[0m21:16:50.763039 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:16:50.763242 [debug] [MainThread]: On master: COMMIT
[0m21:16:50.763385 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:50.763515 [debug] [MainThread]: On master: COMMIT
[0m21:16:50.763945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:50.764091 [debug] [MainThread]: On master: Close
[0m21:16:50.764344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:50.764518 [info ] [MainThread]: 
[0m21:16:50.765855 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_customers
[0m21:16:50.766101 [info ] [Thread-1  ]: 1 of 6 START seed file public.raw_customers .................................... [RUN]
[0m21:16:50.766328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now seed.my_dbt_project.raw_customers)
[0m21:16:50.766487 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_customers
[0m21:16:50.766638 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_customers
[0m21:16:50.781886 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m21:16:50.782085 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: BEGIN
[0m21:16:50.782233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:16:50.790873 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:16:50.791033 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m21:16:50.791187 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_customers"} */

    create table "dw"."public"."raw_customers" ("id" text,"name" text)
  
[0m21:16:50.795411 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.004 seconds
[0m21:16:50.969001 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m21:16:50.969252 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: 
          insert into "dw"."public"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s...
[0m21:16:50.976824 [debug] [Thread-1  ]: SQL status: INSERT 0 930 in 0.007 seconds
[0m21:16:50.979675 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_customers"
[0m21:16:50.988802 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m21:16:50.988989 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m21:16:50.989137 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m21:16:50.989832 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:16:50.990807 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: Close
[0m21:16:50.991554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1d2460>]}
[0m21:16:50.991815 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file public.raw_customers ................................ [[32mINSERT 930[0m in 0.22s]
[0m21:16:50.992102 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_customers
[0m21:16:50.992313 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_items
[0m21:16:50.992586 [info ] [Thread-1  ]: 2 of 6 START seed file public.raw_items ........................................ [RUN]
[0m21:16:50.992801 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_customers, now seed.my_dbt_project.raw_items)
[0m21:16:50.992972 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_items
[0m21:16:50.993135 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_items
[0m21:16:51.280147 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:16:51.280414 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: BEGIN
[0m21:16:51.280573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:16:51.293111 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m21:16:51.293325 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:16:51.293481 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_items"} */

    create table "dw"."public"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m21:16:51.300720 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.007 seconds
[0m21:16:53.583044 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:16:53.583331 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:16:53.646802 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.063 seconds
[0m21:16:55.918347 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:16:55.918607 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:16:55.980805 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.062 seconds
[0m21:16:58.230572 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:16:58.230841 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:16:58.285995 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.055 seconds
[0m21:17:00.523851 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:00.524113 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:00.576259 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.052 seconds
[0m21:17:02.859872 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:02.860250 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:02.922182 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.062 seconds
[0m21:17:05.213142 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:05.213424 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:05.273209 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.060 seconds
[0m21:17:07.560864 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:07.561123 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:07.611561 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.050 seconds
[0m21:17:09.894538 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:09.895155 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:09.942699 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.047 seconds
[0m21:17:12.270712 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:12.271017 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:12.326489 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.055 seconds
[0m21:17:12.372816 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:12.373030 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m21:17:12.374226 [debug] [Thread-1  ]: SQL status: INSERT 0 183 in 0.001 seconds
[0m21:17:12.374827 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_items"
[0m21:17:12.377143 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m21:17:12.377302 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m21:17:12.377445 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m21:17:12.381567 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m21:17:12.382016 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: Close
[0m21:17:12.382355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e3d00>]}
[0m21:17:12.382642 [info ] [Thread-1  ]: 2 of 6 OK loaded seed file public.raw_items .................................... [[32mINSERT 90183[0m in 21.39s]
[0m21:17:12.382934 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_items
[0m21:17:12.383139 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_orders
[0m21:17:12.383411 [info ] [Thread-1  ]: 3 of 6 START seed file public.raw_orders ....................................... [RUN]
[0m21:17:12.383623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_items, now seed.my_dbt_project.raw_orders)
[0m21:17:12.383792 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_orders
[0m21:17:12.383958 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_orders
[0m21:17:13.997443 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:13.997704 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: BEGIN
[0m21:17:13.997864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:17:14.005219 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:17:14.005443 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:14.005604 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_orders"} */

    create table "dw"."public"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m21:17:14.010219 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.004 seconds
[0m21:17:19.161051 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:19.161334 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:19.253549 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.092 seconds
[0m21:17:24.601796 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:24.602078 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:24.695902 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.094 seconds
[0m21:17:30.180508 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:30.181965 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:30.293058 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.111 seconds
[0m21:17:35.711680 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:35.711967 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:35.819547 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.107 seconds
[0m21:17:41.315566 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:41.316038 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:41.411441 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.095 seconds
[0m21:17:46.924854 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:46.925143 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:47.032596 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.107 seconds
[0m21:17:48.702344 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:48.702622 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m21:17:48.745260 [debug] [Thread-1  ]: SQL status: INSERT 0 3148 in 0.042 seconds
[0m21:17:48.746207 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_orders"
[0m21:17:48.747639 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m21:17:48.747831 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m21:17:48.748002 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m21:17:48.749912 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:17:48.750315 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: Close
[0m21:17:48.750686 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa1190>]}
[0m21:17:48.750985 [info ] [Thread-1  ]: 3 of 6 OK loaded seed file public.raw_orders ................................... [[32mINSERT 63148[0m in 36.37s]
[0m21:17:48.751309 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_orders
[0m21:17:48.751533 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_products
[0m21:17:48.751828 [info ] [Thread-1  ]: 4 of 6 START seed file public.raw_products ..................................... [RUN]
[0m21:17:48.752063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_orders, now seed.my_dbt_project.raw_products)
[0m21:17:48.752254 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_products
[0m21:17:48.752437 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_products
[0m21:17:48.755116 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m21:17:48.755308 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: BEGIN
[0m21:17:48.755479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:17:48.763258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:17:48.763504 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m21:17:48.763671 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_products"} */

    create table "dw"."public"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m21:17:48.766434 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m21:17:48.771122 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m21:17:48.771299 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: 
          insert into "dw"."public"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m21:17:48.772267 [debug] [Thread-1  ]: SQL status: INSERT 0 10 in 0.001 seconds
[0m21:17:48.772791 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_products"
[0m21:17:48.773864 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m21:17:48.774033 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m21:17:48.774194 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m21:17:48.775193 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:17:48.775546 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: Close
[0m21:17:48.775812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a912520>]}
[0m21:17:48.776066 [info ] [Thread-1  ]: 4 of 6 OK loaded seed file public.raw_products ................................. [[32mINSERT 10[0m in 0.02s]
[0m21:17:48.776354 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_products
[0m21:17:48.776555 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_stores
[0m21:17:48.776820 [info ] [Thread-1  ]: 5 of 6 START seed file public.raw_stores ....................................... [RUN]
[0m21:17:48.777035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_products, now seed.my_dbt_project.raw_stores)
[0m21:17:48.777202 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_stores
[0m21:17:48.777364 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_stores
[0m21:17:48.779665 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m21:17:48.779914 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: BEGIN
[0m21:17:48.780055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:17:48.788511 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:17:48.788835 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m21:17:48.789022 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_stores"} */

    create table "dw"."public"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m21:17:48.792326 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m21:17:48.795344 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m21:17:48.795533 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: 
          insert into "dw"."public"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m21:17:48.797012 [debug] [Thread-1  ]: SQL status: INSERT 0 6 in 0.001 seconds
[0m21:17:48.797350 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_stores"
[0m21:17:48.798526 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m21:17:48.798702 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m21:17:48.798865 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m21:17:48.799977 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:17:48.800396 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: Close
[0m21:17:48.800696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa1190>]}
[0m21:17:48.800978 [info ] [Thread-1  ]: 5 of 6 OK loaded seed file public.raw_stores ................................... [[32mINSERT 6[0m in 0.02s]
[0m21:17:48.801274 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_stores
[0m21:17:48.801484 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_supplies
[0m21:17:48.801732 [info ] [Thread-1  ]: 6 of 6 START seed file public.raw_supplies ..................................... [RUN]
[0m21:17:48.801961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_stores, now seed.my_dbt_project.raw_supplies)
[0m21:17:48.802134 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_supplies
[0m21:17:48.802298 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_supplies
[0m21:17:48.805539 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m21:17:48.805761 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: BEGIN
[0m21:17:48.805927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:17:48.816037 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:17:48.816345 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m21:17:48.816536 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_supplies"} */

    create table "dw"."public"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m21:17:48.820093 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m21:17:48.849300 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m21:17:48.849598 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: 
          insert into "dw"."public"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%...
[0m21:17:48.851836 [debug] [Thread-1  ]: SQL status: INSERT 0 65 in 0.002 seconds
[0m21:17:48.852460 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_supplies"
[0m21:17:48.853718 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m21:17:48.853913 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m21:17:48.854082 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m21:17:48.855130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:17:48.855489 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: Close
[0m21:17:48.855766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5a107a-39d4-4979-b508-c3ef9ad75cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee6a340>]}
[0m21:17:48.856021 [info ] [Thread-1  ]: 6 of 6 OK loaded seed file public.raw_supplies ................................. [[32mINSERT 65[0m in 0.05s]
[0m21:17:48.856301 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_supplies
[0m21:17:48.857944 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:48.858320 [debug] [MainThread]: On master: BEGIN
[0m21:17:48.858463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:48.868328 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:17:48.868698 [debug] [MainThread]: On master: COMMIT
[0m21:17:48.868865 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:48.869009 [debug] [MainThread]: On master: COMMIT
[0m21:17:48.869907 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:17:48.870077 [debug] [MainThread]: On master: Close
[0m21:17:48.870332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:48.870468 [debug] [MainThread]: Connection 'seed.my_dbt_project.raw_supplies' was properly closed.
[0m21:17:48.870877 [info ] [MainThread]: 
[0m21:17:48.871058 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 58.19 seconds (58.19s).
[0m21:17:48.871786 [debug] [MainThread]: Command end result
[0m21:17:48.891524 [info ] [MainThread]: 
[0m21:17:48.891817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:48.891984 [info ] [MainThread]: 
[0m21:17:48.892159 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:17:48.893430 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 59.12391, "process_user_time": 58.265434, "process_kernel_time": 0.303659, "process_mem_max_rss": "313196544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:48.893655 [debug] [MainThread]: Command `dbt seed` succeeded at 21:17:48.893611 after 59.12 seconds
[0m21:17:48.893850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108177430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb29d0>]}
[0m21:17:48.894033 [debug] [MainThread]: Flushing usage events
[0m22:08:53.465477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104951220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104951a60>]}


============================== 22:08:53.468139 | ca92dee0-4529-4e50-a490-d74aa55091b9 ==============================
[0m22:08:53.468139 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:53.468502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:53.526495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca92dee0-4529-4e50-a490-d74aa55091b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492b9d0>]}
[0m22:08:53.554198 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-ralovrpy'
[0m22:08:53.554547 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:53.676150 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:53.676565 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:53.716523 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:53.719653 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:53.960788 [info ] [MainThread]: Installed from version 1.3.0
[0m22:08:53.961109 [info ] [MainThread]: Up to date!
[0m22:08:53.961326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ca92dee0-4529-4e50-a490-d74aa55091b9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103360fa0>]}
[0m22:08:53.962497 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53256404, "process_user_time": 0.82993, "process_kernel_time": 0.131926, "process_mem_max_rss": "96550912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:53.962786 [debug] [MainThread]: Command `cli deps` succeeded at 22:08:53.962730 after 0.53 seconds
[0m22:08:53.962989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104917190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a678e0>]}
[0m22:08:53.963174 [debug] [MainThread]: Flushing usage events
[0m13:36:55.994185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b70f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fca60>]}


============================== 13:36:55.996431 | 263b8f6e-e673-4a1a-8992-62c94695c709 ==============================
[0m13:36:55.996431 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:36:55.996721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:56.090452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108460dc0>]}
[0m13:36:56.113913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108564e20>]}
[0m13:36:56.114448 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:56.165261 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:36:56.233792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:56.234003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:56.236980 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.staging
[0m13:36:56.253829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdb130>]}
[0m13:36:56.306204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdb160>]}
[0m13:36:56.306494 [info ] [MainThread]: Found 1 model, 6 seeds, 545 macros
[0m13:36:56.306663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdba60>]}
[0m13:36:56.307398 [info ] [MainThread]: 
[0m13:36:56.307665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:36:56.309775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m13:36:56.334807 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m13:36:56.334998 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:36:56.335125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:56.429077 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.094 seconds
[0m13:36:56.429941 [debug] [ThreadPool]: On list_dw: Close
[0m13:36:56.430336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw_public_raw)
[0m13:36:56.430596 [debug] [ThreadPool]: Creating schema "database: "dw"
schema: "public_raw"
"
[0m13:36:56.434013 [debug] [ThreadPool]: Using postgres connection "create_dw_public_raw"
[0m13:36:56.434193 [debug] [ThreadPool]: On create_dw_public_raw: BEGIN
[0m13:36:56.434349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:56.443733 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:36:56.443931 [debug] [ThreadPool]: Using postgres connection "create_dw_public_raw"
[0m13:36:56.444097 [debug] [ThreadPool]: On create_dw_public_raw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw_public_raw"} */
create schema if not exists "public_raw"
[0m13:36:56.445934 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m13:36:56.446437 [debug] [ThreadPool]: On create_dw_public_raw: COMMIT
[0m13:36:56.446603 [debug] [ThreadPool]: Using postgres connection "create_dw_public_raw"
[0m13:36:56.446754 [debug] [ThreadPool]: On create_dw_public_raw: COMMIT
[0m13:36:56.447684 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:36:56.447845 [debug] [ThreadPool]: On create_dw_public_raw: Close
[0m13:36:56.448697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dw_public_raw, now list_dw_public_raw)
[0m13:36:56.452623 [debug] [ThreadPool]: Using postgres connection "list_dw_public_raw"
[0m13:36:56.452786 [debug] [ThreadPool]: On list_dw_public_raw: BEGIN
[0m13:36:56.452930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:56.460571 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:36:56.460761 [debug] [ThreadPool]: Using postgres connection "list_dw_public_raw"
[0m13:36:56.460937 [debug] [ThreadPool]: On list_dw_public_raw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_raw"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m13:36:56.465131 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:36:56.465798 [debug] [ThreadPool]: On list_dw_public_raw: ROLLBACK
[0m13:36:56.466386 [debug] [ThreadPool]: On list_dw_public_raw: Close
[0m13:36:56.466727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_raw, now list_dw_public)
[0m13:36:56.468187 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m13:36:56.468356 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m13:36:56.468510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:56.476021 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:36:56.476232 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m13:36:56.476414 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:36:56.478894 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:36:56.479647 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m13:36:56.480141 [debug] [ThreadPool]: On list_dw_public: Close
[0m13:36:56.483356 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:56.483560 [debug] [MainThread]: On master: BEGIN
[0m13:36:56.483715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:56.492047 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:36:56.492221 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:56.492443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:36:56.495057 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:36:56.495726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e19670>]}
[0m13:36:56.495970 [debug] [MainThread]: On master: ROLLBACK
[0m13:36:56.496459 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:56.496659 [debug] [MainThread]: On master: BEGIN
[0m13:36:56.497467 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:36:56.497670 [debug] [MainThread]: On master: COMMIT
[0m13:36:56.497835 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:56.497991 [debug] [MainThread]: On master: COMMIT
[0m13:36:56.498435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:36:56.498661 [debug] [MainThread]: On master: Close
[0m13:36:56.498971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:56.499168 [info ] [MainThread]: 
[0m13:36:56.500852 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_customers
[0m13:36:56.501180 [info ] [Thread-1  ]: 1 of 6 START seed file public_raw.raw_customers ................................ [RUN]
[0m13:36:56.501459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now seed.my_dbt_project.raw_customers)
[0m13:36:56.501657 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_customers
[0m13:36:56.501944 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_customers
[0m13:36:56.520720 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:36:56.521012 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: BEGIN
[0m13:36:56.521331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:56.530078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:36:56.530329 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:36:56.530509 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_customers"} */

    create table "dw"."public_raw"."raw_customers" ("id" text,"name" text)
  
[0m13:36:56.534549 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.004 seconds
[0m13:36:56.711193 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:36:56.711551 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: 
          insert into "dw"."public_raw"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m13:36:56.721837 [debug] [Thread-1  ]: SQL status: INSERT 0 930 in 0.010 seconds
[0m13:36:56.724788 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_customers"
[0m13:36:56.735281 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m13:36:56.735445 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:36:56.735594 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m13:36:56.737044 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:36:56.737975 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: Close
[0m13:36:56.738645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ebdc0>]}
[0m13:36:56.738888 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file public_raw.raw_customers ............................ [[32mINSERT 930[0m in 0.24s]
[0m13:36:56.739188 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_customers
[0m13:36:56.739367 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_items
[0m13:36:56.739651 [info ] [Thread-1  ]: 2 of 6 START seed file public_raw.raw_items .................................... [RUN]
[0m13:36:56.739903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_customers, now seed.my_dbt_project.raw_items)
[0m13:36:56.740067 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_items
[0m13:36:56.740218 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_items
[0m13:36:57.040755 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:36:57.041013 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: BEGIN
[0m13:36:57.041165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:57.052968 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m13:36:57.053138 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:36:57.053293 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_items"} */

    create table "dw"."public_raw"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m13:36:57.059370 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.006 seconds
[0m13:36:59.220051 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:36:59.220323 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:36:59.267427 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.047 seconds
[0m13:37:01.434216 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:01.434484 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:01.489647 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.055 seconds
[0m13:37:03.685709 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:03.686396 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:03.739703 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.053 seconds
[0m13:37:05.907193 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:05.907477 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:05.946656 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.039 seconds
[0m13:37:08.149457 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:08.149722 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:08.207485 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.058 seconds
[0m13:37:10.477737 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:10.479357 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:10.534841 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.055 seconds
[0m13:37:12.685593 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:12.685827 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:12.734999 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.049 seconds
[0m13:37:14.899342 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:14.899581 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:14.948869 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.049 seconds
[0m13:37:17.145919 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:17.146198 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:17.197450 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.051 seconds
[0m13:37:17.239883 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:17.240082 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:37:17.242629 [debug] [Thread-1  ]: SQL status: INSERT 0 183 in 0.002 seconds
[0m13:37:17.243214 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_items"
[0m13:37:17.245687 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m13:37:17.245839 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:37:17.245981 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m13:37:17.249223 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:37:17.249579 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: Close
[0m13:37:17.249853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109406fd0>]}
[0m13:37:17.250106 [info ] [Thread-1  ]: 2 of 6 OK loaded seed file public_raw.raw_items ................................ [[32mINSERT 90183[0m in 20.51s]
[0m13:37:17.250378 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_items
[0m13:37:17.250575 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_orders
[0m13:37:17.250843 [info ] [Thread-1  ]: 3 of 6 START seed file public_raw.raw_orders ................................... [RUN]
[0m13:37:17.251050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_items, now seed.my_dbt_project.raw_orders)
[0m13:37:17.251214 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_orders
[0m13:37:17.251373 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_orders
[0m13:37:18.786444 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:18.786713 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: BEGIN
[0m13:37:18.786865 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:18.799106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m13:37:18.799346 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:18.799519 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_orders"} */

    create table "dw"."public_raw"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m13:37:18.805742 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.006 seconds
[0m13:37:23.843507 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:23.843800 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:23.943681 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.100 seconds
[0m13:37:29.019990 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:29.020260 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:29.117419 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.097 seconds
[0m13:37:34.280329 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:34.280600 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:34.369825 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.089 seconds
[0m13:37:39.511735 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:39.512010 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:39.613537 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.101 seconds
[0m13:37:44.733377 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:44.733873 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:44.832001 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.098 seconds
[0m13:37:49.896987 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:49.897259 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:49.996858 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.099 seconds
[0m13:37:51.591342 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:51.591587 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:37:51.631706 [debug] [Thread-1  ]: SQL status: INSERT 0 3148 in 0.040 seconds
[0m13:37:51.632480 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_orders"
[0m13:37:51.635463 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m13:37:51.635637 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:37:51.635798 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m13:37:51.637033 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:37:51.637376 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: Close
[0m13:37:51.637667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0a0250>]}
[0m13:37:51.637922 [info ] [Thread-1  ]: 3 of 6 OK loaded seed file public_raw.raw_orders ............................... [[32mINSERT 63148[0m in 34.39s]
[0m13:37:51.638201 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_orders
[0m13:37:51.638397 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_products
[0m13:37:51.638633 [info ] [Thread-1  ]: 4 of 6 START seed file public_raw.raw_products ................................. [RUN]
[0m13:37:51.638929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_orders, now seed.my_dbt_project.raw_products)
[0m13:37:51.639143 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_products
[0m13:37:51.639324 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_products
[0m13:37:51.641708 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:37:51.641891 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: BEGIN
[0m13:37:51.642055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:51.649242 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:37:51.649490 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:37:51.649669 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_products"} */

    create table "dw"."public_raw"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m13:37:51.652400 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m13:37:51.657373 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:37:51.657574 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: 
          insert into "dw"."public_raw"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m13:37:51.658571 [debug] [Thread-1  ]: SQL status: INSERT 0 10 in 0.001 seconds
[0m13:37:51.658892 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_products"
[0m13:37:51.660349 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m13:37:51.660547 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:37:51.660712 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m13:37:51.661610 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:37:51.661948 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: Close
[0m13:37:51.662198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a9910>]}
[0m13:37:51.662447 [info ] [Thread-1  ]: 4 of 6 OK loaded seed file public_raw.raw_products ............................. [[32mINSERT 10[0m in 0.02s]
[0m13:37:51.662718 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_products
[0m13:37:51.662911 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_stores
[0m13:37:51.663179 [info ] [Thread-1  ]: 5 of 6 START seed file public_raw.raw_stores ................................... [RUN]
[0m13:37:51.663385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_products, now seed.my_dbt_project.raw_stores)
[0m13:37:51.663549 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_stores
[0m13:37:51.663707 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_stores
[0m13:37:51.666191 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:37:51.666361 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: BEGIN
[0m13:37:51.666500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:51.673727 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:37:51.673976 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:37:51.674139 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_stores"} */

    create table "dw"."public_raw"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m13:37:51.677283 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m13:37:51.680206 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:37:51.680423 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: 
          insert into "dw"."public_raw"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:37:51.681485 [debug] [Thread-1  ]: SQL status: INSERT 0 6 in 0.001 seconds
[0m13:37:51.681823 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_stores"
[0m13:37:51.683221 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m13:37:51.683409 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:37:51.683572 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m13:37:51.684316 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:37:51.684666 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: Close
[0m13:37:51.684938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e03fe20>]}
[0m13:37:51.685189 [info ] [Thread-1  ]: 5 of 6 OK loaded seed file public_raw.raw_stores ............................... [[32mINSERT 6[0m in 0.02s]
[0m13:37:51.685473 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_stores
[0m13:37:51.685678 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_supplies
[0m13:37:51.685988 [info ] [Thread-1  ]: 6 of 6 START seed file public_raw.raw_supplies ................................. [RUN]
[0m13:37:51.686249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_stores, now seed.my_dbt_project.raw_supplies)
[0m13:37:51.686425 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_supplies
[0m13:37:51.686586 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_supplies
[0m13:37:51.689493 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:37:51.689686 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: BEGIN
[0m13:37:51.689841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:51.698858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:37:51.699107 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:37:51.699265 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_supplies"} */

    create table "dw"."public_raw"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m13:37:51.702095 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m13:37:51.727722 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:37:51.727963 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: 
          insert into "dw"."public_raw"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m13:37:51.729343 [debug] [Thread-1  ]: SQL status: INSERT 0 65 in 0.001 seconds
[0m13:37:51.729675 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_supplies"
[0m13:37:51.730609 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m13:37:51.730760 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:37:51.730899 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m13:37:51.731607 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:37:51.731904 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: Close
[0m13:37:51.732160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b8f6e-e673-4a1a-8992-62c94695c709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f05e3a0>]}
[0m13:37:51.732406 [info ] [Thread-1  ]: 6 of 6 OK loaded seed file public_raw.raw_supplies ............................. [[32mINSERT 65[0m in 0.05s]
[0m13:37:51.732684 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_supplies
[0m13:37:51.733219 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:51.733379 [debug] [MainThread]: On master: BEGIN
[0m13:37:51.733515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:51.739470 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:37:51.739747 [debug] [MainThread]: On master: COMMIT
[0m13:37:51.739909 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:51.740057 [debug] [MainThread]: On master: COMMIT
[0m13:37:51.740490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:51.740653 [debug] [MainThread]: On master: Close
[0m13:37:51.740861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:51.741003 [debug] [MainThread]: Connection 'seed.my_dbt_project.raw_supplies' was properly closed.
[0m13:37:51.741191 [info ] [MainThread]: 
[0m13:37:51.741369 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 55.43 seconds (55.43s).
[0m13:37:51.742056 [debug] [MainThread]: Command end result
[0m13:37:51.760073 [info ] [MainThread]: 
[0m13:37:51.760308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:51.760459 [info ] [MainThread]: 
[0m13:37:51.760617 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:37:51.761685 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 55.801247, "process_user_time": 55.033447, "process_kernel_time": 0.254173, "process_mem_max_rss": "314720256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:37:51.761880 [debug] [MainThread]: Command `dbt seed` succeeded at 13:37:51.761842 after 55.80 seconds
[0m13:37:51.762048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b70f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e7d1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdbb20>]}
[0m13:37:51.762225 [debug] [MainThread]: Flushing usage events
[0m13:44:50.988644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc59a0>]}


============================== 13:44:50.991013 | cc245b4d-fc3b-4006-bd34-8a4aeba809f6 ==============================
[0m13:44:50.991013 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:44:50.991285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:50.992754 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |       port: 5432
    10 |       dbname: dw
    11 |       {# schema:  #}
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 11, column 7
    could not find expected ':'
      in "<unicode string>", line 12, column 1
  
[0m13:44:50.994135 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.014893417, "process_user_time": 0.517291, "process_kernel_time": 0.064585, "process_mem_max_rss": "88178688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:50.994323 [debug] [MainThread]: Command `dbt seed` failed at 13:44:50.994281 after 0.02 seconds
[0m13:44:50.994484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110feefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110feef40>]}
[0m13:44:50.994637 [debug] [MainThread]: Flushing usage events
[0m13:48:08.907756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a0bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600da30>]}


============================== 13:48:08.910017 | 4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5 ==============================
[0m13:48:08.910017 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:08.910293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:48:09.002186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a700>]}
[0m13:48:09.025940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106386640>]}
[0m13:48:09.026485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:48:09.077288 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:48:09.134260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:48:09.134495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:48:09.137825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.my_dbt_project.raw_products
- models.my_dbt_project.raw_customers
- models.my_dbt_project.raw_items
- models.my_dbt_project.raw_stores
- models.my_dbt_project.staging
- models.my_dbt_project.raw_orders
- models.my_dbt_project.raw_supplies
[0m13:48:09.155430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dd130>]}
[0m13:48:09.209807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ddf70>]}
[0m13:48:09.210092 [info ] [MainThread]: Found 1 model, 6 seeds, 545 macros
[0m13:48:09.210260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ea610>]}
[0m13:48:09.211000 [info ] [MainThread]: 
[0m13:48:09.211268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:48:09.213423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m13:48:09.238902 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m13:48:09.239152 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:48:09.239309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:09.258976 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m13:48:09.259615 [debug] [ThreadPool]: On list_dw: Close
[0m13:48:09.260322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m13:48:09.263633 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m13:48:09.263775 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m13:48:09.263931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:09.274539 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:48:09.274737 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m13:48:09.274879 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:48:09.279226 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:48:09.279802 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m13:48:09.280419 [debug] [ThreadPool]: On list_dw_public: Close
[0m13:48:09.280718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_raw)
[0m13:48:09.282003 [debug] [ThreadPool]: Using postgres connection "list_dw_public_raw"
[0m13:48:09.282150 [debug] [ThreadPool]: On list_dw_public_raw: BEGIN
[0m13:48:09.282272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:09.289675 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:48:09.289897 [debug] [ThreadPool]: Using postgres connection "list_dw_public_raw"
[0m13:48:09.290046 [debug] [ThreadPool]: On list_dw_public_raw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_raw"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m13:48:09.293410 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m13:48:09.294041 [debug] [ThreadPool]: On list_dw_public_raw: ROLLBACK
[0m13:48:09.294625 [debug] [ThreadPool]: On list_dw_public_raw: Close
[0m13:48:09.297516 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:09.297673 [debug] [MainThread]: On master: BEGIN
[0m13:48:09.297796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:09.304717 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:48:09.304911 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:09.305089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:48:09.309594 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:48:09.310151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e16e20>]}
[0m13:48:09.310375 [debug] [MainThread]: On master: ROLLBACK
[0m13:48:09.310841 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:09.310976 [debug] [MainThread]: On master: BEGIN
[0m13:48:09.311711 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:48:09.311847 [debug] [MainThread]: On master: COMMIT
[0m13:48:09.311974 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:09.312094 [debug] [MainThread]: On master: COMMIT
[0m13:48:09.312562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:48:09.312727 [debug] [MainThread]: On master: Close
[0m13:48:09.312964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:09.313137 [info ] [MainThread]: 
[0m13:48:09.314533 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_customers
[0m13:48:09.314818 [info ] [Thread-1  ]: 1 of 6 START seed file public_raw.raw_customers ................................ [RUN]
[0m13:48:09.315056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_raw, now seed.my_dbt_project.raw_customers)
[0m13:48:09.315217 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_customers
[0m13:48:09.315372 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_customers
[0m13:48:09.332008 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:48:09.332187 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: BEGIN
[0m13:48:09.332330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:09.340698 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:48:09.340917 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:48:09.341063 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_customers"} */
truncate table "dw"."public_raw"."raw_customers"
[0m13:48:09.344960 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m13:48:09.507563 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:48:09.507806 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: 
          insert into "dw"."public_raw"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m13:48:09.516020 [debug] [Thread-1  ]: SQL status: INSERT 0 930 in 0.008 seconds
[0m13:48:09.518781 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_customers"
[0m13:48:09.527444 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m13:48:09.527607 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m13:48:09.527750 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m13:48:09.528914 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:48:09.529827 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: Close
[0m13:48:09.530545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e16e20>]}
[0m13:48:09.530800 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file public_raw.raw_customers ............................ [[32mINSERT 930[0m in 0.22s]
[0m13:48:09.531080 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_customers
[0m13:48:09.531283 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_items
[0m13:48:09.531577 [info ] [Thread-1  ]: 2 of 6 START seed file public_raw.raw_items .................................... [RUN]
[0m13:48:09.531826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_customers, now seed.my_dbt_project.raw_items)
[0m13:48:09.532005 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_items
[0m13:48:09.532173 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_items
[0m13:48:09.821027 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:09.821272 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: BEGIN
[0m13:48:09.821418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:09.835817 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m13:48:09.836033 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:09.836202 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_items"} */
truncate table "dw"."public_raw"."raw_items"
[0m13:48:09.842193 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m13:48:11.989326 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:11.989612 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:12.043787 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.054 seconds
[0m13:48:14.234804 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:14.235044 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:14.293201 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.058 seconds
[0m13:48:16.487092 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:16.487374 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:16.540250 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.053 seconds
[0m13:48:18.697553 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:18.697841 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:18.737430 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.039 seconds
[0m13:48:20.875610 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:20.875844 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:20.925853 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.050 seconds
[0m13:48:23.059819 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:23.060084 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:23.109742 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.049 seconds
[0m13:48:25.304439 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:25.304721 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:25.355264 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.050 seconds
[0m13:48:27.584478 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:27.584764 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:27.636535 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.052 seconds
[0m13:48:29.883580 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:29.884382 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:29.942052 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.057 seconds
[0m13:48:29.985960 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:29.986175 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m13:48:29.987401 [debug] [Thread-1  ]: SQL status: INSERT 0 183 in 0.001 seconds
[0m13:48:29.988422 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_items"
[0m13:48:29.989605 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m13:48:29.989770 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m13:48:29.989918 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m13:48:29.995658 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m13:48:29.996147 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: Close
[0m13:48:29.996506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a9d760>]}
[0m13:48:29.996827 [info ] [Thread-1  ]: 2 of 6 OK loaded seed file public_raw.raw_items ................................ [[32mINSERT 90183[0m in 20.46s]
[0m13:48:29.997169 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_items
[0m13:48:29.997379 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_orders
[0m13:48:29.997691 [info ] [Thread-1  ]: 3 of 6 START seed file public_raw.raw_orders ................................... [RUN]
[0m13:48:29.997939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_items, now seed.my_dbt_project.raw_orders)
[0m13:48:29.998135 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_orders
[0m13:48:29.998286 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_orders
[0m13:48:31.438835 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:31.439096 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: BEGIN
[0m13:48:31.439257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:31.451902 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m13:48:31.452066 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:31.452215 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_orders"} */
truncate table "dw"."public_raw"."raw_orders"
[0m13:48:31.456425 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m13:48:36.347195 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:36.347484 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:48:36.450526 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.103 seconds
[0m13:48:41.524680 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:41.525877 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:48:41.618033 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.092 seconds
[0m13:48:46.846532 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:46.847812 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:48:46.941977 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.094 seconds
[0m13:48:52.013464 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:52.014661 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:48:52.114189 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.099 seconds
[0m13:48:57.180306 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:48:57.180577 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:48:57.276580 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.096 seconds
[0m13:49:02.465152 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:49:02.465446 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:49:02.556011 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.090 seconds
[0m13:49:04.123644 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:49:04.123887 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:49:04.162913 [debug] [Thread-1  ]: SQL status: INSERT 0 3148 in 0.039 seconds
[0m13:49:04.163728 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_orders"
[0m13:49:04.166702 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m13:49:04.166879 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m13:49:04.167037 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m13:49:04.171504 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m13:49:04.171909 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: Close
[0m13:49:04.172206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119555370>]}
[0m13:49:04.172481 [info ] [Thread-1  ]: 3 of 6 OK loaded seed file public_raw.raw_orders ............................... [[32mINSERT 63148[0m in 34.17s]
[0m13:49:04.172776 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_orders
[0m13:49:04.172983 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_products
[0m13:49:04.173265 [info ] [Thread-1  ]: 4 of 6 START seed file public_raw.raw_products ................................. [RUN]
[0m13:49:04.173481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_orders, now seed.my_dbt_project.raw_products)
[0m13:49:04.173653 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_products
[0m13:49:04.173823 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_products
[0m13:49:04.177178 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:49:04.177346 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: BEGIN
[0m13:49:04.177501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:04.185780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:49:04.186101 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:49:04.186288 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_products"} */
truncate table "dw"."public_raw"."raw_products"
[0m13:49:04.188232 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m13:49:04.193194 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:49:04.193386 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: 
          insert into "dw"."public_raw"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m13:49:04.194184 [debug] [Thread-1  ]: SQL status: INSERT 0 10 in 0.001 seconds
[0m13:49:04.194503 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_products"
[0m13:49:04.195671 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m13:49:04.195853 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m13:49:04.196000 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m13:49:04.196777 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:04.197126 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: Close
[0m13:49:04.197373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a4a520>]}
[0m13:49:04.197628 [info ] [Thread-1  ]: 4 of 6 OK loaded seed file public_raw.raw_products ............................. [[32mINSERT 10[0m in 0.02s]
[0m13:49:04.197905 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_products
[0m13:49:04.198102 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_stores
[0m13:49:04.198364 [info ] [Thread-1  ]: 5 of 6 START seed file public_raw.raw_stores ................................... [RUN]
[0m13:49:04.198569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_products, now seed.my_dbt_project.raw_stores)
[0m13:49:04.198735 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_stores
[0m13:49:04.198891 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_stores
[0m13:49:04.201932 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:49:04.202116 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: BEGIN
[0m13:49:04.202276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:04.208569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:04.208843 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:49:04.209001 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_stores"} */
truncate table "dw"."public_raw"."raw_stores"
[0m13:49:04.210932 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m13:49:04.213419 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:49:04.213577 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: 
          insert into "dw"."public_raw"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:49:04.214227 [debug] [Thread-1  ]: SQL status: INSERT 0 6 in 0.000 seconds
[0m13:49:04.214546 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_stores"
[0m13:49:04.215367 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m13:49:04.215518 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m13:49:04.216183 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m13:49:04.216872 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:04.217216 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: Close
[0m13:49:04.217458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fa730>]}
[0m13:49:04.217711 [info ] [Thread-1  ]: 5 of 6 OK loaded seed file public_raw.raw_stores ............................... [[32mINSERT 6[0m in 0.02s]
[0m13:49:04.217989 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_stores
[0m13:49:04.218181 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_supplies
[0m13:49:04.218436 [info ] [Thread-1  ]: 6 of 6 START seed file public_raw.raw_supplies ................................. [RUN]
[0m13:49:04.218640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_stores, now seed.my_dbt_project.raw_supplies)
[0m13:49:04.218803 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_supplies
[0m13:49:04.218957 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_supplies
[0m13:49:04.222150 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:49:04.222303 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: BEGIN
[0m13:49:04.222445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:04.228149 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:04.228366 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:49:04.228519 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_supplies"} */
truncate table "dw"."public_raw"."raw_supplies"
[0m13:49:04.230628 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m13:49:04.256113 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:49:04.256358 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: 
          insert into "dw"."public_raw"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m13:49:04.257529 [debug] [Thread-1  ]: SQL status: INSERT 0 65 in 0.001 seconds
[0m13:49:04.257838 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_supplies"
[0m13:49:04.258737 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m13:49:04.258887 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m13:49:04.259027 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m13:49:04.260060 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:04.260391 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: Close
[0m13:49:04.260632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c5d96-f0d7-4ee7-936a-7078f96b1ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2dd9d0>]}
[0m13:49:04.260881 [info ] [Thread-1  ]: 6 of 6 OK loaded seed file public_raw.raw_supplies ............................. [[32mINSERT 65[0m in 0.04s]
[0m13:49:04.261153 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_supplies
[0m13:49:04.261677 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:04.261822 [debug] [MainThread]: On master: BEGIN
[0m13:49:04.261954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:04.267146 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:49:04.267396 [debug] [MainThread]: On master: COMMIT
[0m13:49:04.267572 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:04.267720 [debug] [MainThread]: On master: COMMIT
[0m13:49:04.268155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:04.268317 [debug] [MainThread]: On master: Close
[0m13:49:04.268532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:04.268668 [debug] [MainThread]: Connection 'seed.my_dbt_project.raw_supplies' was properly closed.
[0m13:49:04.268837 [info ] [MainThread]: 
[0m13:49:04.269010 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 55.06 seconds (55.06s).
[0m13:49:04.269698 [debug] [MainThread]: Command end result
[0m13:49:04.288447 [info ] [MainThread]: 
[0m13:49:04.288697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:04.288853 [info ] [MainThread]: 
[0m13:49:04.289014 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:49:04.290047 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 55.414608, "process_user_time": 54.79068, "process_kernel_time": 0.236416, "process_mem_max_rss": "315670528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:49:04.290232 [debug] [MainThread]: Command `dbt seed` succeeded at 13:49:04.290194 after 55.41 seconds
[0m13:49:04.290397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a0bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dab070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068dda60>]}
[0m13:49:04.290554 [debug] [MainThread]: Flushing usage events
[0m14:04:16.230080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcba00>]}


============================== 14:04:16.232680 | 3794639c-c873-4148-b3d3-d8d2e8bb2306 ==============================
[0m14:04:16.232680 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:16.232996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:16.326572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee8460>]}
[0m14:04:16.350196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5bb80>]}
[0m14:04:16.350823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:16.401868 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:16.471496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:16.471778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:16.474969 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.staging
[0m14:04:16.492439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046be80>]}
[0m14:04:16.551498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110487a00>]}
[0m14:04:16.551804 [info ] [MainThread]: Found 1 model, 6 seeds, 545 macros
[0m14:04:16.551984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110454df0>]}
[0m14:04:16.552719 [info ] [MainThread]: 
[0m14:04:16.552995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:16.555161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m14:04:16.581200 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m14:04:16.581427 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:04:16.581565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:16.599352 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m14:04:16.600114 [debug] [ThreadPool]: On list_dw: Close
[0m14:04:16.600480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw__jaffle_shop)
[0m14:04:16.600701 [debug] [ThreadPool]: Creating schema "database: "dw"
schema: "_jaffle_shop"
"
[0m14:04:16.603646 [debug] [ThreadPool]: Using postgres connection "create_dw__jaffle_shop"
[0m14:04:16.603792 [debug] [ThreadPool]: On create_dw__jaffle_shop: BEGIN
[0m14:04:16.603911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:16.610082 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:04:16.610276 [debug] [ThreadPool]: Using postgres connection "create_dw__jaffle_shop"
[0m14:04:16.610415 [debug] [ThreadPool]: On create_dw__jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw__jaffle_shop"} */
create schema if not exists "_jaffle_shop"
[0m14:04:16.611175 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:04:16.611600 [debug] [ThreadPool]: On create_dw__jaffle_shop: COMMIT
[0m14:04:16.611730 [debug] [ThreadPool]: Using postgres connection "create_dw__jaffle_shop"
[0m14:04:16.611846 [debug] [ThreadPool]: On create_dw__jaffle_shop: COMMIT
[0m14:04:16.612751 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:04:16.612930 [debug] [ThreadPool]: On create_dw__jaffle_shop: Close
[0m14:04:16.613743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dw__jaffle_shop, now list_dw__jaffle_shop)
[0m14:04:16.617206 [debug] [ThreadPool]: Using postgres connection "list_dw__jaffle_shop"
[0m14:04:16.617344 [debug] [ThreadPool]: On list_dw__jaffle_shop: BEGIN
[0m14:04:16.617462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:16.623847 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:04:16.624032 [debug] [ThreadPool]: Using postgres connection "list_dw__jaffle_shop"
[0m14:04:16.624179 [debug] [ThreadPool]: On list_dw__jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw__jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_jaffle_shop'
  
[0m14:04:16.625918 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:04:16.626524 [debug] [ThreadPool]: On list_dw__jaffle_shop: ROLLBACK
[0m14:04:16.627199 [debug] [ThreadPool]: On list_dw__jaffle_shop: Close
[0m14:04:16.627561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw__jaffle_shop, now list_dw_)
[0m14:04:16.628810 [debug] [ThreadPool]: Using postgres connection "list_dw_"
[0m14:04:16.628949 [debug] [ThreadPool]: On list_dw_: BEGIN
[0m14:04:16.629067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:16.635094 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:04:16.635225 [debug] [ThreadPool]: Using postgres connection "list_dw_"
[0m14:04:16.635360 [debug] [ThreadPool]: On list_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike ''
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike ''
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike ''
  
[0m14:04:16.636973 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m14:04:16.637599 [debug] [ThreadPool]: On list_dw_: ROLLBACK
[0m14:04:16.638109 [debug] [ThreadPool]: On list_dw_: Close
[0m14:04:16.640829 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:16.640987 [debug] [MainThread]: On master: BEGIN
[0m14:04:16.641115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:16.647456 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:04:16.647613 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:16.647805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:16.651206 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:04:16.651761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b45e20>]}
[0m14:04:16.651968 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:16.652463 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:16.652591 [debug] [MainThread]: On master: BEGIN
[0m14:04:16.653310 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:04:16.653477 [debug] [MainThread]: On master: COMMIT
[0m14:04:16.653603 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:16.653723 [debug] [MainThread]: On master: COMMIT
[0m14:04:16.654146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:16.654274 [debug] [MainThread]: On master: Close
[0m14:04:16.654495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:16.654672 [info ] [MainThread]: 
[0m14:04:16.655901 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_customers
[0m14:04:16.656149 [info ] [Thread-1  ]: 1 of 6 START seed file _jaffle_shop.raw_customers .............................. [RUN]
[0m14:04:16.656380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_, now seed.my_dbt_project.raw_customers)
[0m14:04:16.656535 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_customers
[0m14:04:16.656763 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_customers
[0m14:04:16.672347 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m14:04:16.672557 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: BEGIN
[0m14:04:16.672717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:16.679664 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:04:16.679881 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m14:04:16.680034 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_customers"} */

    create table "dw"."_jaffle_shop"."raw_customers" ("id" text,"name" text)
  
[0m14:04:16.683538 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:04:16.846045 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m14:04:16.846298 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: 
          insert into "dw"."_jaffle_shop"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%...
[0m14:04:16.854772 [debug] [Thread-1  ]: SQL status: INSERT 0 930 in 0.008 seconds
[0m14:04:16.857518 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_customers"
[0m14:04:16.867151 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m14:04:16.867317 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m14:04:16.867468 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m14:04:16.870026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:04:16.870910 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: Close
[0m14:04:16.871562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112317610>]}
[0m14:04:16.871783 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file _jaffle_shop.raw_customers .......................... [[32mINSERT 930[0m in 0.21s]
[0m14:04:16.872052 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_customers
[0m14:04:16.872231 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_items
[0m14:04:16.872476 [info ] [Thread-1  ]: 2 of 6 START seed file _jaffle_shop.raw_items .................................. [RUN]
[0m14:04:16.872704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_customers, now seed.my_dbt_project.raw_items)
[0m14:04:16.872862 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_items
[0m14:04:16.873011 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_items
[0m14:04:17.156372 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:17.156615 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: BEGIN
[0m14:04:17.156765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:17.169017 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m14:04:17.169230 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:17.169388 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_items"} */

    create table "dw"."_jaffle_shop"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m14:04:17.176095 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.007 seconds
[0m14:04:19.374857 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:19.375113 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:19.431545 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.056 seconds
[0m14:04:21.576155 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:21.576436 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:21.638486 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.062 seconds
[0m14:04:23.783717 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:23.783951 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:23.839455 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.055 seconds
[0m14:04:25.986271 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:25.986511 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:26.035412 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.049 seconds
[0m14:04:28.203042 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:28.203310 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:28.265699 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.062 seconds
[0m14:04:30.508311 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:30.508589 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:30.562975 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.054 seconds
[0m14:04:32.764403 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:32.765065 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:32.813710 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.048 seconds
[0m14:04:35.064140 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:35.064424 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:35.113954 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.049 seconds
[0m14:04:37.344238 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:37.344520 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:37.395083 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.050 seconds
[0m14:04:37.438976 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:37.439168 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m14:04:37.440392 [debug] [Thread-1  ]: SQL status: INSERT 0 183 in 0.001 seconds
[0m14:04:37.440985 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_items"
[0m14:04:37.442819 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m14:04:37.443004 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m14:04:37.443154 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m14:04:37.445859 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m14:04:37.446224 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: Close
[0m14:04:37.446495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079efb20>]}
[0m14:04:37.446752 [info ] [Thread-1  ]: 2 of 6 OK loaded seed file _jaffle_shop.raw_items .............................. [[32mINSERT 90183[0m in 20.57s]
[0m14:04:37.447035 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_items
[0m14:04:37.447232 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_orders
[0m14:04:37.447496 [info ] [Thread-1  ]: 3 of 6 START seed file _jaffle_shop.raw_orders ................................. [RUN]
[0m14:04:37.447704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_items, now seed.my_dbt_project.raw_orders)
[0m14:04:37.447872 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_orders
[0m14:04:37.448035 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_orders
[0m14:04:39.031028 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:04:39.031614 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: BEGIN
[0m14:04:39.031813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:39.038922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:04:39.039118 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:04:39.039307 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_orders"} */

    create table "dw"."_jaffle_shop"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m14:04:39.041731 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:04:44.150015 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:04:44.150306 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:04:44.244555 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.094 seconds
[0m14:04:49.399227 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:04:49.399604 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:04:49.491883 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.092 seconds
[0m14:04:54.699811 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:04:54.701253 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:04:54.800794 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.099 seconds
[0m14:04:59.966715 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:04:59.967327 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:05:00.074201 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.107 seconds
[0m14:05:05.236018 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:05:05.236625 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:05:05.329916 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.093 seconds
[0m14:05:10.545831 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:05:10.546098 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:05:10.643341 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.097 seconds
[0m14:05:12.289374 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:05:12.289644 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m14:05:12.329142 [debug] [Thread-1  ]: SQL status: INSERT 0 3148 in 0.039 seconds
[0m14:05:12.329951 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_orders"
[0m14:05:12.332972 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m14:05:12.333147 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m14:05:12.333302 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m14:05:12.335438 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:05:12.335797 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: Close
[0m14:05:12.336106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efa550>]}
[0m14:05:12.336362 [info ] [Thread-1  ]: 3 of 6 OK loaded seed file _jaffle_shop.raw_orders ............................. [[32mINSERT 63148[0m in 34.89s]
[0m14:05:12.336650 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_orders
[0m14:05:12.336847 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_products
[0m14:05:12.337125 [info ] [Thread-1  ]: 4 of 6 START seed file _jaffle_shop.raw_products ............................... [RUN]
[0m14:05:12.337332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_orders, now seed.my_dbt_project.raw_products)
[0m14:05:12.337496 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_products
[0m14:05:12.337654 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_products
[0m14:05:12.339936 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m14:05:12.340106 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: BEGIN
[0m14:05:12.340259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:12.348077 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:05:12.348367 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m14:05:12.348550 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_products"} */

    create table "dw"."_jaffle_shop"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m14:05:12.350908 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:05:12.355623 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m14:05:12.355824 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: 
          insert into "dw"."_jaffle_shop"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m14:05:12.356625 [debug] [Thread-1  ]: SQL status: INSERT 0 10 in 0.001 seconds
[0m14:05:12.356941 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_products"
[0m14:05:12.358833 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m14:05:12.358995 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m14:05:12.359146 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m14:05:12.360159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:05:12.360590 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: Close
[0m14:05:12.360863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124685e0>]}
[0m14:05:12.361128 [info ] [Thread-1  ]: 4 of 6 OK loaded seed file _jaffle_shop.raw_products ........................... [[32mINSERT 10[0m in 0.02s]
[0m14:05:12.361417 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_products
[0m14:05:12.361617 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_stores
[0m14:05:12.361882 [info ] [Thread-1  ]: 5 of 6 START seed file _jaffle_shop.raw_stores ................................. [RUN]
[0m14:05:12.362090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_products, now seed.my_dbt_project.raw_stores)
[0m14:05:12.362258 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_stores
[0m14:05:12.362419 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_stores
[0m14:05:12.364792 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m14:05:12.364948 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: BEGIN
[0m14:05:12.365086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:12.372370 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:05:12.372636 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m14:05:12.372802 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_stores"} */

    create table "dw"."_jaffle_shop"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m14:05:12.375361 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:05:12.378259 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m14:05:12.378442 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: 
          insert into "dw"."_jaffle_shop"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:05:12.379283 [debug] [Thread-1  ]: SQL status: INSERT 0 6 in 0.001 seconds
[0m14:05:12.379600 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_stores"
[0m14:05:12.380506 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m14:05:12.380659 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m14:05:12.380798 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m14:05:12.381545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:05:12.381866 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: Close
[0m14:05:12.382115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255e2c10>]}
[0m14:05:12.382369 [info ] [Thread-1  ]: 5 of 6 OK loaded seed file _jaffle_shop.raw_stores ............................. [[32mINSERT 6[0m in 0.02s]
[0m14:05:12.382656 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_stores
[0m14:05:12.382856 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_supplies
[0m14:05:12.383125 [info ] [Thread-1  ]: 6 of 6 START seed file _jaffle_shop.raw_supplies ............................... [RUN]
[0m14:05:12.383339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_stores, now seed.my_dbt_project.raw_supplies)
[0m14:05:12.383508 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_supplies
[0m14:05:12.383665 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_supplies
[0m14:05:12.386474 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m14:05:12.386658 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: BEGIN
[0m14:05:12.386811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:12.393557 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:05:12.393810 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m14:05:12.393969 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_supplies"} */

    create table "dw"."_jaffle_shop"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m14:05:12.395902 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:05:12.421158 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m14:05:12.421394 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: 
          insert into "dw"."_jaffle_shop"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m14:05:12.422630 [debug] [Thread-1  ]: SQL status: INSERT 0 65 in 0.001 seconds
[0m14:05:12.422996 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_supplies"
[0m14:05:12.423963 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m14:05:12.424120 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m14:05:12.424265 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m14:05:12.425130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:05:12.425449 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: Close
[0m14:05:12.425709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3794639c-c873-4148-b3d3-d8d2e8bb2306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ef100>]}
[0m14:05:12.425970 [info ] [Thread-1  ]: 6 of 6 OK loaded seed file _jaffle_shop.raw_supplies ........................... [[32mINSERT 65[0m in 0.04s]
[0m14:05:12.426254 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_supplies
[0m14:05:12.426810 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:12.426991 [debug] [MainThread]: On master: BEGIN
[0m14:05:12.427140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:12.432714 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:05:12.432902 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.433043 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:12.433175 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.433543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:12.433685 [debug] [MainThread]: On master: Close
[0m14:05:12.433889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:12.434021 [debug] [MainThread]: Connection 'seed.my_dbt_project.raw_supplies' was properly closed.
[0m14:05:12.434187 [info ] [MainThread]: 
[0m14:05:12.434349 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 55.88 seconds (55.88s).
[0m14:05:12.434995 [debug] [MainThread]: Command end result
[0m14:05:12.454068 [info ] [MainThread]: 
[0m14:05:12.454343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:12.454506 [info ] [MainThread]: 
[0m14:05:12.454665 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:05:12.455716 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 56.259598, "process_user_time": 55.55598, "process_kernel_time": 0.292091, "process_mem_max_rss": "362348544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:12.455908 [debug] [MainThread]: Command `dbt seed` succeeded at 14:05:12.455867 after 56.26 seconds
[0m14:05:12.456074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110487c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120075220>]}
[0m14:05:12.456238 [debug] [MainThread]: Flushing usage events
[0m16:20:02.336738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104768fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e5b50>]}


============================== 16:20:02.338797 | 083b7bc6-ac7e-4fd2-a970-dd2b8fce9c2f ==============================
[0m16:20:02.338797 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:20:02.339093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:20:02.391832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '083b7bc6-ac7e-4fd2-a970-dd2b8fce9c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a3160>]}
[0m16:20:02.415450 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-ofw_n2aq'
[0m16:20:02.415709 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:20:02.631562 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:20:02.632067 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:20:02.691914 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:20:02.694303 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:20:02.925216 [info ] [MainThread]: Installed from version 1.3.0
[0m16:20:02.925473 [info ] [MainThread]: Up to date!
[0m16:20:02.925671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '083b7bc6-ac7e-4fd2-a970-dd2b8fce9c2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fd310>]}
[0m16:20:02.927186 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62456506, "process_user_time": 0.672154, "process_kernel_time": 0.098098, "process_mem_max_rss": "100073472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:20:02.927450 [debug] [MainThread]: Command `cli deps` succeeded at 16:20:02.927393 after 0.62 seconds
[0m16:20:02.927639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104768fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106533040>]}
[0m16:20:02.927821 [debug] [MainThread]: Flushing usage events
[0m16:25:33.457600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a38fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e5b20>]}


============================== 16:25:33.459479 | 2dcbba7f-5fe4-4a02-9837-a173bc4ca970 ==============================
[0m16:25:33.459479 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:25:33.459753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:33.511933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dcbba7f-5fe4-4a02-9837-a173bc4ca970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c5dac0>]}
[0m16:25:33.534790 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-9jc7fy01'
[0m16:25:33.535020 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:25:33.674214 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:25:33.674706 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:25:33.741369 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:25:33.746047 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:25:34.035126 [info ] [MainThread]: Installed from version 1.3.0
[0m16:25:34.035404 [info ] [MainThread]: Up to date!
[0m16:25:34.035624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2dcbba7f-5fe4-4a02-9837-a173bc4ca970', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031ae1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afc040>]}
[0m16:25:34.037286 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6116057, "process_user_time": 0.689264, "process_kernel_time": 0.106265, "process_mem_max_rss": "99827712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:34.037589 [debug] [MainThread]: Command `cli deps` succeeded at 16:25:34.037528 after 0.61 seconds
[0m16:25:34.037803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a38fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10331ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031ae1c0>]}
[0m16:25:34.038001 [debug] [MainThread]: Flushing usage events
[0m20:40:12.428185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a665280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a665b80>]}


============================== 20:40:12.430081 | 48e059f4-5b2d-4fd3-8811-26b6fdb42c2d ==============================
[0m20:40:12.430081 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:40:12.430364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:12.481031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48e059f4-5b2d-4fd3-8811-26b6fdb42c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d0580>]}
[0m20:40:12.502916 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-duyy19wl'
[0m20:40:12.503164 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:40:12.716535 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:40:12.716942 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:40:12.819415 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:40:12.823612 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:40:13.085815 [info ] [MainThread]: Installed from version 1.3.0
[0m20:40:13.086109 [info ] [MainThread]: Up to date!
[0m20:40:13.086318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '48e059f4-5b2d-4fd3-8811-26b6fdb42c2d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87ec10>]}
[0m20:40:13.087964 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6957634, "process_user_time": 0.671464, "process_kernel_time": 0.098586, "process_mem_max_rss": "100057088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:13.088270 [debug] [MainThread]: Command `cli deps` succeeded at 20:40:13.088209 after 0.70 seconds
[0m20:40:13.088463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b30d0>]}
[0m20:40:13.088654 [debug] [MainThread]: Flushing usage events
[0m20:57:47.612960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102737c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a5b20>]}


============================== 20:57:47.615260 | 890c38df-167a-4b4a-b463-ab872cfa71a1 ==============================
[0m20:57:47.615260 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:57:47.615569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:57:47.671085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '890c38df-167a-4b4a-b463-ab872cfa71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e43880>]}
[0m20:57:47.696069 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-78is7nri'
[0m20:57:47.696327 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:57:48.010230 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:57:48.010851 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:57:48.082037 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:57:48.085991 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:57:48.334899 [info ] [MainThread]: Installed from version 1.3.0
[0m20:57:48.335207 [info ] [MainThread]: Up to date!
[0m20:57:48.335433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '890c38df-167a-4b4a-b463-ab872cfa71a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102deabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e25580>]}
[0m20:57:48.337097 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7668205, "process_user_time": 0.685585, "process_kernel_time": 0.105864, "process_mem_max_rss": "99352576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:57:48.337346 [debug] [MainThread]: Command `cli deps` succeeded at 20:57:48.337294 after 0.77 seconds
[0m20:57:48.337536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102737c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102deabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422e700>]}
[0m20:57:48.337719 [debug] [MainThread]: Flushing usage events
[0m21:45:56.150272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105363b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e6fa0>]}


============================== 21:45:56.152587 | 3d840806-c413-40cf-9282-ff28d20a43e6 ==============================
[0m21:45:56.152587 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:45:56.152904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:56.249403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a4220>]}
[0m21:45:56.273810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063958e0>]}
[0m21:45:56.274428 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:45:56.328005 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:45:56.396950 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:45:56.397212 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:45:56.397403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063df910>]}
[0m21:45:56.994178 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:45:56.994451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fa5e0>]}
[0m21:45:57.130269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108994130>]}
[0m21:45:57.225563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1e040>]}
[0m21:45:57.225880 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:45:57.226058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089940d0>]}
[0m21:45:57.226769 [info ] [MainThread]: 
[0m21:45:57.227049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:45:57.229458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw__jaffle_shop'
[0m21:45:57.254580 [debug] [ThreadPool]: Using postgres connection "list_dw__jaffle_shop"
[0m21:45:57.254776 [debug] [ThreadPool]: On list_dw__jaffle_shop: BEGIN
[0m21:45:57.254904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:57.276590 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:45:57.276800 [debug] [ThreadPool]: Using postgres connection "list_dw__jaffle_shop"
[0m21:45:57.276944 [debug] [ThreadPool]: On list_dw__jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw__jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_jaffle_shop'
  
[0m21:45:57.284812 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m21:45:57.285492 [debug] [ThreadPool]: On list_dw__jaffle_shop: ROLLBACK
[0m21:45:57.286151 [debug] [ThreadPool]: On list_dw__jaffle_shop: Close
[0m21:45:57.286462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw__jaffle_shop, now list_dw_)
[0m21:45:57.288346 [debug] [ThreadPool]: Using postgres connection "list_dw_"
[0m21:45:57.288514 [debug] [ThreadPool]: On list_dw_: BEGIN
[0m21:45:57.288647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:57.296015 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:45:57.296218 [debug] [ThreadPool]: Using postgres connection "list_dw_"
[0m21:45:57.296374 [debug] [ThreadPool]: On list_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike ''
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike ''
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike ''
  
[0m21:45:57.297968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m21:45:57.298528 [debug] [ThreadPool]: On list_dw_: ROLLBACK
[0m21:45:57.298995 [debug] [ThreadPool]: On list_dw_: Close
[0m21:45:57.301990 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:57.302154 [debug] [MainThread]: On master: BEGIN
[0m21:45:57.302283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:57.309075 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:45:57.309233 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:57.309420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:45:57.315737 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m21:45:57.316320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d840806-c413-40cf-9282-ff28d20a43e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a8e50>]}
[0m21:45:57.316538 [debug] [MainThread]: On master: ROLLBACK
[0m21:45:57.317007 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:57.317196 [debug] [MainThread]: On master: BEGIN
[0m21:45:57.317934 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:45:57.318099 [debug] [MainThread]: On master: COMMIT
[0m21:45:57.318238 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:57.318373 [debug] [MainThread]: On master: COMMIT
[0m21:45:57.318801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:45:57.318947 [debug] [MainThread]: On master: Close
[0m21:45:57.319169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:57.319337 [info ] [MainThread]: 
[0m21:45:57.320533 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:45:57.320813 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:45:57.321056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:45:57.321234 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:45:57.330853 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:45:57.331397 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:45:57.338807 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:45:57.339211 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:45:57.339384 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:45:57.339537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:45:57.348277 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:45:57.348484 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:45:57.348654 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw".""."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:45:57.349164 [debug] [Thread-1  ]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 14: from "dw".""."stg_jaffle_shop_customers"
                   ^

[0m21:45:57.349342 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:45:57.349777 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:45:57.352520 [debug] [Thread-1  ]: Database Error in test not_null_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 14: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/not_null_stg_jaffle_shop_customers_customer_id.sql
[0m21:45:57.352770 [error] [Thread-1  ]: 1 of 2 ERROR not_null_stg_jaffle_shop_customers_customer_id .................... [[31mERROR[0m in 0.03s]
[0m21:45:57.353065 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:45:57.353273 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:45:57.353503 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:45:57.353717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:45:57.353897 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:45:57.357288 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:45:57.357590 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:45:57.358873 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:45:57.359156 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:45:57.359309 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:45:57.359462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:45:57.367707 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:45:57.368031 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:45:57.368252 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw".""."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:57.368948 [debug] [Thread-1  ]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 15: from "dw".""."stg_jaffle_shop_customers"
                   ^

[0m21:45:57.369136 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:45:57.369624 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:45:57.370182 [debug] [Thread-1  ]: Database Error in test unique_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 15: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_jaffle_shop_customers_customer_id.sql
[0m21:45:57.370436 [error] [Thread-1  ]: 2 of 2 ERROR unique_stg_jaffle_shop_customers_customer_id ...................... [[31mERROR[0m in 0.02s]
[0m21:45:57.370723 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:45:57.371383 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:57.371537 [debug] [MainThread]: On master: BEGIN
[0m21:45:57.371658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:57.378670 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:45:57.378851 [debug] [MainThread]: On master: COMMIT
[0m21:45:57.378982 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:57.379099 [debug] [MainThread]: On master: COMMIT
[0m21:45:57.379498 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:45:57.379659 [debug] [MainThread]: On master: Close
[0m21:45:57.379879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:57.380020 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:45:57.380183 [info ] [MainThread]: 
[0m21:45:57.380338 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m21:45:57.380759 [debug] [MainThread]: Command end result
[0m21:45:57.400033 [info ] [MainThread]: 
[0m21:45:57.400300 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:45:57.400455 [info ] [MainThread]: 
[0m21:45:57.400648 [error] [MainThread]:   Database Error in test not_null_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 14: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/not_null_stg_jaffle_shop_customers_customer_id.sql
[0m21:45:57.400806 [info ] [MainThread]: 
[0m21:45:57.400986 [error] [MainThread]:   Database Error in test unique_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 15: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_jaffle_shop_customers_customer_id.sql
[0m21:45:57.401134 [info ] [MainThread]: 
[0m21:45:57.401287 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m21:45:57.415019 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3125582, "process_user_time": 1.654473, "process_kernel_time": 0.1282, "process_mem_max_rss": "133447680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:45:57.415209 [debug] [MainThread]: Command `cli test` failed at 21:45:57.415169 after 1.31 seconds
[0m21:45:57.415385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105363b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788ed30>]}
[0m21:45:57.415556 [debug] [MainThread]: Flushing usage events
[0m21:46:23.079428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631b490>]}


============================== 21:46:23.081881 | 8406291b-8746-472e-aa7b-b1815bff9d7a ==============================
[0m21:46:23.081881 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:46:23.082234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:46:23.165640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad1610>]}
[0m21:46:23.189751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1ae50>]}
[0m21:46:23.190385 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:46:23.245861 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:46:23.315606 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:46:23.315873 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:46:23.316071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105719c40>]}
[0m21:46:23.949030 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:46:23.949310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2ec10>]}
[0m21:46:24.092019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e92130>]}
[0m21:46:24.183827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceacd0>]}
[0m21:46:24.184133 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:46:24.184310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8406291b-8746-472e-aa7b-b1815bff9d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f07f40>]}
[0m21:46:24.184961 [info ] [MainThread]: 
[0m21:46:24.185240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:46:24.185676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:46:24.208270 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:46:24.208493 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:46:24.208625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:24.220932 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m21:46:24.221573 [debug] [ThreadPool]: On list_dw: Close
[0m21:46:24.221952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw_)
[0m21:46:24.222190 [debug] [ThreadPool]: Creating schema "database: "dw"
"
[0m21:46:24.225237 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:46:24.225383 [debug] [ThreadPool]: On create_dw_: BEGIN
[0m21:46:24.225504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:24.231906 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:46:24.232082 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:46:24.232208 [debug] [ThreadPool]: On create_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw_"} */
create schema if not exists ""
[0m21:46:24.232733 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m21:46:24.232904 [debug] [ThreadPool]: On create_dw_: ROLLBACK
[0m21:46:24.233383 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m21:46:24.233522 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:46:24.233686 [debug] [ThreadPool]: On create_dw_: Close
[0m21:46:24.234038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:24.234161 [debug] [MainThread]: Connection 'create_dw_' was properly closed.
[0m21:46:24.234288 [info ] [MainThread]: 
[0m21:46:24.234438 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m21:46:24.234679 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m21:46:24.235626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1882967, "process_user_time": 1.643708, "process_kernel_time": 0.111889, "process_mem_max_rss": "127254528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:46:24.235839 [debug] [MainThread]: Command `cli run` failed at 21:46:24.235790 after 1.19 seconds
[0m21:46:24.236028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f07f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f37c0>]}
[0m21:46:24.236219 [debug] [MainThread]: Flushing usage events
[0m21:46:46.350953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884ad00>]}


============================== 21:46:46.353060 | cdb9abbf-1e20-49cd-884c-3de4e318bf13 ==============================
[0m21:46:46.353060 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:46:46.353349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:46:46.431283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107006910>]}
[0m21:46:46.455202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2b070>]}
[0m21:46:46.456500 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:46:46.511679 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:46:46.577595 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:46:46.577859 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:46:46.578052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108923fd0>]}
[0m21:46:47.183361 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:46:47.183644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915c2b0>]}
[0m21:46:47.318289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b2130>]}
[0m21:46:47.407704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921f490>]}
[0m21:46:47.407997 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:46:47.408166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb9abbf-1e20-49cd-884c-3de4e318bf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b2c40>]}
[0m21:46:47.408777 [info ] [MainThread]: 
[0m21:46:47.409039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:46:47.409457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:46:47.434416 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:46:47.434622 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:46:47.434750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:47.455638 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.021 seconds
[0m21:46:47.456286 [debug] [ThreadPool]: On list_dw: Close
[0m21:46:47.456609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw_)
[0m21:46:47.456811 [debug] [ThreadPool]: Creating schema "database: "dw"
"
[0m21:46:47.459900 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:46:47.460053 [debug] [ThreadPool]: On create_dw_: BEGIN
[0m21:46:47.460193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:47.470485 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:46:47.470656 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:46:47.470790 [debug] [ThreadPool]: On create_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw_"} */
create schema if not exists ""
[0m21:46:47.471408 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m21:46:47.471549 [debug] [ThreadPool]: On create_dw_: ROLLBACK
[0m21:46:47.472153 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m21:46:47.472289 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:46:47.472427 [debug] [ThreadPool]: On create_dw_: Close
[0m21:46:47.472755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:47.472882 [debug] [MainThread]: Connection 'create_dw_' was properly closed.
[0m21:46:47.473012 [info ] [MainThread]: 
[0m21:46:47.473165 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m21:46:47.473404 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m21:46:47.474494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1620691, "process_user_time": 1.576373, "process_kernel_time": 0.116735, "process_mem_max_rss": "127565824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:46:47.474720 [debug] [MainThread]: Command `cli run` failed at 21:46:47.474670 after 1.16 seconds
[0m21:46:47.474902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094986d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d80970>]}
[0m21:46:47.475088 [debug] [MainThread]: Flushing usage events
[0m21:47:20.067431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10418dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10418d460>]}


============================== 21:47:20.069849 | 81ffe41f-42fe-43e7-90c1-063dfaa9739d ==============================
[0m21:47:20.069849 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:47:20.070159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:47:20.152479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81ffe41f-42fe-43e7-90c1-063dfaa9739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ae550>]}
[0m21:47:20.176573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81ffe41f-42fe-43e7-90c1-063dfaa9739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413d250>]}
[0m21:47:20.177225 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:47:20.231629 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:47:20.324060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:47:20.324275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:47:20.357315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ffe41f-42fe-43e7-90c1-063dfaa9739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496c130>]}
[0m21:47:20.438651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ffe41f-42fe-43e7-90c1-063dfaa9739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104928820>]}
[0m21:47:20.438941 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:47:20.439838 [info ] [MainThread]: 
[0m21:47:20.440155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:47:20.440576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:47:20.465852 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:47:20.466109 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:47:20.466258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:20.479010 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m21:47:20.479662 [debug] [ThreadPool]: On list_dw: Close
[0m21:47:20.480028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw_)
[0m21:47:20.480253 [debug] [ThreadPool]: Creating schema "database: "dw"
"
[0m21:47:20.483018 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:47:20.483160 [debug] [ThreadPool]: On create_dw_: BEGIN
[0m21:47:20.483283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:20.489536 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:47:20.489703 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:47:20.489830 [debug] [ThreadPool]: On create_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw_"} */
create schema if not exists ""
[0m21:47:20.490319 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m21:47:20.490449 [debug] [ThreadPool]: On create_dw_: ROLLBACK
[0m21:47:20.490936 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m21:47:20.491075 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:47:20.491225 [debug] [ThreadPool]: On create_dw_: Close
[0m21:47:20.491611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:20.491806 [debug] [MainThread]: Connection 'create_dw_' was properly closed.
[0m21:47:20.491985 [info ] [MainThread]: 
[0m21:47:20.492168 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m21:47:20.492528 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m21:47:20.493660 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.46167842, "process_user_time": 0.887511, "process_kernel_time": 0.1143, "process_mem_max_rss": "122765312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:47:20.493909 [debug] [MainThread]: Command `cli build` failed at 21:47:20.493855 after 0.46 seconds
[0m21:47:20.494110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a12730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa02e0>]}
[0m21:47:20.494285 [debug] [MainThread]: Flushing usage events
[0m21:51:49.206034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104728be0>]}


============================== 21:51:49.208122 | 7806911d-8bb4-44d2-bfbf-3d3facab8de5 ==============================
[0m21:51:49.208122 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:51:49.208395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_jaffle_shop_customers', 'send_anonymous_usage_stats': 'True'}
[0m21:51:49.305172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7806911d-8bb4-44d2-bfbf-3d3facab8de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494e640>]}
[0m21:51:49.328907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7806911d-8bb4-44d2-bfbf-3d3facab8de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff4df0>]}
[0m21:51:49.329471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:51:49.382086 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:51:49.473982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:49.474195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:49.504034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7806911d-8bb4-44d2-bfbf-3d3facab8de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503f130>]}
[0m21:51:49.577483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7806911d-8bb4-44d2-bfbf-3d3facab8de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105374df0>]}
[0m21:51:49.577752 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:51:49.577924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7806911d-8bb4-44d2-bfbf-3d3facab8de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502c4c0>]}
[0m21:51:49.578536 [info ] [MainThread]: 
[0m21:51:49.578808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:49.581057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_'
[0m21:51:49.606892 [debug] [ThreadPool]: Using postgres connection "list_dw_"
[0m21:51:49.607100 [debug] [ThreadPool]: On list_dw_: BEGIN
[0m21:51:49.607236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:49.639001 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m21:51:49.639232 [debug] [ThreadPool]: Using postgres connection "list_dw_"
[0m21:51:49.639405 [debug] [ThreadPool]: On list_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike ''
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike ''
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike ''
  
[0m21:51:49.644725 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:51:49.645353 [debug] [ThreadPool]: On list_dw_: ROLLBACK
[0m21:51:49.645870 [debug] [ThreadPool]: On list_dw_: Close
[0m21:51:49.646154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_, now list_dw__jaffle_shop)
[0m21:51:49.647518 [debug] [ThreadPool]: Using postgres connection "list_dw__jaffle_shop"
[0m21:51:49.647667 [debug] [ThreadPool]: On list_dw__jaffle_shop: BEGIN
[0m21:51:49.647797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:49.654975 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:51:49.655176 [debug] [ThreadPool]: Using postgres connection "list_dw__jaffle_shop"
[0m21:51:49.655350 [debug] [ThreadPool]: On list_dw__jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw__jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_jaffle_shop'
  
[0m21:51:49.658711 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:51:49.659396 [debug] [ThreadPool]: On list_dw__jaffle_shop: ROLLBACK
[0m21:51:49.659867 [debug] [ThreadPool]: On list_dw__jaffle_shop: Close
[0m21:51:49.663139 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.663295 [debug] [MainThread]: On master: BEGIN
[0m21:51:49.663428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:49.670757 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:51:49.671015 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.671227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:51:49.674895 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m21:51:49.675547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7806911d-8bb4-44d2-bfbf-3d3facab8de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105031a60>]}
[0m21:51:49.675788 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:49.676395 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.676596 [debug] [MainThread]: On master: BEGIN
[0m21:51:49.677445 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:51:49.677607 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.677748 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.677884 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.678368 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:49.678521 [debug] [MainThread]: On master: Close
[0m21:51:49.678780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:49.678946 [info ] [MainThread]: 
[0m21:51:49.680237 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:51:49.680442 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:51:49.680669 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw__jaffle_shop, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:51:49.680832 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:51:49.690103 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:51:49.690667 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:51:49.699392 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:51:49.699884 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:51:49.700071 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:51:49.700241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:51:49.707387 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:51:49.707647 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:51:49.707821 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw".""."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:51:49.708378 [debug] [Thread-1  ]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 14: from "dw".""."stg_jaffle_shop_customers"
                   ^

[0m21:51:49.708563 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:51:49.709016 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:51:49.712070 [debug] [Thread-1  ]: Database Error in test not_null_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 14: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/not_null_stg_jaffle_shop_customers_customer_id.sql
[0m21:51:49.712338 [error] [Thread-1  ]: 1 of 2 ERROR not_null_stg_jaffle_shop_customers_customer_id .................... [[31mERROR[0m in 0.03s]
[0m21:51:49.712652 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:51:49.712870 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:51:49.713085 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:51:49.713326 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:51:49.713504 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:51:49.742116 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:51:49.742610 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:51:49.744062 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:51:49.744521 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:51:49.744725 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:51:49.744871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:51:49.755805 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:51:49.756024 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:51:49.756200 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw".""."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:51:49.757075 [debug] [Thread-1  ]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 15: from "dw".""."stg_jaffle_shop_customers"
                   ^

[0m21:51:49.757304 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:51:49.757849 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:51:49.758420 [debug] [Thread-1  ]: Database Error in test unique_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 15: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_jaffle_shop_customers_customer_id.sql
[0m21:51:49.758680 [error] [Thread-1  ]: 2 of 2 ERROR unique_stg_jaffle_shop_customers_customer_id ...................... [[31mERROR[0m in 0.05s]
[0m21:51:49.758995 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:51:49.759620 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.759765 [debug] [MainThread]: On master: BEGIN
[0m21:51:49.759886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:49.766950 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:51:49.767165 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.767309 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.767442 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.767849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:49.767990 [debug] [MainThread]: On master: Close
[0m21:51:49.768200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:49.768357 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:51:49.768529 [info ] [MainThread]: 
[0m21:51:49.768689 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m21:51:49.769064 [debug] [MainThread]: Command end result
[0m21:51:49.787098 [info ] [MainThread]: 
[0m21:51:49.787335 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:51:49.787484 [info ] [MainThread]: 
[0m21:51:49.787676 [error] [MainThread]:   Database Error in test not_null_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 14: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/not_null_stg_jaffle_shop_customers_customer_id.sql
[0m21:51:49.787833 [info ] [MainThread]: 
[0m21:51:49.788009 [error] [MainThread]:   Database Error in test unique_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  zero-length delimited identifier at or near """"
  LINE 15: from "dw".""."stg_jaffle_shop_customers"
                     ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_jaffle_shop_customers_customer_id.sql
[0m21:51:49.788159 [info ] [MainThread]: 
[0m21:51:49.788319 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m21:51:49.789384 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6150521, "process_user_time": 0.966968, "process_kernel_time": 0.117747, "process_mem_max_rss": "122404864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:51:49.789574 [debug] [MainThread]: Command `dbt test` failed at 21:51:49.789535 after 0.62 seconds
[0m21:51:49.789769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575ce50>]}
[0m21:51:49.789944 [debug] [MainThread]: Flushing usage events
[0m21:52:11.755678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107124c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b94f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b94640>]}


============================== 21:52:11.757378 | a453c41b-59b1-4c88-88e1-c08e89d5cb22 ==============================
[0m21:52:11.757378 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:52:11.757671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:52:11.836499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a453c41b-59b1-4c88-88e1-c08e89d5cb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b33e50>]}
[0m21:52:11.861942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a453c41b-59b1-4c88-88e1-c08e89d5cb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b339d0>]}
[0m21:52:11.862394 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:52:11.917037 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:52:11.987096 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:52:11.987351 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:52:11.987535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a453c41b-59b1-4c88-88e1-c08e89d5cb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f91b80>]}
[0m21:52:12.576034 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:52:12.576321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a453c41b-59b1-4c88-88e1-c08e89d5cb22', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109136910>]}
[0m21:52:12.716395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a453c41b-59b1-4c88-88e1-c08e89d5cb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f7130>]}
[0m21:52:12.806581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a453c41b-59b1-4c88-88e1-c08e89d5cb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f4b80>]}
[0m21:52:12.806868 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:52:12.807652 [info ] [MainThread]: 
[0m21:52:12.807943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:12.808363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:52:12.828899 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:52:12.829111 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:52:12.829240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:12.849315 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m21:52:12.850010 [debug] [ThreadPool]: On list_dw: Close
[0m21:52:12.850358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw_)
[0m21:52:12.850584 [debug] [ThreadPool]: Creating schema "database: "dw"
"
[0m21:52:12.853324 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:52:12.853476 [debug] [ThreadPool]: On create_dw_: BEGIN
[0m21:52:12.853617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:52:12.862723 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:52:12.862977 [debug] [ThreadPool]: Using postgres connection "create_dw_"
[0m21:52:12.863126 [debug] [ThreadPool]: On create_dw_: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw_"} */
create schema if not exists ""
[0m21:52:12.863829 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m21:52:12.863991 [debug] [ThreadPool]: On create_dw_: ROLLBACK
[0m21:52:12.864635 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m21:52:12.864765 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:52:12.864900 [debug] [ThreadPool]: On create_dw_: Close
[0m21:52:12.865273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:12.865418 [debug] [MainThread]: Connection 'create_dw_' was properly closed.
[0m21:52:12.865560 [info ] [MainThread]: 
[0m21:52:12.865722 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m21:52:12.865973 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m21:52:12.867491 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.1424958, "process_user_time": 1.57687, "process_kernel_time": 0.094709, "process_mem_max_rss": "131563520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:52:12.867677 [debug] [MainThread]: Command `cli build` failed at 21:52:12.867634 after 1.14 seconds
[0m21:52:12.867846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107124c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c6730>]}
[0m21:52:12.868025 [debug] [MainThread]: Flushing usage events
[0m21:56:05.854568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a24b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a7b20>]}


============================== 21:56:05.856832 | 66f8ac16-3328-4fae-abc5-20d9074328b8 ==============================
[0m21:56:05.856832 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:56:05.857124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_jaffle_shop_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:05.968257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f8ac16-3328-4fae-abc5-20d9074328b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107389640>]}
[0m21:56:05.992480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f8ac16-3328-4fae-abc5-20d9074328b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111518190>]}
[0m21:56:05.993080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:06.046592 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:56:06.139006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:06.139268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:06.170273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66f8ac16-3328-4fae-abc5-20d9074328b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbf130>]}
[0m21:56:06.250952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66f8ac16-3328-4fae-abc5-20d9074328b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e08d30>]}
[0m21:56:06.251271 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:56:06.251459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f8ac16-3328-4fae-abc5-20d9074328b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf89a0>]}
[0m21:56:06.252093 [info ] [MainThread]: 
[0m21:56:06.252392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:06.254905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m21:56:06.282303 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:56:06.282520 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:56:06.282652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:06.296774 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:56:06.297024 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:56:06.297190 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:06.301537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:56:06.302123 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:56:06.302544 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:56:06.302824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m21:56:06.304284 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:56:06.304452 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:56:06.304577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:06.311529 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:56:06.311737 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:56:06.311888 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:56:06.313464 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m21:56:06.314062 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:56:06.314538 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:56:06.317570 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.317765 [debug] [MainThread]: On master: BEGIN
[0m21:56:06.317894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:06.324241 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:56:06.324381 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.324554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:06.329282 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:56:06.329793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f8ac16-3328-4fae-abc5-20d9074328b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e61070>]}
[0m21:56:06.330001 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:06.330463 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.330591 [debug] [MainThread]: On master: BEGIN
[0m21:56:06.331497 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:56:06.331629 [debug] [MainThread]: On master: COMMIT
[0m21:56:06.331750 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.331867 [debug] [MainThread]: On master: COMMIT
[0m21:56:06.332301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:06.332431 [debug] [MainThread]: On master: Close
[0m21:56:06.332651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:06.332821 [info ] [MainThread]: 
[0m21:56:06.334029 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:06.334278 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:56:06.334504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:56:06.334665 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:06.343645 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:06.344154 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:06.351760 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:06.352139 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:06.352303 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:56:06.352468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:06.358644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:56:06.358857 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:06.359025 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:56:06.359573 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.stg_jaffle_shop_customers" does not exist
LINE 14: from "dw"."public"."stg_jaffle_shop_customers"
              ^

[0m21:56:06.359747 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:56:06.360236 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:56:06.363223 [debug] [Thread-1  ]: Database Error in test not_null_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  relation "public.stg_jaffle_shop_customers" does not exist
  LINE 14: from "dw"."public"."stg_jaffle_shop_customers"
                ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/not_null_stg_jaffle_shop_customers_customer_id.sql
[0m21:56:06.363477 [error] [Thread-1  ]: 1 of 2 ERROR not_null_stg_jaffle_shop_customers_customer_id .................... [[31mERROR[0m in 0.03s]
[0m21:56:06.363773 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:06.363974 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:06.364194 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:56:06.364407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:56:06.364579 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:06.389590 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:06.390000 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:06.391224 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:06.391518 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:06.391672 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:56:06.391857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:06.400180 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:56:06.400429 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:06.400654 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:56:06.401405 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.stg_jaffle_shop_customers" does not exist
LINE 15: from "dw"."public"."stg_jaffle_shop_customers"
              ^

[0m21:56:06.401595 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:56:06.402112 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:56:06.402644 [debug] [Thread-1  ]: Database Error in test unique_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  relation "public.stg_jaffle_shop_customers" does not exist
  LINE 15: from "dw"."public"."stg_jaffle_shop_customers"
                ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_jaffle_shop_customers_customer_id.sql
[0m21:56:06.402881 [error] [Thread-1  ]: 2 of 2 ERROR unique_stg_jaffle_shop_customers_customer_id ...................... [[31mERROR[0m in 0.04s]
[0m21:56:06.403182 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:06.404007 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.404212 [debug] [MainThread]: On master: BEGIN
[0m21:56:06.404337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:06.411079 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:56:06.411340 [debug] [MainThread]: On master: COMMIT
[0m21:56:06.411476 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.411599 [debug] [MainThread]: On master: COMMIT
[0m21:56:06.412028 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:06.412176 [debug] [MainThread]: On master: Close
[0m21:56:06.412386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:06.412530 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:56:06.412681 [info ] [MainThread]: 
[0m21:56:06.412838 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m21:56:06.413255 [debug] [MainThread]: Command end result
[0m21:56:06.432244 [info ] [MainThread]: 
[0m21:56:06.432509 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:56:06.432661 [info ] [MainThread]: 
[0m21:56:06.432857 [error] [MainThread]:   Database Error in test not_null_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  relation "public.stg_jaffle_shop_customers" does not exist
  LINE 14: from "dw"."public"."stg_jaffle_shop_customers"
                ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/not_null_stg_jaffle_shop_customers_customer_id.sql
[0m21:56:06.433010 [info ] [MainThread]: 
[0m21:56:06.433188 [error] [MainThread]:   Database Error in test unique_stg_jaffle_shop_customers_customer_id (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  relation "public.stg_jaffle_shop_customers" does not exist
  LINE 15: from "dw"."public"."stg_jaffle_shop_customers"
                ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_jaffle_shop_customers_customer_id.sql
[0m21:56:06.433334 [info ] [MainThread]: 
[0m21:56:06.433486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m21:56:06.434395 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6125865, "process_user_time": 0.961961, "process_kernel_time": 0.116117, "process_mem_max_rss": "123305984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:06.434585 [debug] [MainThread]: Command `dbt test` failed at 21:56:06.434545 after 0.61 seconds
[0m21:56:06.434759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a24b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c8f40>]}
[0m21:56:06.434923 [debug] [MainThread]: Flushing usage events
[0m21:56:25.303440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104845b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104845220>]}


============================== 21:56:25.305547 | d5a2e1bd-8fbb-4719-9b2f-168cee094245 ==============================
[0m21:56:25.305547 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:56:25.305846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:56:25.385646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f8c40>]}
[0m21:56:25.409630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab2310>]}
[0m21:56:25.410219 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:25.463106 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:56:25.562023 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:56:25.562289 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:56:25.562490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c40af0>]}
[0m21:56:26.188632 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:56:26.188908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0cee0>]}
[0m21:56:26.324612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a5130>]}
[0m21:56:26.421096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105227850>]}
[0m21:56:26.421389 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:56:26.422186 [info ] [MainThread]: 
[0m21:56:26.422488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:26.422925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:56:26.445731 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:56:26.445940 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:56:26.446069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:26.463973 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m21:56:26.464618 [debug] [ThreadPool]: On list_dw: Close
[0m21:56:26.467076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m21:56:26.470606 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:56:26.470808 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:56:26.470946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:26.480587 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:56:26.480838 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:56:26.481029 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:56:26.484839 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:56:26.485508 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:56:26.486033 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:56:26.486328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m21:56:26.487716 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:56:26.487914 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:56:26.488069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:26.494709 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:56:26.494856 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:56:26.494998 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:26.497217 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:56:26.497726 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:56:26.498174 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:56:26.500941 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:26.501099 [debug] [MainThread]: On master: BEGIN
[0m21:56:26.501222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:26.508167 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:56:26.508419 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:26.508608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:26.513037 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:56:26.513638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d471c0>]}
[0m21:56:26.513864 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:26.514335 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:26.514482 [debug] [MainThread]: On master: BEGIN
[0m21:56:26.515206 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:56:26.515404 [debug] [MainThread]: On master: COMMIT
[0m21:56:26.515553 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:26.515687 [debug] [MainThread]: On master: COMMIT
[0m21:56:26.516113 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:26.516264 [debug] [MainThread]: On master: Close
[0m21:56:26.516507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:26.516680 [info ] [MainThread]: 
[0m21:56:26.519186 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_customers
[0m21:56:26.519529 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_jaffle_shop_customers ................... [RUN]
[0m21:56:26.519800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop_customers)
[0m21:56:26.519984 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_customers
[0m21:56:26.524839 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.525446 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_customers
[0m21:56:26.542432 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.542862 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.543023 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: BEGIN
[0m21:56:26.543169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:26.549522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:56:26.549779 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.549942 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */

  create view "dw"."public"."stg_jaffle_shop_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."_jaffle_shop"."raw_customers"
),

renamed as (
    select
        id as customer_id,
        name as customer_name
    from source
)

select * from renamed
  );
[0m21:56:26.553160 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:56:26.556792 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.556962 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
alter table "dw"."public"."stg_jaffle_shop_customers__dbt_tmp" rename to "stg_jaffle_shop_customers"
[0m21:56:26.557533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:56:26.564389 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: COMMIT
[0m21:56:26.564558 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.564701 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: COMMIT
[0m21:56:26.565721 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:56:26.568883 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop_customers__dbt_backup"
[0m21:56:26.570992 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m21:56:26.571171 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop_customers__dbt_backup" cascade
[0m21:56:26.571799 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:56:26.573015 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: Close
[0m21:56:26.573734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a2e1bd-8fbb-4719-9b2f-168cee094245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d471c0>]}
[0m21:56:26.574013 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_jaffle_shop_customers .............. [[32mCREATE VIEW[0m in 0.05s]
[0m21:56:26.574300 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_customers
[0m21:56:26.574693 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:26.574903 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:56:26.575168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_jaffle_shop_customers, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:56:26.575339 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:26.581730 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:26.582086 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:26.589238 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:26.589565 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:26.589719 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:56:26.589865 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:26.596167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:56:26.596387 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:26.596569 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:56:26.598671 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:56:26.600314 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:56:26.600752 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:56:26.601053 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m21:56:26.601335 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:26.601543 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:26.601753 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:56:26.601970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:56:26.602143 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:26.605499 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:26.605832 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:26.607155 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:26.607471 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:26.607617 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:56:26.607755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:26.614023 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:56:26.614265 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:26.614446 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:56:26.616292 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:56:26.617131 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:56:26.617612 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:56:26.617933 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.02s]
[0m21:56:26.618230 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:26.618769 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:26.618932 [debug] [MainThread]: On master: BEGIN
[0m21:56:26.619080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:26.624940 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:56:26.625096 [debug] [MainThread]: On master: COMMIT
[0m21:56:26.625216 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:26.625353 [debug] [MainThread]: On master: COMMIT
[0m21:56:26.625746 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:26.625878 [debug] [MainThread]: On master: Close
[0m21:56:26.626058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:26.626196 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:56:26.626354 [info ] [MainThread]: 
[0m21:56:26.626502 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m21:56:26.627013 [debug] [MainThread]: Command end result
[0m21:56:26.645650 [info ] [MainThread]: 
[0m21:56:26.645903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:26.646059 [info ] [MainThread]: 
[0m21:56:26.646217 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:56:26.647265 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3737464, "process_user_time": 1.744849, "process_kernel_time": 0.117349, "process_mem_max_rss": "133300224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:26.647463 [debug] [MainThread]: Command `cli build` succeeded at 21:56:26.647422 after 1.37 seconds
[0m21:56:26.647647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030fea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105113e80>]}
[0m21:56:26.647818 [debug] [MainThread]: Flushing usage events
[0m21:56:37.113748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043efc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106267220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106267b20>]}


============================== 21:56:37.116959 | 2c3ee757-12ea-4420-b2f4-df21ce2a3d8f ==============================
[0m21:56:37.116959 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:56:37.117286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:56:37.197779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c3ee757-12ea-4420-b2f4-df21ce2a3d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106203520>]}
[0m21:56:37.222466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c3ee757-12ea-4420-b2f4-df21ce2a3d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a700>]}
[0m21:56:37.223097 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:37.276375 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:56:37.365767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:37.365972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:37.396178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c3ee757-12ea-4420-b2f4-df21ce2a3d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7f130>]}
[0m21:56:37.468430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c3ee757-12ea-4420-b2f4-df21ce2a3d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbba00>]}
[0m21:56:37.468718 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:56:37.468889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3ee757-12ea-4420-b2f4-df21ce2a3d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672c8b0>]}
[0m21:56:37.469538 [info ] [MainThread]: 
[0m21:56:37.469833 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:37.472118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m21:56:37.495566 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:56:37.495759 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:56:37.495888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:37.512183 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:56:37.512401 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:56:37.512550 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:37.517440 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:56:37.518041 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:56:37.518942 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:56:37.519230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m21:56:37.520560 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:56:37.520703 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:56:37.520822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:37.529898 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:56:37.530042 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:56:37.530187 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:56:37.533668 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m21:56:37.534199 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:56:37.534972 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:56:37.537965 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.538196 [debug] [MainThread]: On master: BEGIN
[0m21:56:37.538343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:37.546388 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m21:56:37.546612 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.546814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:37.552979 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m21:56:37.553586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3ee757-12ea-4420-b2f4-df21ce2a3d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbb970>]}
[0m21:56:37.553806 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:37.554492 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.554679 [debug] [MainThread]: On master: BEGIN
[0m21:56:37.555456 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:56:37.555606 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.555736 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.555861 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.556311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:37.556460 [debug] [MainThread]: On master: Close
[0m21:56:37.556697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:37.556874 [info ] [MainThread]: 
[0m21:56:37.558100 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:37.558302 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:56:37.558547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:56:37.558712 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:37.567411 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:37.567749 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:37.575701 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:37.576146 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:37.576306 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:56:37.576526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:37.583720 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:56:37.583936 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:56:37.584120 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:56:37.585063 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:56:37.587465 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:56:37.588027 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:56:37.588381 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m21:56:37.588681 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:56:37.588912 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:37.589096 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:56:37.589414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:56:37.589638 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:37.614080 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:37.614512 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:37.615792 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:37.616076 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:37.616242 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:56:37.616385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:37.624029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:56:37.624223 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:56:37.624390 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:56:37.625900 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:56:37.626653 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:56:37.627061 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:56:37.627399 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.04s]
[0m21:56:37.627692 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:56:37.628210 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.628360 [debug] [MainThread]: On master: BEGIN
[0m21:56:37.628491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:37.633805 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:56:37.633969 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.634087 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.634203 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.634617 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:37.634747 [debug] [MainThread]: On master: Close
[0m21:56:37.634936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:37.635080 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:56:37.635227 [info ] [MainThread]: 
[0m21:56:37.635379 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m21:56:37.635775 [debug] [MainThread]: Command end result
[0m21:56:37.655009 [info ] [MainThread]: 
[0m21:56:37.655254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:37.655406 [info ] [MainThread]: 
[0m21:56:37.655563 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:56:37.656483 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5782343, "process_user_time": 0.967856, "process_kernel_time": 0.109039, "process_mem_max_rss": "122241024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:37.656684 [debug] [MainThread]: Command `cli test` succeeded at 21:56:37.656643 after 0.58 seconds
[0m21:56:37.656868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043efc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f3a90>]}
[0m21:56:37.657044 [debug] [MainThread]: Flushing usage events
[0m21:58:24.825867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031f7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105055280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105055670>]}


============================== 21:58:24.828489 | 4d66f14c-7a5e-450d-977f-16f5aeb1f6b7 ==============================
[0m21:58:24.828489 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:58:24.828823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:58:24.927564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10355f5b0>]}
[0m21:58:24.952567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105312cd0>]}
[0m21:58:24.953194 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:58:25.008454 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:58:25.078070 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:58:25.078345 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:58:25.078544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f1b80>]}
[0m21:58:25.676882 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:58:25.677194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591f580>]}
[0m21:58:25.811638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f45130>]}
[0m21:58:25.905835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bde070>]}
[0m21:58:25.906109 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:58:25.906282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f467f0>]}
[0m21:58:25.906940 [info ] [MainThread]: 
[0m21:58:25.907240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:25.909625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m21:58:25.933258 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:58:25.933456 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:58:25.933586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:25.952449 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m21:58:25.952740 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:58:25.952917 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:58:25.959024 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:58:25.959634 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:58:25.960471 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:58:25.960825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m21:58:25.962262 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:58:25.962409 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:58:25.962528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:25.971822 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:58:25.971964 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:58:25.972101 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:58:25.975675 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:25.976234 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:58:25.977005 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:58:25.979949 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:25.980121 [debug] [MainThread]: On master: BEGIN
[0m21:58:25.980256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:25.988832 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:58:25.988967 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:25.989141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:25.994805 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m21:58:25.995357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d66f14c-7a5e-450d-977f-16f5aeb1f6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be4130>]}
[0m21:58:25.995560 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:25.996063 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:25.996195 [debug] [MainThread]: On master: BEGIN
[0m21:58:25.997009 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:58:25.997147 [debug] [MainThread]: On master: COMMIT
[0m21:58:25.997271 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:25.997389 [debug] [MainThread]: On master: COMMIT
[0m21:58:25.997832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:25.997987 [debug] [MainThread]: On master: Close
[0m21:58:25.998213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:58:25.998380 [info ] [MainThread]: 
[0m21:58:26.000074 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:26.000268 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:58:26.000578 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:58:26.000744 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:26.010353 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:26.011251 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:26.018639 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:26.018978 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:26.019134 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:58:26.019279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:58:26.027147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:58:26.027371 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:26.027540 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:58:26.029931 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:58:26.032065 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:58:26.032588 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:58:26.032927 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m21:58:26.033238 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:26.033460 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:26.033679 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:58:26.033926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:58:26.034106 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:26.037235 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:26.037572 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:26.038819 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:26.039118 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:26.039282 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:58:26.039445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:58:26.046634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:58:26.046858 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:26.047038 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:58:26.048562 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:58:26.049402 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:58:26.050191 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:58:26.050507 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.02s]
[0m21:58:26.050800 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:26.051343 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:26.051521 [debug] [MainThread]: On master: BEGIN
[0m21:58:26.051688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:26.062079 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:58:26.062279 [debug] [MainThread]: On master: COMMIT
[0m21:58:26.062408 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:26.062531 [debug] [MainThread]: On master: COMMIT
[0m21:58:26.063125 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:26.063282 [debug] [MainThread]: On master: Close
[0m21:58:26.063528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:26.063672 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:58:26.063891 [info ] [MainThread]: 
[0m21:58:26.064053 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m21:58:26.064464 [debug] [MainThread]: Command end result
[0m21:58:26.084887 [info ] [MainThread]: 
[0m21:58:26.085145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:26.085303 [info ] [MainThread]: 
[0m21:58:26.085469 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:58:26.086534 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.292353, "process_user_time": 1.654132, "process_kernel_time": 0.118954, "process_mem_max_rss": "132382720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:26.086715 [debug] [MainThread]: Command `cli test` succeeded at 21:58:26.086677 after 1.29 seconds
[0m21:58:26.086887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031f7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105312cd0>]}
[0m21:58:26.087045 [debug] [MainThread]: Flushing usage events
[0m21:58:54.016309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106726220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106726b20>]}


============================== 21:58:54.018466 | 70667e05-de02-47fe-92de-67628094cce6 ==============================
[0m21:58:54.018466 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:58:54.018795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:54.098949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c3520>]}
[0m21:58:54.125440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d7970>]}
[0m21:58:54.126754 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:58:54.184175 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:58:54.250018 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:58:54.250293 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:58:54.250490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fbeb0>]}
[0m21:58:54.850988 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:58:54.851265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725f190>]}
[0m21:58:54.987393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d9130>]}
[0m21:58:55.084956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ea430>]}
[0m21:58:55.085257 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:58:55.085430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075aa730>]}
[0m21:58:55.086056 [info ] [MainThread]: 
[0m21:58:55.086316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:55.088673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m21:58:55.113550 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:58:55.113810 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:58:55.113962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:55.142741 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m21:58:55.142954 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:58:55.143110 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:58:55.148836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:58:55.149432 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:58:55.150172 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:58:55.150509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m21:58:55.151931 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:58:55.152115 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:58:55.152255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:55.160772 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:58:55.160926 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:58:55.161083 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:58:55.164812 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:58:55.165398 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:58:55.165985 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:58:55.169089 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:55.169260 [debug] [MainThread]: On master: BEGIN
[0m21:58:55.169393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:55.177274 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m21:58:55.177481 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:55.177690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:55.183170 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m21:58:55.183865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70667e05-de02-47fe-92de-67628094cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813b20>]}
[0m21:58:55.184098 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:55.184633 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:55.184775 [debug] [MainThread]: On master: BEGIN
[0m21:58:55.185548 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:58:55.185706 [debug] [MainThread]: On master: COMMIT
[0m21:58:55.185845 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:55.185981 [debug] [MainThread]: On master: COMMIT
[0m21:58:55.186428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:55.186577 [debug] [MainThread]: On master: Close
[0m21:58:55.186804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:58:55.186971 [info ] [MainThread]: 
[0m21:58:55.188723 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:55.188930 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:58:55.189232 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:58:55.189414 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:55.198999 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:55.199397 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:55.206690 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:55.207006 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:55.207183 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:58:55.207329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:58:55.218398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:58:55.218615 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:58:55.218779 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:58:55.221442 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:58:55.223657 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:58:55.224226 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:58:55.224579 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.04s]
[0m21:58:55.224866 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:58:55.225118 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:55.225311 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:58:55.225599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:58:55.225815 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:55.229267 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:55.229633 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:55.230928 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:55.231203 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:55.231365 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:58:55.231521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:58:55.239918 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:58:55.240135 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:58:55.240299 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:58:55.243116 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:55.243951 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:58:55.244558 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:58:55.244878 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.02s]
[0m21:58:55.245167 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:58:55.245711 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:55.245870 [debug] [MainThread]: On master: BEGIN
[0m21:58:55.246011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:55.252337 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:58:55.252563 [debug] [MainThread]: On master: COMMIT
[0m21:58:55.252691 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:55.252814 [debug] [MainThread]: On master: COMMIT
[0m21:58:55.253238 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:55.253389 [debug] [MainThread]: On master: Close
[0m21:58:55.253597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:55.253744 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:58:55.253894 [info ] [MainThread]: 
[0m21:58:55.254045 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m21:58:55.254511 [debug] [MainThread]: Command end result
[0m21:58:55.272671 [info ] [MainThread]: 
[0m21:58:55.272897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:55.273055 [info ] [MainThread]: 
[0m21:58:55.273212 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:58:55.274274 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2960275, "process_user_time": 1.659692, "process_kernel_time": 0.123216, "process_mem_max_rss": "131923968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:55.274488 [debug] [MainThread]: Command `cli test` succeeded at 21:58:55.274446 after 1.30 seconds
[0m21:58:55.274679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffc7c0>]}
[0m21:58:55.274853 [debug] [MainThread]: Flushing usage events
[0m21:59:14.011800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b173d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17cd0>]}


============================== 21:59:14.014558 | 7e52566a-74dc-4fbc-b555-a9032672519c ==============================
[0m21:59:14.014558 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:59:14.014883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:14.110734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab3820>]}
[0m21:59:14.135420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d72f70>]}
[0m21:59:14.136091 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:59:14.189061 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:59:14.254971 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:59:14.255238 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:59:14.255427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f15af0>]}
[0m21:59:14.859146 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:59:14.859452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d380d0>]}
[0m21:59:15.002792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767e130>]}
[0m21:59:15.104377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073debe0>]}
[0m21:59:15.104680 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:59:15.104851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107763700>]}
[0m21:59:15.105480 [info ] [MainThread]: 
[0m21:59:15.105741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:15.108116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m21:59:15.131520 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:59:15.131719 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:59:15.131849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:15.151062 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m21:59:15.151261 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:59:15.151411 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:59:15.156577 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:59:15.157149 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:59:15.158140 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:59:15.158398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m21:59:15.159781 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:59:15.159934 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:59:15.160058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:15.169997 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:59:15.170144 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:59:15.170284 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:59:15.173618 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m21:59:15.174178 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:59:15.174993 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:59:15.177850 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:15.178044 [debug] [MainThread]: On master: BEGIN
[0m21:59:15.178191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:15.186414 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m21:59:15.186634 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:15.186865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:59:15.191070 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m21:59:15.191697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e52566a-74dc-4fbc-b555-a9032672519c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a22b0>]}
[0m21:59:15.191916 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:15.192297 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:15.192435 [debug] [MainThread]: On master: BEGIN
[0m21:59:15.193064 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:59:15.193227 [debug] [MainThread]: On master: COMMIT
[0m21:59:15.193367 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:15.193508 [debug] [MainThread]: On master: COMMIT
[0m21:59:15.193880 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:15.194059 [debug] [MainThread]: On master: Close
[0m21:59:15.194301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:15.194462 [info ] [MainThread]: 
[0m21:59:15.195660 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:15.195862 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:59:15.196170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:59:15.196343 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:15.205911 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:15.206535 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:15.214655 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:15.215159 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:15.215327 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:59:15.215480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:59:15.221432 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:59:15.221643 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:15.221821 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:59:15.223054 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:59:15.225327 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:59:15.225777 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:59:15.226081 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m21:59:15.226361 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:15.226568 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:15.226782 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:59:15.226999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:59:15.227178 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:15.230582 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:15.230919 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:15.232207 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:15.232519 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:15.232683 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:59:15.232825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:59:15.238676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:59:15.238859 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:15.239010 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:59:15.240103 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:59:15.240843 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:59:15.241271 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:59:15.241563 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.01s]
[0m21:59:15.241851 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:15.242865 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:15.243068 [debug] [MainThread]: On master: BEGIN
[0m21:59:15.243202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:15.249248 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:59:15.249438 [debug] [MainThread]: On master: COMMIT
[0m21:59:15.249574 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:15.249700 [debug] [MainThread]: On master: COMMIT
[0m21:59:15.250191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:15.250372 [debug] [MainThread]: On master: Close
[0m21:59:15.250598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:15.250738 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:59:15.250898 [info ] [MainThread]: 
[0m21:59:15.251038 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m21:59:15.251417 [debug] [MainThread]: Command end result
[0m21:59:15.272870 [info ] [MainThread]: 
[0m21:59:15.273140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:59:15.273300 [info ] [MainThread]: 
[0m21:59:15.273458 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:59:15.274628 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.298664, "process_user_time": 1.683727, "process_kernel_time": 0.126506, "process_mem_max_rss": "130957312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:59:15.274859 [debug] [MainThread]: Command `cli test` succeeded at 21:59:15.274810 after 1.30 seconds
[0m21:59:15.275042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d2a30>]}
[0m21:59:15.275208 [debug] [MainThread]: Flushing usage events
[0m21:59:44.890458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202a3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122123400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122123d00>]}


============================== 21:59:44.892685 | dda6e50d-f5b0-4c75-816c-95f4d3ba466d ==============================
[0m21:59:44.892685 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:59:44.892975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:44.976139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205df910>]}
[0m21:59:45.001581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12273f070>]}
[0m21:59:45.002223 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:59:45.055358 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m21:59:45.125618 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:59:45.125895 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m21:59:45.126083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221fbfd0>]}
[0m21:59:45.755846 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:59:45.756136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224d8b80>]}
[0m21:59:45.898937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fd9130>]}
[0m21:59:45.992446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ccf2b0>]}
[0m21:59:45.992761 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m21:59:45.992935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fe91f0>]}
[0m21:59:45.993579 [info ] [MainThread]: 
[0m21:59:45.993850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:45.996192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m21:59:46.021066 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:59:46.021275 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:59:46.021403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:46.049510 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m21:59:46.049742 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:59:46.049915 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:59:46.054857 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:59:46.055523 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:59:46.056042 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:59:46.056355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m21:59:46.057802 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:59:46.057985 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:59:46.058118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:46.065672 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:59:46.065849 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:59:46.066001 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:59:46.069344 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m21:59:46.070020 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:59:46.070537 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:59:46.073654 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.073839 [debug] [MainThread]: On master: BEGIN
[0m21:59:46.073992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:46.080437 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:59:46.080654 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.080866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:59:46.085542 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m21:59:46.086138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dda6e50d-f5b0-4c75-816c-95f4d3ba466d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cd5370>]}
[0m21:59:46.086359 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:46.086840 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.086977 [debug] [MainThread]: On master: BEGIN
[0m21:59:46.087756 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:59:46.087923 [debug] [MainThread]: On master: COMMIT
[0m21:59:46.088061 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.088195 [debug] [MainThread]: On master: COMMIT
[0m21:59:46.088610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:46.088754 [debug] [MainThread]: On master: Close
[0m21:59:46.088989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:46.089158 [info ] [MainThread]: 
[0m21:59:46.091331 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:46.091550 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m21:59:46.091875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m21:59:46.092058 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:46.101476 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:46.101887 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:46.109310 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:46.109654 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:46.109829 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m21:59:46.109984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:59:46.116567 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:59:46.116836 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m21:59:46.117021 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m21:59:46.118941 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:59:46.121217 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m21:59:46.121703 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m21:59:46.122020 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m21:59:46.122307 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m21:59:46.122515 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:46.122736 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m21:59:46.122956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m21:59:46.123130 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:46.126357 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:46.126710 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:46.128072 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:46.128370 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:46.128533 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m21:59:46.128672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:59:46.134824 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:59:46.135089 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m21:59:46.135264 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:59:46.136466 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:59:46.137255 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m21:59:46.137770 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m21:59:46.138093 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.02s]
[0m21:59:46.138423 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m21:59:46.139261 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.139436 [debug] [MainThread]: On master: BEGIN
[0m21:59:46.139574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:46.145852 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:59:46.146060 [debug] [MainThread]: On master: COMMIT
[0m21:59:46.146185 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.146305 [debug] [MainThread]: On master: COMMIT
[0m21:59:46.146795 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:46.146950 [debug] [MainThread]: On master: Close
[0m21:59:46.147179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:46.147320 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m21:59:46.147473 [info ] [MainThread]: 
[0m21:59:46.147631 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m21:59:46.148045 [debug] [MainThread]: Command end result
[0m21:59:46.167196 [info ] [MainThread]: 
[0m21:59:46.167447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:59:46.167608 [info ] [MainThread]: 
[0m21:59:46.167772 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:59:46.168801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.308909, "process_user_time": 1.703653, "process_kernel_time": 0.121209, "process_mem_max_rss": "131416064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:59:46.169008 [debug] [MainThread]: Command `cli test` succeeded at 21:59:46.168966 after 1.31 seconds
[0m21:59:46.169180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202a3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122080f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122080550>]}
[0m21:59:46.169343 [debug] [MainThread]: Flushing usage events
[0m22:00:10.030668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e21f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e2af0>]}


============================== 22:00:10.032818 | 8c865b74-a35a-44dd-ad28-bc57c367565a ==============================
[0m22:00:10.032818 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:00:10.033110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:00:10.128910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108903ac0>]}
[0m22:00:10.153466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa74f0>]}
[0m22:00:10.154122 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:00:10.208181 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m22:00:10.275290 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:00:10.275570 [debug] [MainThread]: previous checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, current checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92
[0m22:00:10.275769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae0af0>]}
[0m22:00:10.891657 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:00:10.892360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c98e50>]}
[0m22:00:11.036507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109249130>]}
[0m22:00:11.136205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109086b80>]}
[0m22:00:11.136504 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m22:00:11.136677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925ab50>]}
[0m22:00:11.137308 [info ] [MainThread]: 
[0m22:00:11.137571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:11.139973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m22:00:11.165197 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:00:11.165398 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m22:00:11.165523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:11.198024 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m22:00:11.198250 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:00:11.198388 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:00:11.204791 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m22:00:11.205395 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m22:00:11.206120 [debug] [ThreadPool]: On list_dw_public: Close
[0m22:00:11.206364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m22:00:11.207734 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:00:11.207883 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m22:00:11.208012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:11.219041 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m22:00:11.219246 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:00:11.219405 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m22:00:11.222575 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:00:11.223195 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m22:00:11.223697 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m22:00:11.226611 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:11.226756 [debug] [MainThread]: On master: BEGIN
[0m22:00:11.226878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:11.234271 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:00:11.234427 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:11.234641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:11.238766 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m22:00:11.239341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c865b74-a35a-44dd-ad28-bc57c367565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109070100>]}
[0m22:00:11.239552 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:11.239964 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:11.240125 [debug] [MainThread]: On master: BEGIN
[0m22:00:11.240836 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:00:11.241006 [debug] [MainThread]: On master: COMMIT
[0m22:00:11.241149 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:11.241284 [debug] [MainThread]: On master: COMMIT
[0m22:00:11.241724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:11.241913 [debug] [MainThread]: On master: Close
[0m22:00:11.242199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:11.242385 [info ] [MainThread]: 
[0m22:00:11.244157 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:11.244367 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m22:00:11.244670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m22:00:11.244849 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:11.254405 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:11.254974 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:11.262475 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:11.262815 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:11.262990 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m22:00:11.263147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:11.271099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m22:00:11.271269 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:11.271442 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m22:00:11.272905 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:11.275238 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m22:00:11.276065 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m22:00:11.276446 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m22:00:11.276778 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:11.277013 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:11.277262 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m22:00:11.277536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m22:00:11.277725 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:11.281085 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:11.281441 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:11.282728 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:11.283193 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:11.283370 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m22:00:11.283529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:11.291326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m22:00:11.291612 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:11.291814 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:11.294037 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:11.294952 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m22:00:11.295644 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m22:00:11.295987 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.02s]
[0m22:00:11.296283 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:11.297332 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:11.297534 [debug] [MainThread]: On master: BEGIN
[0m22:00:11.297675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:11.305205 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:00:11.305461 [debug] [MainThread]: On master: COMMIT
[0m22:00:11.305609 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:11.305752 [debug] [MainThread]: On master: COMMIT
[0m22:00:11.306343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:11.306556 [debug] [MainThread]: On master: Close
[0m22:00:11.306818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:11.306969 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m22:00:11.307146 [info ] [MainThread]: 
[0m22:00:11.307313 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m22:00:11.307724 [debug] [MainThread]: Command end result
[0m22:00:11.330988 [info ] [MainThread]: 
[0m22:00:11.331278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:11.331441 [info ] [MainThread]: 
[0m22:00:11.331637 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:00:11.332790 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3341029, "process_user_time": 1.695287, "process_kernel_time": 0.122276, "process_mem_max_rss": "131088384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:11.333014 [debug] [MainThread]: Command `cli test` succeeded at 22:00:11.332968 after 1.33 seconds
[0m22:00:11.333208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090869a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109086730>]}
[0m22:00:11.333397 [debug] [MainThread]: Flushing usage events
[0m22:00:19.844507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104703d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a74f0>]}


============================== 22:00:19.846917 | 857d0f27-4ee4-4e45-bb41-f14356902874 ==============================
[0m22:00:19.846917 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:00:19.847220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:00:19.934793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c17c0>]}
[0m22:00:19.960040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e74c70>]}
[0m22:00:19.960678 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:00:20.013422 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m22:00:20.095865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:20.096089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:20.126685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbf130>]}
[0m22:00:20.195740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b46e50>]}
[0m22:00:20.196053 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m22:00:20.196231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef9280>]}
[0m22:00:20.196859 [info ] [MainThread]: 
[0m22:00:20.197145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:20.197590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:00:20.220288 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:00:20.220489 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:00:20.220617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:20.239626 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m22:00:20.240268 [debug] [ThreadPool]: On list_dw: Close
[0m22:00:20.242748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m22:00:20.245999 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:00:20.246188 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m22:00:20.246323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:20.255754 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:00:20.255897 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:00:20.256039 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m22:00:20.265593 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m22:00:20.266275 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m22:00:20.266796 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m22:00:20.267102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m22:00:20.268917 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:00:20.269115 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m22:00:20.269310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:20.276004 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:00:20.276284 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:00:20.276454 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:00:20.278449 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:20.279092 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m22:00:20.279602 [debug] [ThreadPool]: On list_dw_public: Close
[0m22:00:20.282636 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:20.282799 [debug] [MainThread]: On master: BEGIN
[0m22:00:20.282924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:20.289410 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:00:20.289592 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:20.289796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:20.295468 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m22:00:20.296053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa7d00>]}
[0m22:00:20.296272 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:20.296746 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:20.296880 [debug] [MainThread]: On master: BEGIN
[0m22:00:20.297629 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:00:20.297793 [debug] [MainThread]: On master: COMMIT
[0m22:00:20.297927 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:20.298058 [debug] [MainThread]: On master: COMMIT
[0m22:00:20.298559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:20.298712 [debug] [MainThread]: On master: Close
[0m22:00:20.298951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:20.299128 [info ] [MainThread]: 
[0m22:00:20.300915 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:20.301169 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop_customers ................... [RUN]
[0m22:00:20.301410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop_customers)
[0m22:00:20.301579 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:20.306105 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.306641 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:20.324205 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.324638 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.324797 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: BEGIN
[0m22:00:20.324941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:20.334618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m22:00:20.334838 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.335039 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */

  create view "dw"."public"."stg_jaffle_shop_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."_jaffle_shop"."raw_customers"
),

renamed as (
    select
        id as customer_id,
        name as customer_name
    from source
)

select * from renamed
  );
[0m22:00:20.339637 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:00:20.342913 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.343108 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
alter table "dw"."public"."stg_jaffle_shop_customers" rename to "stg_jaffle_shop_customers__dbt_backup"
[0m22:00:20.343703 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:20.364903 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.365141 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
alter table "dw"."public"."stg_jaffle_shop_customers__dbt_tmp" rename to "stg_jaffle_shop_customers"
[0m22:00:20.366091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:00:20.374102 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: COMMIT
[0m22:00:20.374290 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.374441 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: COMMIT
[0m22:00:20.377018 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:00:20.380210 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop_customers__dbt_backup"
[0m22:00:20.382158 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:20.382319 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop_customers__dbt_backup" cascade
[0m22:00:20.385348 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m22:00:20.386496 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: Close
[0m22:00:20.387225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857d0f27-4ee4-4e45-bb41-f14356902874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107466880>]}
[0m22:00:20.387515 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop_customers .............. [[32mCREATE VIEW[0m in 0.09s]
[0m22:00:20.387800 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:20.388372 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:20.388527 [debug] [MainThread]: On master: BEGIN
[0m22:00:20.388647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:20.395541 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:00:20.395681 [debug] [MainThread]: On master: COMMIT
[0m22:00:20.395802 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:20.395917 [debug] [MainThread]: On master: COMMIT
[0m22:00:20.396410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:20.396538 [debug] [MainThread]: On master: Close
[0m22:00:20.396738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:20.396855 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop_customers' was properly closed.
[0m22:00:20.396987 [info ] [MainThread]: 
[0m22:00:20.397139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m22:00:20.397469 [debug] [MainThread]: Command end result
[0m22:00:20.415502 [info ] [MainThread]: 
[0m22:00:20.415768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:20.415927 [info ] [MainThread]: 
[0m22:00:20.416083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:00:20.416812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6034259, "process_user_time": 0.988165, "process_kernel_time": 0.10732, "process_mem_max_rss": "120291328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:20.416990 [debug] [MainThread]: Command `cli run` succeeded at 22:00:20.416954 after 0.60 seconds
[0m22:00:20.417156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104703d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f450a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b763a0>]}
[0m22:00:20.417315 [debug] [MainThread]: Flushing usage events
[0m22:00:47.436974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0c220>]}


============================== 22:00:47.440040 | c013742f-cfc1-4cce-9713-d44f0d3882a4 ==============================
[0m22:00:47.440040 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:00:47.440346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:00:47.537204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c013742f-cfc1-4cce-9713-d44f0d3882a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0c40>]}
[0m22:00:47.562579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c013742f-cfc1-4cce-9713-d44f0d3882a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106079130>]}
[0m22:00:47.563234 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:00:47.618798 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m22:00:47.706267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:47.706480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:47.738528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c013742f-cfc1-4cce-9713-d44f0d3882a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ec130>]}
[0m22:00:47.816101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c013742f-cfc1-4cce-9713-d44f0d3882a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f8430>]}
[0m22:00:47.816374 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m22:00:47.817164 [info ] [MainThread]: 
[0m22:00:47.817459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:47.817882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:00:47.843383 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:00:47.843600 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:00:47.843733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:47.883131 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m22:00:47.883844 [debug] [ThreadPool]: On list_dw: Close
[0m22:00:47.886516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m22:00:47.889763 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:00:47.889916 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m22:00:47.890056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:47.899941 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m22:00:47.900099 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:00:47.900252 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m22:00:47.906836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m22:00:47.907437 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m22:00:47.908374 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m22:00:47.908760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m22:00:47.910273 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:00:47.910466 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m22:00:47.910628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:47.917331 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:00:47.917640 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:00:47.917854 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:00:47.920132 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:47.920861 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m22:00:47.921407 [debug] [ThreadPool]: On list_dw_public: Close
[0m22:00:47.924534 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:47.924716 [debug] [MainThread]: On master: BEGIN
[0m22:00:47.924853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:47.933112 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:00:47.933271 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:47.933451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:47.940159 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m22:00:47.940808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c013742f-cfc1-4cce-9713-d44f0d3882a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daa760>]}
[0m22:00:47.941031 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:47.941527 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:47.941713 [debug] [MainThread]: On master: BEGIN
[0m22:00:47.942482 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:00:47.942665 [debug] [MainThread]: On master: COMMIT
[0m22:00:47.942816 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:47.942945 [debug] [MainThread]: On master: COMMIT
[0m22:00:47.943377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:47.943523 [debug] [MainThread]: On master: Close
[0m22:00:47.943763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:47.943927 [info ] [MainThread]: 
[0m22:00:47.945673 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:47.945952 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_jaffle_shop_customers ................... [RUN]
[0m22:00:47.946293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop_customers)
[0m22:00:47.946473 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:47.950914 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:47.951260 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:47.991556 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:47.995773 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:47.998423 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: BEGIN
[0m22:00:47.998610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:48.006335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m22:00:48.006603 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:48.006817 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */

  create view "dw"."public"."stg_jaffle_shop_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."_jaffle_shop"."raw_customers"
),

renamed as (
    select
        id as customer_id,
        name as customer_name
    from source
)

select * from renamed
  );
[0m22:00:48.009910 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:00:48.013490 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:48.013679 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
alter table "dw"."public"."stg_jaffle_shop_customers" rename to "stg_jaffle_shop_customers__dbt_backup"
[0m22:00:48.014361 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:00:48.015967 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:48.016134 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
alter table "dw"."public"."stg_jaffle_shop_customers__dbt_tmp" rename to "stg_jaffle_shop_customers"
[0m22:00:48.016743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:48.024887 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: COMMIT
[0m22:00:48.025059 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:48.025215 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: COMMIT
[0m22:00:48.026203 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:00:48.029215 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop_customers__dbt_backup"
[0m22:00:48.031311 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_customers"
[0m22:00:48.031479 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop_customers__dbt_backup" cascade
[0m22:00:48.032831 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m22:00:48.033956 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_customers: Close
[0m22:00:48.034692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c013742f-cfc1-4cce-9713-d44f0d3882a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d03760>]}
[0m22:00:48.034972 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_jaffle_shop_customers .............. [[32mCREATE VIEW[0m in 0.09s]
[0m22:00:48.035254 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_customers
[0m22:00:48.035776 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:48.035988 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m22:00:48.036222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_jaffle_shop_customers, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m22:00:48.036401 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:48.042923 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:48.043701 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:48.051386 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:48.051802 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:48.051962 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m22:00:48.052106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:48.061553 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:00:48.061731 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:00:48.061892 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m22:00:48.064357 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:48.066050 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m22:00:48.066506 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m22:00:48.066822 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m22:00:48.067115 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:00:48.067345 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:48.067572 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m22:00:48.067828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m22:00:48.068044 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:48.071352 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:48.071805 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:48.073135 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:48.073427 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:48.073583 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m22:00:48.073727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:48.083271 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:00:48.083497 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:00:48.083691 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:48.086607 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m22:00:48.087327 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m22:00:48.087807 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m22:00:48.088107 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.02s]
[0m22:00:48.088416 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:00:48.088983 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:48.089127 [debug] [MainThread]: On master: BEGIN
[0m22:00:48.089266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:48.095891 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:00:48.096068 [debug] [MainThread]: On master: COMMIT
[0m22:00:48.096217 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:48.096371 [debug] [MainThread]: On master: COMMIT
[0m22:00:48.096853 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:48.096996 [debug] [MainThread]: On master: Close
[0m22:00:48.097197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:48.097335 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m22:00:48.097486 [info ] [MainThread]: 
[0m22:00:48.097637 [info ] [MainThread]: Finished running 1 view model, 2 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m22:00:48.098082 [debug] [MainThread]: Command end result
[0m22:00:48.116822 [info ] [MainThread]: 
[0m22:00:48.117084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:48.117241 [info ] [MainThread]: 
[0m22:00:48.117401 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:00:48.118322 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.72293776, "process_user_time": 1.045834, "process_kernel_time": 0.124815, "process_mem_max_rss": "124616704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:48.118504 [debug] [MainThread]: Command `cli build` succeeded at 22:00:48.118464 after 0.72 seconds
[0m22:00:48.118668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1c100>]}
[0m22:00:48.118829 [debug] [MainThread]: Flushing usage events
[0m22:01:52.741999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102468c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed7d00>]}


============================== 22:01:52.744303 | f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2 ==============================
[0m22:01:52.744303 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:01:52.744601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:52.843619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102693910>]}
[0m22:01:52.868531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b7070>]}
[0m22:01:52.869142 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:01:52.924306 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m22:01:53.015418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:01:53.015643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:01:53.045781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b7130>]}
[0m22:01:53.120107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f3a00>]}
[0m22:01:53.120388 [info ] [MainThread]: Found 6 models, 6 seeds, 2 data tests, 6 sources, 545 macros
[0m22:01:53.120562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425eb80>]}
[0m22:01:53.121209 [info ] [MainThread]: 
[0m22:01:53.121495 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:01:53.123810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m22:01:53.154443 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:01:53.154699 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m22:01:53.154836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:53.182411 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m22:01:53.182657 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:01:53.182812 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m22:01:53.189600 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:01:53.190238 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m22:01:53.191128 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m22:01:53.191421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m22:01:53.192805 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:01:53.192962 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m22:01:53.193092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:53.199881 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:01:53.200065 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:01:53.200221 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:01:53.203783 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m22:01:53.204391 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m22:01:53.204850 [debug] [ThreadPool]: On list_dw_public: Close
[0m22:01:53.207863 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.208044 [debug] [MainThread]: On master: BEGIN
[0m22:01:53.208182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:53.214882 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:01:53.215105 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.215301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:01:53.218840 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:01:53.219560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26a19c1-0e1f-42c9-8f9f-11bb3b8bcff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f0d60>]}
[0m22:01:53.219804 [debug] [MainThread]: On master: ROLLBACK
[0m22:01:53.220312 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.220450 [debug] [MainThread]: On master: BEGIN
[0m22:01:53.221272 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:01:53.221444 [debug] [MainThread]: On master: COMMIT
[0m22:01:53.221578 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.221702 [debug] [MainThread]: On master: COMMIT
[0m22:01:53.222165 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:01:53.222301 [debug] [MainThread]: On master: Close
[0m22:01:53.222543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:01:53.222711 [info ] [MainThread]: 
[0m22:01:53.224008 [debug] [Thread-1  ]: Began running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:01:53.224228 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_jaffle_shop_customers_customer_id ............... [RUN]
[0m22:01:53.224470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2)
[0m22:01:53.224645 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:01:53.233394 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:01:53.234561 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:01:53.241971 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:01:53.242286 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:01:53.242452 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: BEGIN
[0m22:01:53.242610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:01:53.250941 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m22:01:53.251187 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"
[0m22:01:53.251352 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m22:01:53.254015 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:01:53.256206 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: ROLLBACK
[0m22:01:53.256731 [debug] [Thread-1  ]: On test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2: Close
[0m22:01:53.257089 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_jaffle_shop_customers_customer_id ..................... [[32mPASS[0m in 0.03s]
[0m22:01:53.257394 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2
[0m22:01:53.257631 [debug] [Thread-1  ]: Began running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:01:53.257851 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_jaffle_shop_customers_customer_id ................. [RUN]
[0m22:01:53.258135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_jaffle_shop_customers_customer_id.1828149cc2, now test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999)
[0m22:01:53.258323 [debug] [Thread-1  ]: Began compiling node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:01:53.282015 [debug] [Thread-1  ]: Writing injected SQL for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:01:53.282478 [debug] [Thread-1  ]: Began executing node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:01:53.284015 [debug] [Thread-1  ]: Writing runtime sql for node "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:01:53.284329 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:01:53.284496 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: BEGIN
[0m22:01:53.284641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:01:53.293020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m22:01:53.293171 [debug] [Thread-1  ]: Using postgres connection "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"
[0m22:01:53.293328 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dw"."public"."stg_jaffle_shop_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:01:53.296062 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m22:01:53.296756 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: ROLLBACK
[0m22:01:53.297354 [debug] [Thread-1  ]: On test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999: Close
[0m22:01:53.297640 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_jaffle_shop_customers_customer_id ....................... [[32mPASS[0m in 0.04s]
[0m22:01:53.297941 [debug] [Thread-1  ]: Finished running node test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999
[0m22:01:53.298480 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.298629 [debug] [MainThread]: On master: BEGIN
[0m22:01:53.298747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:53.304758 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:01:53.304918 [debug] [MainThread]: On master: COMMIT
[0m22:01:53.305046 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.305166 [debug] [MainThread]: On master: COMMIT
[0m22:01:53.305579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:01:53.305706 [debug] [MainThread]: On master: Close
[0m22:01:53.305889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:53.306029 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_jaffle_shop_customers_customer_id.b9becc3999' was properly closed.
[0m22:01:53.306174 [info ] [MainThread]: 
[0m22:01:53.306326 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m22:01:53.306817 [debug] [MainThread]: Command end result
[0m22:01:53.326164 [info ] [MainThread]: 
[0m22:01:53.326406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:01:53.326560 [info ] [MainThread]: 
[0m22:01:53.326722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:01:53.327625 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6166698, "process_user_time": 0.980923, "process_kernel_time": 0.120425, "process_mem_max_rss": "124354560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:53.327806 [debug] [MainThread]: Command `cli test` succeeded at 22:01:53.327769 after 0.62 seconds
[0m22:01:53.327975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102468c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5d670>]}
[0m22:01:53.328132 [debug] [MainThread]: Flushing usage events
============================== 337b027a-3d7f-49dd-8334-6137404b3e86 ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: 337b027a-3d7f-49dd-8334-6137404b3e86", "ts": "2025-03-28T11:46:43.173925Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1321510750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1321510990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1321510490>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1321510750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1321510990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1321510490>]}", "name": "SendingEvent", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.699573Z"}}
{"data": {"log_version": 3, "version": "=2025.3.25+321d0d8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.702359Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'json', 'static_parser': 'True', 'target_path': 'target', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.703079Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.824541Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '3a462799-1d2a-4257-ac27-19bb0d269528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13214b7150>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a462799-1d2a-4257-ac27-19bb0d269528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13214b7150>]}", "name": "SendingEvent", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.825354Z"}}
{"data": {"path": "/tmp/dbt-downloads-h_b1oixz"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-h_b1oixz'", "name": "DepsSetDownloadDirectory", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.843506Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.843953Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.858402Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.859081Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.866630Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:43.869141Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.007169Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.007649Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'package', 'label': '3a462799-1d2a-4257-ac27-19bb0d269528', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13214b7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13219341d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a462799-1d2a-4257-ac27-19bb0d269528', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13214b7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13219341d0>]}", "name": "SendingEvent", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.008012Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35060635, "process_in_blocks": "0", "process_kernel_time": 1.268186, "process_mem_max_rss": "234304", "process_out_blocks": "2552", "process_user_time": 2.312395}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 0.35060635, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.268186, \"process_mem_max_rss\": \"234304\", \"process_out_blocks\": \"2552\", \"process_user_time\": 2.312395}", "name": "ResourceReport", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.009151Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:deps", "system_success:True"], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Observability Metric: command_success=1.0", "name": "ObservabilityMetric", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.009559Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 0.35060635}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=0.35060635209083557", "name": "ObservabilityMetric", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.010066Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 2.312395}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Observability Metric: process_user_time=2.3123950958251953", "name": "ObservabilityMetric", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.010443Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.268186}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.2681859731674194", "name": "ObservabilityMetric", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.010773Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 234304.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=234304.0", "name": "ObservabilityMetric", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.011082Z"}}
{"data": {"command": "cli deps", "completed_at": "2025-03-28T11:46:44.011399Z", "elapsed": 0.35060635, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Command `cli deps` succeeded at 11:46:44.011399 after 0.35 seconds", "name": "CommandCompleted", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.011495Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13214f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e132e69f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13215187d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "337b027a-3d7f-49dd-8334-6137404b3e86", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13214f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e132e69f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e13215187d0>]}", "name": "SendingEvent", "pid": 232, "thread": "MainThread", "ts": "2025-03-28T11:46:44.011878Z"}}

============================== 2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1 ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: 2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "ts": "2025-03-28T11:46:47.383511Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dde90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dd950>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dde90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dd950>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:47.876428Z"}}
{"data": {"log_version": 3, "version": "=2025.3.25+321d0d8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:47.878514Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:47.879066Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.003108Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08f3090>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08f3090>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.003915Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b1c7c49d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b1c7c49d0>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.051321Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.9.2-post3+8af49b4f6b50fe149734ad76e3c941dcac06d991"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Registered adapter: snowflake=1.9.2-post3+8af49b4f6b50fe149734ad76e3c941dcac06d991", "name": "AdapterRegistered", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.052032Z"}}
{"data": {"checksum": "48bf215d84be7d1ffe58c3407c2a02a76c01e4b9b755a39d3e1ac2b186ffbf0b", "profile": "user", "target": "", "vars": "{}", "version": "2025.3.25+321d0d8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "checksum: 48bf215d84be7d1ffe58c3407c2a02a76c01e4b9b755a39d3e1ac2b186ffbf0b, vars: {}, profile: user, target: , version: 2025.3.25+321d0d8", "name": "StateCheckVarsHash", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.202053Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.202751Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.203093Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 6124218.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=6124218.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.206513Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.408400Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.408866Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dcbd0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dcbd0>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:48.409237Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae162a610>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae162a610>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.621603Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae156a5d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae156a5d0>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.622174Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 654652.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=654652.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.700481Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae09efdd0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d80ce4b-a3f6-4dd0-9893-afbf0d62b0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae09efdd0>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.706438Z"}}
{"data": {"path": "/app/dbt_project/2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1/target/perf_info.json"}, "info": {"category": "", "code": "I010", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "info", "msg": "Performance info: /app/dbt_project/2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1/target/perf_info.json", "name": "ParsePerfInfoPath", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.709710Z"}}
{"data": {"debug_message": "", "label": "path_count", "tags": [], "value": 208.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: path_count=208.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.710107Z"}}
{"data": {"debug_message": "", "label": "parsed_path_count", "tags": [], "value": 208.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: parsed_path_count=208.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.710502Z"}}
{"data": {"debug_message": "", "label": "read_files_elapsed", "tags": [], "value": 0.018572818}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: read_files_elapsed=0.018572818487882614", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.710881Z"}}
{"data": {"debug_message": "", "label": "load_macros_elapsed", "tags": [], "value": 0.68327117}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: load_macros_elapsed=0.6832711696624756", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.711227Z"}}
{"data": {"debug_message": "", "label": "parse_project_elapsed", "tags": [], "value": 0.50041384}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: parse_project_elapsed=0.5004138350486755", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.711578Z"}}
{"data": {"debug_message": "", "label": "patch_sources_elapsed", "tags": [], "value": 0.0053862426}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: patch_sources_elapsed=0.005386242642998695", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.711904Z"}}
{"data": {"debug_message": "", "label": "process_manifest_elapsed", "tags": [], "value": 0.022670127}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: process_manifest_elapsed=0.02267012745141983", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.712231Z"}}
{"data": {"debug_message": "", "label": "load_all_elapsed", "tags": [], "value": 1.5148451}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: load_all_elapsed=1.5148451328277588", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.712561Z"}}
{"data": {"debug_message": "", "label": "is_partial_parse_enabled", "tags": [], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: is_partial_parse_enabled=1.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.712879Z"}}
{"data": {"artifact_path": "/app/dbt_project/2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Wrote artifact WritableManifest to /app/dbt_project/2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1/target/manifest.json", "name": "ArtifactWritten", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.792566Z"}}
{"data": {"artifact_path": "/app/dbt_project/2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Wrote artifact SemanticManifest to /app/dbt_project/2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.793906Z"}}
{"data": {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.9735274, "process_in_blocks": "0", "process_kernel_time": 1.405494, "process_mem_max_rss": "261496", "process_out_blocks": "2592", "process_user_time": 3.983773}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Resource report: {\"command_name\": \"parse\", \"command_success\": true, \"command_wall_clock_time\": 1.9735274, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.405494, \"process_mem_max_rss\": \"261496\", \"process_out_blocks\": \"2592\", \"process_user_time\": 3.983773}", "name": "ResourceReport", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.794803Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:parse", "system_success:True"], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: command_success=1.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.795180Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 1.9735274}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=1.973527431488037", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.795606Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 3.983773}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: process_user_time=3.9837729930877686", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.795996Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.405494}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.405493974685669", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.796343Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 261496.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=261496.0", "name": "ObservabilityMetric", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.796669Z"}}
{"data": {"command": "cli parse", "completed_at": "2025-03-28T11:46:49.797029Z", "elapsed": 1.9735274, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Command `cli parse` succeeded at 11:46:49.797029 after 1.97 seconds", "name": "CommandCompleted", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.797125Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae237bf10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2bcf19d9-f3fe-4d86-aa5c-90c5a385e4f1", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae08dd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ae237bf10>]}", "name": "SendingEvent", "pid": 262, "thread": "MainThread", "ts": "2025-03-28T11:46:49.797506Z"}}

============================== 9f248c34-1204-4ca8-91f3-32634ebf506a ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: 9f248c34-1204-4ca8-91f3-32634ebf506a", "ts": "2025-04-01T07:53:18.115249Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5433bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d40c15c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5442710>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5433bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d40c15c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5442710>]}", "name": "SendingEvent", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.634780Z"}}
{"data": {"log_version": 3, "version": "=2025.3.25+321d0d8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.636773Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.637260Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.748533Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '3e37eccf-0cc4-44c4-aeb7-a4da8b7873f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d54efa10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e37eccf-0cc4-44c4-aeb7-a4da8b7873f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d54efa10>]}", "name": "SendingEvent", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.749527Z"}}
{"data": {"path": "/tmp/dbt-downloads-_4jyo39h"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-_4jyo39h'", "name": "DepsSetDownloadDirectory", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.757201Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.757581Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.770151Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.770731Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.776324Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.778637Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.913213Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.913597Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'package', 'label': '3e37eccf-0cc4-44c4-aeb7-a4da8b7873f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d54a7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5823e90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e37eccf-0cc4-44c4-aeb7-a4da8b7873f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d54a7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5823e90>]}", "name": "SendingEvent", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.913941Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.31386384, "process_in_blocks": "0", "process_kernel_time": 1.31133, "process_mem_max_rss": "234232", "process_out_blocks": "2312", "process_user_time": 2.190404}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 0.31386384, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.31133, \"process_mem_max_rss\": \"234232\", \"process_out_blocks\": \"2312\", \"process_user_time\": 2.190404}", "name": "ResourceReport", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.914934Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:deps", "system_success:True"], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Observability Metric: command_success=1.0", "name": "ObservabilityMetric", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.915325Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 0.31386384}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=0.3138638436794281", "name": "ObservabilityMetric", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.915783Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 2.190404}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Observability Metric: process_user_time=2.190403938293457", "name": "ObservabilityMetric", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.916137Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.31133}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.311329960823059", "name": "ObservabilityMetric", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.916479Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 234232.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=234232.0", "name": "ObservabilityMetric", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.916785Z"}}
{"data": {"command": "cli deps", "completed_at": "2025-04-01T07:53:18.917098Z", "elapsed": 0.31386384, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Command `cli deps` succeeded at 07:53:18.917098 after 0.31 seconds", "name": "CommandCompleted", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.917183Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5433cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d53e3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d7050710>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "9f248c34-1204-4ca8-91f3-32634ebf506a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d5433cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d53e3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3d7050710>]}", "name": "SendingEvent", "pid": 10782, "thread": "MainThread", "ts": "2025-04-01T07:53:18.917540Z"}}

============================== 57f6fbe6-64bf-48db-a152-b2ab7fd19c85 ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: 57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "ts": "2025-04-01T07:53:22.470569Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a522cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a522cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a522d210>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a522cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a522cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a522d210>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.068637Z"}}
{"data": {"log_version": 3, "version": "=2025.3.25+321d0d8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.070656Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'target', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.071158Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.188146Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5272350>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5272350>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.188925Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536e1f29d50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536e1f29d50>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.235092Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.9.2-post3+8af49b4f6b50fe149734ad76e3c941dcac06d991"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Registered adapter: snowflake=1.9.2-post3+8af49b4f6b50fe149734ad76e3c941dcac06d991", "name": "AdapterRegistered", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.235658Z"}}
{"data": {"checksum": "48bf215d84be7d1ffe58c3407c2a02a76c01e4b9b755a39d3e1ac2b186ffbf0b", "profile": "user", "target": "", "vars": "{}", "version": "2025.3.25+321d0d8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "checksum: 48bf215d84be7d1ffe58c3407c2a02a76c01e4b9b755a39d3e1ac2b186ffbf0b, vars: {}, profile: user, target: , version: 2025.3.25+321d0d8", "name": "StateCheckVarsHash", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.383150Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.383820Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.384158Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 6180387.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=6180387.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.387168Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.564329Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.564769Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a52bd990>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a52bd990>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:23.565080Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5ddebd0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5ddebd0>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.839106Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5efb850>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5efb850>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.839644Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 654652.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=654652.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.914826Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5d82210>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '290832a3-f27e-4718-881a-558d65db7df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a5d82210>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.920517Z"}}
{"data": {"path": "/app/dbt_project/57f6fbe6-64bf-48db-a152-b2ab7fd19c85/target/perf_info.json"}, "info": {"category": "", "code": "I010", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "info", "msg": "Performance info: /app/dbt_project/57f6fbe6-64bf-48db-a152-b2ab7fd19c85/target/perf_info.json", "name": "ParsePerfInfoPath", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.923710Z"}}
{"data": {"debug_message": "", "label": "path_count", "tags": [], "value": 208.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: path_count=208.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.924110Z"}}
{"data": {"debug_message": "", "label": "parsed_path_count", "tags": [], "value": 208.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: parsed_path_count=208.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.924529Z"}}
{"data": {"debug_message": "", "label": "read_files_elapsed", "tags": [], "value": 0.018446673}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: read_files_elapsed=0.018446672707796097", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.924892Z"}}
{"data": {"debug_message": "", "label": "load_macros_elapsed", "tags": [], "value": 0.70767254}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: load_macros_elapsed=0.7076725363731384", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.925238Z"}}
{"data": {"debug_message": "", "label": "parse_project_elapsed", "tags": [], "value": 0.5373318}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: parse_project_elapsed=0.5373318195343018", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.925578Z"}}
{"data": {"debug_message": "", "label": "patch_sources_elapsed", "tags": [], "value": 0.0067886636}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: patch_sources_elapsed=0.006788663566112518", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.925915Z"}}
{"data": {"debug_message": "", "label": "process_manifest_elapsed", "tags": [], "value": 0.023313139}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: process_manifest_elapsed=0.023313138633966446", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.926251Z"}}
{"data": {"debug_message": "", "label": "load_all_elapsed", "tags": [], "value": 1.5473716}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: load_all_elapsed=1.5473716259002686", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.926592Z"}}
{"data": {"debug_message": "", "label": "is_partial_parse_enabled", "tags": [], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: is_partial_parse_enabled=1.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:24.926916Z"}}
{"data": {"artifact_path": "/app/dbt_project/57f6fbe6-64bf-48db-a152-b2ab7fd19c85/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Wrote artifact WritableManifest to /app/dbt_project/57f6fbe6-64bf-48db-a152-b2ab7fd19c85/target/manifest.json", "name": "ArtifactWritten", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.003175Z"}}
{"data": {"artifact_path": "/app/dbt_project/57f6fbe6-64bf-48db-a152-b2ab7fd19c85/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Wrote artifact SemanticManifest to /app/dbt_project/57f6fbe6-64bf-48db-a152-b2ab7fd19c85/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.004349Z"}}
{"data": {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.9711094, "process_in_blocks": "0", "process_kernel_time": 1.436808, "process_mem_max_rss": "262824", "process_out_blocks": "2592", "process_user_time": 3.826491}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Resource report: {\"command_name\": \"parse\", \"command_success\": true, \"command_wall_clock_time\": 1.9711094, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.436808, \"process_mem_max_rss\": \"262824\", \"process_out_blocks\": \"2592\", \"process_user_time\": 3.826491}", "name": "ResourceReport", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.005172Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:parse", "system_success:True"], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: command_success=1.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.005552Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 1.9711094}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=1.971109390258789", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.005934Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 3.826491}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: process_user_time=3.826491117477417", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.006320Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.436808}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.4368079900741577", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.006662Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 262824.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=262824.0", "name": "ObservabilityMetric", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.006985Z"}}
{"data": {"command": "cli parse", "completed_at": "2025-04-01T07:53:25.007316Z", "elapsed": 1.9711094, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Command `cli parse` succeeded at 07:53:25.007316 after 1.97 seconds", "name": "CommandCompleted", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.007407Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a555c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a6716310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a6716250>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "57f6fbe6-64bf-48db-a152-b2ab7fd19c85", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a555c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a6716310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7536a6716250>]}", "name": "SendingEvent", "pid": 10810, "thread": "MainThread", "ts": "2025-04-01T07:53:25.007780Z"}}

============================== 56d53fd2-8fd9-4072-a414-6f3a4e06a522 ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: 56d53fd2-8fd9-4072-a414-6f3a4e06a522", "ts": "2025-04-01T07:53:39.942433Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077757937d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775793d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077b2371d90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077757937d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775793d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077b2371d90>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.494623Z"}}
{"data": {"log_version": 3, "version": "=2025.3.25+321d0d8"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.497495Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': './', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'target', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.498310Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.615308Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077759dd4d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077759dd4d0>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.616048Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077b24c1f10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077b24c1f10>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.662230Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.9.2-post3+8af49b4f6b50fe149734ad76e3c941dcac06d991"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Registered adapter: snowflake=1.9.2-post3+8af49b4f6b50fe149734ad76e3c941dcac06d991", "name": "AdapterRegistered", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.662866Z"}}
{"data": {"checksum": "48bf215d84be7d1ffe58c3407c2a02a76c01e4b9b755a39d3e1ac2b186ffbf0b", "profile": "user", "target": "", "vars": "{}", "version": "2025.3.25+321d0d8"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "checksum: 48bf215d84be7d1ffe58c3407c2a02a76c01e4b9b755a39d3e1ac2b186ffbf0b, vars: {}, profile: user, target: , version: 2025.3.25+321d0d8", "name": "StateCheckVarsHash", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.810322Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.811010Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.811348Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 654652.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=654652.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.812017Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.840887Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.841270Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775d82a10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775d82a10>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.841619Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775d824d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775d824d0>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.841989Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 654658.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=654658.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.901919Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775cb3d90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707775cb3d90>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.910382Z"}}
{"data": {"debug_message": "", "label": "path_count", "tags": [], "value": 208.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: path_count=208.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.910812Z"}}
{"data": {"debug_message": "", "label": "parsed_path_count", "tags": [], "value": 0.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: parsed_path_count=0.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.911166Z"}}
{"data": {"debug_message": "", "label": "read_files_elapsed", "tags": [], "value": 0.018864386}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: read_files_elapsed=0.018864385783672333", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.911532Z"}}
{"data": {"debug_message": "", "label": "load_macros_elapsed", "tags": [], "value": 0.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: load_macros_elapsed=0.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.911851Z"}}
{"data": {"debug_message": "", "label": "parse_project_elapsed", "tags": [], "value": 0.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: parse_project_elapsed=0.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.912148Z"}}
{"data": {"debug_message": "", "label": "patch_sources_elapsed", "tags": [], "value": 0.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: patch_sources_elapsed=0.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.912487Z"}}
{"data": {"debug_message": "", "label": "process_manifest_elapsed", "tags": [], "value": 0.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: process_manifest_elapsed=0.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.912784Z"}}
{"data": {"debug_message": "", "label": "load_all_elapsed", "tags": [], "value": 0.11022835}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: load_all_elapsed=0.11022835224866867", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.913081Z"}}
{"data": {"debug_message": "", "label": "is_partial_parse_enabled", "tags": [], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: is_partial_parse_enabled=1.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.913373Z"}}
{"data": {"artifact_path": "/app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Wrote artifact WritableManifest to /app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/manifest.json", "name": "ArtifactWritten", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.992153Z"}}
{"data": {"artifact_path": "/app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Wrote artifact SemanticManifest to /app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:40.993403Z"}}
{"data": {"debug_message": "", "label": "add_test_edges_time", "tags": [], "value": 0.0005035009}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: add_test_edges_time=0.0005035009235143661", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.605063Z"}}
{"data": {"debug_message": "", "label": "add_test_edges_expansion", "tags": [], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: add_test_edges_expansion=1.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.605646Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772360110>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772360110>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.607017Z"}}
{"data": {"stat_line": "6 models, 6 seeds, 2 data tests, 6 sources, 590 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Found 6 models, 6 seeds, 2 data tests, 6 sources, 590 macros", "name": "FoundStats", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.607474Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.608932Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Concurrency: 4 threads (target='dev')", "name": "ConcurrencyLine", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.609289Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.609571Z"}}
{"data": {"conn_name": "master", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Acquiring new snowflake connection 'master'", "name": "NewConnection", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.610059Z"}}
{"data": {"debug_message": "", "label": "add_test_edges_time", "tags": [], "value": 0.000104742125}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: add_test_edges_time=0.0001047421246767044", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.611497Z"}}
{"data": {"debug_message": "", "label": "add_test_edges_expansion", "tags": [], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: add_test_edges_expansion=1.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.611868Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70777250e910>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70777250e910>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.614097Z"}}
{"data": {"stat_line": "6 models, 6 seeds, 2 data tests, 6 sources, 590 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Found 6 models, 6 seeds, 2 data tests, 6 sources, 590 macros", "name": "FoundStats", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.614528Z"}}
{"data": {"breaking_changes": ["Contracted model 'model.elkjop_dw.dmf_bud_stock' was deleted or renamed."], "column_type_changes": [], "columns_removed": [], "contract_enforced_disabled": false, "enforced_column_constraint_removed": [], "enforced_model_constraint_removed": [], "materialization_changed": [], "model_file_path": "models/marts/stock/dmf_bud_stock.sql", "model_name": "dmf_bud_stock"}, "info": {"category": "", "code": "I071", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Breaking change to contracted, unversioned model dmf_bud_stock (models/marts/stock/dmf_bud_stock.sql)\nWhile comparing to previous project state, dbt detected a breaking change to an unversioned model.\n  - Contracted model 'model.elkjop_dw.dmf_bud_stock' was deleted or renamed.\n", "name": "UnversionedBreakingChange", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.617121Z"}}
{"data": {"breaking_changes": ["Contracted model 'model.elkjop_dw.dmf_bud_sale' was deleted or renamed."], "column_type_changes": [], "columns_removed": [], "contract_enforced_disabled": false, "enforced_column_constraint_removed": [], "enforced_model_constraint_removed": [], "materialization_changed": [], "model_file_path": "models/marts/finance/budget/dmf_bud_sale.sql", "model_name": "dmf_bud_sale"}, "info": {"category": "", "code": "I071", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Breaking change to contracted, unversioned model dmf_bud_sale (models/marts/finance/budget/dmf_bud_sale.sql)\nWhile comparing to previous project state, dbt detected a breaking change to an unversioned model.\n  - Contracted model 'model.elkjop_dw.dmf_bud_sale' was deleted or renamed.\n", "name": "UnversionedBreakingChange", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.618440Z"}}
{"data": {"breaking_changes": ["Contracted model 'model.elkjop_dw.dmf_fi_gl_line' was deleted or renamed."], "column_type_changes": [], "columns_removed": [], "contract_enforced_disabled": false, "enforced_column_constraint_removed": [], "enforced_model_constraint_removed": [], "materialization_changed": [], "model_file_path": "models/marts/finance/dmf_fi_gl_line.sql", "model_name": "dmf_fi_gl_line"}, "info": {"category": "", "code": "I071", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Breaking change to contracted, unversioned model dmf_fi_gl_line (models/marts/finance/dmf_fi_gl_line.sql)\nWhile comparing to previous project state, dbt detected a breaking change to an unversioned model.\n  - Contracted model 'model.elkjop_dw.dmf_fi_gl_line' was deleted or renamed.\n", "name": "UnversionedBreakingChange", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.618826Z"}}
{"data": {"breaking_changes": ["Contracted model 'model.elkjop_dw.dmf_ledger_dep_bud' was deleted or renamed."], "column_type_changes": [], "columns_removed": [], "contract_enforced_disabled": false, "enforced_column_constraint_removed": [], "enforced_model_constraint_removed": [], "materialization_changed": [], "model_file_path": "models/marts/finance/budget/dmf_ledger_dep_bud.sql", "model_name": "dmf_ledger_dep_bud"}, "info": {"category": "", "code": "I071", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Breaking change to contracted, unversioned model dmf_ledger_dep_bud (models/marts/finance/budget/dmf_ledger_dep_bud.sql)\nWhile comparing to previous project state, dbt detected a breaking change to an unversioned model.\n  - Contracted model 'model.elkjop_dw.dmf_ledger_dep_bud' was deleted or renamed.\n", "name": "UnversionedBreakingChange", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.619149Z"}}
{"data": {"breaking_changes": ["Contracted model 'model.elkjop_dw.dmf_stock_old_whs' was deleted or renamed."], "column_type_changes": [], "columns_removed": [], "contract_enforced_disabled": false, "enforced_column_constraint_removed": [], "enforced_model_constraint_removed": [], "materialization_changed": [], "model_file_path": "models/marts/stock/dmf_stock_old_whs.sql", "model_name": "dmf_stock_old_whs"}, "info": {"category": "", "code": "I071", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Breaking change to contracted, unversioned model dmf_stock_old_whs (models/marts/stock/dmf_stock_old_whs.sql)\nWhile comparing to previous project state, dbt detected a breaking change to an unversioned model.\n  - Contracted model 'model.elkjop_dw.dmf_stock_old_whs' was deleted or renamed.\n", "name": "UnversionedBreakingChange", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.619481Z"}}
{"data": {"breaking_changes": ["Contracted model 'model.elkjop_dw.dmf_stock_whs_gl' was deleted or renamed."], "column_type_changes": [], "columns_removed": [], "contract_enforced_disabled": false, "enforced_column_constraint_removed": [], "enforced_model_constraint_removed": [], "materialization_changed": [], "model_file_path": "models/marts/stock/dmf_stock_whs_gl.sql", "model_name": "dmf_stock_whs_gl"}, "info": {"category": "", "code": "I071", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Breaking change to contracted, unversioned model dmf_stock_whs_gl (models/marts/stock/dmf_stock_whs_gl.sql)\nWhile comparing to previous project state, dbt detected a breaking change to an unversioned model.\n  - Contracted model 'model.elkjop_dw.dmf_stock_whs_gl' was deleted or renamed.\n", "name": "UnversionedBreakingChange", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:41.619779Z"}}
{"data": {"conn_name": "list_DBT_DEV", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Acquiring new snowflake connection 'list_DBT_DEV'", "name": "NewConnection", "pid": 10838, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-04-01T07:53:41.621176Z"}}
{"data": {"conn_name": "list_DBT_DEV", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Using snowflake connection \"list_DBT_DEV\"", "name": "ConnectionUsed", "pid": 10838, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-04-01T07:53:41.658006Z"}}
{"data": {"conn_name": "list_DBT_DEV", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"connection_name\": \"list_DBT_DEV\"} */\nshow terse schemas in database DBT_DEV\n    limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "On list_DBT_DEV: /* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"connection_name\": \"list_DBT_DEV\"} */\nshow terse schemas in database DBT_DEV\n    limit 10000", "name": "SQLQuery", "pid": 10838, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-04-01T07:53:41.658539Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 10838, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-04-01T07:53:41.658982Z"}}
{"data": {"elapsed": 0.5353241, "query_id": "01bb64b9-0305-fd1d-0001-250312a3de8f", "status": "SUCCESS 13"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "SQL status: SUCCESS 13 in 0.535 seconds", "name": "SQLQueryStatus", "pid": 10838, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-04-01T07:53:42.194371Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI", "orig_conn_name": "list_DBT_DEV"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_DBT_DEV, now list_DBT_DEV_FEHMMI)", "name": "ConnectionReused", "pid": 10838, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-01T07:53:42.200405Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI_jaffle_shop", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Acquiring new snowflake connection 'list_DBT_DEV_FEHMMI_jaffle_shop'", "name": "NewConnection", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.201077Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Using snowflake connection \"list_DBT_DEV_FEHMMI\"", "name": "ConnectionUsed", "pid": 10838, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-01T07:53:42.208926Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI_jaffle_shop", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Using snowflake connection \"list_DBT_DEV_FEHMMI_jaffle_shop\"", "name": "ConnectionUsed", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.210209Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"connection_name\": \"list_DBT_DEV_FEHMMI\"} */\nshow objects in DBT_DEV.FEHMMI limit 10000;"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "On list_DBT_DEV_FEHMMI: /* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"connection_name\": \"list_DBT_DEV_FEHMMI\"} */\nshow objects in DBT_DEV.FEHMMI limit 10000;", "name": "SQLQuery", "pid": 10838, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-01T07:53:42.210618Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI_jaffle_shop", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"connection_name\": \"list_DBT_DEV_FEHMMI_jaffle_shop\"} */\nshow objects in DBT_DEV.FEHMMI_jaffle_shop limit 10000;"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "On list_DBT_DEV_FEHMMI_jaffle_shop: /* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"connection_name\": \"list_DBT_DEV_FEHMMI_jaffle_shop\"} */\nshow objects in DBT_DEV.FEHMMI_jaffle_shop limit 10000;", "name": "SQLQuery", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.211001Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.212162Z"}}
{"data": {"elapsed": 0.21755165, "query_id": "01bb64b9-0305-faa8-0001-250312a4e743", "status": "SUCCESS 83"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "SQL status: SUCCESS 83 in 0.218 seconds", "name": "SQLQueryStatus", "pid": 10838, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-01T07:53:42.428959Z"}}
{"data": {"args": [], "base_msg": "Snowflake query id: 01bb64b9-0305-fcab-0001-250312a4ae1f", "name": "Snowflake"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Snowflake adapter: Snowflake query id: 01bb64b9-0305-fcab-0001-250312a4ae1f", "name": "AdapterEventDebug", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.554123Z"}}
{"data": {"args": [], "base_msg": "Snowflake error: 002043 (02000): SQL compilation error:\nObject does not exist, or operation cannot be performed.", "name": "Snowflake"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:\nObject does not exist, or operation cannot be performed.", "name": "AdapterEventDebug", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.554544Z"}}
{"data": {"args": ["macro list_relations_without_caching"], "base_msg": "Error running SQL: {}", "name": "Snowflake"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Snowflake adapter: Error running SQL: macro list_relations_without_caching", "name": "AdapterEventDebug", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.554944Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "Snowflake"}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Snowflake adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 10838, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-01T07:53:42.555280Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772871390>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772871390>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.556013Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Began running node model.my_dbt_project.stg_jaffle_shop_items", "name": "NodeStart", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.558311Z"}}
{"data": {"description": "sql view model FEHMMI.stg_jaffle_shop_items", "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "started", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "1 of 1 START sql view model FEHMMI.stg_jaffle_shop_items ....................... [RUN]", "name": "LogStartLine", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.558879Z"}}
{"data": {"conn_name": "model.my_dbt_project.stg_jaffle_shop_items", "orig_conn_name": "list_DBT_DEV_FEHMMI_jaffle_shop"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_DBT_DEV_FEHMMI_jaffle_shop, now model.my_dbt_project.stg_jaffle_shop_items)", "name": "ConnectionReused", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.559375Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Began compiling node model.my_dbt_project.stg_jaffle_shop_items", "name": "NodeCompiling", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.559707Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "compiling", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Writing injected SQL for node \"model.my_dbt_project.stg_jaffle_shop_items\"", "name": "WritingInjectedSQLForNode", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.565034Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Began executing node model.my_dbt_project.stg_jaffle_shop_items", "name": "NodeExecuting", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.565706Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.my_dbt_project.stg_jaffle_shop_items\"", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Writing runtime sql for node \"model.my_dbt_project.stg_jaffle_shop_items\"", "name": "JinjaLogDebug", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.587372Z"}}
{"data": {"conn_name": "model.my_dbt_project.stg_jaffle_shop_items", "conn_type": "snowflake", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Using snowflake connection \"model.my_dbt_project.stg_jaffle_shop_items\"", "name": "ConnectionUsed", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.588319Z"}}
{"data": {"conn_name": "model.my_dbt_project.stg_jaffle_shop_items", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_project.stg_jaffle_shop_items\"} */\ncreate or replace   view DBT_DEV.FEHMMI.stg_jaffle_shop_items\n  \n   as (\n    with source as (\n    select * from dw._jaffle_shop.raw_items\n),\n\nrenamed as (\n    select\n        id,\n        order_id,\n        sku\n    from source\n)\n\nselect * from renamed\n  );"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "On model.my_dbt_project.stg_jaffle_shop_items: /* {\"app\": \"dbt\", \"dbt_version\": \"2025.3.25+321d0d8\", \"profile_name\": \"user\", \"target_name\": \"dev\", \"node_id\": \"model.my_dbt_project.stg_jaffle_shop_items\"} */\ncreate or replace   view DBT_DEV.FEHMMI.stg_jaffle_shop_items\n  \n   as (\n    with source as (\n    select * from dw._jaffle_shop.raw_items\n),\n\nrenamed as (\n    select\n        id,\n        order_id,\n        sku\n    from source\n)\n\nselect * from renamed\n  );", "name": "SQLQuery", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.588746Z"}}
{"data": {"args": [], "base_msg": "Snowflake query id: 01bb64b9-0305-fcf1-0001-250312a4d8b7", "name": "Snowflake", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Snowflake adapter: Snowflake query id: 01bb64b9-0305-fcf1-0001-250312a4d8b7", "name": "AdapterEventDebug", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.671024Z"}}
{"data": {"args": [], "base_msg": "Snowflake error: 002003 (02000): SQL compilation error:\nSchema 'DW._JAFFLE_SHOP' does not exist or not authorized.", "name": "Snowflake", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:\nSchema 'DW._JAFFLE_SHOP' does not exist or not authorized.", "name": "AdapterEventDebug", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.671491Z"}}
{"data": {"exc": "Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "exc_info": "Traceback (most recent call last):\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py\", line 317, in exception_handler\n    yield\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/snowflake/connector/cursor.py\", line 1104, in execute\n    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/snowflake/connector/errors.py\", line 283, in errorhandler_wrapper\n    handed_over = Error.hand_to_other_handler(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/snowflake/connector/errors.py\", line 338, in hand_to_other_handler\n    cursor.errorhandler(connection, cursor, error_class, error_value)\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/snowflake/connector/errors.py\", line 214, in default_errorhandler\n    raise error_class(\nsnowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:\nSchema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/task/base.py\", line 385, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/task/base.py\", line 332, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/task/base.py\", line 432, in run\n    return self.execute(compiled_node, manifest)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/task/run.py\", line 335, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/task/run.py\", line 295, in _execute_model\n    result = MacroGenerator(\n             ^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/clients/jinja.py\", line 92, in __call__\n    return self.call_macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt_common/clients/jinja.py\", line 389, in call_macro\n    return macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"<template>\", line 29, in macro\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/clients/jinja.py\", line 92, in __call__\n    return self.call_macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt_common/clients/jinja.py\", line 389, in call_macro\n    return macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"<template>\", line 65, in macro\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/clients/jinja.py\", line 92, in __call__\n    return self.call_macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt_common/clients/jinja.py\", line 389, in call_macro\n    return macro(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"<template>\", line 52, in macro\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt_common/record.py\", line 470, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/base/impl.py\", line 430, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py\", line 514, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py\", line 551, in add_query\n    connection, cursor = self._add_standard_queries(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py\", line 607, in _add_standard_queries\n    connection, cursor = self.add_standard_query(query, **kwargs)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py\", line 525, in add_standard_query\n    return super().add_query(self._add_query_comment(sql), **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/sql/connections.py\", line 130, in add_query\n    with self.exception_handler(sql):\n  File \"/usr/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/venv/dbt-latest/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py\", line 343, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql\n", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "executing", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "name": "CatchableExceptionOnRun", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.674242Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'run_model', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70777245ecd0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8b9b899-bee2-4c99-bad0-6a6d1be38a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70777245ecd0>]}", "name": "SendingEvent", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.675756Z"}}
{"data": {"description": "sql view model FEHMMI.stg_jaffle_shop_items", "execution_time": 0.11547184, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "2025-04-01T07:53:42.674716", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "error", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "error", "msg": "1 of 1 ERROR creating sql view model FEHMMI.stg_jaffle_shop_items .............. [\u001b[31mERROR\u001b[0m in 0.12s]", "name": "LogModelResult", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.676362Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "2025-04-01T07:53:42.674716", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "2025-04-01T07:53:42.558185", "node_status": "error", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "run_result": {"adapter_response": {}, "execution_time": 0.11547184, "message": "Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "num_failures": 0, "status": "error", "thread": "Thread-2 (worker)", "timing_info": [{"completed_at": "2025-04-01T07:53:42.565593Z", "name": "compile", "started_at": "2025-04-01T07:53:42.559989Z"}, {"completed_at": "2025-04-01T07:53:42.671833Z", "name": "execute", "started_at": "2025-04-01T07:53:42.566043Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Finished running node model.my_dbt_project.stg_jaffle_shop_items", "name": "NodeFinished", "pid": 10838, "thread": "Thread-2 (worker)", "ts": "2025-04-01T07:53:42.676984Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 0.11547184, "message": "Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "num_failures": 0, "status": "error", "thread": "Thread-2 (worker)", "timing_info": [{"completed_at": "2025-04-01T07:53:42.565593Z", "name": "compile", "started_at": "2025-04-01T07:53:42.559989Z"}, {"completed_at": "2025-04-01T07:53:42.671833Z", "name": "execute", "started_at": "2025-04-01T07:53:42.566043Z"}]}, "status": "error", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Marking all children of 'model.my_dbt_project.stg_jaffle_shop_items' to be skipped because of status 'error'.  Reason: Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql.", "name": "MarkSkippedChildren", "pid": 10838, "thread": "Thread-8 (_handle_results)", "ts": "2025-04-01T07:53:42.677707Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.679320Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI"}, "info": {"category": "", "code": "E007", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Connection 'list_DBT_DEV_FEHMMI' was left open.", "name": "ConnectionLeftOpenInCleanup", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.679646Z"}}
{"data": {"conn_name": "list_DBT_DEV_FEHMMI"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "On list_DBT_DEV_FEHMMI: Close", "name": "ConnectionClosed", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.679928Z"}}
{"data": {"conn_name": "model.my_dbt_project.stg_jaffle_shop_items"}, "info": {"category": "", "code": "E007", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Connection 'model.my_dbt_project.stg_jaffle_shop_items' was left open.", "name": "ConnectionLeftOpenInCleanup", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.757688Z"}}
{"data": {"conn_name": "model.my_dbt_project.stg_jaffle_shop_items"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "On model.my_dbt_project.stg_jaffle_shop_items: Close", "name": "ConnectionClosed", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.758291Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.838797Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 1.23 seconds", "execution_time": 1.2288687, "stat_line": "1 view model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Finished running 1 view model in 0 hours 0 minutes and 1.23 seconds (1.23s).", "name": "FinishedRunningStats", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.839471Z"}}
{"data": {"elapsed_time": 1.2288687, "generated_at": "2025-04-01T07:53:42Z", "results": [{"adapter_response": {}, "execution_time": 0.11547184, "message": "Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "num_failures": 0, "status": "error", "thread": "Thread-2 (worker)", "timing_info": [{"completed_at": "2025-04-01T07:53:42.565593Z", "name": "compile", "started_at": "2025-04-01T07:53:42.559989Z"}, {"completed_at": "2025-04-01T07:53:42.671833Z", "name": "execute", "started_at": "2025-04-01T07:53:42.566043Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.840541Z"}}
{"data": {"artifact_path": "/app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Wrote artifact WritableManifest to /app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/manifest.json", "name": "ArtifactWritten", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.878455Z"}}
{"data": {"artifact_path": "/app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Wrote artifact SemanticManifest to /app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.880027Z"}}
{"data": {"artifact_path": "/app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /app/dbt_project/56d53fd2-8fd9-4072-a414-6f3a4e06a522/target/run_results.json", "name": "ArtifactWritten", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.887043Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.887515Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.888094Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.888616Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "node_name": "stg_jaffle_shop_items", "path": "models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "resource_type": "model"}, "info": {"category": "", "code": "Z022", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "error", "msg": "\u001b[31mFailure in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\u001b[0m", "name": "RunResultFailure", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.889210Z"}}
{"data": {"msg": "Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "error", "msg": "  Database Error in model stg_jaffle_shop_items (models/staging/jaffle_shop/stg_jaffle_shop_items.sql)\n  002003 (02000): SQL compilation error:\n  Schema 'DW._JAFFLE_SHOP' does not exist or not authorized.\n  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "name": "RunResultError", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.889940Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.890529Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "3b3ece90bcfc43193de390bdc608b155bf39f659ab32464f99027395480d0fca", "node_finished_at": "", "node_name": "stg_jaffle_shop_items", "node_path": "staging/jaffle_shop/stg_jaffle_shop_items.sql", "node_relation": {"alias": "stg_jaffle_shop_items", "database": "DBT_DEV", "relation_name": "DBT_DEV.FEHMMI.stg_jaffle_shop_items", "schema": "FEHMMI"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.my_dbt_project.stg_jaffle_shop_items"}, "path": "target/compiled/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql"}, "info": {"category": "", "code": "Z026", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "  compiled code at target/compiled/my_dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_items.sql", "name": "SQLCompiledPath", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.891077Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "", "name": "Formatting", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.891643Z"}}
{"data": {"stats": {"error": 1, "noop": 0, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1", "name": "StatsLine", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.892141Z"}}
{"data": {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4582984, "process_in_blocks": "0", "process_kernel_time": 1.376076, "process_mem_max_rss": "303080", "process_out_blocks": "5384", "process_user_time": 3.264163}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Resource report: {\"command_name\": \"build\", \"command_success\": false, \"command_wall_clock_time\": 2.4582984, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.376076, \"process_mem_max_rss\": \"303080\", \"process_out_blocks\": \"5384\", \"process_user_time\": 3.264163}", "name": "ResourceReport", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.899303Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:build", "system_success:True"], "value": 0.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: command_success=0.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.899827Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 2.4582984}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=2.458298444747925", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.900345Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 3.264163}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: process_user_time=3.264163017272949", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.900693Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.376076}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.3760759830474854", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.901013Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 303080.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=303080.0", "name": "ObservabilityMetric", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.901313Z"}}
{"data": {"command": "cli build", "completed_at": "2025-04-01T07:53:42.901620Z", "elapsed": 2.4582984, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Command `cli build` failed at 07:53:42.901620 after 2.46 seconds", "name": "CommandCompleted", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.901701Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772386050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772385d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772385c90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "56d53fd2-8fd9-4072-a414-6f3a4e06a522", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772386050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772385d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707772385c90>]}", "name": "SendingEvent", "pid": 10838, "thread": "MainThread", "ts": "2025-04-01T07:53:42.902079Z"}}

[0m09:56:31.860385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104727250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104727cd0>]}


============================== 09:56:31.867987 | 04672f17-32b7-4999-b965-adc692887000 ==============================
[0m09:56:31.867987 [info ] [MainThread]: Running with dbt=1.8.0
[0m09:56:31.868497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:56:31.945833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04672f17-32b7-4999-b965-adc692887000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d88b0>]}
[0m09:56:32.009446 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-jn3ng_pk'
[0m09:56:32.009719 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:56:32.211449 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:56:32.212400 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:56:32.574308 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:56:32.584889 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:56:32.886334 [info ] [MainThread]: Installed from version 1.3.0
[0m09:56:32.886647 [info ] [MainThread]: Up to date!
[0m09:56:32.886858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '04672f17-32b7-4999-b965-adc692887000', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104778b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d44310>]}
[0m09:56:32.903357 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1102254, "process_user_time": 0.698, "process_kernel_time": 0.143037, "process_mem_max_rss": "101187584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:56:32.903694 [debug] [MainThread]: Command `cli deps` succeeded at 09:56:32.903630 after 1.11 seconds
[0m09:56:32.903906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031f8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c681f0>]}
[0m09:56:32.904097 [debug] [MainThread]: Flushing usage events
[0m09:56:33.001788 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:01:28.225629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10362e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e7cd0>]}


============================== 10:01:28.228754 | 1d3bb74b-860d-4db3-a319-ba2ce9815722 ==============================
[0m10:01:28.228754 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:01:28.229072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:01:28.327333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d3bb74b-860d-4db3-a319-ba2ce9815722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039690a0>]}
[0m10:01:28.453455 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-7mgvyleh'
[0m10:01:28.453711 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:01:28.524481 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:01:28.524901 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:01:28.571157 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:01:28.573801 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:01:28.959949 [info ] [MainThread]: Installed from version 1.3.0
[0m10:01:28.960230 [info ] [MainThread]: Up to date!
[0m10:01:28.960472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1d3bb74b-860d-4db3-a319-ba2ce9815722', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f901c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078488b0>]}
[0m10:01:28.963629 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8229522, "process_user_time": 0.678697, "process_kernel_time": 0.179331, "process_mem_max_rss": "100499456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:01:28.963939 [debug] [MainThread]: Command `cli deps` succeeded at 10:01:28.963884 after 0.82 seconds
[0m10:01:28.964133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10362e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025cf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a28130>]}
[0m10:01:28.964324 [debug] [MainThread]: Flushing usage events
[0m10:01:29.032294 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:01:53.502880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fae610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2ccd0>]}


============================== 10:01:53.505981 | f2975782-19fd-4b65-9831-1199cbf6a0a8 ==============================
[0m10:01:53.505981 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:01:53.506274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:01:53.533277 [info ] [MainThread]: dbt version: 1.8.0
[0m10:01:53.533513 [info ] [MainThread]: python version: 3.9.2
[0m10:01:53.533659 [info ] [MainThread]: python path: /Users/fehmmialiti/.pyenv/versions/3.9.2/bin/python
[0m10:01:53.533930 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m10:01:53.574787 [info ] [MainThread]: Using profiles dir at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project
[0m10:01:53.575049 [info ] [MainThread]: Using profiles.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/profiles.yml
[0m10:01:53.575204 [info ] [MainThread]: Using dbt_project.yml file at /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/dbt_project.yml
[0m10:01:53.575722 [info ] [MainThread]: adapter type: postgres
[0m10:01:53.575867 [info ] [MainThread]: adapter version: 1.9.0
[0m10:01:53.619550 [info ] [MainThread]: Configuration:
[0m10:01:53.619826 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:01:53.619986 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:01:53.620205 [info ] [MainThread]: Required dependencies:
[0m10:01:53.620443 [debug] [MainThread]: Executing "git --help"
[0m10:01:53.660524 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:01:53.661010 [debug] [MainThread]: STDERR: "b''"
[0m10:01:53.661183 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:01:53.661359 [info ] [MainThread]: Connection:
[0m10:01:53.661723 [info ] [MainThread]:   host: localhost
[0m10:01:53.661931 [info ] [MainThread]:   port: 5432
[0m10:01:53.662080 [info ] [MainThread]:   user: dw_user
[0m10:01:53.662275 [info ] [MainThread]:   database: dw
[0m10:01:53.662512 [info ] [MainThread]:   schema: public
[0m10:01:53.662684 [info ] [MainThread]:   connect_timeout: 10
[0m10:01:53.662822 [info ] [MainThread]:   role: None
[0m10:01:53.662956 [info ] [MainThread]:   search_path: None
[0m10:01:53.663093 [info ] [MainThread]:   keepalives_idle: 0
[0m10:01:53.663250 [info ] [MainThread]:   sslmode: None
[0m10:01:53.663395 [info ] [MainThread]:   sslcert: None
[0m10:01:53.663532 [info ] [MainThread]:   sslkey: None
[0m10:01:53.663665 [info ] [MainThread]:   sslrootcert: None
[0m10:01:53.663795 [info ] [MainThread]:   application_name: dbt
[0m10:01:53.663928 [info ] [MainThread]:   retries: 1
[0m10:01:53.664318 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:01:53.767174 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:01:54.408131 [debug] [MainThread]: Using postgres connection "debug"
[0m10:01:54.408619 [debug] [MainThread]: On debug: select 1 as id
[0m10:01:54.408947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:54.559606 [debug] [MainThread]: SQL status: SELECT 1 in 0.150 seconds
[0m10:01:54.560955 [debug] [MainThread]: On debug: Close
[0m10:01:54.561406 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:01:54.561830 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:01:54.563680 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0964223, "process_user_time": 0.730697, "process_kernel_time": 0.213113, "process_mem_max_rss": "111837184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:01:54.563941 [debug] [MainThread]: Command `cli debug` succeeded at 10:01:54.563886 after 1.10 seconds
[0m10:01:54.564106 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:01:54.564274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fae610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f1f40>]}
[0m10:01:54.564460 [debug] [MainThread]: Flushing usage events
[0m10:01:54.671247 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:10:13.145808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b966a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113027220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113027d30>]}


============================== 10:10:13.148127 | 94cade44-0b88-4607-bce7-3ff402560801 ==============================
[0m10:10:13.148127 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:10:13.148420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:10:13.228383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94cade44-0b88-4607-bce7-3ff402560801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdcac0>]}
[0m10:10:13.285631 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-by8xbg0u'
[0m10:10:13.285902 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:10:13.385806 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:10:13.386284 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:10:13.441994 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:10:13.444746 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:10:13.761329 [info ] [MainThread]: Installed from version 1.3.0
[0m10:10:13.761652 [info ] [MainThread]: Up to date!
[0m10:10:13.761862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '94cade44-0b88-4607-bce7-3ff402560801', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113078070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113240220>]}
[0m10:10:13.764017 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.65760756, "process_user_time": 0.694412, "process_kernel_time": 0.153292, "process_mem_max_rss": "100745216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:10:13.764308 [debug] [MainThread]: Command `cli deps` succeeded at 10:10:13.764252 after 0.66 seconds
[0m10:10:13.764506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b966a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113164190>]}
[0m10:10:13.764716 [debug] [MainThread]: Flushing usage events
[0m10:10:13.821303 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:11:38.085495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494bd30>]}


============================== 10:11:38.087783 | 927668e8-602d-4943-b04e-7584fb712a59 ==============================
[0m10:11:38.087783 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:11:38.088290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:11:38.177477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '927668e8-602d-4943-b04e-7584fb712a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104900ac0>]}
[0m10:11:38.293244 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-rr1j5mq0'
[0m10:11:38.293707 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:11:38.398642 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:11:38.399115 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:11:38.494242 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:11:38.496898 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:11:38.787470 [info ] [MainThread]: Installed from version 1.3.0
[0m10:11:38.787745 [info ] [MainThread]: Up to date!
[0m10:11:38.788203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '927668e8-602d-4943-b04e-7584fb712a59', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b641f0>]}
[0m10:11:38.790253 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.74491894, "process_user_time": 0.767433, "process_kernel_time": 0.178087, "process_mem_max_rss": "98418688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:11:38.790561 [debug] [MainThread]: Command `cli deps` succeeded at 10:11:38.790495 after 0.75 seconds
[0m10:11:38.790763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a88190>]}
[0m10:11:38.790950 [debug] [MainThread]: Flushing usage events
[0m10:11:38.857397 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:21:03.616483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c1310>]}


============================== 10:21:03.618955 | 2e4c7789-c877-41d5-9e5f-f0a5acaf8828 ==============================
[0m10:21:03.618955 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:21:03.619253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:03.701132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e4c7789-c877-41d5-9e5f-f0a5acaf8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11229b6d0>]}
[0m10:21:03.746695 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-_ne12ow3'
[0m10:21:03.746985 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:21:03.859119 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:21:03.859543 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:21:03.908001 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:21:03.910690 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:21:04.306757 [info ] [MainThread]: Installed from version 1.3.0
[0m10:21:04.307023 [info ] [MainThread]: Up to date!
[0m10:21:04.307243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2e4c7789-c877-41d5-9e5f-f0a5acaf8828', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112459fd0>]}
[0m10:21:04.317201 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7834569, "process_in_blocks": "0", "process_kernel_time": 0.162796, "process_mem_max_rss": "102809600", "process_out_blocks": "0", "process_user_time": 0.70924}
[0m10:21:04.317531 [debug] [MainThread]: Command `cli deps` succeeded at 10:21:04.317472 after 0.78 seconds
[0m10:21:04.317742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122aca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2adc0>]}
[0m10:21:04.317950 [debug] [MainThread]: Flushing usage events
[0m10:21:04.367651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:19.487687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a35910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c01880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c016a0>]}


============================== 20:44:19.489985 | 155ae4d3-7ab6-4f5b-84f5-6c828d4e1491 ==============================
[0m20:44:19.489985 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:44:19.490275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:19.565805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '155ae4d3-7ab6-4f5b-84f5-6c828d4e1491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4fb50>]}
[0m20:44:19.675674 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-gutr82hy'
[0m20:44:19.675923 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:44:19.923801 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:44:19.924469 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:44:19.986324 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:44:19.992562 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:44:20.333536 [info ] [MainThread]: Installed from version 1.3.0
[0m20:44:20.333801 [info ] [MainThread]: Up to date!
[0m20:44:20.334015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '155ae4d3-7ab6-4f5b-84f5-6c828d4e1491', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d99700>]}
[0m20:44:20.346562 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9496198, "process_in_blocks": "0", "process_kernel_time": 0.158192, "process_mem_max_rss": "104185856", "process_out_blocks": "0", "process_user_time": 0.726804}
[0m20:44:20.346885 [debug] [MainThread]: Command `cli deps` succeeded at 20:44:20.346831 after 0.95 seconds
[0m20:44:20.347086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a35910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7deb0>]}
[0m20:44:20.347291 [debug] [MainThread]: Flushing usage events
[0m20:44:20.878691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:49.724492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108491910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109339880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093396a0>]}


============================== 20:48:49.726885 | 7cf33126-997f-457b-8eb6-584a4ed57f1f ==============================
[0m20:48:49.726885 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:48:49.727181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:49.800600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cf33126-997f-457b-8eb6-584a4ed57f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109187b50>]}
[0m20:48:49.852239 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-9ziz0jy7'
[0m20:48:49.852508 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:48:49.995512 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:48:49.995925 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:48:50.083395 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:48:50.088119 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:48:50.371574 [info ] [MainThread]: Installed from version 1.3.0
[0m20:48:50.371869 [info ] [MainThread]: Up to date!
[0m20:48:50.372076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7cf33126-997f-457b-8eb6-584a4ed57f1f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d1700>]}
[0m20:48:50.374452 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.68638664, "process_in_blocks": "0", "process_kernel_time": 0.144344, "process_mem_max_rss": "102744064", "process_out_blocks": "0", "process_user_time": 0.730634}
[0m20:48:50.374724 [debug] [MainThread]: Command `cli deps` succeeded at 20:48:50.374671 after 0.69 seconds
[0m20:48:50.374919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108491910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b5eb0>]}
[0m20:48:50.375107 [debug] [MainThread]: Flushing usage events
[0m20:48:50.859821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:05.591675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c3280>]}


============================== 20:49:05.594092 | 5c359e2b-6efb-4f9d-81ce-717a861f524a ==============================
[0m20:49:05.594092 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:49:05.594374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:49:05.702378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c359e2b-6efb-4f9d-81ce-717a861f524a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e2520>]}
[0m20:49:05.729321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c359e2b-6efb-4f9d-81ce-717a861f524a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074baa30>]}
[0m20:49:05.730206 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:49:05.825131 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m20:49:05.892042 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:49:05.892312 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m20:49:05.892511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c359e2b-6efb-4f9d-81ce-717a861f524a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106275bb0>]}
[0m20:49:06.717883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c359e2b-6efb-4f9d-81ce-717a861f524a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e01c10>]}
[0m20:49:06.774010 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:49:06.788932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:49:06.811434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c359e2b-6efb-4f9d-81ce-717a861f524a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797e9d0>]}
[0m20:49:06.811691 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m20:49:06.811863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c359e2b-6efb-4f9d-81ce-717a861f524a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795e1c0>]}
[0m20:49:06.812556 [info ] [MainThread]: 
[0m20:49:06.812765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:06.812934 [info ] [MainThread]: 
[0m20:49:06.813194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:06.813581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:49:08.067160 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:49:08.067443 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:49:08.067606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:08.069804 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m20:49:08.070696 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:49:08.070867 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:49:08.071048 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:49:08.071191 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:49:08.071338 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m20:49:08.071693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:08.071876 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m20:49:08.072038 [info ] [MainThread]: 
[0m20:49:08.072208 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m20:49:08.072462 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m20:49:08.073951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.517185, "process_in_blocks": "0", "process_kernel_time": 0.263477, "process_mem_max_rss": "126091264", "process_out_blocks": "0", "process_user_time": 1.676166}
[0m20:49:08.074167 [debug] [MainThread]: Command `cli run` failed at 20:49:08.074125 after 2.52 seconds
[0m20:49:08.074352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c546a0>]}
[0m20:49:08.074545 [debug] [MainThread]: Flushing usage events
[0m20:49:08.470258 [debug] [MainThread]: An error was encountered while trying to flush usage events
============================== 851a444e-41c2-4532-baa2-9786b78c1120 ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: 851a444e-41c2-4532-baa2-9786b78c1120", "ts": "2025-04-07T18:56:21.836371Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebe6aa850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebfd4b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ec94c0750>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebe6aa850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebfd4b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ec94c0750>]}", "name": "SendingEvent", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.420809Z"}}
{"data": {"log_version": 3, "version": "=2025.4.2+2c45924"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.422826Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'invocation_command': 'dbt ', 'target_path': 'target', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.423372Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.537438Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'cd958dc0-33c7-4ff2-be48-b9f77afb0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc44c390>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd958dc0-33c7-4ff2-be48-b9f77afb0375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc44c390>]}", "name": "SendingEvent", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.538204Z"}}
{"data": {"path": "/tmp/dbt-downloads-rl6_dwm2"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-rl6_dwm2'", "name": "DepsSetDownloadDirectory", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.546761Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.547198Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.564549Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.565147Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.574792Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.577212Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.717820Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.718272Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'package', 'label': 'cd958dc0-33c7-4ff2-be48-b9f77afb0375', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc630290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc2d7890>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd958dc0-33c7-4ff2-be48-b9f77afb0375', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc630290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc2d7890>]}", "name": "SendingEvent", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.718648Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3337802, "process_in_blocks": "0", "process_kernel_time": 1.429766, "process_mem_max_rss": "237972", "process_out_blocks": "2312", "process_user_time": 2.184218}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 0.3337802, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.429766, \"process_mem_max_rss\": \"237972\", \"process_out_blocks\": \"2312\", \"process_user_time\": 2.184218}", "name": "ResourceReport", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.719734Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:deps", "system_success:True"], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Observability Metric: command_success=1.0", "name": "ObservabilityMetric", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.720127Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 0.3337802}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=0.3337801992893219", "name": "ObservabilityMetric", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.720643Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 2.184218}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Observability Metric: process_user_time=2.184217929840088", "name": "ObservabilityMetric", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.721044Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.429766}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.429766058921814", "name": "ObservabilityMetric", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.721393Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 237972.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=237972.0", "name": "ObservabilityMetric", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.721721Z"}}
{"data": {"command": "cli deps", "completed_at": "2025-04-07T18:56:22.722055Z", "elapsed": 0.3337802, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Command `cli deps` succeeded at 18:56:22.722055 after 0.33 seconds", "name": "CommandCompleted", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.722152Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc1de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebbd30150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebf1ca190>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "851a444e-41c2-4532-baa2-9786b78c1120", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebc1de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebbd30150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ebf1ca190>]}", "name": "SendingEvent", "pid": 4449, "thread": "MainThread", "ts": "2025-04-07T18:56:22.722516Z"}}

============================== b5f7435c-0d41-487b-9c68-90dcccaeb2ff ==============================
{"info": {"code": "Z050", "level": "info", "msg": "Cloud CLI invocation created: b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "ts": "2025-04-07T18:56:25.924761Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0356cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f092f7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0352b050>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0356cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f092f7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0352b050>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.436937Z"}}
{"data": {"log_version": 3, "version": "=2025.4.2+2c45924"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "info", "msg": "Running dbt...", "name": "MainReportVersion", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.438995Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt ", "log_cache_events": "False", "log_format": "json", "log_path": "logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "./", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "target", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'target', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.439518Z"}}
{"data": {"msg": "Discovered Exposures:\n[]"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Discovered Exposures:\n[]", "name": "Note", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.558333Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f036c72d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f036c72d0>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.559208Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f03967f10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f03967f10>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.607355Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.9.2-post4+996a302fa9107369eb30d733dadfaf307023f33d"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Registered adapter: snowflake=1.9.2-post4+996a302fa9107369eb30d733dadfaf307023f33d", "name": "AdapterRegistered", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.608077Z"}}
{"data": {"checksum": "a48c0652fbca7d3c270b36dbb46e5c0c1d058a955b32275b333f68e326cb2c64", "profile": "user", "target": "", "vars": "{}", "version": "2025.4.2+2c45924"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "checksum: a48c0652fbca7d3c270b36dbb46e5c0c1d058a955b32275b333f68e326cb2c64, vars: {}, profile: user, target: , version: 2025.4.2+2c45924", "name": "StateCheckVarsHash", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.756592Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.757295Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.757643Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 6728109.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=6728109.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.761288Z"}}
{"data": {"reason": "env vars used in dbt_project.yml have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "info", "msg": "Unable to do partial parsing because env vars used in dbt_project.yml have changed", "name": "UnableToPartialParse", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.969634Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.970122Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f01bbc790>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f01bbc790>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:26.970456Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0834e710>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0834e710>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.262011Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0846fd10>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'plugin_get_nodes', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f0846fd10>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.262593Z"}}
{"data": {"debug_message": "", "label": "msgpack_manifest_bytes", "tags": [], "value": 660304.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: msgpack_manifest_bytes=660304.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.334975Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f3f0b5090>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24c93866-f9a0-44e9-93b5-c88173dbd592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f3f0b5090>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.340752Z"}}
{"data": {"path": "/app/dbt_project/b5f7435c-0d41-487b-9c68-90dcccaeb2ff/target/perf_info.json"}, "info": {"category": "", "code": "I010", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "info", "msg": "Performance info: /app/dbt_project/b5f7435c-0d41-487b-9c68-90dcccaeb2ff/target/perf_info.json", "name": "ParsePerfInfoPath", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.343970Z"}}
{"data": {"debug_message": "", "label": "path_count", "tags": [], "value": 211.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: path_count=211.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.344368Z"}}
{"data": {"debug_message": "", "label": "parsed_path_count", "tags": [], "value": 211.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: parsed_path_count=211.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.344775Z"}}
{"data": {"debug_message": "", "label": "read_files_elapsed", "tags": [], "value": 0.018754842}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: read_files_elapsed=0.01875484175980091", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.345131Z"}}
{"data": {"debug_message": "", "label": "load_macros_elapsed", "tags": [], "value": 0.697619}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: load_macros_elapsed=0.6976190209388733", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.345466Z"}}
{"data": {"debug_message": "", "label": "parse_project_elapsed", "tags": [], "value": 0.5647783}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: parse_project_elapsed=0.5647783279418945", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.345785Z"}}
{"data": {"debug_message": "", "label": "patch_sources_elapsed", "tags": [], "value": 0.0049138498}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: patch_sources_elapsed=0.0049138497561216354", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.346111Z"}}
{"data": {"debug_message": "", "label": "process_manifest_elapsed", "tags": [], "value": 0.022047995}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: process_manifest_elapsed=0.022047994658350945", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.346426Z"}}
{"data": {"debug_message": "", "label": "load_all_elapsed", "tags": [], "value": 1.5944141}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: load_all_elapsed=1.5944141149520874", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.346747Z"}}
{"data": {"debug_message": "", "label": "is_partial_parse_enabled", "tags": [], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: is_partial_parse_enabled=1.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.347066Z"}}
{"data": {"artifact_path": "/app/dbt_project/b5f7435c-0d41-487b-9c68-90dcccaeb2ff/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Wrote artifact WritableManifest to /app/dbt_project/b5f7435c-0d41-487b-9c68-90dcccaeb2ff/target/manifest.json", "name": "ArtifactWritten", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.424225Z"}}
{"data": {"artifact_path": "/app/dbt_project/b5f7435c-0d41-487b-9c68-90dcccaeb2ff/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Wrote artifact SemanticManifest to /app/dbt_project/b5f7435c-0d41-487b-9c68-90dcccaeb2ff/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.425535Z"}}
{"data": {"command_name": "parse", "command_success": true, "command_wall_clock_time": 2.024018, "process_in_blocks": "0", "process_kernel_time": 1.420229, "process_mem_max_rss": "268168", "process_out_blocks": "2624", "process_user_time": 3.974786}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Resource report: {\"command_name\": \"parse\", \"command_success\": true, \"command_wall_clock_time\": 2.024018, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.420229, \"process_mem_max_rss\": \"268168\", \"process_out_blocks\": \"2624\", \"process_user_time\": 3.974786}", "name": "ResourceReport", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.426419Z"}}
{"data": {"debug_message": "", "label": "command_success", "tags": ["command_exception_type:None", "command_name:parse", "system_success:True"], "value": 1.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: command_success=1.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.426816Z"}}
{"data": {"debug_message": "", "label": "command_wall_clock_time", "tags": [], "value": 2.024018}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: command_wall_clock_time=2.0240180492401123", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.427259Z"}}
{"data": {"debug_message": "", "label": "process_user_time", "tags": [], "value": 3.974786}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: process_user_time=3.9747860431671143", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.427612Z"}}
{"data": {"debug_message": "", "label": "process_kernel_time", "tags": [], "value": 1.420229}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: process_kernel_time=1.4202289581298828", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.427930Z"}}
{"data": {"debug_message": "", "label": "process_mem_max_rss", "tags": [], "value": 268168.0}, "info": {"category": "", "code": "Z052", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Observability Metric: process_mem_max_rss=268168.0", "name": "ObservabilityMetric", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.428229Z"}}
{"data": {"command": "cli parse", "completed_at": "2025-04-07T18:56:28.428533Z", "elapsed": 2.024018, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Command `cli parse` succeeded at 18:56:28.428533 after 2.02 seconds", "name": "CommandCompleted", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.428621Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f03529e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f03511b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f09bed290>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "b5f7435c-0d41-487b-9c68-90dcccaeb2ff", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f03529e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f03511b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710f09bed290>]}", "name": "SendingEvent", "pid": 4477, "thread": "MainThread", "ts": "2025-04-07T18:56:28.428997Z"}}

[0m21:02:49.744536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110985550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110985370>]}


============================== 21:02:49.747665 | 324554bf-2781-44b5-a90e-e4005156d69c ==============================
[0m21:02:49.747665 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:02:49.747996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:02:49.824761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '324554bf-2781-44b5-a90e-e4005156d69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110940fa0>]}
[0m21:02:49.944432 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-ycbd2yz1'
[0m21:02:49.944783 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:02:50.163162 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:02:50.163628 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:02:50.221742 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:02:50.224323 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:02:50.507175 [info ] [MainThread]: Installed from version 1.3.0
[0m21:02:50.507451 [info ] [MainThread]: Up to date!
[0m21:02:50.507659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '324554bf-2781-44b5-a90e-e4005156d69c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b84d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c11ca0>]}
[0m21:02:50.513976 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8555908, "process_in_blocks": "0", "process_kernel_time": 0.143451, "process_mem_max_rss": "102465536", "process_out_blocks": "0", "process_user_time": 0.673071}
[0m21:02:50.514290 [debug] [MainThread]: Command `cli deps` succeeded at 21:02:50.514227 after 0.86 seconds
[0m21:02:50.514496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a618e0>]}
[0m21:02:50.514705 [debug] [MainThread]: Flushing usage events
[0m21:02:51.001402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:18.217947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84520>]}


============================== 22:06:18.221265 | e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d ==============================
[0m22:06:18.221265 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:06:18.221685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.331770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a66070>]}
[0m22:06:18.358250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107421580>]}
[0m22:06:18.359877 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:06:18.462394 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m22:06:18.535991 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:06:18.536270 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m22:06:18.536462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb66a0>]}
[0m22:06:19.393532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a3b50>]}
[0m22:06:19.457566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:06:19.474212 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:06:19.501838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108192880>]}
[0m22:06:19.502145 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:06:19.502324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e799fb63-eaf9-4d36-8d8e-18ddf2ebe08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081951f0>]}
[0m22:06:19.503016 [info ] [MainThread]: 
[0m22:06:19.503204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:06:19.503399 [info ] [MainThread]: 
[0m22:06:19.503733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:19.504211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:06:19.575296 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:06:19.575527 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:06:19.575666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:19.586097 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m22:06:19.587456 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:06:19.587652 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:06:19.587840 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:06:19.587984 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:06:19.588120 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m22:06:19.588422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:19.588590 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m22:06:19.588743 [info ] [MainThread]: 
[0m22:06:19.588907 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:06:19.589161 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m22:06:19.592389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5251652, "process_in_blocks": "0", "process_kernel_time": 0.182068, "process_mem_max_rss": "129449984", "process_out_blocks": "0", "process_user_time": 1.717965}
[0m22:06:19.592604 [debug] [MainThread]: Command `cli run` failed at 22:06:19.592560 after 1.53 seconds
[0m22:06:19.592779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854abe0>]}
[0m22:06:19.592959 [debug] [MainThread]: Flushing usage events
[0m22:06:20.063989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:34.400592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118da2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f81820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f81640>]}


============================== 22:09:34.403295 | c0357e8e-1776-4f59-ba24-f9a2f02f680a ==============================
[0m22:09:34.403295 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:09:34.403590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:09:34.510624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0357e8e-1776-4f59-ba24-f9a2f02f680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1aa7c0>]}
[0m22:09:34.536626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0357e8e-1776-4f59-ba24-f9a2f02f680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f4ad90>]}
[0m22:09:34.538255 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:09:34.597704 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:09:34.662804 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:09:34.663059 [debug] [MainThread]: previous checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, current checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23
[0m22:09:34.663233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0357e8e-1776-4f59-ba24-f9a2f02f680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199ec490>]}
[0m22:09:35.512706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0357e8e-1776-4f59-ba24-f9a2f02f680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abf8d90>]}
[0m22:09:35.571383 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:09:35.573928 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:09:35.590974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0357e8e-1776-4f59-ba24-f9a2f02f680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f43e50>]}
[0m22:09:35.591253 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:09:35.591445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0357e8e-1776-4f59-ba24-f9a2f02f680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6d1310>]}
[0m22:09:35.592323 [info ] [MainThread]: 
[0m22:09:35.592501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:09:35.592650 [info ] [MainThread]: 
[0m22:09:35.592902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:35.595301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:09:35.664268 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:09:35.664504 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:09:35.664650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:35.674781 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m22:09:35.675988 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:09:35.676152 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:09:35.676317 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:09:35.676451 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:09:35.676590 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m22:09:35.676912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:35.677069 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m22:09:35.677211 [info ] [MainThread]: 
[0m22:09:35.677378 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m22:09:35.677623 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m22:09:35.679125 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.315744, "process_in_blocks": "0", "process_kernel_time": 0.175651, "process_mem_max_rss": "129400832", "process_out_blocks": "0", "process_user_time": 1.673902}
[0m22:09:35.679312 [debug] [MainThread]: Command `dbt seed` failed at 22:09:35.679272 after 1.32 seconds
[0m22:09:35.679481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118da2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a683640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9da8e0>]}
[0m22:09:35.679661 [debug] [MainThread]: Flushing usage events
[0m22:09:36.078551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:19.629185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42670>]}


============================== 22:13:19.636533 | 490d793b-8f30-428b-a566-2652d7ae34ad ==============================
[0m22:13:19.636533 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:13:19.638045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:13:19.766024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '490d793b-8f30-428b-a566-2652d7ae34ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7be80>]}
[0m22:13:19.793292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '490d793b-8f30-428b-a566-2652d7ae34ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0db80>]}
[0m22:13:19.794266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:13:19.852605 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:13:19.970595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:19.970817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:20.002685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '490d793b-8f30-428b-a566-2652d7ae34ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8d130>]}
[0m22:13:20.060191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:13:20.062810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:13:20.077517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '490d793b-8f30-428b-a566-2652d7ae34ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb93a0>]}
[0m22:13:20.077788 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:13:20.077970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '490d793b-8f30-428b-a566-2652d7ae34ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb6ca0>]}
[0m22:13:20.078882 [info ] [MainThread]: 
[0m22:13:20.079068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:13:20.079217 [info ] [MainThread]: 
[0m22:13:20.079466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:20.081817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:13:20.156586 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:13:20.156845 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:13:20.157011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:20.169071 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m22:13:20.170539 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:13:20.170874 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:13:20.171150 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:13:20.171316 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:13:20.171488 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m22:13:20.171828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:20.171989 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m22:13:20.172134 [info ] [MainThread]: 
[0m22:13:20.172308 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:13:20.172573 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m22:13:20.174162 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.5977391, "process_in_blocks": "0", "process_kernel_time": 0.186935, "process_mem_max_rss": "120307712", "process_out_blocks": "0", "process_user_time": 0.969678}
[0m22:13:20.174357 [debug] [MainThread]: Command `dbt seed` failed at 22:13:20.174316 after 0.60 seconds
[0m22:13:20.174530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc91d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dac640>]}
[0m22:13:20.174710 [debug] [MainThread]: Flushing usage events
[0m22:13:20.645573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:24.430764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b81670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b81490>]}


============================== 22:13:24.432820 | 6085aaf6-7ee6-4eff-951d-89d576fa1615 ==============================
[0m22:13:24.432820 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:13:24.433128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:13:24.532431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6085aaf6-7ee6-4eff-951d-89d576fa1615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de87c0>]}
[0m22:13:24.560731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6085aaf6-7ee6-4eff-951d-89d576fa1615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e3550>]}
[0m22:13:24.561496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:13:24.620444 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:13:24.806294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:24.806601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:24.843859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6085aaf6-7ee6-4eff-951d-89d576fa1615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd130>]}
[0m22:13:24.906783 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:13:24.909794 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:13:24.928850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6085aaf6-7ee6-4eff-951d-89d576fa1615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f9100>]}
[0m22:13:24.929233 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:13:24.929472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6085aaf6-7ee6-4eff-951d-89d576fa1615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f5c10>]}
[0m22:13:24.930481 [info ] [MainThread]: 
[0m22:13:24.930992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:13:24.931552 [info ] [MainThread]: 
[0m22:13:24.931900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:24.934390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:13:25.013572 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:13:25.013827 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:13:25.013974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:25.024401 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m22:13:25.027330 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:13:25.027507 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:13:25.027687 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:13:25.027826 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:13:25.027973 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m22:13:25.028307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:25.028479 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m22:13:25.028645 [info ] [MainThread]: 
[0m22:13:25.028823 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m22:13:25.029094 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m22:13:25.030295 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.68012476, "process_in_blocks": "0", "process_kernel_time": 0.185895, "process_mem_max_rss": "119341056", "process_out_blocks": "0", "process_user_time": 1.020043}
[0m22:13:25.030494 [debug] [MainThread]: Command `dbt seed` failed at 22:13:25.030452 after 0.68 seconds
[0m22:13:25.030679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223d1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d90d30>]}
[0m22:13:25.030852 [debug] [MainThread]: Flushing usage events
[0m22:13:25.427972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:03.548428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103822970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049012e0>]}


============================== 22:15:03.551022 | 1300e3cc-e9a0-4e66-bd19-a6aaafcd3469 ==============================
[0m22:15:03.551022 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:15:03.551315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m22:15:03.666695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1300e3cc-e9a0-4e66-bd19-a6aaafcd3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b16e80>]}
[0m22:15:03.693016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1300e3cc-e9a0-4e66-bd19-a6aaafcd3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afb160>]}
[0m22:15:03.693859 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:15:03.753781 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:15:03.893225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:03.893457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:03.925434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1300e3cc-e9a0-4e66-bd19-a6aaafcd3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530d130>]}
[0m22:15:03.983195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:15:03.986318 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:15:04.003808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1300e3cc-e9a0-4e66-bd19-a6aaafcd3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053204f0>]}
[0m22:15:04.004072 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:15:04.004256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1300e3cc-e9a0-4e66-bd19-a6aaafcd3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053355e0>]}
[0m22:15:04.005138 [info ] [MainThread]: 
[0m22:15:04.005321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:04.005470 [info ] [MainThread]: 
[0m22:15:04.005719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:04.007983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:15:04.076440 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:15:04.076738 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:04.076907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:04.088282 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m22:15:04.089724 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:04.089908 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:15:04.090077 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:15:04.090212 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:15:04.090360 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m22:15:04.090676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:04.090847 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m22:15:04.090994 [info ] [MainThread]: 
[0m22:15:04.091170 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:15:04.091424 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m22:15:04.093038 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.582216, "process_in_blocks": "0", "process_kernel_time": 0.180736, "process_mem_max_rss": "120422400", "process_out_blocks": "0", "process_user_time": 0.939633}
[0m22:15:04.093264 [debug] [MainThread]: Command `dbt seed` failed at 22:15:04.093215 after 0.58 seconds
[0m22:15:04.093446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103822970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105414460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6b5e0>]}
[0m22:15:04.093635 [debug] [MainThread]: Flushing usage events
[0m22:15:04.643261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:35.792238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d194c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d192e0>]}


============================== 22:15:35.795338 | 6a809949-6701-4531-b68d-8066259248a1 ==============================
[0m22:15:35.795338 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:15:35.795724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:35.910406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a809949-6701-4531-b68d-8066259248a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f62e80>]}
[0m22:15:35.937144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a809949-6701-4531-b68d-8066259248a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f47160>]}
[0m22:15:35.938047 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:15:36.001766 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:15:36.157877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:36.158123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:36.190074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a809949-6701-4531-b68d-8066259248a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752d130>]}
[0m22:15:36.248341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:15:36.251566 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:15:36.268085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a809949-6701-4531-b68d-8066259248a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075404f0>]}
[0m22:15:36.268335 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:15:36.268516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a809949-6701-4531-b68d-8066259248a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075555e0>]}
[0m22:15:36.269391 [info ] [MainThread]: 
[0m22:15:36.269575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:36.269727 [info ] [MainThread]: 
[0m22:15:36.269981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:36.272249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:15:36.342776 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:15:36.343028 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:36.343180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:36.355416 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m22:15:36.357011 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:36.357222 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:15:36.357413 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:15:36.357572 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:15:36.357806 [debug] [ThreadPool]: On list_dw: No close available on handle
[0m22:15:36.358185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:36.358335 [debug] [MainThread]: Connection 'list_dw' was properly closed.
[0m22:15:36.358489 [info ] [MainThread]: 
[0m22:15:36.358675 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m22:15:36.358943 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m22:15:36.360801 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.6987246, "process_in_blocks": "0", "process_kernel_time": 0.179196, "process_mem_max_rss": "120913920", "process_out_blocks": "0", "process_user_time": 0.952649}
[0m22:15:36.361034 [debug] [MainThread]: Command `dbt seed` failed at 22:15:36.360989 after 0.70 seconds
[0m22:15:36.361247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107634460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bb5e0>]}
[0m22:15:36.361461 [debug] [MainThread]: Flushing usage events
[0m22:15:36.772691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:13.380866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dea850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dea670>]}


============================== 22:18:13.383802 | c77d0fac-10e9-4314-9ffc-8eebf791d10c ==============================
[0m22:18:13.383802 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:18:13.384115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:13.501255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023e80>]}
[0m22:18:13.528135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db5b80>]}
[0m22:18:13.529151 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:18:13.589332 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:18:13.735347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:13.735581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:13.767640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fd130>]}
[0m22:18:13.825666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m22:18:13.829061 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m22:18:13.845909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105629130>]}
[0m22:18:13.846176 [info ] [MainThread]: Found 6 models, 9 seeds, 2 data tests, 6 sources, 549 macros
[0m22:18:13.846364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056257c0>]}
[0m22:18:13.847262 [info ] [MainThread]: 
[0m22:18:13.847441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:18:13.847592 [info ] [MainThread]: 
[0m22:18:13.847846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:13.850118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m22:18:13.919130 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m22:18:13.919374 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:18:13.919522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:13.942286 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m22:18:13.943023 [debug] [ThreadPool]: On list_dw: Close
[0m22:18:13.943476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now create_dw_public_jaffle_shop)
[0m22:18:13.943767 [debug] [ThreadPool]: Creating schema "database: "dw"
schema: "public_jaffle_shop"
"
[0m22:18:13.946800 [debug] [ThreadPool]: Using postgres connection "create_dw_public_jaffle_shop"
[0m22:18:13.946959 [debug] [ThreadPool]: On create_dw_public_jaffle_shop: BEGIN
[0m22:18:13.947094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:13.957866 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m22:18:13.958086 [debug] [ThreadPool]: Using postgres connection "create_dw_public_jaffle_shop"
[0m22:18:13.958253 [debug] [ThreadPool]: On create_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "create_dw_public_jaffle_shop"} */
create schema if not exists "public_jaffle_shop"
[0m22:18:13.962854 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m22:18:13.963309 [debug] [ThreadPool]: On create_dw_public_jaffle_shop: COMMIT
[0m22:18:13.963468 [debug] [ThreadPool]: Using postgres connection "create_dw_public_jaffle_shop"
[0m22:18:13.963605 [debug] [ThreadPool]: On create_dw_public_jaffle_shop: COMMIT
[0m22:18:13.964644 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:18:13.964876 [debug] [ThreadPool]: On create_dw_public_jaffle_shop: Close
[0m22:18:13.965986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dw_public_jaffle_shop, now list_dw_public)
[0m22:18:13.988429 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:18:13.988652 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m22:18:13.988794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:13.998812 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m22:18:13.999039 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m22:18:13.999225 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:18:14.006870 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m22:18:14.007483 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m22:18:14.008168 [debug] [ThreadPool]: On list_dw_public: Close
[0m22:18:14.008446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m22:18:14.009751 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:18:14.009908 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m22:18:14.010065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:14.017541 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:18:14.017714 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m22:18:14.017909 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m22:18:14.020560 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:18:14.021093 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m22:18:14.021779 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m22:18:14.024789 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:14.024969 [debug] [MainThread]: On master: BEGIN
[0m22:18:14.025111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:14.032695 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:18:14.032855 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:14.033089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:18:14.041233 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m22:18:14.041870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561da60>]}
[0m22:18:14.042119 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:14.042650 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:14.042797 [debug] [MainThread]: On master: BEGIN
[0m22:18:14.043597 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:18:14.043779 [debug] [MainThread]: On master: COMMIT
[0m22:18:14.043939 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:14.044088 [debug] [MainThread]: On master: COMMIT
[0m22:18:14.044507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:14.044690 [debug] [MainThread]: On master: Close
[0m22:18:14.055094 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.customers
[0m22:18:14.055391 [info ] [Thread-1  ]: 1 of 9 START seed file public_jaffle_shop.customers ............................ [RUN]
[0m22:18:14.055654 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now seed.my_dbt_project.customers)
[0m22:18:14.055846 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.customers
[0m22:18:14.056030 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.customers
[0m22:18:14.072070 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m22:18:14.072273 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: BEGIN
[0m22:18:14.072443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:18:14.080871 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m22:18:14.081098 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m22:18:14.081281 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.customers"} */

    create table "dw"."public_jaffle_shop"."customers" ("ID" integer,"FIRST_NAME" text,"LAST_NAME" text)
  
[0m22:18:14.088804 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.007 seconds
[0m22:18:14.123039 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m22:18:14.123280 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: 
          insert into "dw"."public_jaffle_shop"."customers" ("ID", "FIRST_NAME", "LAST_NAME") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m22:18:14.125238 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.002 seconds
[0m22:18:14.127849 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.customers"
[0m22:18:14.137317 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: COMMIT
[0m22:18:14.137496 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m22:18:14.137652 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: COMMIT
[0m22:18:14.139508 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:18:14.140432 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: Close
[0m22:18:14.144276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105689ee0>]}
[0m22:18:14.144537 [info ] [Thread-1  ]: 1 of 9 OK loaded seed file public_jaffle_shop.customers ........................ [[32mINSERT 100[0m in 0.09s]
[0m22:18:14.144814 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.customers
[0m22:18:14.145001 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.orders
[0m22:18:14.145261 [info ] [Thread-1  ]: 2 of 9 START seed file public_jaffle_shop.orders ............................... [RUN]
[0m22:18:14.145500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.customers, now seed.my_dbt_project.orders)
[0m22:18:14.145662 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.orders
[0m22:18:14.145817 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.orders
[0m22:18:14.149748 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m22:18:14.149911 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: BEGIN
[0m22:18:14.150060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:18:14.159330 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:18:14.159794 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m22:18:14.160343 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.orders"} */

    create table "dw"."public_jaffle_shop"."orders" ("ID" integer,"USER_ID" integer,"ORDER_DATE" date,"STATUS" text)
  
[0m22:18:14.163743 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m22:18:14.198065 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m22:18:14.198329 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: 
          insert into "dw"."public_jaffle_shop"."orders" ("ID", "USER_ID", "ORDER_DATE", "STATUS") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
[0m22:18:14.200789 [debug] [Thread-1  ]: SQL status: INSERT 0 99 in 0.002 seconds
[0m22:18:14.201107 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.orders"
[0m22:18:14.202357 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: COMMIT
[0m22:18:14.202522 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m22:18:14.202671 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: COMMIT
[0m22:18:14.204164 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:18:14.204494 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: Close
[0m22:18:14.204774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b2880>]}
[0m22:18:14.205011 [info ] [Thread-1  ]: 2 of 9 OK loaded seed file public_jaffle_shop.orders ........................... [[32mINSERT 99[0m in 0.06s]
[0m22:18:14.205282 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.orders
[0m22:18:14.205471 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.payments
[0m22:18:14.205725 [info ] [Thread-1  ]: 3 of 9 START seed file public_jaffle_shop.payments ............................. [RUN]
[0m22:18:14.205933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.orders, now seed.my_dbt_project.payments)
[0m22:18:14.206106 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.payments
[0m22:18:14.206272 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.payments
[0m22:18:14.211438 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m22:18:14.211708 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: BEGIN
[0m22:18:14.211896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:18:14.221464 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m22:18:14.221720 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m22:18:14.221898 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.payments"} */

    create table "dw"."public_jaffle_shop"."payments" ("ID" integer,"ORDERID" integer,"PAYMENTMETHOD" text,"STATUS" text,"AMOUNT" integer,"CREATED" date)
  
[0m22:18:14.223625 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m22:18:14.283062 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m22:18:14.283304 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: 
          insert into "dw"."public_jaffle_shop"."payments" ("ID", "ORDERID", "PAYMENTMETHOD", "STATUS", "AMOUNT", "CREATED") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s...
[0m22:18:14.286991 [debug] [Thread-1  ]: SQL status: INSERT 0 120 in 0.004 seconds
[0m22:18:14.287297 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.payments"
[0m22:18:14.288592 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: COMMIT
[0m22:18:14.288757 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m22:18:14.288906 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: COMMIT
[0m22:18:14.290510 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:18:14.290820 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: Close
[0m22:18:14.291088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b51460>]}
[0m22:18:14.291322 [info ] [Thread-1  ]: 3 of 9 OK loaded seed file public_jaffle_shop.payments ......................... [[32mINSERT 120[0m in 0.09s]
[0m22:18:14.291590 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.payments
[0m22:18:14.291779 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_customers
[0m22:18:14.292043 [info ] [Thread-1  ]: 4 of 9 START seed file public_jaffle_shop.raw_customers ........................ [RUN]
[0m22:18:14.292249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.payments, now seed.my_dbt_project.raw_customers)
[0m22:18:14.292421 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_customers
[0m22:18:14.292590 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_customers
[0m22:18:14.296227 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m22:18:14.296386 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: BEGIN
[0m22:18:14.296533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:18:14.307633 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m22:18:14.307939 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m22:18:14.308109 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_customers"} */

    create table "dw"."public_jaffle_shop"."raw_customers" ("id" text,"name" text)
  
[0m22:18:14.312833 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.005 seconds
[0m22:18:14.464783 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m22:18:14.465024 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: 
          insert into "dw"."public_jaffle_shop"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m22:18:14.474536 [debug] [Thread-1  ]: SQL status: INSERT 0 930 in 0.009 seconds
[0m22:18:14.474868 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_customers"
[0m22:18:14.481705 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m22:18:14.481881 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m22:18:14.482039 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m22:18:14.484181 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:18:14.484517 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: Close
[0m22:18:14.484807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77d0fac-10e9-4314-9ffc-8eebf791d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b58280>]}
[0m22:18:14.485056 [info ] [Thread-1  ]: 4 of 9 OK loaded seed file public_jaffle_shop.raw_customers .................... [[32mINSERT 930[0m in 0.19s]
[0m22:18:14.485329 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_customers
[0m22:18:14.485519 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_items
[0m22:18:14.485783 [info ] [Thread-1  ]: 5 of 9 START seed file public_jaffle_shop.raw_items ............................ [RUN]
[0m22:18:14.485993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_customers, now seed.my_dbt_project.raw_items)
[0m22:18:14.486167 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_items
[0m22:18:14.486338 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_items
[0m22:18:14.782584 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m22:18:14.782836 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: BEGIN
[0m22:18:14.782996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:18:14.792058 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:18:14.792308 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m22:18:14.792495 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_items"} */

    create table "dw"."public_jaffle_shop"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m22:18:14.796333 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.004 seconds
[0m22:18:17.356719 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m22:18:17.357012 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m22:18:17.410651 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.053 seconds
[0m22:18:19.846390 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m22:18:19.846671 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m22:18:19.900868 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.054 seconds
[0m22:18:22.473053 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m22:18:22.474159 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m22:18:22.527471 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.053 seconds
[0m16:26:46.579667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c5520>]}


============================== 16:26:46.582897 | 7ae81e49-4481-48ed-b689-c9ce881a1a90 ==============================
[0m16:26:46.582897 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:26:46.583362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:46.661981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ae81e49-4481-48ed-b689-c9ce881a1a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d00e20>]}
[0m16:26:46.729707 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-4q0nt57_'
[0m16:26:46.729978 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:26:46.941148 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:26:46.941742 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:26:47.080519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:26:47.091359 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:26:47.498644 [info ] [MainThread]: Installed from version 1.3.0
[0m16:26:47.499079 [info ] [MainThread]: Up to date!
[0m16:26:47.499454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7ae81e49-4481-48ed-b689-c9ce881a1a90', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a59ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b58e20>]}
[0m16:26:47.518790 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0833943, "process_in_blocks": "0", "process_kernel_time": 0.180269, "process_mem_max_rss": "104235008", "process_out_blocks": "0", "process_user_time": 0.771072}
[0m16:26:47.519268 [debug] [MainThread]: Command `cli deps` succeeded at 16:26:47.519206 after 1.08 seconds
[0m16:26:47.519511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d000d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064979d0>]}
[0m16:26:47.519723 [debug] [MainThread]: Flushing usage events
[0m16:26:47.599070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:18.805934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109765a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b143490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1432b0>]}


============================== 09:38:18.809308 | 2566b29a-e49d-4b69-80a1-aab38f54adc0 ==============================
[0m09:38:18.809308 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:18.809771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:38:18.921314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066825e0>]}
[0m09:38:18.948574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b5eb0>]}
[0m09:38:18.949610 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:19.053946 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m09:38:19.125054 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:38:19.125367 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m09:38:19.125576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4a550>]}
[0m09:38:20.003194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd59130>]}
[0m09:38:20.060548 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:38:20.077919 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:38:20.100844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba99ee0>]}
[0m09:38:20.101152 [info ] [MainThread]: Found 9 models, 9 seeds, 2 data tests, 9 sources, 549 macros
[0m09:38:20.101333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba99670>]}
[0m09:38:20.102008 [info ] [MainThread]: 
[0m09:38:20.102187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:20.102384 [info ] [MainThread]: 
[0m09:38:20.102686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:20.103125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m09:38:20.165760 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m09:38:20.165985 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m09:38:20.166124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:20.184963 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m09:38:20.185598 [debug] [ThreadPool]: On list_dw: Close
[0m09:38:20.188459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m09:38:20.191585 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:38:20.191750 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m09:38:20.191914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:20.200600 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:38:20.200755 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:38:20.200908 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m09:38:20.207657 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:38:20.208263 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m09:38:20.208887 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m09:38:20.209194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m09:38:20.211285 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:38:20.211441 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m09:38:20.211585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:20.219000 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:38:20.219154 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:38:20.219309 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:38:20.222741 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:38:20.223326 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m09:38:20.223875 [debug] [ThreadPool]: On list_dw_public: Close
[0m09:38:20.227253 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:20.227441 [debug] [MainThread]: On master: BEGIN
[0m09:38:20.227581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:20.234225 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:38:20.234386 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:20.234574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:20.241574 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m09:38:20.242324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb183d0>]}
[0m09:38:20.242598 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:20.243150 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:20.243306 [debug] [MainThread]: On master: BEGIN
[0m09:38:20.244129 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:38:20.244304 [debug] [MainThread]: On master: COMMIT
[0m09:38:20.244455 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:20.244592 [debug] [MainThread]: On master: COMMIT
[0m09:38:20.245074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:20.245226 [debug] [MainThread]: On master: Close
[0m09:38:20.250418 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:20.250784 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop_payments .................... [RUN]
[0m09:38:20.251195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop_payments)
[0m09:38:20.251539 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:20.256206 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:20.257089 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:20.274740 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:20.275493 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:20.275686 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: BEGIN
[0m09:38:20.275860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:38:20.282783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m09:38:20.283020 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:20.283185 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_payments"} */

  create view "dw"."public"."stg_jaffle_shop_payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."payments"
)
,

renamed as (
    select
        ID
        -- orderid,
        -- paymentmethod,
        -- status,
        -- amount,
        -- created
    from source
)
select * from renamed
  );
[0m09:38:20.284359 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 14:         ID
                 ^

[0m09:38:20.284535 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: ROLLBACK
[0m09:38:20.285072 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: Close
[0m09:38:20.316141 [debug] [Thread-1  ]: Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         ID
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql
[0m09:38:20.318724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2566b29a-e49d-4b69-80a1-aab38f54adc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb78190>]}
[0m09:38:20.319113 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_jaffle_shop_payments ........... [[31mERROR[0m in 0.07s]
[0m09:38:20.319417 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:20.319722 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.stg_jaffle_shop_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         ID
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql.
[0m09:38:20.320316 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:20.320503 [debug] [MainThread]: On master: BEGIN
[0m09:38:20.320648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:20.330397 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:38:20.330577 [debug] [MainThread]: On master: COMMIT
[0m09:38:20.330728 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:20.330865 [debug] [MainThread]: On master: COMMIT
[0m09:38:20.331657 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:38:20.331811 [debug] [MainThread]: On master: Close
[0m09:38:20.332029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:20.332168 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop_payments' was properly closed.
[0m09:38:20.332323 [info ] [MainThread]: 
[0m09:38:20.332486 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m09:38:20.332875 [debug] [MainThread]: Command end result
[0m09:38:20.351188 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:38:20.352636 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:38:20.360389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m09:38:20.360582 [info ] [MainThread]: 
[0m09:38:20.360789 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:38:20.360962 [info ] [MainThread]: 
[0m09:38:20.361169 [error] [MainThread]:   Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         ID
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql
[0m09:38:20.361327 [info ] [MainThread]: 
[0m09:38:20.361542 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:38:20.368637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7100898, "process_in_blocks": "0", "process_kernel_time": 0.180622, "process_mem_max_rss": "129744896", "process_out_blocks": "0", "process_user_time": 1.827956}
[0m09:38:20.368853 [debug] [MainThread]: Command `cli run` failed at 09:38:20.368809 after 1.71 seconds
[0m09:38:20.369044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109765a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba06400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba06130>]}
[0m09:38:20.369234 [debug] [MainThread]: Flushing usage events
[0m09:38:20.928890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:38.487036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510cdc0>]}


============================== 09:38:38.489738 | 3080eead-70db-4376-8573-3d4bbc94f0d0 ==============================
[0m09:38:38.489738 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:38.490027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:38.601348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c9e610>]}
[0m09:38:38.628405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7f6a0>]}
[0m09:38:38.629506 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:38.690900 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m09:38:38.757292 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:38:38.757555 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m09:38:38.757746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104563ca0>]}
[0m09:38:39.641246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143c10>]}
[0m09:38:39.698224 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:38:39.701719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:38:39.753724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb9970>]}
[0m09:38:39.754050 [info ] [MainThread]: Found 9 models, 9 seeds, 2 data tests, 9 sources, 549 macros
[0m09:38:39.754891 [info ] [MainThread]: 
[0m09:38:39.755070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:39.755221 [info ] [MainThread]: 
[0m09:38:39.755492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:39.755967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m09:38:39.820596 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m09:38:39.820819 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m09:38:39.820976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:39.843803 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m09:38:39.844524 [debug] [ThreadPool]: On list_dw: Close
[0m09:38:39.847727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m09:38:39.851627 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:38:39.851856 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m09:38:39.852004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:39.862621 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:38:39.862782 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:38:39.862931 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m09:38:39.867162 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:38:39.867839 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m09:38:39.868529 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m09:38:39.868799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m09:38:39.870413 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:38:39.870565 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m09:38:39.870695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:39.879139 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:38:39.879276 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:38:39.879418 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:38:39.882647 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:38:39.883174 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m09:38:39.883919 [debug] [ThreadPool]: On list_dw_public: Close
[0m09:38:39.887028 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:39.887183 [debug] [MainThread]: On master: BEGIN
[0m09:38:39.887309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:39.895621 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:38:39.895790 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:39.895990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:39.901796 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m09:38:39.902385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d5d400>]}
[0m09:38:39.902618 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:39.903261 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:39.903404 [debug] [MainThread]: On master: BEGIN
[0m09:38:39.904334 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:38:39.904479 [debug] [MainThread]: On master: COMMIT
[0m09:38:39.904617 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:39.904752 [debug] [MainThread]: On master: COMMIT
[0m09:38:39.905233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:39.905380 [debug] [MainThread]: On master: Close
[0m09:38:39.907882 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:39.908156 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop_payments .................... [RUN]
[0m09:38:39.908384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop_payments)
[0m09:38:39.908576 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:39.913581 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:39.914085 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:39.931735 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:39.932564 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:39.932735 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: BEGIN
[0m09:38:39.932887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:38:39.940980 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m09:38:39.941165 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:39.941336 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_payments"} */

  create view "dw"."public"."stg_jaffle_shop_payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."payments"
)
,

renamed as (
    select
        id
        -- orderid,
        -- paymentmethod,
        -- status,
        -- amount,
        -- created
    from source
)
select * from renamed
  );
[0m09:38:39.942191 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 14:         id
                 ^

[0m09:38:39.942356 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: ROLLBACK
[0m09:38:39.943044 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: Close
[0m09:38:39.947775 [debug] [Thread-1  ]: Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         id
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql
[0m09:38:39.948818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3080eead-70db-4376-8573-3d4bbc94f0d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110215e80>]}
[0m09:38:39.949123 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_jaffle_shop_payments ........... [[31mERROR[0m in 0.04s]
[0m09:38:39.949406 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:39.949695 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.stg_jaffle_shop_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         id
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql.
[0m09:38:39.950240 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:39.950406 [debug] [MainThread]: On master: BEGIN
[0m09:38:39.950545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:39.959722 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:38:39.959890 [debug] [MainThread]: On master: COMMIT
[0m09:38:39.960023 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:39.960147 [debug] [MainThread]: On master: COMMIT
[0m09:38:39.960718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:39.960856 [debug] [MainThread]: On master: Close
[0m09:38:39.961049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:39.961171 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop_payments' was properly closed.
[0m09:38:39.961319 [info ] [MainThread]: 
[0m09:38:39.961472 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m09:38:39.961858 [debug] [MainThread]: Command end result
[0m09:38:39.977803 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:38:39.980746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:38:39.983843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m09:38:39.983992 [info ] [MainThread]: 
[0m09:38:39.984197 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:38:39.984362 [info ] [MainThread]: 
[0m09:38:39.984554 [error] [MainThread]:   Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         id
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql
[0m09:38:39.984705 [info ] [MainThread]: 
[0m09:38:39.984863 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:38:39.986777 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5371968, "process_in_blocks": "0", "process_kernel_time": 0.171918, "process_mem_max_rss": "131366912", "process_out_blocks": "0", "process_user_time": 1.809753}
[0m09:38:39.986966 [debug] [MainThread]: Command `cli build` failed at 09:38:39.986928 after 1.54 seconds
[0m09:38:39.987368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c9e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548cee0>]}
[0m09:38:39.987616 [debug] [MainThread]: Flushing usage events
[0m09:38:40.467566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:58.177307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d71a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c18b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c18d60>]}


============================== 09:38:58.180398 | acbf91ee-e657-4e32-ad10-1739082b1244 ==============================
[0m09:38:58.180398 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:58.180693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:38:58.293744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e33250>]}
[0m09:38:58.321121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0c2b0>]}
[0m09:38:58.322769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:58.385193 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m09:38:58.456688 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:38:58.456989 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m09:38:58.457187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468b0d0>]}
[0m09:38:59.345431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105511190>]}
[0m09:38:59.413039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:38:59.415966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:38:59.444530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa9f40>]}
[0m09:38:59.444873 [info ] [MainThread]: Found 9 models, 9 seeds, 2 data tests, 9 sources, 549 macros
[0m09:38:59.445795 [info ] [MainThread]: 
[0m09:38:59.446006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:59.446231 [info ] [MainThread]: 
[0m09:38:59.446579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:59.447077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m09:38:59.507304 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m09:38:59.507561 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m09:38:59.508125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:59.524426 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m09:38:59.525127 [debug] [ThreadPool]: On list_dw: Close
[0m09:38:59.528419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m09:38:59.531617 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:38:59.531789 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m09:38:59.531924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:59.538796 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:38:59.538963 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:38:59.539128 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:38:59.541175 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m09:38:59.541732 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m09:38:59.542284 [debug] [ThreadPool]: On list_dw_public: Close
[0m09:38:59.542690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m09:38:59.544217 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:38:59.544376 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m09:38:59.544509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:59.550741 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:38:59.550880 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:38:59.551043 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m09:38:59.552927 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m09:38:59.553512 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m09:38:59.554024 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m09:38:59.557282 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:59.557433 [debug] [MainThread]: On master: BEGIN
[0m09:38:59.557557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:59.564128 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:38:59.564313 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:59.564502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:59.568370 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:38:59.568953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536d700>]}
[0m09:38:59.569201 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:59.569761 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:59.569907 [debug] [MainThread]: On master: BEGIN
[0m09:38:59.570766 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:38:59.570905 [debug] [MainThread]: On master: COMMIT
[0m09:38:59.571059 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:59.571183 [debug] [MainThread]: On master: COMMIT
[0m09:38:59.571660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:59.571800 [debug] [MainThread]: On master: Close
[0m09:38:59.574299 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:59.574563 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop_payments .................... [RUN]
[0m09:38:59.574791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.stg_jaffle_shop_payments)
[0m09:38:59.574977 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:59.579995 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:59.585756 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:59.604884 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:59.609720 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:59.609919 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: BEGIN
[0m09:38:59.610118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:38:59.616333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m09:38:59.616553 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:38:59.616726 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_payments"} */

  create view "dw"."public"."stg_jaffle_shop_payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."payments"
)
,

renamed as (
    select
        id
        -- orderid,
        -- paymentmethod,
        -- status,
        -- amount,
        -- created
    from source
)
select * from renamed
  );
[0m09:38:59.617394 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 14:         id
                 ^

[0m09:38:59.617609 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: ROLLBACK
[0m09:38:59.618080 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: Close
[0m09:38:59.622455 [debug] [Thread-1  ]: Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         id
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql
[0m09:38:59.623677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acbf91ee-e657-4e32-ad10-1739082b1244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482faf0>]}
[0m09:38:59.623991 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_jaffle_shop_payments ........... [[31mERROR[0m in 0.05s]
[0m09:38:59.624274 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:38:59.624550 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.stg_jaffle_shop_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         id
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql.
[0m09:38:59.625075 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:59.625228 [debug] [MainThread]: On master: BEGIN
[0m09:38:59.625363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:59.631263 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:38:59.631485 [debug] [MainThread]: On master: COMMIT
[0m09:38:59.631627 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:59.631753 [debug] [MainThread]: On master: COMMIT
[0m09:38:59.632227 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:59.632376 [debug] [MainThread]: On master: Close
[0m09:38:59.632587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:59.632727 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop_payments' was properly closed.
[0m09:38:59.632880 [info ] [MainThread]: 
[0m09:38:59.633037 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m09:38:59.633475 [debug] [MainThread]: Command end result
[0m09:38:59.650155 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:38:59.653188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:38:59.656558 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m09:38:59.656705 [info ] [MainThread]: 
[0m09:38:59.656897 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:38:59.657058 [info ] [MainThread]: 
[0m09:38:59.657326 [error] [MainThread]:   Database Error in model stg_jaffle_shop_payments (models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql)
  column "id" does not exist
  LINE 14:         id
                   ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop_v2/stg_jaffle_shop_payments.sql
[0m09:38:59.657499 [info ] [MainThread]: 
[0m09:38:59.657668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:38:59.659399 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5201998, "process_in_blocks": "0", "process_kernel_time": 0.175259, "process_mem_max_rss": "132694016", "process_out_blocks": "0", "process_user_time": 1.838962}
[0m09:38:59.659617 [debug] [MainThread]: Command `cli build` failed at 09:38:59.659575 after 1.52 seconds
[0m09:38:59.659830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d71a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537b5b0>]}
[0m09:38:59.660036 [debug] [MainThread]: Flushing usage events
[0m09:39:00.202267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:39:27.163748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f81bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f81d90>]}


============================== 09:39:27.166495 | a8e72a55-a962-446b-9c31-64af16cdb6e4 ==============================
[0m09:39:27.166495 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:39:27.166794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:39:27.265291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cbe50>]}
[0m09:39:27.293417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f63970>]}
[0m09:39:27.294470 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:39:27.355532 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m09:39:27.421832 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:39:27.422146 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m09:39:27.422353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b8df0>]}
[0m09:39:28.286755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b85970>]}
[0m09:39:28.348747 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:39:28.351837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:39:28.377336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057595e0>]}
[0m09:39:28.377662 [info ] [MainThread]: Found 9 models, 9 seeds, 2 data tests, 9 sources, 549 macros
[0m09:39:28.378486 [info ] [MainThread]: 
[0m09:39:28.378660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:39:28.378807 [info ] [MainThread]: 
[0m09:39:28.379056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:39:28.379481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m09:39:28.450190 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m09:39:28.450425 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m09:39:28.450565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:39:28.473455 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m09:39:28.474137 [debug] [ThreadPool]: On list_dw: Close
[0m09:39:28.477011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m09:39:28.480211 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:39:28.480381 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m09:39:28.480514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:28.490437 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:39:28.490590 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:39:28.490735 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m09:39:28.494431 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:39:28.495047 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m09:39:28.495719 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m09:39:28.495976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m09:39:28.497510 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:39:28.497652 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m09:39:28.497786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:28.505802 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:39:28.505951 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:39:28.506105 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:39:28.509133 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:39:28.509652 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m09:39:28.510296 [debug] [ThreadPool]: On list_dw_public: Close
[0m09:39:28.513299 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:28.513459 [debug] [MainThread]: On master: BEGIN
[0m09:39:28.513590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:39:28.520945 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:39:28.521125 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:28.521356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:39:28.526581 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m09:39:28.527299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10268d490>]}
[0m09:39:28.527551 [debug] [MainThread]: On master: ROLLBACK
[0m09:39:28.528090 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:28.528245 [debug] [MainThread]: On master: BEGIN
[0m09:39:28.529420 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:39:28.529598 [debug] [MainThread]: On master: COMMIT
[0m09:39:28.529769 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:28.529906 [debug] [MainThread]: On master: COMMIT
[0m09:39:28.530417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:39:28.530565 [debug] [MainThread]: On master: Close
[0m09:39:28.533008 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:39:28.533272 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop_payments .................... [RUN]
[0m09:39:28.533508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop_payments)
[0m09:39:28.533713 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:39:28.538442 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.539681 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:39:28.556751 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.558211 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.558382 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: BEGIN
[0m09:39:28.558536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:39:28.567496 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m09:39:28.567723 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.567895 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_payments"} */

  create view "dw"."public"."stg_jaffle_shop_payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."payments"
)
,

renamed as (
    select
        *
        -- orderid,
        -- paymentmethod,
        -- status,
        -- amount,
        -- created
    from source
)
select * from renamed
  );
[0m09:39:28.576513 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:39:28.580039 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.580237 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_payments"} */
alter table "dw"."public"."stg_jaffle_shop_payments__dbt_tmp" rename to "stg_jaffle_shop_payments"
[0m09:39:28.581384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:39:28.588344 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: COMMIT
[0m09:39:28.588521 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.588682 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: COMMIT
[0m09:39:28.590338 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m09:39:28.593339 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop_payments__dbt_backup"
[0m09:39:28.595346 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop_payments"
[0m09:39:28.595519 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop_payments"} */
drop view if exists "dw"."public"."stg_jaffle_shop_payments__dbt_backup" cascade
[0m09:39:28.596389 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m09:39:28.597503 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop_payments: Close
[0m09:39:28.598786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e72a55-a962-446b-9c31-64af16cdb6e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37850>]}
[0m09:39:28.599097 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop_payments ............... [[32mCREATE VIEW[0m in 0.06s]
[0m09:39:28.599372 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop_payments
[0m09:39:28.599894 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:28.600033 [debug] [MainThread]: On master: BEGIN
[0m09:39:28.600155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:39:28.608231 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:39:28.608451 [debug] [MainThread]: On master: COMMIT
[0m09:39:28.608603 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:28.608742 [debug] [MainThread]: On master: COMMIT
[0m09:39:28.609288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:39:28.609442 [debug] [MainThread]: On master: Close
[0m09:39:28.609685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:39:28.609825 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop_payments' was properly closed.
[0m09:39:28.609989 [info ] [MainThread]: 
[0m09:39:28.610145 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m09:39:28.610521 [debug] [MainThread]: Command end result
[0m09:39:28.627839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:39:28.630537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:39:28.633597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m09:39:28.633740 [info ] [MainThread]: 
[0m09:39:28.633936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:39:28.634133 [info ] [MainThread]: 
[0m09:39:28.634339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:39:28.636147 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5112427, "process_in_blocks": "0", "process_kernel_time": 0.184323, "process_mem_max_rss": "133300224", "process_out_blocks": "0", "process_user_time": 1.858211}
[0m09:39:28.636336 [debug] [MainThread]: Command `cli build` succeeded at 09:39:28.636297 after 1.51 seconds
[0m09:39:28.636504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104037430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cbe50>]}
[0m09:39:28.636674 [debug] [MainThread]: Flushing usage events
[0m09:39:29.143266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:29.472928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f04700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f04520>]}


============================== 09:50:29.475606 | b4a74fce-2c54-46f0-bf74-8fc1a3062966 ==============================
[0m09:50:29.475606 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:50:29.475895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:29.552657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a74fce-2c54-46f0-bf74-8fc1a3062966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107019e20>]}
[0m09:50:29.701556 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-07lsdnix'
[0m09:50:29.701891 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:50:29.804655 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:50:29.805102 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:50:29.855747 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:50:29.858174 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:50:30.292701 [info ] [MainThread]: Installed from version 1.3.0
[0m09:50:30.292996 [info ] [MainThread]: Up to date!
[0m09:50:30.293206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4a74fce-2c54-46f0-bf74-8fc1a3062966', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f96ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108098e20>]}
[0m09:50:30.295759 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86347216, "process_in_blocks": "0", "process_kernel_time": 0.178238, "process_mem_max_rss": "103890944", "process_out_blocks": "0", "process_user_time": 0.817626}
[0m09:50:30.296071 [debug] [MainThread]: Command `cli deps` succeeded at 09:50:30.296017 after 0.86 seconds
[0m09:50:30.296271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070190d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d89d0>]}
[0m09:50:30.296468 [debug] [MainThread]: Flushing usage events
[0m09:50:30.787190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:54.180318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b49760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b49580>]}


============================== 09:54:54.183046 | 485e7d93-c4b8-4db2-af1e-a1f05858b1d9 ==============================
[0m09:54:54.183046 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:54:54.183363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:54:54.288433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af4790>]}
[0m09:54:54.315746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e996a0>]}
[0m09:54:54.317369 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:54:54.377123 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:54:54.504979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:54.505202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:54.529897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109327130>]}
[0m09:54:54.578336 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:54:54.581229 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:54:54.597134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934bdf0>]}
[0m09:54:54.597434 [info ] [MainThread]: Found 9 seeds, 3 models, 3 sources, 549 macros
[0m09:54:54.597623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092eb730>]}
[0m09:54:54.598480 [info ] [MainThread]: 
[0m09:54:54.598662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:54.598811 [info ] [MainThread]: 
[0m09:54:54.599058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:54.601368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m09:54:54.671010 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m09:54:54.671288 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m09:54:54.671463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:54.694580 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m09:54:54.695294 [debug] [ThreadPool]: On list_dw: Close
[0m09:54:54.696213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m09:54:54.699343 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:54:54.699511 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m09:54:54.699642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:54.709280 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:54:54.709464 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m09:54:54.709625 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:54:54.714244 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:54:54.714856 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m09:54:54.715708 [debug] [ThreadPool]: On list_dw_public: Close
[0m09:54:54.715986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m09:54:54.717372 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:54:54.717523 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m09:54:54.717657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:54.725387 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:54:54.725548 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m09:54:54.725705 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m09:54:54.728250 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m09:54:54.728815 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m09:54:54.729481 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m09:54:54.732789 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:54.732948 [debug] [MainThread]: On master: BEGIN
[0m09:54:54.733087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:54.740361 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:54:54.740538 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:54.740746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:54.746271 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m09:54:54.747000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934e100>]}
[0m09:54:54.747251 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:54.747812 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:54.747964 [debug] [MainThread]: On master: BEGIN
[0m09:54:54.748772 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:54:54.748923 [debug] [MainThread]: On master: COMMIT
[0m09:54:54.749079 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:54.749220 [debug] [MainThread]: On master: COMMIT
[0m09:54:54.749697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:54:54.749848 [debug] [MainThread]: On master: Close
[0m09:54:54.752852 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.customers
[0m09:54:54.753124 [info ] [Thread-1  ]: 1 of 9 START seed file public_jaffle_shop.customers ............................ [RUN]
[0m09:54:54.753367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now seed.my_dbt_project.customers)
[0m09:54:54.753548 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.customers
[0m09:54:54.775461 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.customers
[0m09:54:54.791602 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m09:54:54.791838 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: BEGIN
[0m09:54:54.791999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:54.802140 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m09:54:54.802334 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m09:54:54.802498 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.customers"} */
truncate table "dw"."public_jaffle_shop"."customers"
[0m09:54:54.809911 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m09:54:54.842504 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m09:54:54.842711 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: 
          insert into "dw"."public_jaffle_shop"."customers" ("ID", "FIRST_NAME", "LAST_NAME") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m09:54:54.845153 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.002 seconds
[0m09:54:54.847668 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.customers"
[0m09:54:54.856203 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: COMMIT
[0m09:54:54.856392 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.customers"
[0m09:54:54.856552 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: COMMIT
[0m09:54:54.859056 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m09:54:54.859937 [debug] [Thread-1  ]: On seed.my_dbt_project.customers: Close
[0m09:54:54.861108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a23d0>]}
[0m09:54:54.861371 [info ] [Thread-1  ]: 1 of 9 OK loaded seed file public_jaffle_shop.customers ........................ [[32mINSERT 100[0m in 0.11s]
[0m09:54:54.861650 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.customers
[0m09:54:54.861828 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.orders
[0m09:54:54.862079 [info ] [Thread-1  ]: 2 of 9 START seed file public_jaffle_shop.orders ............................... [RUN]
[0m09:54:54.862308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.customers, now seed.my_dbt_project.orders)
[0m09:54:54.862467 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.orders
[0m09:54:54.862618 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.orders
[0m09:54:54.867235 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m09:54:54.867479 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: BEGIN
[0m09:54:54.867686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:54.877295 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m09:54:54.877530 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m09:54:54.877696 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.orders"} */
truncate table "dw"."public_jaffle_shop"."orders"
[0m09:54:54.881695 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m09:54:54.915037 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m09:54:54.915254 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: 
          insert into "dw"."public_jaffle_shop"."orders" ("ID", "USER_ID", "ORDER_DATE", "STATUS") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
[0m09:54:54.917759 [debug] [Thread-1  ]: SQL status: INSERT 0 99 in 0.002 seconds
[0m09:54:54.918114 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.orders"
[0m09:54:54.919371 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: COMMIT
[0m09:54:54.919561 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.orders"
[0m09:54:54.919728 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: COMMIT
[0m09:54:54.921891 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m09:54:54.922306 [debug] [Thread-1  ]: On seed.my_dbt_project.orders: Close
[0m09:54:54.922630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772ceb0>]}
[0m09:54:54.922882 [info ] [Thread-1  ]: 2 of 9 OK loaded seed file public_jaffle_shop.orders ........................... [[32mINSERT 99[0m in 0.06s]
[0m09:54:54.923154 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.orders
[0m09:54:54.923345 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.payments
[0m09:54:54.923619 [info ] [Thread-1  ]: 3 of 9 START seed file public_jaffle_shop.payments ............................. [RUN]
[0m09:54:54.923843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.orders, now seed.my_dbt_project.payments)
[0m09:54:54.924025 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.payments
[0m09:54:54.924198 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.payments
[0m09:54:54.929842 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m09:54:54.930030 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: BEGIN
[0m09:54:54.930185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:54.940990 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m09:54:54.941206 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m09:54:54.941369 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.payments"} */
truncate table "dw"."public_jaffle_shop"."payments"
[0m09:54:54.944669 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m09:54:55.007955 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m09:54:55.008216 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: 
          insert into "dw"."public_jaffle_shop"."payments" ("ID", "ORDERID", "PAYMENTMETHOD", "STATUS", "AMOUNT", "CREATED") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s...
[0m09:54:55.013692 [debug] [Thread-1  ]: SQL status: INSERT 0 120 in 0.005 seconds
[0m09:54:55.014000 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.payments"
[0m09:54:55.015251 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: COMMIT
[0m09:54:55.015448 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.payments"
[0m09:54:55.015633 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: COMMIT
[0m09:54:55.017582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m09:54:55.017942 [debug] [Thread-1  ]: On seed.my_dbt_project.payments: Close
[0m09:54:55.018237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b30c40>]}
[0m09:54:55.018482 [info ] [Thread-1  ]: 3 of 9 OK loaded seed file public_jaffle_shop.payments ......................... [[32mINSERT 120[0m in 0.09s]
[0m09:54:55.018827 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.payments
[0m09:54:55.019022 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_customers
[0m09:54:55.019278 [info ] [Thread-1  ]: 4 of 9 START seed file public_jaffle_shop.raw_customers ........................ [RUN]
[0m09:54:55.019484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.payments, now seed.my_dbt_project.raw_customers)
[0m09:54:55.019659 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_customers
[0m09:54:55.019825 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_customers
[0m09:54:55.024749 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m09:54:55.024980 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: BEGIN
[0m09:54:55.025151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:55.036485 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m09:54:55.036672 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m09:54:55.036829 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_customers"} */
truncate table "dw"."public_jaffle_shop"."raw_customers"
[0m09:54:55.040619 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m09:54:55.196286 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m09:54:55.196580 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: 
          insert into "dw"."public_jaffle_shop"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m09:54:55.205812 [debug] [Thread-1  ]: SQL status: INSERT 0 930 in 0.009 seconds
[0m09:54:55.206152 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_customers"
[0m09:54:55.207781 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m09:54:55.207953 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_customers"
[0m09:54:55.208108 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: COMMIT
[0m09:54:55.210666 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m09:54:55.210988 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_customers: Close
[0m09:54:55.211278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109867250>]}
[0m09:54:55.211518 [info ] [Thread-1  ]: 4 of 9 OK loaded seed file public_jaffle_shop.raw_customers .................... [[32mINSERT 930[0m in 0.19s]
[0m09:54:55.211791 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_customers
[0m09:54:55.211982 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_items
[0m09:54:55.212257 [info ] [Thread-1  ]: 5 of 9 START seed file public_jaffle_shop.raw_items ............................ [RUN]
[0m09:54:55.212519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_customers, now seed.my_dbt_project.raw_items)
[0m09:54:55.212702 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_items
[0m09:54:55.212863 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_items
[0m09:54:55.521064 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:54:55.521343 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: BEGIN
[0m09:54:55.521506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:55.531964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m09:54:55.532132 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:54:55.532290 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_items"} */

    create table "dw"."public_jaffle_shop"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m09:54:55.538533 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.006 seconds
[0m09:54:58.116428 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:54:58.116732 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:54:58.159061 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.042 seconds
[0m09:55:00.689906 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:00.690194 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:00.745945 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.056 seconds
[0m09:55:03.296121 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:03.296399 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:03.347790 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.051 seconds
[0m09:55:05.919874 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:05.920942 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:05.966942 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.046 seconds
[0m09:55:08.533700 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:08.534006 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:08.593321 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.059 seconds
[0m09:55:11.178362 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:11.178648 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:11.224860 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.046 seconds
[0m09:55:13.821059 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:13.821683 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:13.861663 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.040 seconds
[0m09:55:16.403684 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:16.403970 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:16.450235 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.046 seconds
[0m09:55:19.033752 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:19.034036 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:19.082436 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.048 seconds
[0m09:55:19.131169 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:19.131372 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: 
          insert into "dw"."public_jaffle_shop"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m09:55:19.133342 [debug] [Thread-1  ]: SQL status: INSERT 0 183 in 0.002 seconds
[0m09:55:19.133945 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_items"
[0m09:55:19.138062 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m09:55:19.138236 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_items"
[0m09:55:19.138389 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: COMMIT
[0m09:55:19.142376 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m09:55:19.142784 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_items: Close
[0m09:55:19.143071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b30c40>]}
[0m09:55:19.143310 [info ] [Thread-1  ]: 5 of 9 OK loaded seed file public_jaffle_shop.raw_items ........................ [[32mINSERT 90183[0m in 23.93s]
[0m09:55:19.143582 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_items
[0m09:55:19.143754 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_orders
[0m09:55:19.144018 [info ] [Thread-1  ]: 6 of 9 START seed file public_jaffle_shop.raw_orders ........................... [RUN]
[0m09:55:19.144277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_items, now seed.my_dbt_project.raw_orders)
[0m09:55:19.144449 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_orders
[0m09:55:19.144605 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_orders
[0m09:55:20.786183 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:20.786660 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: BEGIN
[0m09:55:20.786827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:55:20.800159 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m09:55:20.800393 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:20.800580 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_orders"} */

    create table "dw"."public_jaffle_shop"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m09:55:20.809311 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.008 seconds
[0m09:55:26.792574 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:26.793073 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:55:26.896639 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.103 seconds
[0m09:55:33.299508 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:33.301501 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:55:33.418628 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.116 seconds
[0m09:55:39.527534 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:39.527843 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:55:39.632701 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.105 seconds
[0m09:55:45.691766 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:45.692854 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:55:45.803774 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.111 seconds
[0m09:55:51.919985 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:51.920266 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:55:52.012920 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.092 seconds
[0m09:55:58.056616 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:55:58.057165 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:55:58.153391 [debug] [Thread-1  ]: SQL status: INSERT 0 10000 in 0.096 seconds
[0m09:56:00.105739 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:56:00.106033 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: 
          insert into "dw"."public_jaffle_shop"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m09:56:00.142149 [debug] [Thread-1  ]: SQL status: INSERT 0 3148 in 0.036 seconds
[0m09:56:00.143292 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_orders"
[0m09:56:00.145641 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m09:56:00.145880 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_orders"
[0m09:56:00.146060 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: COMMIT
[0m09:56:00.147710 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m09:56:00.148176 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_orders: Close
[0m09:56:00.148641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faea640>]}
[0m09:56:00.148962 [info ] [Thread-1  ]: 6 of 9 OK loaded seed file public_jaffle_shop.raw_orders ....................... [[32mINSERT 63148[0m in 41.00s]
[0m09:56:00.149262 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_orders
[0m09:56:00.149467 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_products
[0m09:56:00.149753 [info ] [Thread-1  ]: 7 of 9 START seed file public_jaffle_shop.raw_products ......................... [RUN]
[0m09:56:00.150108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_orders, now seed.my_dbt_project.raw_products)
[0m09:56:00.150365 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_products
[0m09:56:00.150573 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_products
[0m09:56:00.153783 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m09:56:00.153989 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: BEGIN
[0m09:56:00.154162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:56:00.162411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m09:56:00.162674 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m09:56:00.162860 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_products"} */

    create table "dw"."public_jaffle_shop"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m09:56:00.165233 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m09:56:00.170605 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m09:56:00.170807 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: 
          insert into "dw"."public_jaffle_shop"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m09:56:00.171656 [debug] [Thread-1  ]: SQL status: INSERT 0 10 in 0.001 seconds
[0m09:56:00.172057 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_products"
[0m09:56:00.173798 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m09:56:00.173995 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_products"
[0m09:56:00.174166 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: COMMIT
[0m09:56:00.174979 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m09:56:00.175384 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_products: Close
[0m09:56:00.175709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faea640>]}
[0m09:56:00.175987 [info ] [Thread-1  ]: 7 of 9 OK loaded seed file public_jaffle_shop.raw_products ..................... [[32mINSERT 10[0m in 0.03s]
[0m09:56:00.176273 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_products
[0m09:56:00.176468 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_stores
[0m09:56:00.176804 [info ] [Thread-1  ]: 8 of 9 START seed file public_jaffle_shop.raw_stores ........................... [RUN]
[0m09:56:00.177089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_products, now seed.my_dbt_project.raw_stores)
[0m09:56:00.177286 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_stores
[0m09:56:00.177461 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_stores
[0m09:56:00.180331 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m09:56:00.180518 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: BEGIN
[0m09:56:00.180668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:56:00.186940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m09:56:00.187193 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m09:56:00.187386 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_stores"} */

    create table "dw"."public_jaffle_shop"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m09:56:00.189423 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m09:56:00.192400 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m09:56:00.192582 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: 
          insert into "dw"."public_jaffle_shop"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m09:56:00.193665 [debug] [Thread-1  ]: SQL status: INSERT 0 6 in 0.001 seconds
[0m09:56:00.193996 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_stores"
[0m09:56:00.195369 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m09:56:00.195544 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_stores"
[0m09:56:00.195710 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: COMMIT
[0m09:56:00.196304 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m09:56:00.196727 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_stores: Close
[0m09:56:00.197077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa3340>]}
[0m09:56:00.197373 [info ] [Thread-1  ]: 8 of 9 OK loaded seed file public_jaffle_shop.raw_stores ....................... [[32mINSERT 6[0m in 0.02s]
[0m09:56:00.197662 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_stores
[0m09:56:00.197860 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.raw_supplies
[0m09:56:00.198189 [info ] [Thread-1  ]: 9 of 9 START seed file public_jaffle_shop.raw_supplies ......................... [RUN]
[0m09:56:00.198450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.my_dbt_project.raw_stores, now seed.my_dbt_project.raw_supplies)
[0m09:56:00.198639 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.raw_supplies
[0m09:56:00.198817 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.raw_supplies
[0m09:56:00.202583 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m09:56:00.202785 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: BEGIN
[0m09:56:00.202959 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:56:00.209266 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m09:56:00.209496 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m09:56:00.209674 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.my_dbt_project.raw_supplies"} */

    create table "dw"."public_jaffle_shop"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m09:56:00.211604 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.002 seconds
[0m09:56:00.240931 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m09:56:00.241144 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: 
          insert into "dw"."public_jaffle_shop"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,...
[0m09:56:00.242611 [debug] [Thread-1  ]: SQL status: INSERT 0 65 in 0.001 seconds
[0m09:56:00.242937 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.my_dbt_project.raw_supplies"
[0m09:56:00.244152 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m09:56:00.244327 [debug] [Thread-1  ]: Using postgres connection "seed.my_dbt_project.raw_supplies"
[0m09:56:00.244489 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: COMMIT
[0m09:56:00.245654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m09:56:00.245993 [debug] [Thread-1  ]: On seed.my_dbt_project.raw_supplies: Close
[0m09:56:00.246283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e7d93-c4b8-4db2-af1e-a1f05858b1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a3d30>]}
[0m09:56:00.246539 [info ] [Thread-1  ]: 9 of 9 OK loaded seed file public_jaffle_shop.raw_supplies ..................... [[32mINSERT 65[0m in 0.05s]
[0m09:56:00.246815 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.raw_supplies
[0m09:56:00.247375 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:00.247558 [debug] [MainThread]: On master: BEGIN
[0m09:56:00.247707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:00.254381 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:56:00.254614 [debug] [MainThread]: On master: COMMIT
[0m09:56:00.254794 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:00.254942 [debug] [MainThread]: On master: COMMIT
[0m09:56:00.255455 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:56:00.255608 [debug] [MainThread]: On master: Close
[0m09:56:00.255823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:00.255971 [debug] [MainThread]: Connection 'seed.my_dbt_project.raw_supplies' was properly closed.
[0m09:56:00.256147 [info ] [MainThread]: 
[0m09:56:00.256335 [info ] [MainThread]: Finished running 9 seeds in 0 hours 1 minutes and 5.66 seconds (65.66s).
[0m09:56:00.257181 [debug] [MainThread]: Command end result
[0m09:56:00.273032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m09:56:00.275393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m09:56:00.281515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m09:56:00.281710 [info ] [MainThread]: 
[0m09:56:00.281933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:00.282092 [info ] [MainThread]: 
[0m09:56:00.282262 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:56:00.284228 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 66.229805, "process_in_blocks": "0", "process_kernel_time": 0.455236, "process_mem_max_rss": "305643520", "process_out_blocks": "0", "process_user_time": 64.865685}
[0m09:56:00.284441 [debug] [MainThread]: Command `dbt seed` succeeded at 09:56:00.284402 after 66.23 seconds
[0m09:56:00.284622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093123d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe05dc0>]}
[0m09:56:00.284801 [debug] [MainThread]: Flushing usage events
[0m09:56:00.903562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:33.176076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109584490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095842b0>]}


============================== 10:10:33.179297 | 65c2535e-449f-48c0-a3f7-326c8291ebfe ==============================
[0m10:10:33.179297 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:33.179602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:10:33.250860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65c2535e-449f-48c0-a3f7-326c8291ebfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956b580>]}
[0m10:10:33.348903 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-pkexkzg2'
[0m10:10:33.349186 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:10:35.065468 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:10:35.065941 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:10:35.133031 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:10:35.135544 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:10:35.581252 [info ] [MainThread]: Installed from version 1.3.0
[0m10:10:35.581576 [info ] [MainThread]: Up to date!
[0m10:10:35.581819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65c2535e-449f-48c0-a3f7-326c8291ebfe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109684cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109715dc0>]}
[0m10:10:35.587070 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.5641208, "process_in_blocks": "0", "process_kernel_time": 0.162087, "process_mem_max_rss": "102563840", "process_out_blocks": "0", "process_user_time": 0.789069}
[0m10:10:35.587376 [debug] [MainThread]: Command `cli deps` succeeded at 10:10:35.587321 after 2.56 seconds
[0m10:10:35.587579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108640f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109684cd0>]}
[0m10:10:35.587778 [debug] [MainThread]: Flushing usage events
[0m10:10:36.095171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:29.602333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106565a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844550>]}


============================== 10:12:29.605251 | 27b6c3c3-4cfb-417a-bf47-61bff30073d8 ==============================
[0m10:12:29.605251 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:12:29.605628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:29.681559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b6c3c3-4cfb-417a-bf47-61bff30073d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c7490>]}
[0m10:12:29.728045 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-_31m0r51'
[0m10:12:29.728333 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:12:29.798297 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:12:29.798769 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:12:29.843149 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:12:29.846856 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:12:30.241883 [info ] [MainThread]: Installed from version 1.3.0
[0m10:12:30.242184 [info ] [MainThread]: Up to date!
[0m10:12:30.242405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27b6c3c3-4cfb-417a-bf47-61bff30073d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a44d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad8520>]}
[0m10:12:30.245090 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7729336, "process_in_blocks": "0", "process_kernel_time": 0.164519, "process_mem_max_rss": "103956480", "process_out_blocks": "0", "process_user_time": 0.750376}
[0m10:12:30.245402 [debug] [MainThread]: Command `cli deps` succeeded at 10:12:30.245343 after 0.77 seconds
[0m10:12:30.245606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106565a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a44d00>]}
[0m10:12:30.245810 [debug] [MainThread]: Flushing usage events
[0m10:12:30.767017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:35.011536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129847f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112984610>]}


============================== 10:14:35.014546 | 152f4fe9-e00e-45cf-a9a5-ddd434bd9942 ==============================
[0m10:14:35.014546 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:14:35.014948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:35.099215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '152f4fe9-e00e-45cf-a9a5-ddd434bd9942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296d700>]}
[0m10:14:35.154464 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-w02lo9ww'
[0m10:14:35.154736 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:14:35.228249 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:14:35.228739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:14:35.257995 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:14:35.261449 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:14:35.679251 [info ] [MainThread]: Installed from version 1.3.0
[0m10:14:35.679547 [info ] [MainThread]: Up to date!
[0m10:14:35.679767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '152f4fe9-e00e-45cf-a9a5-ddd434bd9942', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a84f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c180d0>]}
[0m10:14:35.682242 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8053849, "process_in_blocks": "0", "process_kernel_time": 0.17286, "process_mem_max_rss": "103448576", "process_out_blocks": "0", "process_user_time": 0.752765}
[0m10:14:35.682546 [debug] [MainThread]: Command `cli deps` succeeded at 10:14:35.682488 after 0.81 seconds
[0m10:14:35.682744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac61f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485bb20>]}
[0m10:14:35.682937 [debug] [MainThread]: Flushing usage events
[0m10:14:36.250057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:22.404645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c5610>]}


============================== 10:16:22.407360 | 2b586c6c-5808-4d1e-8f32-4a2e87c015eb ==============================
[0m10:16:22.407360 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:16:22.407711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:22.484862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b586c6c-5808-4d1e-8f32-4a2e87c015eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ade80>]}
[0m10:16:22.536872 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-kbdlvarl'
[0m10:16:22.537194 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:16:22.698450 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:16:22.699159 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:16:22.726589 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:16:22.732247 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:16:23.149975 [info ] [MainThread]: Installed from version 1.3.0
[0m10:16:23.150261 [info ] [MainThread]: Up to date!
[0m10:16:23.150500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b586c6c-5808-4d1e-8f32-4a2e87c015eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457f400>]}
[0m10:16:23.153258 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86023164, "process_in_blocks": "0", "process_kernel_time": 0.160009, "process_mem_max_rss": "103514112", "process_out_blocks": "0", "process_user_time": 0.744668}
[0m10:16:23.153544 [debug] [MainThread]: Command `cli deps` succeeded at 10:16:23.153489 after 0.86 seconds
[0m10:16:23.153746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105571cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ade80>]}
[0m10:16:23.153941 [debug] [MainThread]: Flushing usage events
[0m10:16:23.726380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:35.234414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875550>]}


============================== 10:18:35.236984 | 00937fc0-5bf9-42ac-8dd6-b8c847e47749 ==============================
[0m10:18:35.236984 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:18:35.237275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:18:35.310498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00937fc0-5bf9-42ac-8dd6-b8c847e47749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7490>]}
[0m10:18:35.365832 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-stca8tdm'
[0m10:18:35.366122 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:18:35.503799 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:18:35.504231 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:18:35.591089 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:18:35.595436 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:18:35.961091 [info ] [MainThread]: Installed from version 1.3.0
[0m10:18:35.961486 [info ] [MainThread]: Up to date!
[0m10:18:35.962193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '00937fc0-5bf9-42ac-8dd6-b8c847e47749', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106974d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a082e0>]}
[0m10:18:35.966115 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.77187955, "process_in_blocks": "0", "process_kernel_time": 0.153206, "process_mem_max_rss": "103432192", "process_out_blocks": "0", "process_user_time": 0.730089}
[0m10:18:35.966454 [debug] [MainThread]: Command `cli deps` succeeded at 10:18:35.966393 after 0.77 seconds
[0m10:18:35.966668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106974d00>]}
[0m10:18:35.966876 [debug] [MainThread]: Flushing usage events
[0m10:18:36.519685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:07.376097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105955a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b054f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b05310>]}


============================== 10:21:07.378674 | c7dc4fc1-6c53-4d0c-8069-2e5eed8bc850 ==============================
[0m10:21:07.378674 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:21:07.379123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:07.461761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7dc4fc1-6c53-4d0c-8069-2e5eed8bc850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae91f0>]}
[0m10:21:07.531565 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-gcosna9p'
[0m10:21:07.531855 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:21:08.901360 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:21:08.901955 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:21:08.959162 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:21:08.961838 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:21:09.378636 [info ] [MainThread]: Installed from version 1.3.0
[0m10:21:09.378942 [info ] [MainThread]: Up to date!
[0m10:21:09.379172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c7dc4fc1-6c53-4d0c-8069-2e5eed8bc850', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c04b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c98be0>]}
[0m10:21:09.383900 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.155081, "process_in_blocks": "0", "process_kernel_time": 0.168024, "process_mem_max_rss": "103415808", "process_out_blocks": "0", "process_user_time": 0.744748}
[0m10:21:09.384250 [debug] [MainThread]: Command `cli deps` succeeded at 10:21:09.384194 after 2.16 seconds
[0m10:21:09.384467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105955a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043949d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7bfd0>]}
[0m10:21:09.384672 [debug] [MainThread]: Flushing usage events
[0m10:21:09.872713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:04.090317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0b20>]}


============================== 10:24:04.093234 | dd81cd75-80f7-4771-a6ba-9b3cfe0e2e86 ==============================
[0m10:24:04.093234 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:24:04.093566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:04.179546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd81cd75-80f7-4771-a6ba-9b3cfe0e2e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c6ac0>]}
[0m10:24:04.233251 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-zkuxmzpq'
[0m10:24:04.233591 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:24:04.337905 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:24:04.338362 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:24:04.372828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:24:04.375550 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:24:04.800616 [info ] [MainThread]: Installed from version 1.3.0
[0m10:24:04.800904 [info ] [MainThread]: Up to date!
[0m10:24:04.801144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dd81cd75-80f7-4771-a6ba-9b3cfe0e2e86', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfe3a0>]}
[0m10:24:04.803702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed5b50>]}
[0m10:24:04.803986 [debug] [MainThread]: Flushing usage events
[0m10:28:37.714788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ec7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ec610>]}


============================== 10:28:37.717620 | d62f4cb5-6c8e-46cb-a1e2-f586ff1c0eea ==============================
[0m10:28:37.717620 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:28:37.717978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:28:37.790564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd62f4cb5-6c8e-46cb-a1e2-f586ff1c0eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d5e80>]}
[0m10:28:37.827873 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-9cmrnkm4'
[0m10:28:37.828195 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:28:37.953342 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:28:37.953995 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:28:38.080195 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:28:38.082757 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:28:38.525580 [info ] [MainThread]: Installed from version 1.3.0
[0m10:28:38.525890 [info ] [MainThread]: Up to date!
[0m10:28:38.526116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd62f4cb5-6c8e-46cb-a1e2-f586ff1c0eea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065940a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bb400>]}
[0m10:28:38.528816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9413709, "process_in_blocks": "0", "process_kernel_time": 0.148504, "process_mem_max_rss": "102907904", "process_out_blocks": "0", "process_user_time": 0.713386}
[0m10:28:38.529131 [debug] [MainThread]: Command `cli deps` succeeded at 10:28:38.529072 after 0.94 seconds
[0m10:28:38.529349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106498cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d5e80>]}
[0m10:28:38.529671 [debug] [MainThread]: Flushing usage events
[0m10:28:39.128074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:17.761322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11188ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11188ae20>]}


============================== 10:35:17.765483 | 16a8583d-a012-48be-8273-e553a8729d4b ==============================
[0m10:35:17.765483 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:35:17.765924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:17.847730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16a8583d-a012-48be-8273-e553a8729d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113012b0>]}
[0m10:35:17.907519 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-657s7njk'
[0m10:35:17.907819 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:35:18.582108 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:35:18.584044 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:35:19.331903 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:35:19.340396 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:35:20.409152 [info ] [MainThread]: Installed from version 1.3.0
[0m10:35:20.409426 [info ] [MainThread]: Up to date!
[0m10:35:20.409649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16a8583d-a012-48be-8273-e553a8729d4b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a99310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad4d90>]}
[0m10:35:20.414057 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7945497, "process_in_blocks": "0", "process_kernel_time": 0.177319, "process_mem_max_rss": "107282432", "process_out_blocks": "0", "process_user_time": 0.749555}
[0m10:35:20.414404 [debug] [MainThread]: Command `cli deps` succeeded at 10:35:20.414338 after 2.79 seconds
[0m10:35:20.414621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad4d90>]}
[0m10:35:20.414829 [debug] [MainThread]: Flushing usage events
[0m10:35:20.926857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:35.008431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119db2e0>]}


============================== 10:56:35.011694 | 5fe7d20a-7fde-48e3-98a6-d2d5a433e79f ==============================
[0m10:56:35.011694 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:56:35.011979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:56:35.087772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe7d20a-7fde-48e3-98a6-d2d5a433e79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111966df0>]}
[0m10:56:35.148636 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-0t0l9gf7'
[0m10:56:35.148920 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:56:35.262203 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:56:35.262620 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:56:35.307366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:56:35.310075 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:56:35.764859 [info ] [MainThread]: Installed from version 1.3.0
[0m10:56:35.765258 [info ] [MainThread]: Up to date!
[0m10:56:35.765887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5fe7d20a-7fde-48e3-98a6-d2d5a433e79f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111adb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b1f40>]}
[0m10:56:35.771917 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8818626, "process_in_blocks": "0", "process_kernel_time": 0.175044, "process_mem_max_rss": "105611264", "process_out_blocks": "0", "process_user_time": 0.828604}
[0m10:56:35.772309 [debug] [MainThread]: Command `cli deps` succeeded at 10:56:35.772242 after 0.88 seconds
[0m10:56:35.772551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c14e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111966df0>]}
[0m10:56:35.772774 [debug] [MainThread]: Flushing usage events
[0m10:56:36.286495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:24.979849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1b2b0>]}


============================== 10:57:24.983499 | 867a8891-b48b-4259-bd91-87f23722731b ==============================
[0m10:57:24.983499 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:57:24.983840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:25.056746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '867a8891-b48b-4259-bd91-87f23722731b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a07280>]}
[0m10:57:25.115901 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-f0zmrxsi'
[0m10:57:25.116182 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:57:25.190020 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:57:25.190476 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:57:25.212943 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:57:25.216146 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:57:25.578213 [info ] [MainThread]: Installed from version 1.3.0
[0m10:57:25.578520 [info ] [MainThread]: Up to date!
[0m10:57:25.578786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '867a8891-b48b-4259-bd91-87f23722731b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b97fd0>]}
[0m10:57:25.581566 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72648364, "process_in_blocks": "0", "process_kernel_time": 0.169147, "process_mem_max_rss": "106545152", "process_out_blocks": "0", "process_user_time": 0.756156}
[0m10:57:25.581859 [debug] [MainThread]: Command `cli deps` succeeded at 10:57:25.581805 after 0.73 seconds
[0m10:57:25.582233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b76910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109fb580>]}
[0m10:57:25.582564 [debug] [MainThread]: Flushing usage events
[0m10:57:26.096143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:30.914841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9b220>]}


============================== 11:47:30.918636 | dd43737e-730a-4a58-b1ca-663cc43f9753 ==============================
[0m11:47:30.918636 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:30.919014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:47:30.999610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd43737e-730a-4a58-b1ca-663cc43f9753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a87190>]}
[0m11:47:31.066560 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-xlhev93u'
[0m11:47:31.066845 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:47:31.188101 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:47:31.188602 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:47:31.237176 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:47:31.240113 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:47:31.673782 [info ] [MainThread]: Installed from version 1.3.0
[0m11:47:31.674130 [info ] [MainThread]: Up to date!
[0m11:47:31.674377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dd43737e-730a-4a58-b1ca-663cc43f9753', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b59d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105574c40>]}
[0m11:47:31.681778 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92034876, "process_in_blocks": "0", "process_kernel_time": 0.171973, "process_mem_max_rss": "106135552", "process_out_blocks": "0", "process_user_time": 0.738331}
[0m11:47:31.682155 [debug] [MainThread]: Command `cli deps` succeeded at 11:47:31.682096 after 0.92 seconds
[0m11:47:31.682376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9e820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a87730>]}
[0m11:47:31.682586 [debug] [MainThread]: Flushing usage events
[0m11:47:32.180623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:19.253613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a863a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d5b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d5b250>]}


============================== 11:53:19.257695 | e7b2fb61-ef71-4e23-849d-3a73a66284ab ==============================
[0m11:53:19.257695 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:53:19.258124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:19.342699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7b2fb61-ef71-4e23-849d-3a73a66284ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d3abb0>]}
[0m11:53:19.412691 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-ncsgoetm'
[0m11:53:19.412986 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:53:19.504547 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:53:19.505045 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:53:19.551704 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:53:19.555759 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:53:19.935435 [info ] [MainThread]: Installed from version 1.3.0
[0m11:53:19.935739 [info ] [MainThread]: Up to date!
[0m11:53:19.935974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e7b2fb61-ef71-4e23-849d-3a73a66284ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e5a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ed6cd0>]}
[0m11:53:19.940997 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8318386, "process_in_blocks": "0", "process_kernel_time": 0.170443, "process_mem_max_rss": "105988096", "process_out_blocks": "0", "process_user_time": 0.740139}
[0m11:53:19.941307 [debug] [MainThread]: Command `cli deps` succeeded at 11:53:19.941247 after 0.83 seconds
[0m11:53:19.941515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a863a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e7c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d3a610>]}
[0m11:53:19.941713 [debug] [MainThread]: Flushing usage events
[0m11:53:20.465370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:40.405778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c86370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae5e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae5e250>]}


============================== 19:40:40.409505 | 77589c77-163a-40ca-8c8b-43c80263f0f0 ==============================
[0m19:40:40.409505 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:40:40.409818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:40.518057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b060280>]}
[0m19:40:40.544500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7f0820>]}
[0m19:40:40.545461 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:40:40.655744 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:40:40.716710 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:40:40.716980 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m19:40:40.717306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e1310>]}
[0m19:40:41.474827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bd130>]}
[0m19:40:41.547724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:40:41.562573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:40:41.586863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2da400>]}
[0m19:40:41.587160 [info ] [MainThread]: Found 5 models, 9 seeds, 3 sources, 549 macros
[0m19:40:41.587335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b3220>]}
[0m19:40:41.587963 [info ] [MainThread]: 
[0m19:40:41.588139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:41.588335 [info ] [MainThread]: 
[0m19:40:41.588631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:41.589096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:40:41.652188 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:40:41.652452 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:40:41.652610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:41.678379 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m19:40:41.679094 [debug] [ThreadPool]: On list_dw: Close
[0m19:40:41.682144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m19:40:41.685637 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:40:41.685820 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:40:41.685967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:41.694997 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:40:41.695190 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:40:41.695352 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:40:41.701799 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m19:40:41.702531 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:40:41.703041 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:40:41.703326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m19:40:41.705449 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:40:41.705645 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:40:41.705801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:41.713043 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m19:40:41.713203 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:40:41.713355 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:41.716899 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m19:40:41.717572 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:40:41.718097 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:40:41.721381 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:41.721563 [debug] [MainThread]: On master: BEGIN
[0m19:40:41.721749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:41.729604 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m19:40:41.729818 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:41.730024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:41.738751 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m19:40:41.739501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108341400>]}
[0m19:40:41.739748 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:41.740276 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:41.740430 [debug] [MainThread]: On master: BEGIN
[0m19:40:41.741197 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:40:41.741338 [debug] [MainThread]: On master: COMMIT
[0m19:40:41.741479 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:41.741615 [debug] [MainThread]: On master: COMMIT
[0m19:40:41.742095 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:40:41.742237 [debug] [MainThread]: On master: Close
[0m19:40:41.744210 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__payments
[0m19:40:41.744514 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__payments ................... [RUN]
[0m19:40:41.744846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop__payments)
[0m19:40:41.745121 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__payments
[0m19:40:41.749724 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.750907 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__payments
[0m19:40:41.769064 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.769935 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.770119 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: BEGIN
[0m19:40:41.770275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:40:41.776352 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m19:40:41.776638 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.776840 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */

  create view "dw"."public"."stg_jaffle_shop__payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."payments"
)
,

renamed as (
    select
        "ID" as id,
        "ORDERID" as orderid,
        "PAYMENTMETHOD" as paymentmethod,
        "STATUS" as status,
        "AMOUNT" as amount,
        "CREATED" as created
    from source
)

select * from renamed
  );
[0m19:40:41.781653 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:40:41.786262 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.786472 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */
alter table "dw"."public"."stg_jaffle_shop__payments__dbt_tmp" rename to "stg_jaffle_shop__payments"
[0m19:40:41.787465 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:40:41.794808 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: COMMIT
[0m19:40:41.795008 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.795179 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: COMMIT
[0m19:40:41.796425 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:40:41.799842 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__payments__dbt_backup"
[0m19:40:41.801893 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m19:40:41.802066 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */
drop view if exists "dw"."public"."stg_jaffle_shop__payments__dbt_backup" cascade
[0m19:40:41.803415 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:40:41.804640 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: Close
[0m19:40:41.807614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77589c77-163a-40ca-8c8b-43c80263f0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b6c70>]}
[0m19:40:41.807972 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__payments .............. [[32mCREATE VIEW[0m in 0.06s]
[0m19:40:41.808255 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__payments
[0m19:40:41.808800 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:41.808959 [debug] [MainThread]: On master: BEGIN
[0m19:40:41.809096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:41.815027 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:40:41.815234 [debug] [MainThread]: On master: COMMIT
[0m19:40:41.815384 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:41.815529 [debug] [MainThread]: On master: COMMIT
[0m19:40:41.815995 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:40:41.816129 [debug] [MainThread]: On master: Close
[0m19:40:41.816321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:41.816470 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__payments' was properly closed.
[0m19:40:41.816623 [info ] [MainThread]: 
[0m19:40:41.816788 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m19:40:41.817191 [debug] [MainThread]: Command end result
[0m19:40:41.832862 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:40:41.835243 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:40:41.843655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:40:41.843832 [info ] [MainThread]: 
[0m19:40:41.844037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:41.844243 [info ] [MainThread]: 
[0m19:40:41.844457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:40:41.850577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5684806, "process_in_blocks": "0", "process_kernel_time": 0.173486, "process_mem_max_rss": "132005888", "process_out_blocks": "0", "process_user_time": 1.707616}
[0m19:40:41.850776 [debug] [MainThread]: Command `cli run` succeeded at 19:40:41.850735 after 1.57 seconds
[0m19:40:41.850966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c86370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109deae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b759700>]}
[0m19:40:41.851147 [debug] [MainThread]: Flushing usage events
[0m19:40:42.356867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:51.725948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f663d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1a1f0>]}


============================== 19:51:51.730816 | ef75a527-8c58-48a1-8fc9-c2d55e41bde2 ==============================
[0m19:51:51.730816 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:51:51.731270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:51:51.863554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef0970>]}
[0m19:51:51.891203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110edbdf0>]}
[0m19:51:51.892002 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:51:52.005955 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:51:52.067559 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:51:52.067869 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m19:51:52.068077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c03a0>]}
[0m19:51:52.821681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112596130>]}
[0m19:51:52.894643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:51:52.909512 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:51:52.930527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112290af0>]}
[0m19:51:52.930843 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m19:51:52.931028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122712e0>]}
[0m19:51:52.931666 [info ] [MainThread]: 
[0m19:51:52.931845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:52.932070 [info ] [MainThread]: 
[0m19:51:52.932338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:52.932782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:51:52.996505 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:51:52.996739 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:51:52.996876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:53.022340 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m19:51:53.023090 [debug] [ThreadPool]: On list_dw: Close
[0m19:51:53.026289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m19:51:53.030950 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:51:53.031212 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:51:53.031364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:53.038864 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m19:51:53.039080 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:51:53.039235 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:51:53.042697 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m19:51:53.043405 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:51:53.043880 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:51:53.044196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m19:51:53.046052 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:51:53.046238 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:51:53.046386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:53.053634 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m19:51:53.053903 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:51:53.054071 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:51:53.056856 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m19:51:53.057560 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:51:53.058105 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:51:53.061964 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:53.062222 [debug] [MainThread]: On master: BEGIN
[0m19:51:53.062358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:53.069791 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:51:53.070018 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:53.070222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:53.075489 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m19:51:53.076390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f0df0>]}
[0m19:51:53.076644 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:53.077329 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:53.077477 [debug] [MainThread]: On master: BEGIN
[0m19:51:53.078244 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:51:53.078431 [debug] [MainThread]: On master: COMMIT
[0m19:51:53.078577 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:53.078706 [debug] [MainThread]: On master: COMMIT
[0m19:51:53.079105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:53.079254 [debug] [MainThread]: On master: Close
[0m19:51:53.081586 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:51:53.081950 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__orders ..................... [RUN]
[0m19:51:53.082216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.stg_jaffle_shop__orders)
[0m19:51:53.082461 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:51:53.086976 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.087775 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:51:53.105685 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.106324 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.106495 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: BEGIN
[0m19:51:53.106654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:53.113504 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m19:51:53.113742 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.113911 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */

  create view "dw"."public"."stg_jaffle_shop__orders__dbt_tmp"
    
    
  as (
    -- filepath: /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_orders.sql
with source as (
    select * from "dw"."public_jaffle_shop"."orders"
)
,

renamed as (
    select
        "ID" as order_id,
        "USER_ID" as customer_id,
        "ORDER_DATE" as order_date,
        "STATUS" as status
    from source
)

select * from renamed
  );
[0m19:51:53.116076 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:51:53.120686 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.120992 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */
alter table "dw"."public"."stg_jaffle_shop__orders__dbt_tmp" rename to "stg_jaffle_shop__orders"
[0m19:51:53.122159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:53.129940 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: COMMIT
[0m19:51:53.130194 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.130356 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: COMMIT
[0m19:51:53.133283 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m19:51:53.136725 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__orders__dbt_backup"
[0m19:51:53.138806 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:51:53.138980 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */
drop view if exists "dw"."public"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m19:51:53.139679 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:51:53.140887 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: Close
[0m19:51:53.145347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef75a527-8c58-48a1-8fc9-c2d55e41bde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8e8b0>]}
[0m19:51:53.145677 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__orders ................ [[32mCREATE VIEW[0m in 0.06s]
[0m19:51:53.145956 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:51:53.146501 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:53.146647 [debug] [MainThread]: On master: BEGIN
[0m19:51:53.146768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:53.154179 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:51:53.154381 [debug] [MainThread]: On master: COMMIT
[0m19:51:53.154521 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:53.154649 [debug] [MainThread]: On master: COMMIT
[0m19:51:53.155133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:53.155276 [debug] [MainThread]: On master: Close
[0m19:51:53.155488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:53.155651 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__orders' was properly closed.
[0m19:51:53.155793 [info ] [MainThread]: 
[0m19:51:53.155947 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:51:53.156357 [debug] [MainThread]: Command end result
[0m19:51:53.171962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:51:53.174672 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:51:53.184924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:51:53.185112 [info ] [MainThread]: 
[0m19:51:53.185328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:53.185501 [info ] [MainThread]: 
[0m19:51:53.185781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:51:53.192078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6201012, "process_in_blocks": "0", "process_kernel_time": 0.193319, "process_mem_max_rss": "130875392", "process_out_blocks": "0", "process_user_time": 1.745147}
[0m19:51:53.192322 [debug] [MainThread]: Command `cli run` succeeded at 19:51:53.192275 after 1.62 seconds
[0m19:51:53.192526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f663d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106913100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112290f70>]}
[0m19:51:53.192737 [debug] [MainThread]: Flushing usage events
[0m19:51:53.693823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:55.851888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e463d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131e1f0>]}


============================== 19:51:55.854832 | e65444ff-ecd5-4c36-9154-13559a7f9135 ==============================
[0m19:51:55.854832 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:51:55.855220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:51:55.966328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f4970>]}
[0m19:51:55.992814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112dfdf0>]}
[0m19:51:55.993708 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:51:56.055454 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:51:56.166629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:56.166853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:56.192894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b09130>]}
[0m19:51:56.244902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:51:56.249272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:51:56.260763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ab040>]}
[0m19:51:56.261038 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m19:51:56.261231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af6f70>]}
[0m19:51:56.261883 [info ] [MainThread]: 
[0m19:51:56.262097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:56.262278 [info ] [MainThread]: 
[0m19:51:56.262571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:56.262960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:51:56.327401 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:51:56.327667 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:51:56.327829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:56.350474 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m19:51:56.351167 [debug] [ThreadPool]: On list_dw: Close
[0m19:51:56.353916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m19:51:56.377749 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:51:56.377975 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:51:56.378108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:56.389703 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m19:51:56.389859 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:51:56.390007 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:51:56.394713 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m19:51:56.395373 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:51:56.396377 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:51:56.396662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m19:51:56.398432 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:51:56.398576 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:51:56.398702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:56.407207 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m19:51:56.407351 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:51:56.407501 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:51:56.411766 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:51:56.412407 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:51:56.413021 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:51:56.416256 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:56.416438 [debug] [MainThread]: On master: BEGIN
[0m19:51:56.416592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:56.424263 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m19:51:56.424406 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:56.424596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:56.432677 [debug] [MainThread]: SQL status: SELECT 4 in 0.008 seconds
[0m19:51:56.433588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fd460>]}
[0m19:51:56.433823 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:56.434623 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:56.434787 [debug] [MainThread]: On master: BEGIN
[0m19:51:56.435686 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:51:56.435831 [debug] [MainThread]: On master: COMMIT
[0m19:51:56.435974 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:56.436115 [debug] [MainThread]: On master: COMMIT
[0m19:51:56.436685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:56.436834 [debug] [MainThread]: On master: Close
[0m19:51:56.438431 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:51:56.438715 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__customers .................. [RUN]
[0m19:51:56.438960 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop__customers)
[0m19:51:56.439142 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:51:56.443779 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.444426 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:51:56.463685 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.464459 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.464650 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: BEGIN
[0m19:51:56.464820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:56.471834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m19:51:56.472051 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.472236 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */

  create view "dw"."public"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."customers"
)
,

renamed as (
    select
        "ID" as id,
        "FIRST_NAME" as first_name,
        "LAST_NAME" as last_name
    from source
)

select * from renamed
  );
[0m19:51:56.474084 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:51:56.477618 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.477800 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:51:56.478692 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:56.485842 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:51:56.486022 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.486173 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:51:56.487597 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:51:56.490512 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__customers__dbt_backup"
[0m19:51:56.492449 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:51:56.492612 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:51:56.493497 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:51:56.494602 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: Close
[0m19:51:56.495668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e65444ff-ecd5-4c36-9154-13559a7f9135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112171910>]}
[0m19:51:56.495990 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__customers ............. [[32mCREATE VIEW[0m in 0.06s]
[0m19:51:56.496271 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:51:56.496798 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:56.496938 [debug] [MainThread]: On master: BEGIN
[0m19:51:56.497061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:56.504272 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:51:56.504428 [debug] [MainThread]: On master: COMMIT
[0m19:51:56.504562 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:56.504701 [debug] [MainThread]: On master: COMMIT
[0m19:51:56.505231 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:56.505364 [debug] [MainThread]: On master: Close
[0m19:51:56.505543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:56.505663 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__customers' was properly closed.
[0m19:51:56.505798 [info ] [MainThread]: 
[0m19:51:56.505953 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m19:51:56.506355 [debug] [MainThread]: Command end result
[0m19:51:56.521316 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:51:56.525659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:51:56.528954 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:51:56.529106 [info ] [MainThread]: 
[0m19:51:56.529302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:56.529489 [info ] [MainThread]: 
[0m19:51:56.529708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:51:56.531243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.714056, "process_in_blocks": "0", "process_kernel_time": 0.15744, "process_mem_max_rss": "124289024", "process_out_blocks": "0", "process_user_time": 1.101008}
[0m19:51:56.531459 [debug] [MainThread]: Command `cli run` succeeded at 19:51:56.531414 after 0.71 seconds
[0m19:51:56.531654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e463d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105887af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692f9a0>]}
[0m19:51:56.531830 [debug] [MainThread]: Flushing usage events
[0m19:51:57.011456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:27.244352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063363d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791f1f0>]}


============================== 19:53:27.248215 | 79836787-245f-4344-8930-386186a9389c ==============================
[0m19:53:27.248215 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:53:27.248569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:27.355610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ef970>]}
[0m19:53:27.382020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078dfdf0>]}
[0m19:53:27.383495 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:53:27.445406 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:53:27.502954 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:53:27.503228 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m19:53:27.503430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c43a0>]}
[0m19:53:28.329123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d6130>]}
[0m19:53:28.400899 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:53:28.404651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:53:28.421779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ce790>]}
[0m19:53:28.422109 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m19:53:28.422292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110466e50>]}
[0m19:53:28.422910 [info ] [MainThread]: 
[0m19:53:28.423077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:28.423222 [info ] [MainThread]: 
[0m19:53:28.423470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:53:28.423883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:53:28.487471 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:53:28.487714 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:53:28.487880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:28.510147 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m19:53:28.510786 [debug] [ThreadPool]: On list_dw: Close
[0m19:53:28.513520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m19:53:28.516997 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:53:28.517184 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:53:28.517324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:28.527594 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:53:28.527739 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:53:28.527886 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:53:28.531467 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m19:53:28.532057 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:53:28.532899 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:53:28.533166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m19:53:28.534737 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:53:28.534878 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:53:28.535003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:28.543084 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m19:53:28.543266 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:53:28.543423 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:53:28.546415 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m19:53:28.547068 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:53:28.547723 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:53:28.551101 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:28.551297 [debug] [MainThread]: On master: BEGIN
[0m19:53:28.551425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:28.558868 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:53:28.559013 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:28.559199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:53:28.566011 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m19:53:28.567007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b22ca0>]}
[0m19:53:28.567230 [debug] [MainThread]: On master: ROLLBACK
[0m19:53:28.567851 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:28.567993 [debug] [MainThread]: On master: BEGIN
[0m19:53:28.569265 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:53:28.569538 [debug] [MainThread]: On master: COMMIT
[0m19:53:28.569715 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:28.569854 [debug] [MainThread]: On master: COMMIT
[0m19:53:28.570309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:53:28.570459 [debug] [MainThread]: On master: Close
[0m19:53:28.572035 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:53:28.572336 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__customers .................. [RUN]
[0m19:53:28.572571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.stg_jaffle_shop__customers)
[0m19:53:28.572825 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:53:28.577596 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.578455 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:53:28.596033 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.596794 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.596960 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: BEGIN
[0m19:53:28.597111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:28.604686 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:53:28.604884 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.605054 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */

  create view "dw"."public"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."customers"
)
,

renamed as (
    select
        "ID" as id,
        "FIRST_NAME" as first_name,
        "LAST_NAME" as last_name
    from source
)

select * from renamed
  );
[0m19:53:28.608346 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:53:28.612534 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.612722 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m19:53:28.613580 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:53:28.615131 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.615294 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:53:28.615915 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:53:28.623760 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:53:28.623947 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.624097 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:53:28.625453 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:53:28.628397 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__customers__dbt_backup"
[0m19:53:28.630387 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:53:28.630551 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:53:28.634564 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m19:53:28.635813 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: Close
[0m19:53:28.637241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79836787-245f-4344-8930-386186a9389c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca7a00>]}
[0m19:53:28.637580 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__customers ............. [[32mCREATE VIEW[0m in 0.06s]
[0m19:53:28.637860 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:53:28.638421 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:28.638582 [debug] [MainThread]: On master: BEGIN
[0m19:53:28.638710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:28.645264 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:53:28.645452 [debug] [MainThread]: On master: COMMIT
[0m19:53:28.645602 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:28.645724 [debug] [MainThread]: On master: COMMIT
[0m19:53:28.646149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:53:28.646295 [debug] [MainThread]: On master: Close
[0m19:53:28.646485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:28.646629 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__customers' was properly closed.
[0m19:53:28.646779 [info ] [MainThread]: 
[0m19:53:28.646933 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:53:28.647325 [debug] [MainThread]: Command end result
[0m19:53:28.662794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:53:28.666062 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:53:28.669258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:53:28.669411 [info ] [MainThread]: 
[0m19:53:28.669609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:28.669812 [info ] [MainThread]: 
[0m19:53:28.670013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:53:28.671753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5530957, "process_in_blocks": "0", "process_kernel_time": 0.171908, "process_mem_max_rss": "131596288", "process_out_blocks": "0", "process_user_time": 1.778164}
[0m19:53:28.671938 [debug] [MainThread]: Command `cli run` succeeded at 19:53:28.671899 after 1.55 seconds
[0m19:53:28.672109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063363d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110152130>]}
[0m19:53:28.672275 [debug] [MainThread]: Flushing usage events
[0m19:53:29.156718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:35.975768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c423d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae6280>]}


============================== 19:56:35.979536 | b0dcd930-9243-4bf7-9113-7efa03a3c6d5 ==============================
[0m19:56:35.979536 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:56:35.979833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:56:36.088518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d110d0>]}
[0m19:56:36.115051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abc460>]}
[0m19:56:36.116704 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:56:36.180552 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:56:36.239086 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:56:36.239361 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m19:56:36.239622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658c3a0>]}
[0m19:56:37.016472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107667130>]}
[0m19:56:37.089808 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:56:37.092896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:56:37.112291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746c730>]}
[0m19:56:37.112554 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m19:56:37.112730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107441fa0>]}
[0m19:56:37.113401 [info ] [MainThread]: 
[0m19:56:37.113609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:37.113817 [info ] [MainThread]: 
[0m19:56:37.114140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:37.114558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:56:37.183956 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:56:37.184223 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:56:37.184385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:37.202183 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m19:56:37.202952 [debug] [ThreadPool]: On list_dw: Close
[0m19:56:37.206137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m19:56:37.209740 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:56:37.209940 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:56:37.210116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:37.228051 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:56:37.228316 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:56:37.228497 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:37.231230 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m19:56:37.231984 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:56:37.232501 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:56:37.232846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m19:56:37.234751 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:56:37.234919 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:56:37.235046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:37.242026 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m19:56:37.242259 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:56:37.242423 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:56:37.245271 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m19:56:37.246314 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:56:37.246983 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:56:37.250630 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.250877 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.251005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:37.259034 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m19:56:37.259287 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.259502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:37.263527 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m19:56:37.264671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107482100>]}
[0m19:56:37.264938 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:37.265518 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.265648 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.266437 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:56:37.266586 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.266719 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.266842 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.267299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:56:37.267479 [debug] [MainThread]: On master: Close
[0m19:56:37.269513 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:56:37.269768 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__orders ..................... [RUN]
[0m19:56:37.270008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.stg_jaffle_shop__orders)
[0m19:56:37.270201 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:56:37.274327 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.274923 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:56:37.292540 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.293293 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.293469 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: BEGIN
[0m19:56:37.293645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:37.299831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m19:56:37.300076 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.300276 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */

  create view "dw"."public"."stg_jaffle_shop__orders__dbt_tmp"
    
    
  as (
    -- filepath: /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/models/staging/jaffle_shop/stg_jaffle_shop_orders.sql
with source as (
    select * from "dw"."public_jaffle_shop"."orders"
)
,

renamed as (
    select
        "ID" as order_id,
        "USER_ID" as customer_id,
        "ORDER_DATE" as order_date,
        "STATUS" as status
    from source
)

select * from renamed
  );
[0m19:56:37.302095 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:56:37.306528 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.306744 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */
alter table "dw"."public"."stg_jaffle_shop__orders" rename to "stg_jaffle_shop__orders__dbt_backup"
[0m19:56:37.307510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:56:37.309041 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.309199 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */
alter table "dw"."public"."stg_jaffle_shop__orders__dbt_tmp" rename to "stg_jaffle_shop__orders"
[0m19:56:37.309821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:56:37.317804 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: COMMIT
[0m19:56:37.318016 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.318168 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: COMMIT
[0m19:56:37.320956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m19:56:37.324408 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__orders__dbt_backup"
[0m19:56:37.326466 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__orders"
[0m19:56:37.326652 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__orders"} */
drop view if exists "dw"."public"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m19:56:37.327923 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:56:37.329175 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__orders: Close
[0m19:56:37.330620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0dcd930-9243-4bf7-9113-7efa03a3c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e785b0>]}
[0m19:56:37.330997 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__orders ................ [[32mCREATE VIEW[0m in 0.06s]
[0m19:56:37.331278 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__orders
[0m19:56:37.331881 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.332051 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.332186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:37.338187 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:56:37.338389 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.338540 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.338670 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.339107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:56:37.339248 [debug] [MainThread]: On master: Close
[0m19:56:37.339453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:37.339598 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__orders' was properly closed.
[0m19:56:37.339736 [info ] [MainThread]: 
[0m19:56:37.339888 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m19:56:37.340334 [debug] [MainThread]: Command end result
[0m19:56:37.356424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:56:37.359987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:56:37.363807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:56:37.363964 [info ] [MainThread]: 
[0m19:56:37.364163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:37.364320 [info ] [MainThread]: 
[0m19:56:37.364538 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:56:37.366491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4304727, "process_in_blocks": "0", "process_kernel_time": 0.177718, "process_mem_max_rss": "132399104", "process_out_blocks": "0", "process_user_time": 1.735701}
[0m19:56:37.366702 [debug] [MainThread]: Command `cli run` succeeded at 19:56:37.366659 after 1.43 seconds
[0m19:56:37.366877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c423d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adc100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106514f10>]}
[0m19:56:37.367057 [debug] [MainThread]: Flushing usage events
[0m19:56:37.862362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:19.965558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9f250>]}


============================== 19:59:19.975385 | dc1a6067-53bf-42d5-9de6-fd9017a05e80 ==============================
[0m19:59:19.975385 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:59:19.975971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:59:20.167914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bb610>]}
[0m19:59:20.195054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107730580>]}
[0m19:59:20.200178 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:59:20.331527 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:59:20.393236 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:59:20.393511 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m19:59:20.393701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771da00>]}
[0m19:59:21.790673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108956130>]}
[0m19:59:21.874469 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:59:21.894173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:59:22.001161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876a460>]}
[0m19:59:22.001548 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m19:59:22.001766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f1820>]}
[0m19:59:22.002547 [info ] [MainThread]: 
[0m19:59:22.002754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:22.002930 [info ] [MainThread]: 
[0m19:59:22.003344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:22.003916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:59:22.582791 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:59:22.583230 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:59:22.583522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:22.628096 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.045 seconds
[0m19:59:22.629273 [debug] [ThreadPool]: On list_dw: Close
[0m19:59:22.634327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m19:59:22.639811 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:59:22.640100 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:59:22.640302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:22.653431 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m19:59:22.653773 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:59:22.654017 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:59:22.660339 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m19:59:22.661517 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:59:22.662349 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:59:22.662794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m19:59:22.665712 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:59:22.665937 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:59:22.666125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:22.675063 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:59:22.675336 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:59:22.675542 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:59:22.678733 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m19:59:22.679813 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:59:22.680532 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:59:22.685470 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:22.685737 [debug] [MainThread]: On master: BEGIN
[0m19:59:22.685991 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:22.694623 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:59:22.694858 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:22.695114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:59:22.702878 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m19:59:22.704283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089662b0>]}
[0m19:59:22.704610 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:22.705379 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:22.705591 [debug] [MainThread]: On master: BEGIN
[0m19:59:22.706571 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:59:22.706812 [debug] [MainThread]: On master: COMMIT
[0m19:59:22.707021 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:22.707219 [debug] [MainThread]: On master: COMMIT
[0m19:59:22.707745 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:22.707937 [debug] [MainThread]: On master: Close
[0m19:59:22.714698 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:22.715157 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__customers .................. [RUN]
[0m19:59:22.715503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop__customers)
[0m19:59:22.715752 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:22.721555 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.724055 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:22.745629 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.748842 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.749056 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: BEGIN
[0m19:59:22.749237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:22.757797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m19:59:22.758049 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.758248 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */

  create view "dw"."public"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."customers"
)
,

renamed as (
    select
        "ID" as id,
        "FIRST_NAME" as first_name,
        "LAST_NAME" as last_name
    from source
)

select * from renamed
  );
[0m19:59:22.761182 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:59:22.766189 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.766465 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m19:59:22.767547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:22.769541 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.769742 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:59:22.771318 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:22.780198 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:59:22.780429 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.780587 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:59:22.782763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m19:59:22.786029 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__customers__dbt_backup"
[0m19:59:22.788149 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:22.788321 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:59:22.791315 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m19:59:22.792637 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: Close
[0m19:59:22.797876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc1a6067-53bf-42d5-9de6-fd9017a05e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108078d60>]}
[0m19:59:22.798230 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__customers ............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:59:22.798512 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:22.799096 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:22.799277 [debug] [MainThread]: On master: BEGIN
[0m19:59:22.799422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:22.808850 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:59:22.809057 [debug] [MainThread]: On master: COMMIT
[0m19:59:22.809205 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:22.809351 [debug] [MainThread]: On master: COMMIT
[0m19:59:22.809888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:22.810040 [debug] [MainThread]: On master: Close
[0m19:59:22.810265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:22.810410 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__customers' was properly closed.
[0m19:59:22.810564 [info ] [MainThread]: 
[0m19:59:22.810720 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m19:59:22.811145 [debug] [MainThread]: Command end result
[0m19:59:22.828666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:59:22.832513 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:59:22.840275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:59:22.840441 [info ] [MainThread]: 
[0m19:59:22.840654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:22.840817 [info ] [MainThread]: 
[0m19:59:22.841045 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:59:22.847815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0577667, "process_in_blocks": "0", "process_kernel_time": 0.307762, "process_mem_max_rss": "129171456", "process_out_blocks": "0", "process_user_time": 2.141212}
[0m19:59:22.848068 [debug] [MainThread]: Command `cli run` succeeded at 19:59:22.848024 after 3.06 seconds
[0m19:59:22.848255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d31670>]}
[0m19:59:22.848440 [debug] [MainThread]: Flushing usage events
[0m19:59:23.347725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:54.605217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043463a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561f220>]}


============================== 19:59:54.609019 | 72aaa6d5-1368-41bf-a4b7-9d7f501b0615 ==============================
[0m19:59:54.609019 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:59:54.609321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:59:54.745729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055efa30>]}
[0m19:59:54.772796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc0e50>]}
[0m19:59:54.773516 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:59:54.837556 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m19:59:54.895635 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:59:54.895941 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m19:59:54.896157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059712e0>]}
[0m19:59:55.651386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d6130>]}
[0m19:59:55.724995 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:59:55.727987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:59:55.739724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dcd30>]}
[0m19:59:55.740018 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m19:59:55.740189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106179a30>]}
[0m19:59:55.740798 [info ] [MainThread]: 
[0m19:59:55.740963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:55.741109 [info ] [MainThread]: 
[0m19:59:55.741355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:55.741781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m19:59:55.811385 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m19:59:55.811616 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:59:55.811757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:55.836631 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m19:59:55.837381 [debug] [ThreadPool]: On list_dw: Close
[0m19:59:55.840231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m19:59:55.843872 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:59:55.844056 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m19:59:55.844187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:55.855771 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m19:59:55.855964 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m19:59:55.856130 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m19:59:55.861522 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m19:59:55.862192 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m19:59:55.862957 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m19:59:55.863230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m19:59:55.865182 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:59:55.865324 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m19:59:55.865452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:55.872560 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m19:59:55.872784 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m19:59:55.872948 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:59:55.876079 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m19:59:55.876823 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m19:59:55.877402 [debug] [ThreadPool]: On list_dw_public: Close
[0m19:59:55.880829 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:55.881006 [debug] [MainThread]: On master: BEGIN
[0m19:59:55.881189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:55.888154 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:59:55.888387 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:55.888587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:59:55.893048 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m19:59:55.894573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029e5430>]}
[0m19:59:55.894815 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:55.895508 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:55.895652 [debug] [MainThread]: On master: BEGIN
[0m19:59:55.896559 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:59:55.896711 [debug] [MainThread]: On master: COMMIT
[0m19:59:55.896859 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:55.896995 [debug] [MainThread]: On master: COMMIT
[0m19:59:55.897464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:55.897603 [debug] [MainThread]: On master: Close
[0m19:59:55.899928 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:55.900192 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_jaffle_shop__customers .................. [RUN]
[0m19:59:55.900436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop__customers)
[0m19:59:55.900627 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:55.904855 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.906074 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:55.923197 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.924508 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.924679 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: BEGIN
[0m19:59:55.924827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:55.934675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m19:59:55.934839 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.935004 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */

  create view "dw"."public"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."customers"
)
,

renamed as (
    select
        "ID" as customer_id,
        "FIRST_NAME" as first_name,
        "LAST_NAME" as last_name
    from source
)

select * from renamed
  );
[0m19:59:55.938165 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:59:55.942265 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.942445 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m19:59:55.943186 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:55.944790 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.944955 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
alter table "dw"."public"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:59:55.945629 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:55.953497 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:59:55.953683 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.953831 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: COMMIT
[0m19:59:55.956126 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m19:59:55.959015 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__customers__dbt_backup"
[0m19:59:55.960943 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__customers"
[0m19:59:55.961104 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__customers"} */
drop view if exists "dw"."public"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:59:55.963457 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m19:59:55.964607 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__customers: Close
[0m19:59:55.966080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72aaa6d5-1368-41bf-a4b7-9d7f501b0615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b1af0>]}
[0m19:59:55.966478 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_jaffle_shop__customers ............. [[32mCREATE VIEW[0m in 0.06s]
[0m19:59:55.966776 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__customers
[0m19:59:55.967308 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:55.967460 [debug] [MainThread]: On master: BEGIN
[0m19:59:55.967585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:55.974486 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m19:59:55.974662 [debug] [MainThread]: On master: COMMIT
[0m19:59:55.974798 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:55.974947 [debug] [MainThread]: On master: COMMIT
[0m19:59:55.975443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:55.975585 [debug] [MainThread]: On master: Close
[0m19:59:55.975808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:55.975953 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_jaffle_shop__customers' was properly closed.
[0m19:59:55.976156 [info ] [MainThread]: 
[0m19:59:55.976374 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m19:59:55.976744 [debug] [MainThread]: Command end result
[0m19:59:55.993085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m19:59:55.996079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m19:59:55.999347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m19:59:55.999493 [info ] [MainThread]: 
[0m19:59:55.999692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:55.999878 [info ] [MainThread]: 
[0m19:59:56.000076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:59:56.002126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4373797, "process_in_blocks": "0", "process_kernel_time": 0.183368, "process_mem_max_rss": "132579328", "process_out_blocks": "0", "process_user_time": 1.754851}
[0m19:59:56.002345 [debug] [MainThread]: Command `cli run` succeeded at 19:59:56.002300 after 1.44 seconds
[0m19:59:56.002538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043463a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eee190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eee0a0>]}
[0m19:59:56.002736 [debug] [MainThread]: Flushing usage events
[0m19:59:56.471502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:32.836489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fe400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a3220>]}


============================== 20:02:32.840247 | 3998ea34-7fb7-43b4-a7f9-08d792c6eac2 ==============================
[0m20:02:32.840247 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:02:32.840587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:02:32.964809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ab160>]}
[0m20:02:32.991706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e47f0>]}
[0m20:02:32.992841 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:02:33.058599 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m20:02:33.115180 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:02:33.115455 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m20:02:33.115639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108204c10>]}
[0m20:02:33.913548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109323130>]}
[0m20:02:33.987302 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:02:33.991821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:02:34.007471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913da90>]}
[0m20:02:34.007748 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m20:02:34.007921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913d940>]}
[0m20:02:34.008533 [info ] [MainThread]: 
[0m20:02:34.008702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:34.008848 [info ] [MainThread]: 
[0m20:02:34.009147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:34.009596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:02:34.080071 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:02:34.080319 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:02:34.080463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:34.110218 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.030 seconds
[0m20:02:34.110853 [debug] [ThreadPool]: On list_dw: Close
[0m20:02:34.113773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m20:02:34.117260 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:02:34.117433 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m20:02:34.117570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:34.126708 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:02:34.126876 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:02:34.127031 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m20:02:34.131551 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:02:34.132231 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m20:02:34.133452 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m20:02:34.133759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m20:02:34.135819 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:02:34.135978 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m20:02:34.136107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:34.145608 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:02:34.145819 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:02:34.145981 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:34.147678 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m20:02:34.148448 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m20:02:34.148967 [debug] [ThreadPool]: On list_dw_public: Close
[0m20:02:34.152445 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.152658 [debug] [MainThread]: On master: BEGIN
[0m20:02:34.152854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:34.160121 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:02:34.160283 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.160474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:34.167668 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m20:02:34.168688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920b550>]}
[0m20:02:34.168921 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:34.169460 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.169606 [debug] [MainThread]: On master: BEGIN
[0m20:02:34.170455 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:02:34.170595 [debug] [MainThread]: On master: COMMIT
[0m20:02:34.170738 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.170875 [debug] [MainThread]: On master: COMMIT
[0m20:02:34.171338 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:34.171482 [debug] [MainThread]: On master: Close
[0m20:02:34.174300 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_payment_orders
[0m20:02:34.174572 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_payment_orders ......................... [RUN]
[0m20:02:34.174805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_payment_orders)
[0m20:02:34.174997 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_payment_orders
[0m20:02:34.179481 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_payment_orders"
[0m20:02:34.180352 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_payment_orders
[0m20:02:34.200801 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_payment_orders"
[0m20:02:34.202126 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:02:34.202302 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: BEGIN
[0m20:02:34.202450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:34.209465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:02:34.209706 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:02:34.209899 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */

  
    

  create  table "dw"."public"."int_payment_orders__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)
,

payment_orders as (
    select
        orderid,
        max(created) as payment_finalized_date,
        sum(amount) / 100.0 as total_amount_paid
    from source
    where status <> 'fail'
    group by 1
)

select * from payment_orders
  );
  
[0m20:02:34.215580 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.005 seconds
[0m20:02:34.219039 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:02:34.219238 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
alter table "dw"."public"."int_payment_orders__dbt_tmp" rename to "int_payment_orders"
[0m20:02:34.220290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:02:34.228787 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: COMMIT
[0m20:02:34.228962 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:02:34.229114 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: COMMIT
[0m20:02:34.230025 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:02:34.233076 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_payment_orders__dbt_backup"
[0m20:02:34.235114 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:02:34.235275 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
drop table if exists "dw"."public"."int_payment_orders__dbt_backup" cascade
[0m20:02:34.235888 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:02:34.237074 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: Close
[0m20:02:34.238344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3998ea34-7fb7-43b4-a7f9-08d792c6eac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2aa90>]}
[0m20:02:34.238683 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.int_payment_orders .................... [[32mSELECT 99[0m in 0.06s]
[0m20:02:34.238967 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_payment_orders
[0m20:02:34.239493 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.239641 [debug] [MainThread]: On master: BEGIN
[0m20:02:34.239769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:34.246374 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:02:34.246594 [debug] [MainThread]: On master: COMMIT
[0m20:02:34.246740 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:34.246882 [debug] [MainThread]: On master: COMMIT
[0m20:02:34.247389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:34.247527 [debug] [MainThread]: On master: Close
[0m20:02:34.247732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:34.247891 [debug] [MainThread]: Connection 'model.my_dbt_project.int_payment_orders' was properly closed.
[0m20:02:34.248048 [info ] [MainThread]: 
[0m20:02:34.248201 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m20:02:34.248656 [debug] [MainThread]: Command end result
[0m20:02:34.264005 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:02:34.267805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:02:34.271015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m20:02:34.271158 [info ] [MainThread]: 
[0m20:02:34.271356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:34.271562 [info ] [MainThread]: 
[0m20:02:34.271759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:34.273803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4759057, "process_in_blocks": "0", "process_kernel_time": 0.205687, "process_mem_max_rss": "132317184", "process_out_blocks": "0", "process_user_time": 1.744213}
[0m20:02:34.274027 [debug] [MainThread]: Command `cli run` succeeded at 20:02:34.273985 after 1.48 seconds
[0m20:02:34.274208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fe400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a46fa0>]}
[0m20:02:34.274387 [debug] [MainThread]: Flushing usage events
[0m20:02:34.756468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:39.488495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d76430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1f250>]}


============================== 20:02:39.492157 | e6bbf2b8-c6ff-4d3c-80d0-52b04269187e ==============================
[0m20:02:39.492157 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:02:39.492444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m20:02:39.603882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f60730>]}
[0m20:02:39.630485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbe310>]}
[0m20:02:39.632200 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:02:39.696364 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m20:02:39.814399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:39.814626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:39.840540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107743130>]}
[0m20:02:39.889690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:02:39.893675 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:02:39.909537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107764d30>]}
[0m20:02:39.909821 [info ] [MainThread]: Found 6 models, 9 seeds, 3 sources, 549 macros
[0m20:02:39.909999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776ca90>]}
[0m20:02:39.910625 [info ] [MainThread]: 
[0m20:02:39.910798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:39.910947 [info ] [MainThread]: 
[0m20:02:39.911212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:39.911638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:02:39.977864 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:02:39.978149 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:02:39.978317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:40.004284 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m20:02:40.005001 [debug] [ThreadPool]: On list_dw: Close
[0m20:02:40.007864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m20:02:40.036464 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:02:40.036699 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m20:02:40.036836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:40.049104 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:02:40.049260 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:02:40.049409 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m20:02:40.054740 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m20:02:40.055478 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m20:02:40.056483 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m20:02:40.056788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m20:02:40.058598 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:02:40.058750 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m20:02:40.058877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:40.067382 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:02:40.067529 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:02:40.067675 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:40.070823 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:02:40.071397 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m20:02:40.072058 [debug] [ThreadPool]: On list_dw_public: Close
[0m20:02:40.075356 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:40.075531 [debug] [MainThread]: On master: BEGIN
[0m20:02:40.075660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:40.083755 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:02:40.083937 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:40.084141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:40.090329 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m20:02:40.091353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043094c0>]}
[0m20:02:40.091582 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:40.092119 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:40.092272 [debug] [MainThread]: On master: BEGIN
[0m20:02:40.093151 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:02:40.093344 [debug] [MainThread]: On master: COMMIT
[0m20:02:40.093504 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:40.093644 [debug] [MainThread]: On master: COMMIT
[0m20:02:40.094244 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:40.094390 [debug] [MainThread]: On master: Close
[0m20:02:40.096879 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_customer_orders
[0m20:02:40.097160 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_customer_orders ........................ [RUN]
[0m20:02:40.097388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_customer_orders)
[0m20:02:40.097579 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_customer_orders
[0m20:02:40.102346 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_customer_orders"
[0m20:02:40.103104 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_customer_orders
[0m20:02:40.123263 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_customer_orders"
[0m20:02:40.123991 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m20:02:40.124154 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: BEGIN
[0m20:02:40.124300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:40.133416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:02:40.133612 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m20:02:40.133799 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */

  
    

  create  table "dw"."public"."int_customer_orders__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dw"."public"."stg_jaffle_shop__customers"
)
,

orders as (
    select * from "dw"."public"."stg_jaffle_shop__orders"
)
,

customer_orders as (
    select
        c.customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(o.order_id) as number_of_orders
    from customers as c
    left join orders as o
        on c.customer_id = o.customer_id
    group by 1
)

select * from customer_orders
  );
  
[0m20:02:40.136407 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.002 seconds
[0m20:02:40.139944 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m20:02:40.140137 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */
alter table "dw"."public"."int_customer_orders__dbt_tmp" rename to "int_customer_orders"
[0m20:02:40.140800 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:02:40.149493 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: COMMIT
[0m20:02:40.149690 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m20:02:40.149844 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: COMMIT
[0m20:02:40.151484 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:02:40.154508 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_customer_orders__dbt_backup"
[0m20:02:40.156512 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m20:02:40.156673 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */
drop table if exists "dw"."public"."int_customer_orders__dbt_backup" cascade
[0m20:02:40.157719 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:02:40.158856 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: Close
[0m20:02:40.160121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6bbf2b8-c6ff-4d3c-80d0-52b04269187e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6c760>]}
[0m20:02:40.160426 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.int_customer_orders ................... [[32mSELECT 100[0m in 0.06s]
[0m20:02:40.160698 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_customer_orders
[0m20:02:40.161233 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:40.161394 [debug] [MainThread]: On master: BEGIN
[0m20:02:40.161528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:40.170543 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:02:40.170698 [debug] [MainThread]: On master: COMMIT
[0m20:02:40.170832 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:40.170953 [debug] [MainThread]: On master: COMMIT
[0m20:02:40.171522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:40.171650 [debug] [MainThread]: On master: Close
[0m20:02:40.171833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:40.171950 [debug] [MainThread]: Connection 'model.my_dbt_project.int_customer_orders' was properly closed.
[0m20:02:40.172092 [info ] [MainThread]: 
[0m20:02:40.172247 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:02:40.172676 [debug] [MainThread]: Command end result
[0m20:02:40.188242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:02:40.191431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:02:40.194640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m20:02:40.194801 [info ] [MainThread]: 
[0m20:02:40.195034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:40.195211 [info ] [MainThread]: 
[0m20:02:40.195476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:40.197017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.74657786, "process_in_blocks": "0", "process_kernel_time": 0.179913, "process_mem_max_rss": "120733696", "process_out_blocks": "0", "process_user_time": 1.101883}
[0m20:02:40.197232 [debug] [MainThread]: Command `cli run` succeeded at 20:02:40.197187 after 0.75 seconds
[0m20:02:40.197420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d76430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c39d90>]}
[0m20:02:40.197595 [debug] [MainThread]: Flushing usage events
[0m20:02:40.674395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:28.361198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b72310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17250>]}


============================== 20:07:28.365080 | b8652ba7-53ee-460c-b6b9-d889836a560f ==============================
[0m20:07:28.365080 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:07:28.365413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m20:07:28.482116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10248c580>]}
[0m20:07:28.508941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c585e0>]}
[0m20:07:28.510114 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:07:28.575264 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m20:07:28.633057 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:07:28.633350 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m20:07:28.633579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044914f0>]}
[0m20:07:29.380415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105596130>]}
[0m20:07:29.462364 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:07:29.467639 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:07:29.486475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105394610>]}
[0m20:07:29.486857 [info ] [MainThread]: Found 7 models, 9 seeds, 3 sources, 549 macros
[0m20:07:29.487119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053476a0>]}
[0m20:07:29.487914 [info ] [MainThread]: 
[0m20:07:29.488096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:29.488245 [info ] [MainThread]: 
[0m20:07:29.488500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:29.488942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:07:29.556412 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:07:29.556637 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:07:29.556773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.582060 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m20:07:29.582756 [debug] [ThreadPool]: On list_dw: Close
[0m20:07:29.585589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m20:07:29.588884 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:07:29.589053 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m20:07:29.589186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.599367 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:07:29.599570 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:07:29.599721 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m20:07:29.604134 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:07:29.604799 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m20:07:29.605643 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m20:07:29.605931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m20:07:29.608047 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:07:29.608274 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m20:07:29.608434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.615340 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:07:29.615549 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:07:29.615699 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:07:29.618200 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m20:07:29.619024 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m20:07:29.619721 [debug] [ThreadPool]: On list_dw_public: Close
[0m20:07:29.623340 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.623506 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.623723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:29.633020 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:07:29.633405 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.633703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:29.640588 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m20:07:29.641920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105017be0>]}
[0m20:07:29.642200 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:29.642965 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.643106 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.643956 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:07:29.644105 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.644237 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.644363 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.644911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:07:29.645053 [debug] [MainThread]: On master: Close
[0m20:07:29.647020 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_payment_orders
[0m20:07:29.647332 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_payment_orders ......................... [RUN]
[0m20:07:29.647597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_payment_orders)
[0m20:07:29.647787 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_payment_orders
[0m20:07:29.652166 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_payment_orders"
[0m20:07:29.652799 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_payment_orders
[0m20:07:29.672823 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_payment_orders"
[0m20:07:29.673876 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:07:29.674062 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: BEGIN
[0m20:07:29.674217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:07:29.681316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:07:29.681549 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:07:29.681718 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */

  
    

  create  table "dw"."public"."int_payment_orders__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)
,

payment_orders as (
    select
        order_id,
        max(created) as payment_finalized_date,
        sum(amount) / 100.0 as total_amount_paid
    from source
    where status <> 'fail'
    group by 1
)

select * from payment_orders
  );
  
[0m20:07:29.682429 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "order_id" does not exist
LINE 19:         order_id,
                 ^
HINT:  Perhaps you meant to reference the column "source.orderid".

[0m20:07:29.682612 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: ROLLBACK
[0m20:07:29.683100 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: Close
[0m20:07:29.722245 [debug] [Thread-1  ]: Database Error in model int_payment_orders (models/intermediate/sales/int_payment_orders.sql)
  column "order_id" does not exist
  LINE 19:         order_id,
                   ^
  HINT:  Perhaps you meant to reference the column "source.orderid".
  compiled code at target/run/my_dbt_project/models/intermediate/sales/int_payment_orders.sql
[0m20:07:29.723592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8652ba7-53ee-460c-b6b9-d889836a560f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105864430>]}
[0m20:07:29.723960 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.int_payment_orders ................ [[31mERROR[0m in 0.08s]
[0m20:07:29.724262 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_payment_orders
[0m20:07:29.724543 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.int_payment_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_payment_orders (models/intermediate/sales/int_payment_orders.sql)
  column "order_id" does not exist
  LINE 19:         order_id,
                   ^
  HINT:  Perhaps you meant to reference the column "source.orderid".
  compiled code at target/run/my_dbt_project/models/intermediate/sales/int_payment_orders.sql.
[0m20:07:29.725135 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.725288 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.725423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:29.733464 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:07:29.733670 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.733819 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.733960 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.734419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:07:29.734567 [debug] [MainThread]: On master: Close
[0m20:07:29.734786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:29.734924 [debug] [MainThread]: Connection 'model.my_dbt_project.int_payment_orders' was properly closed.
[0m20:07:29.735077 [info ] [MainThread]: 
[0m20:07:29.735235 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m20:07:29.735663 [debug] [MainThread]: Command end result
[0m20:07:29.751870 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:07:29.753970 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:07:29.758195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m20:07:29.758393 [info ] [MainThread]: 
[0m20:07:29.758585 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:07:29.758798 [info ] [MainThread]: 
[0m20:07:29.759022 [error] [MainThread]:   Database Error in model int_payment_orders (models/intermediate/sales/int_payment_orders.sql)
  column "order_id" does not exist
  LINE 19:         order_id,
                   ^
  HINT:  Perhaps you meant to reference the column "source.orderid".
  compiled code at target/run/my_dbt_project/models/intermediate/sales/int_payment_orders.sql
[0m20:07:29.759187 [info ] [MainThread]: 
[0m20:07:29.759357 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:07:29.761039 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4393194, "process_in_blocks": "0", "process_kernel_time": 0.187576, "process_mem_max_rss": "130678784", "process_out_blocks": "0", "process_user_time": 1.731133}
[0m20:07:29.761225 [debug] [MainThread]: Command `cli run` failed at 20:07:29.761186 after 1.44 seconds
[0m20:07:29.761400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b72310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1ffd0>]}
[0m20:07:29.761572 [debug] [MainThread]: Flushing usage events
[0m20:07:30.239965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:14.483265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058763d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730de20>]}


============================== 20:08:14.487014 | 5d58be54-e7c2-4e02-aefe-8b73d60c880a ==============================
[0m20:08:14.487014 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:08:14.487300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:08:14.607556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f4970>]}
[0m20:08:14.634259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dfdf0>]}
[0m20:08:14.635859 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:08:14.699008 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m20:08:14.785788 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:08:14.786075 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m20:08:14.786282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc46a0>]}
[0m20:08:15.585598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd89d0>]}
[0m20:08:15.658943 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:08:15.662807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:08:15.681142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e305b0>]}
[0m20:08:15.681420 [info ] [MainThread]: Found 7 models, 9 seeds, 3 sources, 549 macros
[0m20:08:15.681592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d51fa0>]}
[0m20:08:15.682214 [info ] [MainThread]: 
[0m20:08:15.682377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:15.682524 [info ] [MainThread]: 
[0m20:08:15.682830 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:08:15.683257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:08:15.749900 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:08:15.750125 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:08:15.750262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:15.773596 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m20:08:15.774253 [debug] [ThreadPool]: On list_dw: Close
[0m20:08:15.777059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m20:08:15.780486 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:08:15.780648 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m20:08:15.780778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:15.788038 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:08:15.788244 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:08:15.788416 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m20:08:15.791934 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m20:08:15.792626 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m20:08:15.793146 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m20:08:15.793417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m20:08:15.795375 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:08:15.795534 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m20:08:15.795691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:15.802335 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:08:15.802515 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:08:15.802658 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:08:15.805203 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m20:08:15.805901 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m20:08:15.806396 [debug] [ThreadPool]: On list_dw_public: Close
[0m20:08:15.809960 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:15.810136 [debug] [MainThread]: On master: BEGIN
[0m20:08:15.810335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:15.818820 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:08:15.818982 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:15.819171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:08:15.825548 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m20:08:15.826586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcbfa0>]}
[0m20:08:15.826815 [debug] [MainThread]: On master: ROLLBACK
[0m20:08:15.827398 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:15.827543 [debug] [MainThread]: On master: BEGIN
[0m20:08:15.828379 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:08:15.828542 [debug] [MainThread]: On master: COMMIT
[0m20:08:15.828684 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:15.828813 [debug] [MainThread]: On master: COMMIT
[0m20:08:15.829263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:08:15.829483 [debug] [MainThread]: On master: Close
[0m20:08:15.832007 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_payment_orders
[0m20:08:15.832281 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_payment_orders ......................... [RUN]
[0m20:08:15.832506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_payment_orders)
[0m20:08:15.832692 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_payment_orders
[0m20:08:15.837909 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_payment_orders"
[0m20:08:15.841891 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_payment_orders
[0m20:08:15.862063 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_payment_orders"
[0m20:08:15.865702 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:15.865891 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: BEGIN
[0m20:08:15.866045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:15.874028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:08:15.874192 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:15.874356 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */

  
    

  create  table "dw"."public"."int_payment_orders__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)
,

payment_orders as (
    select
        order_id,
        max(created) as payment_finalized_date,
        sum(amount) / 100.0 as total_amount_paid
    from source
    where status <> 'fail'
    group by 1
)

select * from payment_orders
  );
  
[0m20:08:15.875377 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "order_id" does not exist
LINE 19:         order_id,
                 ^
HINT:  Perhaps you meant to reference the column "source.orderid".

[0m20:08:15.875540 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: ROLLBACK
[0m20:08:15.876206 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: Close
[0m20:08:15.881414 [debug] [Thread-1  ]: Database Error in model int_payment_orders (models/intermediate/sales/int_payment_orders.sql)
  column "order_id" does not exist
  LINE 19:         order_id,
                   ^
  HINT:  Perhaps you meant to reference the column "source.orderid".
  compiled code at target/run/my_dbt_project/models/intermediate/sales/int_payment_orders.sql
[0m20:08:15.882633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d58be54-e7c2-4e02-aefe-8b73d60c880a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad15b0>]}
[0m20:08:15.882960 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.int_payment_orders ................ [[31mERROR[0m in 0.05s]
[0m20:08:15.883240 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_payment_orders
[0m20:08:15.883522 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.int_payment_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_payment_orders (models/intermediate/sales/int_payment_orders.sql)
  column "order_id" does not exist
  LINE 19:         order_id,
                   ^
  HINT:  Perhaps you meant to reference the column "source.orderid".
  compiled code at target/run/my_dbt_project/models/intermediate/sales/int_payment_orders.sql.
[0m20:08:15.884065 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:15.884238 [debug] [MainThread]: On master: BEGIN
[0m20:08:15.884371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:15.892702 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:08:15.892880 [debug] [MainThread]: On master: COMMIT
[0m20:08:15.893022 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:15.893148 [debug] [MainThread]: On master: COMMIT
[0m20:08:15.893531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:08:15.893676 [debug] [MainThread]: On master: Close
[0m20:08:15.893887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:15.894021 [debug] [MainThread]: Connection 'model.my_dbt_project.int_payment_orders' was properly closed.
[0m20:08:15.894172 [info ] [MainThread]: 
[0m20:08:15.894332 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:08:15.894730 [debug] [MainThread]: Command end result
[0m20:08:15.910028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:08:15.913974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:08:15.917269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m20:08:15.917441 [info ] [MainThread]: 
[0m20:08:15.917636 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:08:15.917802 [info ] [MainThread]: 
[0m20:08:15.917995 [error] [MainThread]:   Database Error in model int_payment_orders (models/intermediate/sales/int_payment_orders.sql)
  column "order_id" does not exist
  LINE 19:         order_id,
                   ^
  HINT:  Perhaps you meant to reference the column "source.orderid".
  compiled code at target/run/my_dbt_project/models/intermediate/sales/int_payment_orders.sql
[0m20:08:15.918153 [info ] [MainThread]: 
[0m20:08:15.918355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:08:15.920112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4739314, "process_in_blocks": "0", "process_kernel_time": 0.184978, "process_mem_max_rss": "133578752", "process_out_blocks": "0", "process_user_time": 1.75815}
[0m20:08:15.920296 [debug] [MainThread]: Command `cli run` failed at 20:08:15.920258 after 1.47 seconds
[0m20:08:15.920471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058763d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ddb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e30610>]}
[0m20:08:15.920640 [debug] [MainThread]: Flushing usage events
[0m20:08:16.402877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:41.799517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106486370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732b2b0>]}


============================== 20:08:41.802458 | eff85fe9-9953-4f33-9d6a-ff9c8cc1052d ==============================
[0m20:08:41.802458 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:08:41.802746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m20:08:41.914631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075752b0>]}
[0m20:08:41.940956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cbf70>]}
[0m20:08:41.942589 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:08:42.004530 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m20:08:42.063070 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:08:42.063371 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m20:08:42.063653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dad310>]}
[0m20:08:42.833687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e69ee0>]}
[0m20:08:42.906332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:08:42.909864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:08:42.962947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b190>]}
[0m20:08:42.963256 [info ] [MainThread]: Found 7 models, 9 seeds, 3 sources, 549 macros
[0m20:08:42.964241 [info ] [MainThread]: 
[0m20:08:42.964428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:42.964647 [info ] [MainThread]: 
[0m20:08:42.964982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:08:42.967889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:08:43.035532 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:08:43.035759 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:08:43.035899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:43.059399 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m20:08:43.060164 [debug] [ThreadPool]: On list_dw: Close
[0m20:08:43.061560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m20:08:43.065865 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:08:43.066088 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m20:08:43.066240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:43.074030 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:08:43.074272 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:08:43.074434 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m20:08:43.078066 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m20:08:43.078760 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m20:08:43.079290 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m20:08:43.079574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m20:08:43.080967 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:08:43.081730 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m20:08:43.081873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:43.089715 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:08:43.089916 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:08:43.090071 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:08:43.093323 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:08:43.094003 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m20:08:43.094516 [debug] [ThreadPool]: On list_dw_public: Close
[0m20:08:43.098390 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:43.098581 [debug] [MainThread]: On master: BEGIN
[0m20:08:43.098734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:43.105184 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:08:43.105362 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:43.105538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:08:43.113110 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m20:08:43.114217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715cbe0>]}
[0m20:08:43.114440 [debug] [MainThread]: On master: ROLLBACK
[0m20:08:43.114991 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:43.115129 [debug] [MainThread]: On master: BEGIN
[0m20:08:43.116010 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:08:43.116148 [debug] [MainThread]: On master: COMMIT
[0m20:08:43.116296 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:43.116426 [debug] [MainThread]: On master: COMMIT
[0m20:08:43.116944 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:08:43.117089 [debug] [MainThread]: On master: Close
[0m20:08:43.119402 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_jaffle_shop__payments
[0m20:08:43.119685 [info ] [Thread-1  ]: 1 of 2 START sql view model public.stg_jaffle_shop__payments ................... [RUN]
[0m20:08:43.119934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.stg_jaffle_shop__payments)
[0m20:08:43.120125 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_jaffle_shop__payments
[0m20:08:43.124530 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.127191 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_jaffle_shop__payments
[0m20:08:43.145162 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.149129 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.149301 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: BEGIN
[0m20:08:43.149465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:43.156350 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:08:43.156586 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.156758 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */

  create view "dw"."public"."stg_jaffle_shop__payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dw"."public_jaffle_shop"."payments"
)
,

renamed as (
    select
        "ID" as id,
        "ORDERID" as order_id,
        "PAYMENTMETHOD" as paymentmethod,
        "STATUS" as status,
        "AMOUNT" as amount,
        "CREATED" as created
    from source
)

select * from renamed
  );
[0m20:08:43.159743 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:08:43.163365 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.163542 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */
alter table "dw"."public"."stg_jaffle_shop__payments" rename to "stg_jaffle_shop__payments__dbt_backup"
[0m20:08:43.164232 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:08:43.165864 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.166046 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */
alter table "dw"."public"."stg_jaffle_shop__payments__dbt_tmp" rename to "stg_jaffle_shop__payments"
[0m20:08:43.166633 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:08:43.174919 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: COMMIT
[0m20:08:43.175089 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.175241 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: COMMIT
[0m20:08:43.178245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:08:43.181362 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_jaffle_shop__payments__dbt_backup"
[0m20:08:43.183367 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_jaffle_shop__payments"
[0m20:08:43.183532 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.stg_jaffle_shop__payments"} */
drop view if exists "dw"."public"."stg_jaffle_shop__payments__dbt_backup" cascade
[0m20:08:43.184870 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:08:43.186056 [debug] [Thread-1  ]: On model.my_dbt_project.stg_jaffle_shop__payments: Close
[0m20:08:43.187509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2ca0>]}
[0m20:08:43.187884 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.stg_jaffle_shop__payments .............. [[32mCREATE VIEW[0m in 0.07s]
[0m20:08:43.188174 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_jaffle_shop__payments
[0m20:08:43.188524 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_payment_orders
[0m20:08:43.188781 [info ] [Thread-1  ]: 2 of 2 START sql table model public.int_payment_orders ......................... [RUN]
[0m20:08:43.189029 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_jaffle_shop__payments, now model.my_dbt_project.int_payment_orders)
[0m20:08:43.189205 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_payment_orders
[0m20:08:43.190747 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_payment_orders"
[0m20:08:43.193979 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_payment_orders
[0m20:08:43.204786 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_payment_orders"
[0m20:08:43.206182 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:43.206379 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: BEGIN
[0m20:08:43.206543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:43.213239 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:08:43.213482 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:43.213664 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */

  
    

  create  table "dw"."public"."int_payment_orders__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)
,

payment_orders as (
    select
        order_id,
        max(created) as payment_finalized_date,
        sum(amount) / 100.0 as total_amount_paid
    from source
    where status <> 'fail'
    group by 1
)

select * from payment_orders
  );
  
[0m20:08:43.218981 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.005 seconds
[0m20:08:43.221042 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:43.221221 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
alter table "dw"."public"."int_payment_orders" rename to "int_payment_orders__dbt_backup"
[0m20:08:43.221863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:08:43.223394 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:43.223554 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
alter table "dw"."public"."int_payment_orders__dbt_tmp" rename to "int_payment_orders"
[0m20:08:43.224124 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:08:43.227252 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: COMMIT
[0m20:08:43.227417 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:43.227566 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: COMMIT
[0m20:08:43.228970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:08:43.230296 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_payment_orders__dbt_backup"
[0m20:08:43.231407 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m20:08:43.231571 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
drop table if exists "dw"."public"."int_payment_orders__dbt_backup" cascade
[0m20:08:43.233394 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:08:43.234045 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: Close
[0m20:08:43.234341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eff85fe9-9953-4f33-9d6a-ff9c8cc1052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083eef40>]}
[0m20:08:43.234678 [info ] [Thread-1  ]: 2 of 2 OK created sql table model public.int_payment_orders .................... [[32mSELECT 99[0m in 0.05s]
[0m20:08:43.234964 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_payment_orders
[0m20:08:43.235519 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:43.235670 [debug] [MainThread]: On master: BEGIN
[0m20:08:43.235807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:43.242687 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:08:43.242888 [debug] [MainThread]: On master: COMMIT
[0m20:08:43.243034 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:43.243160 [debug] [MainThread]: On master: COMMIT
[0m20:08:43.243581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:08:43.243730 [debug] [MainThread]: On master: Close
[0m20:08:43.243951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:43.244093 [debug] [MainThread]: Connection 'model.my_dbt_project.int_payment_orders' was properly closed.
[0m20:08:43.244253 [info ] [MainThread]: 
[0m20:08:43.244423 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m20:08:43.244923 [debug] [MainThread]: Command end result
[0m20:08:43.260516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:08:43.263871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:08:43.267105 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m20:08:43.267251 [info ] [MainThread]: 
[0m20:08:43.267446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:43.267616 [info ] [MainThread]: 
[0m20:08:43.267870 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:08:43.269665 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5084578, "process_in_blocks": "0", "process_kernel_time": 0.183677, "process_mem_max_rss": "134955008", "process_out_blocks": "0", "process_user_time": 1.750141}
[0m20:08:43.269863 [debug] [MainThread]: Command `cli build` succeeded at 20:08:43.269821 after 1.51 seconds
[0m20:08:43.270037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106486370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065eadf0>]}
[0m20:08:43.270213 [debug] [MainThread]: Flushing usage events
[0m20:08:43.801004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:11.089509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955b250>]}


============================== 20:17:11.093472 | 1406deac-a908-4ab8-82c3-8ffb62f14ee2 ==============================
[0m20:17:11.093472 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:17:11.093887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m20:17:11.179893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1406deac-a908-4ab8-82c3-8ffb62f14ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095484c0>]}
[0m20:17:11.231869 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-vjf1_24q'
[0m20:17:11.232209 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:17:11.303445 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:17:11.303995 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:17:11.361043 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:17:11.369972 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m20:17:11.553605 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m20:17:11.581331 [info ] [MainThread]: Updating lock file in file path: /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/package-lock.yml
[0m20:17:11.644050 [debug] [MainThread]: Set downloads directory='/var/folders/j5/kts5lcfn54l1vxnfxq_dg8_w0000gn/T/dbt-downloads-g5rlio9w'
[0m20:17:11.647753 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:17:12.006869 [info ] [MainThread]: Installed from version 1.3.0
[0m20:17:12.007180 [info ] [MainThread]: Up to date!
[0m20:17:12.007401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1406deac-a908-4ab8-82c3-8ffb62f14ee2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108708a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889adf0>]}
[0m20:17:12.007626 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m20:17:12.307443 [info ] [MainThread]: Installed from version 1.0.0
[0m20:17:12.307751 [info ] [MainThread]: Up to date!
[0m20:17:12.307970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1406deac-a908-4ab8-82c3-8ffb62f14ee2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108708a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109894a60>]}
[0m20:17:12.310355 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3618355, "process_in_blocks": "0", "process_kernel_time": 0.235717, "process_mem_max_rss": "105365504", "process_out_blocks": "0", "process_user_time": 0.780083}
[0m20:17:12.310642 [debug] [MainThread]: Command `dbt deps` succeeded at 20:17:12.310583 after 1.36 seconds
[0m20:17:12.310848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bd3a0>]}
[0m20:17:12.311049 [debug] [MainThread]: Flushing usage events
[0m20:17:12.779709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:52.899755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da02e0>]}


============================== 20:22:52.902344 | 1f0cf3de-53cc-45ec-9e01-61da4de54585 ==============================
[0m20:22:52.902344 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:22:52.902653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select package:dbt_project_evaluator dbt_project_evaluator_exceptions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:22:53.021814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7bfa0>]}
[0m20:22:53.048360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa9f70>]}
[0m20:22:53.049387 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:22:53.227314 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:22:53.297433 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:22:53.297740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104702b80>]}
[0m20:22:55.375548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107469ac0>]}
[0m20:22:55.456204 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:22:55.468627 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:22:55.550078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074117c0>]}
[0m20:22:55.550435 [info ] [MainThread]: Found 55 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m20:22:55.554017 [info ] [MainThread]: 
[0m20:22:55.554215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:55.554374 [info ] [MainThread]: 
[0m20:22:55.554644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:55.559149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m20:22:56.149861 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m20:22:56.150494 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:22:56.150800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:56.342452 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.191 seconds
[0m20:22:56.344800 [debug] [ThreadPool]: On list_dw: Close
[0m20:22:56.353257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m20:22:56.362826 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:22:56.363115 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m20:22:56.363277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:56.371399 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:22:56.371702 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m20:22:56.371893 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m20:22:56.374628 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m20:22:56.375569 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m20:22:56.376096 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m20:22:56.376438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m20:22:56.379033 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:22:56.379222 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m20:22:56.379366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:56.386039 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:22:56.386253 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m20:22:56.386407 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:22:56.388118 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m20:22:56.388876 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m20:22:56.389384 [debug] [ThreadPool]: On list_dw_public: Close
[0m20:22:56.394896 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:56.395119 [debug] [MainThread]: On master: BEGIN
[0m20:22:56.395257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:56.403769 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:22:56.404048 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:56.404262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:56.409078 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m20:22:56.410237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.410520 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:56.411153 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:56.411346 [debug] [MainThread]: On master: BEGIN
[0m20:22:56.412374 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:22:56.412551 [debug] [MainThread]: On master: COMMIT
[0m20:22:56.412713 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:56.412860 [debug] [MainThread]: On master: COMMIT
[0m20:22:56.413311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:56.413475 [debug] [MainThread]: On master: Close
[0m20:22:56.423303 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_exposure_relationships
[0m20:22:56.423672 [info ] [Thread-1  ]: 1 of 78 START sql table model public.base_exposure_relationships ............... [RUN]
[0m20:22:56.423977 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.dbt_project_evaluator.base_exposure_relationships)
[0m20:22:56.424176 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_exposure_relationships
[0m20:22:56.430717 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.432089 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_exposure_relationships
[0m20:22:56.455494 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.457035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.457722 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: BEGIN
[0m20:22:56.458769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.470074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m20:22:56.470404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.470638 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */

  
    

  create  table "dw"."public"."base_exposure_relationships__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as resource_id,
    cast(null as TEXT) as direct_parent_id,
    cast(True as boolean) as is_primary_relationship

from dummy_cte
where false
  );
  
[0m20:22:56.475317 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:56.480569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.480904 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */
alter table "dw"."public"."base_exposure_relationships__dbt_tmp" rename to "base_exposure_relationships"
[0m20:22:56.482216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.530484 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: COMMIT
[0m20:22:56.530781 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.530971 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: COMMIT
[0m20:22:56.531991 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.535439 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_exposure_relationships__dbt_backup"
[0m20:22:56.537882 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m20:22:56.538173 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */
drop table if exists "dw"."public"."base_exposure_relationships__dbt_backup" cascade
[0m20:22:56.539057 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:56.540468 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: Close
[0m20:22:56.546085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.546505 [info ] [Thread-1  ]: 1 of 78 OK created sql table model public.base_exposure_relationships .......... [[32mSELECT 0[0m in 0.12s]
[0m20:22:56.546806 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_exposure_relationships
[0m20:22:56.547013 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_metric_relationships
[0m20:22:56.547291 [info ] [Thread-1  ]: 2 of 78 START sql table model public.base_metric_relationships ................. [RUN]
[0m20:22:56.547586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_exposure_relationships, now model.dbt_project_evaluator.base_metric_relationships)
[0m20:22:56.547772 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_metric_relationships
[0m20:22:56.550666 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.551157 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_metric_relationships
[0m20:22:56.553662 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.554563 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.554786 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: BEGIN
[0m20:22:56.554965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.563556 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:22:56.563865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.564079 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */

  
    

  create  table "dw"."public"."base_metric_relationships__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as resource_id,
    cast(null as TEXT) as direct_parent_id,
    cast(True as boolean) as is_primary_relationship

from dummy_cte
where false
  );
  
[0m20:22:56.567067 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m20:22:56.569210 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.569425 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */
alter table "dw"."public"."base_metric_relationships__dbt_tmp" rename to "base_metric_relationships"
[0m20:22:56.570131 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.571911 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: COMMIT
[0m20:22:56.572107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.572280 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: COMMIT
[0m20:22:56.573153 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.575249 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_metric_relationships__dbt_backup"
[0m20:22:56.575630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m20:22:56.575798 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */
drop table if exists "dw"."public"."base_metric_relationships__dbt_backup" cascade
[0m20:22:56.576394 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:56.577015 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: Close
[0m20:22:56.577330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.577759 [info ] [Thread-1  ]: 2 of 78 OK created sql table model public.base_metric_relationships ............ [[32mSELECT 0[0m in 0.03s]
[0m20:22:56.578080 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_metric_relationships
[0m20:22:56.578289 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_node_columns
[0m20:22:56.578565 [info ] [Thread-1  ]: 3 of 78 START sql table model public.base_node_columns ......................... [RUN]
[0m20:22:56.578843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_metric_relationships, now model.dbt_project_evaluator.base_node_columns)
[0m20:22:56.579029 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_node_columns
[0m20:22:56.582849 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.583462 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_node_columns
[0m20:22:56.585822 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.586510 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.586727 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: BEGIN
[0m20:22:56.586912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.594297 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:56.594616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.594836 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */

  
    

  create  table "dw"."public"."base_node_columns__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as node_unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as description,
    cast(null as TEXT) as data_type,
    cast(null as TEXT) as constraints,
    cast(True as boolean) as has_not_null_constraint,
    cast(0 as integer) as constraints_count,
    cast(null as TEXT) as quote

from dummy_cte
where false
  );
  
[0m20:22:56.598418 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m20:22:56.600673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.600905 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
alter table "dw"."public"."base_node_columns__dbt_tmp" rename to "base_node_columns"
[0m20:22:56.601783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.612467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.612760 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
insert into "dw"."public"."base_node_columns" values 
(
  
    'model.dbt_project_evaluator.fct_documentation_coverage'
  
, 

  
    'documentation_coverage_pct'
  
, 

  
    'the number of models in the project with a description divided by the total number of models in the project'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'model.dbt_project_evaluator.fct_test_coverage'
  
, 

  
    'test_to_model_ratio'
  
, 

  
    'the total number of tests in the project divided by the total number of models in the project'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'model.dbt_project_evaluator.fct_test_coverage'
  
, 

  
    'test_coverage_pct'
  
, 

  
    'the number of models in the project with at least one test configured divided by the total number of models in the project'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'fct_name'
  
, 

  
    'Name of the fact table to define exceptions.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'column_name'
  
, 

  
    'Column name from fct_name to define exceptions.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'id_to_exclude'
  
, 

  
    'Values (or like pattern) to exclude for column_name.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'comment'
  
, 

  
    'Field to document why a given exception is legitimate.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
);
[0m20:22:56.614277 [debug] [Thread-1  ]: SQL status: INSERT 0 7 in 0.001 seconds
[0m20:22:56.614939 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: COMMIT
[0m20:22:56.615105 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.615256 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: COMMIT
[0m20:22:56.616271 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.617747 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_node_columns__dbt_backup"
[0m20:22:56.618129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m20:22:56.618295 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
drop table if exists "dw"."public"."base_node_columns__dbt_backup" cascade
[0m20:22:56.618865 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:56.619480 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: Close
[0m20:22:56.619776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.620106 [info ] [Thread-1  ]: 3 of 78 OK created sql table model public.base_node_columns .................... [[32mSELECT 0[0m in 0.04s]
[0m20:22:56.620387 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_node_columns
[0m20:22:56.620580 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_node_relationships
[0m20:22:56.620887 [info ] [Thread-1  ]: 4 of 78 START sql table model public.base_node_relationships ................... [RUN]
[0m20:22:56.621154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_node_columns, now model.dbt_project_evaluator.base_node_relationships)
[0m20:22:56.621346 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_node_relationships
[0m20:22:56.623955 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.624506 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_node_relationships
[0m20:22:56.626819 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.627309 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.627475 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: BEGIN
[0m20:22:56.627660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.644532 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m20:22:56.644814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.645005 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */

  
    

  create  table "dw"."public"."base_node_relationships__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as resource_id,
    cast(null as TEXT) as direct_parent_id,
    cast(True as boolean) as is_primary_relationship

from dummy_cte
where false
  );
  
[0m20:22:56.648186 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m20:22:56.650230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.650442 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
alter table "dw"."public"."base_node_relationships__dbt_tmp" rename to "base_node_relationships"
[0m20:22:56.651168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.701170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.701848 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
insert into "dw"."public"."base_node_relationships" values 
(cast('model.my_dbt_project.migrate_legacy_code' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.my_dbt_project.stg_jaffle_shop__payments' as TEXT), 
cast('source.my_dbt_project.jaffle_shop.payments' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.stg_jaffle_shop__customers' as TEXT), 
cast('source.my_dbt_project.jaffle_shop.customers' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.stg_jaffle_shop__orders' as TEXT), 
cast('source.my_dbt_project.jaffle_shop.orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_paid_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_paid_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__customers' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_paid_orders' as TEXT), 
cast('model.my_dbt_project.int_payment_orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_customer_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__customers' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_customer_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_payment_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__payments' as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_items' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.customers' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_customers' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.orders' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_stores' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.payments' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_orders' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_supplies' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_products' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_columns' as TEXT), 
cast('model.dbt_project_evaluator.base_node_columns' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_columns' as TEXT), 
cast('model.dbt_project_evaluator.base_source_columns' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_nodes' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_exposure_relationships' as TEXT), 
cast('model.dbt_project_evaluator.base_exposure_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_node_relationships' as TEXT), 
cast('model.dbt_project_evaluator.base_node_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_sources' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_exposures' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_metric_relationships' as TEXT), 
cast('model.dbt_project_evaluator.base_metric_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_metrics' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_node_relationships' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_source_columns' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_node_columns' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_exposure_relationships' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_metric_relationships' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_naming_convention_folders' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_naming_convention_prefixes' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_documentation_coverage' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_sources' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_sources' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_source_tables' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_source_tables' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.stg_node_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.stg_exposure_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.stg_metric_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_nodes' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_exposures' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_metrics' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_sources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_prefixes' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_folders' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_multiple_sources_joined' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_multiple_sources_joined' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_root_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_root_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_fanout' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_fanout' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_unused_sources' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_unused_sources' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_duplicate_sources' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_duplicate_sources' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_fanout' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_fanout' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_direct_join_to_source' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_direct_join_to_source' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_staging' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_staging' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_too_many_joins' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_too_many_joins' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_hard_coded_references' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_hard_coded_references' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_missing_primary_key_tests' as TEXT), 
cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_missing_primary_key_tests' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_sources_without_freshness' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_sources_without_freshness' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_coverage' as TEXT), 
cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
cast('model.dbt_project_evaluator.base_node_columns' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_public_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_public_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposures_dependent_on_private_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposures_dependent_on_private_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_public_models_without_contract' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_public_models_without_contract' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposure_parents_materializations' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposure_parents_materializations' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_chained_views_dependencies' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_chained_views_dependencies' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_directories' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_prefixes' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_folders' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' as TEXT), 
cast('model.dbt_project_evaluator.fct_documentation_coverage' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_source_tables' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_sources' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' as TEXT), 
cast('model.dbt_project_evaluator.fct_direct_join_to_source' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' as TEXT), 
cast('model.dbt_project_evaluator.fct_duplicate_sources' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' as TEXT), 
cast('model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' as TEXT), 
cast('model.dbt_project_evaluator.fct_model_fanout' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' as TEXT), 
cast('model.dbt_project_evaluator.fct_multiple_sources_joined' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' as TEXT), 
cast('model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' as TEXT), 
cast('model.dbt_project_evaluator.fct_root_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' as TEXT), 
cast('model.dbt_project_evaluator.fct_source_fanout' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' as TEXT), 
cast('model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' as TEXT), 
cast('model.dbt_project_evaluator.fct_staging_dependent_on_staging' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' as TEXT), 
cast('model.dbt_project_evaluator.fct_unused_sources' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' as TEXT), 
cast('model.dbt_project_evaluator.fct_exposure_parents_materializations' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' as TEXT), 
cast('model.dbt_project_evaluator.fct_hard_coded_references' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' as TEXT), 
cast('model.dbt_project_evaluator.fct_too_many_joins' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.valid_test_coverage.df03f31e09' as TEXT), 
cast('model.dbt_project_evaluator.fct_test_coverage' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' as TEXT), 
cast('model.dbt_project_evaluator.fct_missing_primary_key_tests' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283' as TEXT), 
cast('model.dbt_project_evaluator.fct_sources_without_freshness' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' as TEXT), 
cast('model.dbt_project_evaluator.fct_public_models_without_contract' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_public_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' as TEXT), 
cast('model.dbt_project_evaluator.fct_exposures_dependent_on_private_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' as TEXT), 
cast('model.dbt_project_evaluator.fct_chained_views_dependencies' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' as TEXT), 
cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' as TEXT), 
cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' as TEXT), 
cast('model.dbt_project_evaluator.fct_source_directories' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' as TEXT), 
cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
True);
[0m20:22:56.706955 [debug] [Thread-1  ]: SQL status: INSERT 0 139 in 0.004 seconds
[0m20:22:56.707622 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: COMMIT
[0m20:22:56.707789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.707945 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: COMMIT
[0m20:22:56.709925 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:56.711371 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_node_relationships__dbt_backup"
[0m20:22:56.711723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m20:22:56.711889 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
drop table if exists "dw"."public"."base_node_relationships__dbt_backup" cascade
[0m20:22:56.713069 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:56.713620 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: Close
[0m20:22:56.713906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.714202 [info ] [Thread-1  ]: 4 of 78 OK created sql table model public.base_node_relationships .............. [[32mSELECT 0[0m in 0.09s]
[0m20:22:56.714480 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_node_relationships
[0m20:22:56.714654 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_source_columns
[0m20:22:56.714916 [info ] [Thread-1  ]: 5 of 78 START sql table model public.base_source_columns ....................... [RUN]
[0m20:22:56.715219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_node_relationships, now model.dbt_project_evaluator.base_source_columns)
[0m20:22:56.715397 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_source_columns
[0m20:22:56.719258 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.719904 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_source_columns
[0m20:22:56.722204 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.722820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.723000 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: BEGIN
[0m20:22:56.723162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.733337 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m20:22:56.733562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.733751 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */

  
    

  create  table "dw"."public"."base_source_columns__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as node_unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as description,
    cast(null as TEXT) as data_type,
    cast(null as TEXT) as constraints,
    cast(True as boolean) as has_not_null_constraint,
    cast(0 as integer) as constraints_count,
    cast(null as TEXT) as quote

from dummy_cte
where false
  );
  
[0m20:22:56.738871 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:56.740659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.740830 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */
alter table "dw"."public"."base_source_columns__dbt_tmp" rename to "base_source_columns"
[0m20:22:56.741736 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.743446 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: COMMIT
[0m20:22:56.743617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.743773 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: COMMIT
[0m20:22:56.745405 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.746828 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_source_columns__dbt_backup"
[0m20:22:56.747200 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m20:22:56.747375 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */
drop table if exists "dw"."public"."base_source_columns__dbt_backup" cascade
[0m20:22:56.748135 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:56.748738 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: Close
[0m20:22:56.749032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.749336 [info ] [Thread-1  ]: 5 of 78 OK created sql table model public.base_source_columns .................. [[32mSELECT 0[0m in 0.03s]
[0m20:22:56.749618 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_source_columns
[0m20:22:56.749807 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_exposures
[0m20:22:56.750092 [info ] [Thread-1  ]: 6 of 78 START sql table model public.stg_exposures ............................. [RUN]
[0m20:22:56.750385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_source_columns, now model.dbt_project_evaluator.stg_exposures)
[0m20:22:56.750577 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_exposures
[0m20:22:56.755462 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.756069 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_exposures
[0m20:22:56.759123 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.759970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.760180 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: BEGIN
[0m20:22:56.760350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.770136 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m20:22:56.770305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.770479 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */

  
    

  create  table "dw"."public"."stg_exposures__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT ) as unique_id,
    cast(null as TEXT ) as name,
    cast(null as TEXT ) as resource_type,
    cast(null as TEXT ) as file_path,
    cast(True as boolean) as is_described,
    cast(null as TEXT ) as exposure_type,
    cast(null as TEXT ) as maturity,
    cast(null as TEXT ) as package_name,
    cast(null as TEXT ) as url,
    cast(null as TEXT ) as owner_name,
    cast(null as TEXT ) as owner_email,
    cast(null as TEXT ) as meta

from dummy_cte
where false
  );
  
[0m20:22:56.775355 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:56.777181 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.777358 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */
alter table "dw"."public"."stg_exposures__dbt_tmp" rename to "stg_exposures"
[0m20:22:56.778705 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.780450 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: COMMIT
[0m20:22:56.780628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.780782 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: COMMIT
[0m20:22:56.782380 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.783726 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_exposures__dbt_backup"
[0m20:22:56.784073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m20:22:56.784235 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */
drop table if exists "dw"."public"."stg_exposures__dbt_backup" cascade
[0m20:22:56.784927 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:56.785476 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: Close
[0m20:22:56.785762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.786093 [info ] [Thread-1  ]: 6 of 78 OK created sql table model public.stg_exposures ........................ [[32mSELECT 0[0m in 0.04s]
[0m20:22:56.786367 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_exposures
[0m20:22:56.786542 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_metrics
[0m20:22:56.786790 [info ] [Thread-1  ]: 7 of 78 START sql table model public.stg_metrics ............................... [RUN]
[0m20:22:56.787015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposures, now model.dbt_project_evaluator.stg_metrics)
[0m20:22:56.787179 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_metrics
[0m20:22:56.793257 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.793962 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_metrics
[0m20:22:56.796548 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.797085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.797247 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: BEGIN
[0m20:22:56.797398 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.805705 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:56.805949 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.806139 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */

  
    

  create  table "dw"."public"."stg_metrics__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT) as unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as resource_type,
    cast(null as TEXT) as file_path,
    cast(True as boolean) as is_described,
    cast(null as TEXT) as metric_type,
    cast(null as TEXT) as label,
    cast(null as TEXT) as package_name,
    cast(null as TEXT) as metric_filter,
    cast(null as TEXT) as metric_measure,
    cast(null as TEXT) as metric_measure_alias,
    cast(null as TEXT) as numerator,
    cast(null as TEXT) as denominator,
    cast(null as TEXT) as expr,
    cast(null as TEXT) as metric_window,
    cast(null as TEXT) as grain_to_date,
    cast(null as TEXT) as meta

from dummy_cte
where false
  );
  
[0m20:22:56.809288 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m20:22:56.811152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.811327 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */
alter table "dw"."public"."stg_metrics__dbt_tmp" rename to "stg_metrics"
[0m20:22:56.811953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:56.813919 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: COMMIT
[0m20:22:56.814126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.814283 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: COMMIT
[0m20:22:56.815404 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.816924 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_metrics__dbt_backup"
[0m20:22:56.817310 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m20:22:56.817473 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */
drop table if exists "dw"."public"."stg_metrics__dbt_backup" cascade
[0m20:22:56.818031 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:56.818656 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: Close
[0m20:22:56.818964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102281f10>]}
[0m20:22:56.819292 [info ] [Thread-1  ]: 7 of 78 OK created sql table model public.stg_metrics .......................... [[32mSELECT 0[0m in 0.03s]
[0m20:22:56.819577 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_metrics
[0m20:22:56.819771 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_naming_convention_folders
[0m20:22:56.820001 [info ] [Thread-1  ]: 8 of 78 START sql view model public.stg_naming_convention_folders .............. [RUN]
[0m20:22:56.820257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metrics, now model.dbt_project_evaluator.stg_naming_convention_folders)
[0m20:22:56.820436 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_naming_convention_folders
[0m20:22:56.823305 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.824259 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_naming_convention_folders
[0m20:22:56.834005 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.834854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.835020 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: BEGIN
[0m20:22:56.835174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.844768 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m20:22:56.845022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.845237 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */

  create view "dw"."public"."stg_naming_convention_folders__dbt_tmp"
    
    
  as (
    





  

  

  

  

  


with vars_folders_table as (
    
        select 'base_folder_name' as var_name, 'base' as var_value
        union all
        select 'staging_folder_name' as var_name, 'staging' as var_value
        union all
        select 'intermediate_folder_name' as var_name, 'intermediate' as var_value
        union all
        select 'marts_folder_name' as var_name, 'marts' as var_value
        
)

select
    var_name as folder_name, 
    

    replace(
        var_name,
        
  
    '_folder_name'
  
,
        ''
    )


 as model_type,
    var_value as folder_name_value
from vars_folders_table
  );
[0m20:22:56.848486 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:56.851212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.851410 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */
alter table "dw"."public"."stg_naming_convention_folders__dbt_tmp" rename to "stg_naming_convention_folders"
[0m20:22:56.852139 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.852943 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: COMMIT
[0m20:22:56.853131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.853286 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: COMMIT
[0m20:22:56.854687 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.856236 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_naming_convention_folders__dbt_backup"
[0m20:22:56.857597 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m20:22:56.857774 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */
drop view if exists "dw"."public"."stg_naming_convention_folders__dbt_backup" cascade
[0m20:22:56.858426 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:56.859158 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: Close
[0m20:22:56.859497 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11995ce80>]}
[0m20:22:56.859851 [info ] [Thread-1  ]: 8 of 78 OK created sql view model public.stg_naming_convention_folders ......... [[32mCREATE VIEW[0m in 0.04s]
[0m20:22:56.860139 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_naming_convention_folders
[0m20:22:56.860345 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m20:22:56.860635 [info ] [Thread-1  ]: 9 of 78 START sql view model public.stg_naming_convention_prefixes ............. [RUN]
[0m20:22:56.860886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_naming_convention_folders, now model.dbt_project_evaluator.stg_naming_convention_prefixes)
[0m20:22:56.861075 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m20:22:56.864649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.865290 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m20:22:56.867745 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.868307 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.868487 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: BEGIN
[0m20:22:56.868655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.874854 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:56.875059 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.875251 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */

  create view "dw"."public"."stg_naming_convention_prefixes__dbt_tmp"
    
    
  as (
    





  

  

  

  

  


with vars_prefix_table as (
    
            select 'base_prefixes' as var_name, 'base_' as var_value
            union all
            select 'staging_prefixes' as var_name, 'stg_' as var_value
            union all
            select 'intermediate_prefixes' as var_name, 'int_' as var_value
            union all
            select 'marts_prefixes' as var_name, 'fct_' as var_value
            union all
            select 'marts_prefixes' as var_name, 'dim_' as var_value
            union all
            select 'other_prefixes' as var_name, 'rpt_' as var_value
            
),

parsed as (

select
    var_name as prefix_name, 
    

    replace(
        var_name,
        
  
    '_prefixes'
  
,
        ''
    )


 as model_type,
    var_value as prefix_value
from vars_prefix_table

),

final as (

    select
        md5(cast(coalesce(cast(model_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(prefix_value as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id,
        *
    from parsed

)

select * from final
  );
[0m20:22:56.877977 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:56.880065 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.880296 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */
alter table "dw"."public"."stg_naming_convention_prefixes__dbt_tmp" rename to "stg_naming_convention_prefixes"
[0m20:22:56.881080 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:56.881849 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: COMMIT
[0m20:22:56.882045 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.882354 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: COMMIT
[0m20:22:56.883321 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:56.885529 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_naming_convention_prefixes__dbt_backup"
[0m20:22:56.885894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m20:22:56.886079 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */
drop view if exists "dw"."public"."stg_naming_convention_prefixes__dbt_backup" cascade
[0m20:22:56.886824 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:56.887423 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: Close
[0m20:22:56.887726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11993fa60>]}
[0m20:22:56.888060 [info ] [Thread-1  ]: 9 of 78 OK created sql view model public.stg_naming_convention_prefixes ........ [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:56.888347 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m20:22:56.888543 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_nodes
[0m20:22:56.888811 [info ] [Thread-1  ]: 10 of 78 START sql table model public.stg_nodes ................................ [RUN]
[0m20:22:56.889035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_naming_convention_prefixes, now model.dbt_project_evaluator.stg_nodes)
[0m20:22:56.889213 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_nodes
[0m20:22:56.897863 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_nodes"
[0m20:22:56.898598 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_nodes
[0m20:22:56.900935 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_nodes"
[0m20:22:56.901528 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m20:22:56.901694 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: BEGIN
[0m20:22:56.901843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:56.909828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:56.910135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m20:22:56.910365 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */

  
    

  create  table "dw"."public"."stg_nodes__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT) as unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as resource_type,
    cast(null as TEXT) as file_path,
    cast(True as boolean) as is_enabled,
    cast(null as TEXT) as materialized,
    cast(null as TEXT) as on_schema_change,
    cast(null as TEXT) as model_group,
    cast(null as TEXT) as access,
    cast(null as TEXT) as latest_version,
    cast(null as TEXT) as version,
    cast(null as TEXT) as deprecation_date,
    cast(True as boolean) as is_contract_enforced,
    cast(0 as integer) as total_defined_columns,
    cast(0 as integer) as total_described_columns,
    cast(null as TEXT) as database,
    cast(null as TEXT) as schema,
    cast(null as TEXT) as package_name,
    cast(null as TEXT) as alias,
    cast(True as boolean) as is_described,
    cast(null as TEXT) as column_name,
    cast(null as TEXT) as meta,
    cast(null as TEXT) as hard_coded_references,
    cast(null as integer) as number_lines,
    cast(null as float) as sql_complexity,
    cast(null as TEXT) as macro_dependencies,
    cast(True as boolean) as is_generic_test,
    cast(True as boolean) as is_excluded

from dummy_cte
where false
  );
  
[0m20:22:56.912902 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m20:22:56.914911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m20:22:56.915120 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
alter table "dw"."public"."stg_nodes__dbt_tmp" rename to "stg_nodes"
[0m20:22:56.916006 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.237464 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m20:22:57.239256 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
insert into "dw"."public"."stg_nodes" values 
(
  
    'model.my_dbt_project.migrate_legacy_code'
  
, 

  
    'migrate_legacy_code'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/migrate_legacy_code.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'migrate_legacy_code'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    'dw.public_jaffle_shop.customers, dw.public_jaffle_shop.orders, dw.public_jaffle_shop.payments, raw.jaffle_shop.orders'
  
, 
65, 
22.6, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.stg_jaffle_shop__payments'
  
, 

  
    'stg_jaffle_shop__payments'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/stg_jaffle_shop__payments.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'stg_jaffle_shop__payments'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
16, 
3.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.stg_jaffle_shop__customers'
  
, 

  
    'stg_jaffle_shop__customers'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/stg_jaffle_shop__customers.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'stg_jaffle_shop__customers'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
13, 
3.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.stg_jaffle_shop__orders'
  
, 

  
    'stg_jaffle_shop__orders'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/stg_jaffle_shop__orders.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'stg_jaffle_shop__orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
15, 
3.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.int_paid_orders'
  
, 

  
    'int_paid_orders'
  
, 

  
    'model'
  
, 

  
    'models/intermediate/sales/int_paid_orders.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'int_paid_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
31, 
7.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.int_customer_orders'
  
, 

  
    'int_customer_orders'
  
, 

  
    'model'
  
, 

  
    'models/intermediate/sales/int_customer_orders.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'int_customer_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
6.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.int_payment_orders'
  
, 

  
    'int_payment_orders'
  
, 

  
    'model'
  
, 

  
    'models/intermediate/sales/int_payment_orders.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'int_payment_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
15, 
5.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_items'
  
, 

  
    'raw_items'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_items.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_items'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.customers'
  
, 

  
    'customers'
  
, 

  
    'seed'
  
, 

  
    'seeds/customers.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'customers'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_customers'
  
, 

  
    'raw_customers'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_customers.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_customers'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.orders'
  
, 

  
    'orders'
  
, 

  
    'seed'
  
, 

  
    'seeds/orders.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_stores'
  
, 

  
    'raw_stores'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_stores.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_stores'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.payments'
  
, 

  
    'payments'
  
, 

  
    'seed'
  
, 

  
    'seeds/payments.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'payments'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_orders'
  
, 

  
    'raw_orders'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_orders.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_supplies'
  
, 

  
    'raw_supplies'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_supplies.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_supplies'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_products'
  
, 

  
    'raw_products'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_products.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_products'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_columns'
  
, 

  
    'stg_columns'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_columns.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_columns'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
10, 
1.0, 

  
    '["macro.dbt_utils.union_relations"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_nodes'
  
, 

  
    'stg_nodes'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_nodes.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_nodes'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
48, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt.type_int", "macro.dbt.type_float", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_exposure_relationships'
  
, 

  
    'stg_exposure_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_exposure_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_exposure_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
13, 
4.0, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_node_relationships'
  
, 

  
    'stg_node_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_node_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_node_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
14, 
4.0, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_sources'
  
, 

  
    'stg_sources'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_sources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_sources'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
38, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_exposures'
  
, 

  
    'stg_exposures'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_exposures.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_exposures'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
31, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_metric_relationships'
  
, 

  
    'stg_metric_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_metric_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_metric_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
13, 
4.0, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_metrics'
  
, 

  
    'stg_metrics'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_metrics.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_metrics'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
36, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_node_relationships'
  
, 

  
    'base_node_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_node_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_node_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_source_columns'
  
, 

  
    'base_source_columns'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_source_columns.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_source_columns'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
26, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt_project_evaluator.type_large_string", "macro.dbt.type_int", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_node_columns'
  
, 

  
    'base_node_columns'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_node_columns.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_node_columns'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
26, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt_project_evaluator.type_large_string", "macro.dbt.type_boolean", "macro.dbt.type_int", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_exposure_relationships'
  
, 

  
    'base_exposure_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_exposure_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_exposure_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_metric_relationships'
  
, 

  
    'base_metric_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_metric_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_metric_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_naming_convention_folders'
  
, 

  
    'stg_naming_convention_folders'
  
, 

  
    'model'
  
, 

  
    'models/staging/variables/stg_naming_convention_folders.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_naming_convention_folders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
17, 
1.0, 

  
    '["macro.dbt_project_evaluator.loop_vars", "macro.dbt_project_evaluator.wrap_string_with_quotes", "macro.dbt.replace"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_naming_convention_prefixes'
  
, 

  
    'stg_naming_convention_prefixes'
  
, 

  
    'model'
  
, 

  
    'models/staging/variables/stg_naming_convention_prefixes.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_naming_convention_prefixes'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
32, 
3.0, 

  
    '["macro.dbt_project_evaluator.loop_vars", "macro.dbt_project_evaluator.wrap_string_with_quotes", "macro.dbt.replace", "macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_models'
  
, 

  
    'fct_undocumented_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_undocumented_models.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_documentation_coverage'
  
, 

  
    'fct_documentation_coverage'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_documentation_coverage.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
1, 
1, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_documentation_coverage'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
40, 
7.7, 

  
    '["macro.dbt.current_timestamp", "macro.dbt.type_int", "macro.dbt_utils.safe_divide"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_sources'
  
, 

  
    'fct_undocumented_sources'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_undocumented_sources.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_sources'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
20, 
6.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_source_tables'
  
, 

  
    'fct_undocumented_source_tables'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_undocumented_source_tables.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_source_tables'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
20, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_direct_relationships'
  
, 

  
    'int_direct_relationships'
  
, 

  
    'model'
  
, 

  
    'models/marts/core/int_direct_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_direct_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
86, 
12.1, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_all_dag_relationships'
  
, 

  
    'int_all_dag_relationships'
  
, 

  
    'model'
  
, 

  
    'models/marts/core/int_all_dag_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_all_dag_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
4, 
2.0, 

  
    '["macro.dbt_project_evaluator.recursive_dag"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_all_graph_resources'
  
, 

  
    'int_all_graph_resources'
  
, 

  
    'model'
  
, 

  
    'models/marts/core/int_all_graph_resources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_all_graph_resources'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
156, 
24.7, 

  
    '["macro.dbt_project_evaluator.get_directory_pattern", "macro.dbt_project_evaluator.wrap_string_with_quotes", "macro.dbt_utils.union_relations", "macro.dbt.concat", "macro.dbt.split_part", "macro.dbt_project_evaluator.get_dbtreplace_directory_pattern", "macro.dbt_project_evaluator.get_regexp_directory_pattern", "macro.dbt.position"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_multiple_sources_joined'
  
, 

  
    'fct_multiple_sources_joined'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_multiple_sources_joined.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_multiple_sources_joined'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
29, 
10.3, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_root_models'
  
, 

  
    'fct_root_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_root_models.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_root_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
24, 
7.2, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_model_fanout'
  
, 

  
    'fct_model_fanout'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_model_fanout.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_model_fanout'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
50, 
18.2, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_unused_sources'
  
, 

  
    'fct_unused_sources'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_unused_sources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_unused_sources'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
7.2, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_duplicate_sources'
  
, 

  
    'fct_duplicate_sources'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_duplicate_sources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_duplicate_sources'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
30, 
9.6, 

  
    '["macro.dbt.concat", "macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_source_fanout'
  
, 

  
    'fct_source_fanout'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_source_fanout.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_source_fanout'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
29, 
9.4, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_direct_join_to_source'
  
, 

  
    'fct_direct_join_to_source'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_direct_join_to_source.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_direct_join_to_source'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
43, 
10.9, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_staging_dependent_on_staging'
  
, 

  
    'fct_staging_dependent_on_staging'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_staging_dependent_on_staging.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_staging_dependent_on_staging'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
25, 
5.5, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_too_many_joins'
  
, 

  
    'fct_too_many_joins'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_too_many_joins.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_too_many_joins'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
10.1, 

  
    '["macro.dbt.type_int", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate'
  
, 

  
    'fct_staging_dependent_on_marts_or_intermediate'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_staging_dependent_on_marts_or_intermediate.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_staging_dependent_on_marts_or_intermediate'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
24, 
5.5, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source'
  
, 

  
    'fct_marts_or_intermediate_dependent_on_source'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_marts_or_intermediate_dependent_on_source.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_marts_or_intermediate_dependent_on_source'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
5.3, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_hard_coded_references'
  
, 

  
    'fct_hard_coded_references'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_hard_coded_references.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_hard_coded_references'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
18, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts'
  
, 

  
    'fct_rejoining_of_upstream_concepts'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_rejoining_of_upstream_concepts.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_rejoining_of_upstream_concepts'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
68, 
22.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_missing_primary_key_tests'
  
, 

  
    'fct_missing_primary_key_tests'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/fct_missing_primary_key_tests.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_missing_primary_key_tests'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
27, 
5.0, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_sources_without_freshness'
  
, 

  
    'fct_sources_without_freshness'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/fct_sources_without_freshness.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_sources_without_freshness'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
20, 
6.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_test_coverage'
  
, 

  
    'fct_test_coverage'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/fct_test_coverage.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
2, 
2, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_test_coverage'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
41, 
7.6, 

  
    '["macro.dbt.type_boolean", "macro.dbt.current_timestamp", "macro.dbt.type_int", "macro.dbt_utils.safe_divide"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_model_test_summary'
  
, 

  
    'int_model_test_summary'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/intermediate/int_model_test_summary.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_model_test_summary'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
106, 
23.4, 

  
    '["macro.dbt.type_boolean", "macro.dbt.type_int"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_public_models'
  
, 

  
    'fct_undocumented_public_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/governance/fct_undocumented_public_models.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_public_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
30, 
5.3, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_exposures_dependent_on_private_models'
  
, 

  
    'fct_exposures_dependent_on_private_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/governance/fct_exposures_dependent_on_private_models.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_exposures_dependent_on_private_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
28, 
4.4, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_public_models_without_contract'
  
, 

  
    'fct_public_models_without_contract'
  
, 

  
    'model'
  
, 

  
    'models/marts/governance/fct_public_models_without_contract.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_public_models_without_contract'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_exposure_parents_materializations'
  
, 

  
    'fct_exposure_parents_materializations'
  
, 

  
    'model'
  
, 

  
    'models/marts/performance/fct_exposure_parents_materializations.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_exposure_parents_materializations'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
33, 
4.5, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_chained_views_dependencies'
  
, 

  
    'fct_chained_views_dependencies'
  
, 

  
    'model'
  
, 

  
    'models/marts/performance/fct_chained_views_dependencies.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_chained_views_dependencies'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
25, 
6.4, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_source_directories'
  
, 

  
    'fct_source_directories'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_source_directories.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_source_directories'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
25, 
5.1, 

  
    '["macro.dbt_project_evaluator.get_directory_pattern", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_test_directories'
  
, 

  
    'fct_test_directories'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_test_directories.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_test_directories'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
86, 
15.2, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_model_naming_conventions'
  
, 

  
    'fct_model_naming_conventions'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_model_naming_conventions.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_model_naming_conventions'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
56, 
14.2, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_model_directories'
  
, 

  
    'fct_model_directories'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_model_directories.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_model_directories'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
69, 
16.2, 

  
    '["macro.dbt_project_evaluator.get_directory_pattern", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'dbt_project_evaluator_exceptions'
  
, 

  
    'seed'
  
, 

  
    'seeds/dbt_project_evaluator_exceptions.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
4, 
4, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'dbt_project_evaluator_exceptions'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7'
  
, 

  
    'valid_documentation_coverage'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'valid_documentation_coverage'
  
, 
cast(False as boolean), 

  
    'documentation_coverage_pct'
  
, 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_utils.test_accepted_range", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c'
  
, 

  
    'is_empty_fct_undocumented_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166'
  
, 

  
    'is_empty_fct_undocumented_source_tables_'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_source_tables_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235'
  
, 

  
    'is_empty_fct_undocumented_sources_'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_sources_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028'
  
, 

  
    'is_empty_fct_direct_join_to_source_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_direct_join_to_source_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31'
  
, 

  
    'is_empty_fct_duplicate_sources_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_duplicate_sources_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f'
  
, 

  
    'is_empty_fct_marts_or_intermediate_dependent_on_source_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_marts_or_intermediate_dependent_on_source_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95'
  
, 

  
    'is_empty_fct_model_fanout_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_model_fanout_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817'
  
, 

  
    'is_empty_fct_multiple_sources_joined_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_multiple_sources_joined_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d'
  
, 

  
    'is_empty_fct_rejoining_of_upstream_concepts_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_rejoining_of_upstream_concepts_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1'
  
, 

  
    'is_empty_fct_root_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_root_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722'
  
, 

  
    'is_empty_fct_source_fanout_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_source_fanout_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f'
  
, 

  
    'is_empty_fct_staging_dependent_on_marts_or_intermediate_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_staging_dependent_on_marts_or_intermediate_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca'
  
, 

  
    'is_empty_fct_staging_dependent_on_staging_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_staging_dependent_on_staging_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8'
  
, 

  
    'is_empty_fct_unused_sources_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_unused_sources_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422'
  
, 

  
    'is_empty_fct_exposure_parents_materializations_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_exposure_parents_materializations_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113'
  
, 

  
    'is_empty_fct_hard_coded_references_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_hard_coded_references_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535'
  
, 

  
    'is_empty_fct_too_many_joins_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_too_many_joins_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.valid_test_coverage.df03f31e09'
  
, 

  
    'valid_test_coverage'
  
, 

  
    'test'
  
, 

  
    'models/marts/tests/testing.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'valid_test_coverage'
  
, 
cast(False as boolean), 

  
    'test_coverage_pct'
  
, 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_utils.test_accepted_range", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0'
  
, 

  
    'is_empty_fct_missing_primary_key_tests_'
  
, 

  
    'test'
  
, 

  
    'models/marts/tests/testing.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_missing_primary_key_tests_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283'
  
, 

  
    'is_empty_fct_sources_without_freshness_'
  
, 

  
    'test'
  
, 

  
    'models/marts/tests/testing.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_sources_without_freshness_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0'
  
, 

  
    'is_empty_fct_public_models_without_contract_'
  
, 

  
    'test'
  
, 

  
    'models/marts/governance/governance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_public_models_without_contract_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938'
  
, 

  
    'is_empty_fct_undocumented_public_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/governance/governance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_public_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e'
  
, 

  
    'is_empty_fct_exposures_dependent_on_private_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/governance/governance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_exposures_dependent_on_private_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33'
  
, 

  
    'is_empty_fct_chained_views_dependencies_'
  
, 

  
    'test'
  
, 

  
    'models/marts/performance/performance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_chained_views_dependencies_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db'
  
, 

  
    'is_empty_fct_model_directories_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_model_directories_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2'
  
, 

  
    'is_empty_fct_model_naming_conventions_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_model_naming_conventions_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c'
  
, 

  
    'is_empty_fct_source_directories_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_source_directories_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433'
  
, 

  
    'is_empty_fct_test_directories_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_test_directories_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean));
[0m20:22:57.251853 [debug] [Thread-1  ]: SQL status: INSERT 0 94 in 0.011 seconds
[0m20:22:57.252586 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: COMMIT
[0m20:22:57.252758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m20:22:57.252917 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: COMMIT
[0m20:22:57.255297 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:57.256784 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_nodes__dbt_backup"
[0m20:22:57.257140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m20:22:57.257305 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
drop table if exists "dw"."public"."stg_nodes__dbt_backup" cascade
[0m20:22:57.258349 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:57.258918 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: Close
[0m20:22:57.259214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11993fa60>]}
[0m20:22:57.259513 [info ] [Thread-1  ]: 10 of 78 OK created sql table model public.stg_nodes ........................... [[32mSELECT 0[0m in 0.37s]
[0m20:22:57.259793 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_nodes
[0m20:22:57.259978 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_sources
[0m20:22:57.260253 [info ] [Thread-1  ]: 11 of 78 START sql table model public.stg_sources .............................. [RUN]
[0m20:22:57.260507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_nodes, now model.dbt_project_evaluator.stg_sources)
[0m20:22:57.260684 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_sources
[0m20:22:57.267052 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.267888 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_sources
[0m20:22:57.270279 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.270870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.271040 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: BEGIN
[0m20:22:57.271195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.280670 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:22:57.280887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.281092 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */

  
    

  create  table "dw"."public"."stg_sources__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT) as unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as file_path,
    cast(null as TEXT) as alias,
    cast(null as TEXT) as resource_type,
    cast(null as TEXT) as source_name,
    cast(True as boolean) as is_source_described,
    cast(True as boolean) as is_described,
    cast(True as boolean) as is_enabled,
    cast(null as TEXT) as loaded_at_field,
    cast(True as boolean) as is_freshness_enabled,
    cast(null as TEXT) as database,
    cast(null as TEXT) as schema,
    cast(null as TEXT) as package_name,
    cast(null as TEXT) as loader,
    cast(null as TEXT) as identifier,
    cast(null as TEXT)  as meta,
    cast(True as boolean) as is_excluded

from dummy_cte
where false
  );
  
[0m20:22:57.289385 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m20:22:57.291293 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.291472 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
alter table "dw"."public"."stg_sources__dbt_tmp" rename to "stg_sources"
[0m20:22:57.292472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.300860 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.301131 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
insert into "dw"."public"."stg_sources" values 
(
  
    'source.my_dbt_project.jaffle_shop.payments'
  
, 

  
    'payments'
  
, 

  
    'models/staging/jaffle_shop/src_jaffle_shop.yml'
  
, 

  
    ''
  
, 

  
    'source'
  
, 

  
    'jaffle_shop'
  
, 
cast(False as boolean), 
cast(False as boolean), 
cast(True as boolean), 

  
    'None'
  
, 
cast(False as boolean), 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    ''
  
, 

  
    'payments'
  
, 

  
    '{}'
  
, 
cast(False as boolean)), 

(
  
    'source.my_dbt_project.jaffle_shop.customers'
  
, 

  
    'customers'
  
, 

  
    'models/staging/jaffle_shop/src_jaffle_shop.yml'
  
, 

  
    ''
  
, 

  
    'source'
  
, 

  
    'jaffle_shop'
  
, 
cast(False as boolean), 
cast(False as boolean), 
cast(True as boolean), 

  
    'None'
  
, 
cast(False as boolean), 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    ''
  
, 

  
    'customers'
  
, 

  
    '{}'
  
, 
cast(False as boolean)), 

(
  
    'source.my_dbt_project.jaffle_shop.orders'
  
, 

  
    'orders'
  
, 

  
    'models/staging/jaffle_shop/src_jaffle_shop.yml'
  
, 

  
    ''
  
, 

  
    'source'
  
, 

  
    'jaffle_shop'
  
, 
cast(False as boolean), 
cast(False as boolean), 
cast(True as boolean), 

  
    'None'
  
, 
cast(False as boolean), 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    ''
  
, 

  
    'orders'
  
, 

  
    '{}'
  
, 
cast(False as boolean));
[0m20:22:57.302140 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.001 seconds
[0m20:22:57.302833 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: COMMIT
[0m20:22:57.303020 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.303187 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: COMMIT
[0m20:22:57.304371 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.305885 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_sources__dbt_backup"
[0m20:22:57.306273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m20:22:57.306458 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
drop table if exists "dw"."public"."stg_sources__dbt_backup" cascade
[0m20:22:57.307613 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:57.308204 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: Close
[0m20:22:57.308500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11993fa60>]}
[0m20:22:57.308800 [info ] [Thread-1  ]: 11 of 78 OK created sql table model public.stg_sources ......................... [[32mSELECT 0[0m in 0.05s]
[0m20:22:57.309077 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_sources
[0m20:22:57.309275 [debug] [Thread-1  ]: Began running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m20:22:57.309580 [info ] [Thread-1  ]: 12 of 78 START seed file public.dbt_project_evaluator_exceptions ............... [RUN]
[0m20:22:57.309828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_sources, now seed.dbt_project_evaluator.dbt_project_evaluator_exceptions)
[0m20:22:57.310023 [debug] [Thread-1  ]: Began compiling node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m20:22:57.310197 [debug] [Thread-1  ]: Began executing node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m20:22:57.325797 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m20:22:57.326032 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: BEGIN
[0m20:22:57.326189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.333510 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:57.333818 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m20:22:57.334007 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"} */

    create table "dw"."public"."dbt_project_evaluator_exceptions" ("fct_name" varchar,"column_name" varchar,"id_to_exclude" varchar,"comment" varchar)
  
[0m20:22:57.337015 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.003 seconds
[0m20:22:57.346065 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m20:22:57.347513 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: COMMIT
[0m20:22:57.347714 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m20:22:57.347878 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: COMMIT
[0m20:22:57.349645 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:57.350009 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: Close
[0m20:22:57.350324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11993fa60>]}
[0m20:22:57.350602 [info ] [Thread-1  ]: 12 of 78 OK loaded seed file public.dbt_project_evaluator_exceptions ........... [[32mINSERT 0[0m in 0.04s]
[0m20:22:57.350886 [debug] [Thread-1  ]: Finished running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m20:22:57.351086 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_exposure_relationships
[0m20:22:57.351419 [info ] [Thread-1  ]: 13 of 78 START sql view model public.stg_exposure_relationships ................ [RUN]
[0m20:22:57.351699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_project_evaluator.dbt_project_evaluator_exceptions, now model.dbt_project_evaluator.stg_exposure_relationships)
[0m20:22:57.351898 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_exposure_relationships
[0m20:22:57.354759 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.355378 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_exposure_relationships
[0m20:22:57.357791 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.358543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.358777 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: BEGIN
[0m20:22:57.358965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.367827 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:22:57.368092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.368290 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */

  create view "dw"."public"."stg_exposure_relationships__dbt_tmp"
    
    
  as (
    with 

_base_exposure_relationships as (
    select * from "dw"."public"."base_exposure_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_exposure_relationships
)

select distinct * from final
  );
[0m20:22:57.370785 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:57.373051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.373291 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */
alter table "dw"."public"."stg_exposure_relationships__dbt_tmp" rename to "stg_exposure_relationships"
[0m20:22:57.374110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.374958 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: COMMIT
[0m20:22:57.375169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.375343 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: COMMIT
[0m20:22:57.376646 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.378241 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_exposure_relationships__dbt_backup"
[0m20:22:57.378650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m20:22:57.378826 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */
drop view if exists "dw"."public"."stg_exposure_relationships__dbt_backup" cascade
[0m20:22:57.380148 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:57.380770 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: Close
[0m20:22:57.381082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1d24c0>]}
[0m20:22:57.381390 [info ] [Thread-1  ]: 13 of 78 OK created sql view model public.stg_exposure_relationships ........... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:57.381665 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_exposure_relationships
[0m20:22:57.381856 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_metric_relationships
[0m20:22:57.382109 [info ] [Thread-1  ]: 14 of 78 START sql view model public.stg_metric_relationships .................. [RUN]
[0m20:22:57.382321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposure_relationships, now model.dbt_project_evaluator.stg_metric_relationships)
[0m20:22:57.382500 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_metric_relationships
[0m20:22:57.384893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.385455 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_metric_relationships
[0m20:22:57.388666 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.389262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.389450 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: BEGIN
[0m20:22:57.389627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.397529 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:57.397786 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.397982 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */

  create view "dw"."public"."stg_metric_relationships__dbt_tmp"
    
    
  as (
    with 

_base_metric_relationships as (
    select * from "dw"."public"."base_metric_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_metric_relationships
)

select distinct * from final
  );
[0m20:22:57.399657 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:22:57.401948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.402174 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */
alter table "dw"."public"."stg_metric_relationships__dbt_tmp" rename to "stg_metric_relationships"
[0m20:22:57.403052 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.403761 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: COMMIT
[0m20:22:57.403946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.404117 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: COMMIT
[0m20:22:57.405185 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.406615 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_metric_relationships__dbt_backup"
[0m20:22:57.406989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m20:22:57.407169 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */
drop view if exists "dw"."public"."stg_metric_relationships__dbt_backup" cascade
[0m20:22:57.407697 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:57.408283 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: Close
[0m20:22:57.408588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1d24c0>]}
[0m20:22:57.408914 [info ] [Thread-1  ]: 14 of 78 OK created sql view model public.stg_metric_relationships ............. [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:57.409203 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_metric_relationships
[0m20:22:57.409398 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_node_relationships
[0m20:22:57.409663 [info ] [Thread-1  ]: 15 of 78 START sql table model public.stg_node_relationships ................... [RUN]
[0m20:22:57.409883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metric_relationships, now model.dbt_project_evaluator.stg_node_relationships)
[0m20:22:57.410065 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_node_relationships
[0m20:22:57.412300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.412821 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_node_relationships
[0m20:22:57.415108 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.415529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.415707 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: BEGIN
[0m20:22:57.415877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.422659 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:57.422958 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.423162 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */

  
    

  create  table "dw"."public"."stg_node_relationships__dbt_tmp"
  
  
    as
  
  (
    with 

_base_node_relationships as (
    select * from "dw"."public"."base_node_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_node_relationships
)

-- we need distinct as the graph lists relationships multiple times if they are ref'd multiple times
select distinct * from final
  );
  
[0m20:22:57.427080 [debug] [Thread-1  ]: SQL status: SELECT 139 in 0.004 seconds
[0m20:22:57.429316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.429535 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
alter table "dw"."public"."stg_node_relationships__dbt_tmp" rename to "stg_node_relationships"
[0m20:22:57.430468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.431282 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: COMMIT
[0m20:22:57.431450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.431604 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: COMMIT
[0m20:22:57.432730 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.434877 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_node_relationships__dbt_backup"
[0m20:22:57.435253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m20:22:57.435417 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
drop table if exists "dw"."public"."stg_node_relationships__dbt_backup" cascade
[0m20:22:57.435947 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:57.436724 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: Close
[0m20:22:57.437102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103658d00>]}
[0m20:22:57.437451 [info ] [Thread-1  ]: 15 of 78 OK created sql table model public.stg_node_relationships .............. [[32mSELECT 139[0m in 0.03s]
[0m20:22:57.437746 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_node_relationships
[0m20:22:57.437942 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_columns
[0m20:22:57.438202 [info ] [Thread-1  ]: 16 of 78 START sql view model public.stg_columns ............................... [RUN]
[0m20:22:57.438422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_node_relationships, now model.dbt_project_evaluator.stg_columns)
[0m20:22:57.438604 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_columns
[0m20:22:57.450686 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.450934 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: BEGIN
[0m20:22:57.451090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.459536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:57.459743 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.459919 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'base_node_columns'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:22:57.476013 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.016 seconds
[0m20:22:57.479405 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.479620 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'base_source_columns'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:22:57.481415 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.002 seconds
[0m20:22:57.483084 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.483804 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_columns
[0m20:22:57.486219 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.486731 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.486953 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

  create view "dw"."public"."stg_columns__dbt_tmp"
    
    
  as (
    with

final as (

    
    

        (
            select
                cast('"dw"."public"."base_node_columns"' as TEXT) as _dbt_source_relation,

                
                    cast("node_unique_id" as text) as "node_unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("description" as text) as "description" ,
                    cast("data_type" as text) as "data_type" ,
                    cast("constraints" as text) as "constraints" ,
                    cast("has_not_null_constraint" as boolean) as "has_not_null_constraint" ,
                    cast("constraints_count" as integer) as "constraints_count" ,
                    cast("quote" as text) as "quote" 

            from "dw"."public"."base_node_columns"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."base_source_columns"' as TEXT) as _dbt_source_relation,

                
                    cast("node_unique_id" as text) as "node_unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("description" as text) as "description" ,
                    cast("data_type" as text) as "data_type" ,
                    cast("constraints" as text) as "constraints" ,
                    cast("has_not_null_constraint" as boolean) as "has_not_null_constraint" ,
                    cast("constraints_count" as integer) as "constraints_count" ,
                    cast("quote" as text) as "quote" 

            from "dw"."public"."base_source_columns"

            
        )

        
)

select * from final
  );
[0m20:22:57.488711 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:57.491055 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.491232 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */
alter table "dw"."public"."stg_columns__dbt_tmp" rename to "stg_columns"
[0m20:22:57.491838 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:57.492512 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: COMMIT
[0m20:22:57.492684 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.492852 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: COMMIT
[0m20:22:57.493631 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.495041 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_columns__dbt_backup"
[0m20:22:57.495450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m20:22:57.495627 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */
drop view if exists "dw"."public"."stg_columns__dbt_backup" cascade
[0m20:22:57.496150 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:57.496761 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: Close
[0m20:22:57.497075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5fe20>]}
[0m20:22:57.497398 [info ] [Thread-1  ]: 16 of 78 OK created sql view model public.stg_columns .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m20:22:57.497675 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_columns
[0m20:22:57.497867 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_all_graph_resources
[0m20:22:57.498096 [info ] [Thread-1  ]: 17 of 78 START sql table model public.int_all_graph_resources .................. [RUN]
[0m20:22:57.498351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_columns, now model.dbt_project_evaluator.int_all_graph_resources)
[0m20:22:57.498530 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_all_graph_resources
[0m20:22:57.506976 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.507188 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: BEGIN
[0m20:22:57.507356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.513913 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:57.514192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.514379 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_nodes'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:22:57.521324 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.007 seconds
[0m20:22:57.524152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.524351 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_exposures'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:22:57.527267 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m20:22:57.530102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.530290 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_metrics'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:22:57.532049 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.002 seconds
[0m20:22:57.534386 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.534587 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sources'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:22:57.536962 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.002 seconds
[0m20:22:57.542691 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.544016 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_all_graph_resources
[0m20:22:57.546362 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.547536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.548164 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

  
    

  create  table "dw"."public"."int_all_graph_resources__dbt_tmp"
  
  
    as
  
  (
    -- one row for each resource in the graph



with unioned as (

    
    

        (
            select
                cast('"dw"."public"."stg_nodes"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast("is_enabled" as boolean) as "is_enabled" ,
                    cast("materialized" as text) as "materialized" ,
                    cast("on_schema_change" as text) as "on_schema_change" ,
                    cast("model_group" as text) as "model_group" ,
                    cast("access" as text) as "access" ,
                    cast("latest_version" as text) as "latest_version" ,
                    cast("version" as text) as "version" ,
                    cast("deprecation_date" as text) as "deprecation_date" ,
                    cast("is_contract_enforced" as boolean) as "is_contract_enforced" ,
                    cast("total_defined_columns" as integer) as "total_defined_columns" ,
                    cast("total_described_columns" as integer) as "total_described_columns" ,
                    cast("database" as text) as "database" ,
                    cast("schema" as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast("alias" as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast("column_name" as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast("hard_coded_references" as text) as "hard_coded_references" ,
                    cast("number_lines" as integer) as "number_lines" ,
                    cast("sql_complexity" as double precision) as "sql_complexity" ,
                    cast("macro_dependencies" as text) as "macro_dependencies" ,
                    cast("is_generic_test" as boolean) as "is_generic_test" ,
                    cast("is_excluded" as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dw"."public"."stg_nodes"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."stg_exposures"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast(null as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast(null as text) as "database" ,
                    cast(null as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast(null as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast(null as boolean) as "is_excluded" ,
                    cast("exposure_type" as text) as "exposure_type" ,
                    cast("maturity" as text) as "maturity" ,
                    cast("url" as text) as "url" ,
                    cast("owner_name" as text) as "owner_name" ,
                    cast("owner_email" as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dw"."public"."stg_exposures"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."stg_metrics"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast(null as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast(null as text) as "database" ,
                    cast(null as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast(null as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast(null as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast("metric_type" as text) as "metric_type" ,
                    cast("label" as text) as "label" ,
                    cast("metric_filter" as text) as "metric_filter" ,
                    cast("metric_measure" as text) as "metric_measure" ,
                    cast("metric_measure_alias" as text) as "metric_measure_alias" ,
                    cast("numerator" as text) as "numerator" ,
                    cast("denominator" as text) as "denominator" ,
                    cast("expr" as text) as "expr" ,
                    cast("metric_window" as text) as "metric_window" ,
                    cast("grain_to_date" as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dw"."public"."stg_metrics"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."stg_sources"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast("is_enabled" as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast("database" as text) as "database" ,
                    cast("schema" as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast("alias" as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast("is_excluded" as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast("source_name" as text) as "source_name" ,
                    cast("is_source_described" as boolean) as "is_source_described" ,
                    cast("loaded_at_field" as text) as "loaded_at_field" ,
                    cast("is_freshness_enabled" as boolean) as "is_freshness_enabled" ,
                    cast("loader" as text) as "loader" ,
                    cast("identifier" as text) as "identifier" 

            from "dw"."public"."stg_sources"

            
        )

        

),

naming_convention_prefixes as (
    select * from "dw"."public"."stg_naming_convention_prefixes"
), 

naming_convention_folders as (
    select * from "dw"."public"."stg_naming_convention_folders"
), 

unioned_with_calc as (
    select 
        *,
        case 
            when resource_type = 'source' then  source_name || '.' || name
            when coalesce(version, '') != '' then name || '.v' || version 
            else name 
        end as resource_name,
        case
            when resource_type = 'source' then null
            else 

  
    

    split_part(
        name,
        '_',
        1
        )


  

||'_' 
        end as prefix,
        
  

    replace(
        file_path,
        regexp_replace(file_path,'.*/',''),
        ''
    )



    
  
 as directory_path,
        regexp_replace(file_path,'.*/','') as file_name
    from unioned
    where coalesce(is_enabled, True) = True and package_name != 'dbt_project_evaluator'
), 

joined as (

    select
        unioned_with_calc.unique_id as resource_id, 
        unioned_with_calc.resource_name, 
        unioned_with_calc.prefix, 
        unioned_with_calc.resource_type, 
        unioned_with_calc.file_path, 
        unioned_with_calc.directory_path,
        unioned_with_calc.is_generic_test,
        unioned_with_calc.file_name,
        case 
            when unioned_with_calc.resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            else nullif(naming_convention_prefixes.model_type, '')
        end as model_type_prefix,
        case 
            when unioned_with_calc.resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            when 

    position(
        
  
    '/'
  
 || naming_convention_folders.folder_name_value || 
  
    '/'
  
 in unioned_with_calc.directory_path
    ) = 0 then null
            else naming_convention_folders.model_type 
        end as model_type_folder,
        

    position(
        
  
    '/'
  
 || naming_convention_folders.folder_name_value || 
  
    '/'
  
 in unioned_with_calc.directory_path
    ) as position_folder,  
        nullif(unioned_with_calc.column_name, '') as column_name,
        
        unioned_with_calc.macro_dependencies like '%macro.dbt_utils.test_unique_combination_of_columns%' and unioned_with_calc.resource_type = 'test' as is_test_unique_combination_of_columns,  
        
        unioned_with_calc.macro_dependencies like '%macro.dbt.test_unique%' and unioned_with_calc.resource_type = 'test' as is_test_unique,  
        
        unioned_with_calc.macro_dependencies like '%macro.dbt.test_not_null%' and unioned_with_calc.resource_type = 'test' as is_test_not_null,  
        
        unioned_with_calc.is_enabled, 
        unioned_with_calc.materialized, 
        unioned_with_calc.on_schema_change, 
        unioned_with_calc.database, 
        unioned_with_calc.schema, 
        unioned_with_calc.package_name, 
        unioned_with_calc.alias, 
        unioned_with_calc.is_described, 
        unioned_with_calc.model_group, 
        unioned_with_calc.access, 
        unioned_with_calc.access = 'public' as is_public, 
        unioned_with_calc.latest_version, 
        unioned_with_calc.version, 
        unioned_with_calc.deprecation_date, 
        unioned_with_calc.is_contract_enforced, 
        unioned_with_calc.total_defined_columns, 
        unioned_with_calc.total_described_columns, 
        unioned_with_calc.exposure_type, 
        unioned_with_calc.maturity, 
        unioned_with_calc.url, 
        unioned_with_calc.owner_name,
        unioned_with_calc.owner_email,
        unioned_with_calc.meta,
        unioned_with_calc.macro_dependencies,
        unioned_with_calc.metric_type, 
        unioned_with_calc.label, 
        unioned_with_calc.metric_filter,
        unioned_with_calc.metric_measure,
        unioned_with_calc.metric_measure_alias,
        unioned_with_calc.numerator,
        unioned_with_calc.denominator,
        unioned_with_calc.expr,
        unioned_with_calc.metric_window,
        unioned_with_calc.grain_to_date,
        unioned_with_calc.source_name, -- NULL for non-source resources
        unioned_with_calc.is_source_described, 
        unioned_with_calc.loaded_at_field, 
        unioned_with_calc.is_freshness_enabled, 
        unioned_with_calc.loader, 
        unioned_with_calc.identifier,
        unioned_with_calc.hard_coded_references, -- NULL for non-model resources
        unioned_with_calc.number_lines, -- NULL for non-model resources
        unioned_with_calc.sql_complexity, -- NULL for non-model resources
        unioned_with_calc.is_excluded -- NULL for metrics and exposures

    from unioned_with_calc
    left join naming_convention_prefixes
        on unioned_with_calc.prefix = naming_convention_prefixes.prefix_value

    cross join naming_convention_folders   

), 

calculate_model_type as (
    select 
        *, 
        case 
            when resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            -- by default we will define the model type based on its prefix in the case prefix and folder types are different
            else coalesce(model_type_prefix, model_type_folder, 'other') 
        end as model_type,
        row_number() over (partition by resource_id order by position_folder desc) as folder_name_rank
    from joined
),

final as (
    select
        *
    from calculate_model_type
    where folder_name_rank = 1
)

select 
    *
from final
  );
  
[0m20:22:57.558002 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.009 seconds
[0m20:22:57.560083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.560310 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
alter table "dw"."public"."int_all_graph_resources__dbt_tmp" rename to "int_all_graph_resources"
[0m20:22:57.561165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.562032 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: COMMIT
[0m20:22:57.562225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.562389 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: COMMIT
[0m20:22:57.563623 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.565170 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_all_graph_resources__dbt_backup"
[0m20:22:57.565547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m20:22:57.565723 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
drop table if exists "dw"."public"."int_all_graph_resources__dbt_backup" cascade
[0m20:22:57.566335 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:57.566945 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: Close
[0m20:22:57.567273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103658d00>]}
[0m20:22:57.567599 [info ] [Thread-1  ]: 17 of 78 OK created sql table model public.int_all_graph_resources ............. [[32mSELECT 19[0m in 0.07s]
[0m20:22:57.567884 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_all_graph_resources
[0m20:22:57.568393 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_documentation_coverage
[0m20:22:57.568695 [info ] [Thread-1  ]: 18 of 78 START sql view model public.fct_documentation_coverage ................ [RUN]
[0m20:22:57.568951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_graph_resources, now model.dbt_project_evaluator.fct_documentation_coverage)
[0m20:22:57.569137 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_documentation_coverage
[0m20:22:57.574163 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.586087 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_documentation_coverage
[0m20:22:57.589031 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.589828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.590058 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: BEGIN
[0m20:22:57.590244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.598450 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:57.598729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.598989 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */

  create view "dw"."public"."fct_documentation_coverage__dbt_tmp"
    
    
  as (
    with

models as (
    select * from "dw"."public"."int_all_graph_resources"
    where resource_type = 'model'
    and not is_excluded
),

conversion as (
    select
        resource_id,
        case when is_described then 1 else 0 end as is_described_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when is_described and model_type = 'base' then 1.0 else 0 end as is_described_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when is_described and model_type = 'staging' then 1.0 else 0 end as is_described_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when is_described and model_type = 'intermediate' then 1.0 else 0 end as is_described_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when is_described and model_type = 'marts' then 1.0 else 0 end as is_described_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when is_described and model_type = 'other' then 1.0 else 0 end as is_described_other_model
        

    from models
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(is_described_model) as integer) as documented_models,
        round(sum(is_described_model) * 100.00 / count(*), 2) as documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_base_model) * 100 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_staging_model) * 100 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_intermediate_model) * 100 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_marts_model) * 100 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_other_model) * 100 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_documentation_coverage_pct
        

    from models
    left join conversion
    on models.resource_id = conversion.resource_id
)

select * from final
  );
[0m20:22:57.603845 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:22:57.605966 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.606172 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */
alter table "dw"."public"."fct_documentation_coverage__dbt_tmp" rename to "fct_documentation_coverage"
[0m20:22:57.607095 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.607829 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: COMMIT
[0m20:22:57.608014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.608183 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: COMMIT
[0m20:22:57.609707 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.611307 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_documentation_coverage__dbt_backup"
[0m20:22:57.611704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m20:22:57.611890 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */
drop view if exists "dw"."public"."fct_documentation_coverage__dbt_backup" cascade
[0m20:22:57.612483 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:57.613138 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: Close
[0m20:22:57.613487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11989d310>]}
[0m20:22:57.613833 [info ] [Thread-1  ]: 18 of 78 OK created sql view model public.fct_documentation_coverage ........... [[32mCREATE VIEW[0m in 0.04s]
[0m20:22:57.614120 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_documentation_coverage
[0m20:22:57.614317 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_duplicate_sources
[0m20:22:57.614687 [info ] [Thread-1  ]: 19 of 78 START sql table model public.fct_duplicate_sources .................... [RUN]
[0m20:22:57.614963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_documentation_coverage, now model.dbt_project_evaluator.fct_duplicate_sources)
[0m20:22:57.615155 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_duplicate_sources
[0m20:22:57.618629 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.619332 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_duplicate_sources
[0m20:22:57.655810 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.658900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.659107 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: BEGIN
[0m20:22:57.659262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.667066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:57.667313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.667534 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */

  
    

  create  table "dw"."public"."fct_duplicate_sources__dbt_tmp"
  
  
    as
  
  (
    with sources as (
    select
        resource_name,
        case 
            -- if you're using databricks but not the unity catalog, database will be null
            when database is NULL then schema || '.' || identifier 
            else database || '.' || schema || '.' || identifier 
        end as source_db_location 
    from "dw"."public"."int_all_graph_resources"
    where resource_type = 'source'
    and not is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

source_duplicates as (
    select
        source_db_location,
        
    string_agg(
        resource_name,
        ', '
        
        ) as source_names
    from sources
    group by source_db_location
    having count(*) > 1
)

select * from source_duplicates



    

    
    

    

    


  );
  
[0m20:22:57.670706 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m20:22:57.672606 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.672781 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
alter table "dw"."public"."fct_duplicate_sources__dbt_tmp" rename to "fct_duplicate_sources"
[0m20:22:57.673365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:57.674211 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: COMMIT
[0m20:22:57.674389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.674544 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: COMMIT
[0m20:22:57.675570 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.676983 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_duplicate_sources__dbt_backup"
[0m20:22:57.677344 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m20:22:57.677512 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
drop table if exists "dw"."public"."fct_duplicate_sources__dbt_backup" cascade
[0m20:22:57.678073 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:57.678637 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: Close
[0m20:22:57.678972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2f05b0>]}
[0m20:22:57.679327 [info ] [Thread-1  ]: 19 of 78 OK created sql table model public.fct_duplicate_sources ............... [[32mSELECT 0[0m in 0.06s]
[0m20:22:57.679631 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_duplicate_sources
[0m20:22:57.679834 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_hard_coded_references
[0m20:22:57.680111 [info ] [Thread-1  ]: 20 of 78 START sql table model public.fct_hard_coded_references ................ [RUN]
[0m20:22:57.680420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_duplicate_sources, now model.dbt_project_evaluator.fct_hard_coded_references)
[0m20:22:57.680626 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_hard_coded_references
[0m20:22:57.682637 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.683260 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_hard_coded_references
[0m20:22:57.685546 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.686025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.686212 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: BEGIN
[0m20:22:57.686378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.692643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:57.692897 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.693090 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */

  
    

  create  table "dw"."public"."fct_hard_coded_references__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has hard coded references

with models as (
    select * from "dw"."public"."int_all_graph_resources"
    where resource_type = 'model'
    and not is_excluded
),

final as (
    select
        resource_name as model,
        hard_coded_references
    from models
    where hard_coded_references != ''
)

select * from final



    

    
    

    

    


  );
  
[0m20:22:57.696329 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:57.699054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.699260 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
alter table "dw"."public"."fct_hard_coded_references__dbt_tmp" rename to "fct_hard_coded_references"
[0m20:22:57.699869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:57.700624 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: COMMIT
[0m20:22:57.700788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.700942 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: COMMIT
[0m20:22:57.701662 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.703040 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_hard_coded_references__dbt_backup"
[0m20:22:57.703384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m20:22:57.703544 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
drop table if exists "dw"."public"."fct_hard_coded_references__dbt_backup" cascade
[0m20:22:57.704117 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:57.704668 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: Close
[0m20:22:57.704965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119918b80>]}
[0m20:22:57.705285 [info ] [Thread-1  ]: 20 of 78 OK created sql table model public.fct_hard_coded_references ........... [[32mSELECT 1[0m in 0.02s]
[0m20:22:57.705575 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_hard_coded_references
[0m20:22:57.705770 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m20:22:57.706214 [info ] [Thread-1  ]: 21 of 78 START sql view model public.fct_model_naming_conventions .............. [RUN]
[0m20:22:57.706467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_hard_coded_references, now model.dbt_project_evaluator.fct_model_naming_conventions)
[0m20:22:57.706648 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_model_naming_conventions
[0m20:22:57.709359 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.710187 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_model_naming_conventions
[0m20:22:57.712585 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.713289 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.713470 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: BEGIN
[0m20:22:57.713626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.721791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:57.722044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.722297 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */

  create view "dw"."public"."fct_model_naming_conventions__dbt_tmp"
    
    
  as (
    -- all models with inappropriate (or lack of) pre-fix
-- ensure dbt project has consistent naming conventions

with all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
    -- exclude required metricflow time spine
    and resource_name != 'metricflow_time_spine'
),

naming_convention_prefixes as (
    select * from "dw"."public"."stg_naming_convention_prefixes"
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by prefix_value
), 

appropriate_prefixes as (
    select 
        model_type, 
        
    string_agg(
        prefix_value,
        ', '
        
        ) as appropriate_prefixes
    from naming_convention_prefixes
    group by model_type
), 

models as (
    select
        all_graph_resources.resource_name,
        all_graph_resources.prefix,
        all_graph_resources.model_type,
        naming_convention_prefixes.prefix_value
    from all_graph_resources 
    left join naming_convention_prefixes
        on all_graph_resources.model_type = naming_convention_prefixes.model_type
        and all_graph_resources.prefix = naming_convention_prefixes.prefix_value
    where resource_type = 'model'
),

inappropriate_model_names as (
    select 
        models.resource_name,
        models.prefix,
        models.model_type,
        appropriate_prefixes.appropriate_prefixes
    from models
    left join appropriate_prefixes
        on models.model_type = appropriate_prefixes.model_type
    where nullif(models.prefix_value, '') is null

)

select * from inappropriate_model_names



    

    
    

    

    


  );
[0m20:22:57.725856 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:57.727916 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.728137 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */
alter table "dw"."public"."fct_model_naming_conventions__dbt_tmp" rename to "fct_model_naming_conventions"
[0m20:22:57.729328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.730075 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: COMMIT
[0m20:22:57.730265 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.730422 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: COMMIT
[0m20:22:57.731327 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.732755 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_model_naming_conventions__dbt_backup"
[0m20:22:57.733142 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m20:22:57.733326 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */
drop view if exists "dw"."public"."fct_model_naming_conventions__dbt_backup" cascade
[0m20:22:57.733902 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:57.734492 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: Close
[0m20:22:57.734798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119954eb0>]}
[0m20:22:57.735128 [info ] [Thread-1  ]: 21 of 78 OK created sql view model public.fct_model_naming_conventions ......... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:57.735421 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m20:22:57.735619 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m20:22:57.735897 [info ] [Thread-1  ]: 22 of 78 START sql view model public.fct_public_models_without_contract ........ [RUN]
[0m20:22:57.736165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_naming_conventions, now model.dbt_project_evaluator.fct_public_models_without_contract)
[0m20:22:57.736347 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_public_models_without_contract
[0m20:22:57.739119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.739850 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_public_models_without_contract
[0m20:22:57.742359 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.743138 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.743344 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: BEGIN
[0m20:22:57.743526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.749938 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:57.750197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.750377 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */

  create view "dw"."public"."fct_public_models_without_contract__dbt_tmp"
    
    
  as (
    with 

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

final as (

    select 
        resource_name,
        is_public,
        is_contract_enforced
        
    from all_resources
    where 
        is_public 
        and not is_contract_enforced
)

select * from final



    

    
    

    

    


  );
[0m20:22:57.752583 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:57.754629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.754830 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */
alter table "dw"."public"."fct_public_models_without_contract__dbt_tmp" rename to "fct_public_models_without_contract"
[0m20:22:57.755926 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:57.756596 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: COMMIT
[0m20:22:57.756762 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.756913 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: COMMIT
[0m20:22:57.759310 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:57.760687 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_public_models_without_contract__dbt_backup"
[0m20:22:57.761039 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m20:22:57.761203 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */
drop view if exists "dw"."public"."fct_public_models_without_contract__dbt_backup" cascade
[0m20:22:57.761816 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:57.762429 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: Close
[0m20:22:57.762725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119954eb0>]}
[0m20:22:57.763053 [info ] [Thread-1  ]: 22 of 78 OK created sql view model public.fct_public_models_without_contract ... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:57.763335 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m20:22:57.763532 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_source_directories
[0m20:22:57.763821 [info ] [Thread-1  ]: 23 of 78 START sql view model public.fct_source_directories .................... [RUN]
[0m20:22:57.764127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_public_models_without_contract, now model.dbt_project_evaluator.fct_source_directories)
[0m20:22:57.764323 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_source_directories
[0m20:22:57.766723 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.767379 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_source_directories
[0m20:22:57.770607 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.771225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.771401 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: BEGIN
[0m20:22:57.771559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.778759 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:57.778985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.779185 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */

  create view "dw"."public"."fct_source_directories__dbt_tmp"
    
    
  as (
    -- Because we often work with multiple data sources, in our staging directory, we create one directory per source.

-- This model finds all cases where a source definition is NOT in the appropriate subdirectory.



with all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

-- find all sources that are definied in a .yml file NOT in their subdirectory
inappropriate_subdirectories_sources as (
    select 
        resource_name,
        resource_type,
        file_path as current_file_path,
        'models/' || 'staging' || '/' || source_name || '/' || file_name as change_file_path_to
    from all_graph_resources
    where resource_type = 'source'
    and directory_path not like '%' || source_name || '%'
)

select * from inappropriate_subdirectories_sources



    

    
    

    

    


  );
[0m20:22:57.781873 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:57.783658 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.783830 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */
alter table "dw"."public"."fct_source_directories__dbt_tmp" rename to "fct_source_directories"
[0m20:22:57.784413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:57.785091 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: COMMIT
[0m20:22:57.785256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.785408 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: COMMIT
[0m20:22:57.786380 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:57.787757 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_source_directories__dbt_backup"
[0m20:22:57.788155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m20:22:57.788323 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */
drop view if exists "dw"."public"."fct_source_directories__dbt_backup" cascade
[0m20:22:57.789133 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:57.789724 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: Close
[0m20:22:57.790043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1eadf0>]}
[0m20:22:58.396124 [debug] [Thread-1  ]: An error was encountered while trying to send an event
[0m20:22:58.398785 [info ] [Thread-1  ]: 23 of 78 OK created sql view model public.fct_source_directories ............... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.400603 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_source_directories
[0m20:22:58.401595 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m20:22:58.402847 [info ] [Thread-1  ]: 24 of 78 START sql view model public.fct_sources_without_freshness ............. [RUN]
[0m20:22:58.404283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_directories, now model.dbt_project_evaluator.fct_sources_without_freshness)
[0m20:22:58.404894 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_sources_without_freshness
[0m20:22:58.413211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.415823 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_sources_without_freshness
[0m20:22:58.422035 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.423340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.423714 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: BEGIN
[0m20:22:58.424042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.439093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m20:22:58.439613 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.439953 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */

  create view "dw"."public"."fct_sources_without_freshness__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select distinct
        resource_name

    from all_resources
    where not is_freshness_enabled and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m20:22:58.445550 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:22:58.449763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.450100 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */
alter table "dw"."public"."fct_sources_without_freshness__dbt_tmp" rename to "fct_sources_without_freshness"
[0m20:22:58.451777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.453040 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: COMMIT
[0m20:22:58.453356 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.453643 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: COMMIT
[0m20:22:58.455704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:58.458013 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_sources_without_freshness__dbt_backup"
[0m20:22:58.458581 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m20:22:58.458851 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */
drop view if exists "dw"."public"."fct_sources_without_freshness__dbt_backup" cascade
[0m20:22:58.459795 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:58.460696 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: Close
[0m20:22:58.461147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1eadf0>]}
[0m20:22:58.461621 [info ] [Thread-1  ]: 24 of 78 OK created sql view model public.fct_sources_without_freshness ........ [[32mCREATE VIEW[0m in 0.06s]
[0m20:22:58.462035 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m20:22:58.462320 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_models
[0m20:22:58.462738 [info ] [Thread-1  ]: 25 of 78 START sql view model public.fct_undocumented_models ................... [RUN]
[0m20:22:58.463213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_sources_without_freshness, now model.dbt_project_evaluator.fct_undocumented_models)
[0m20:22:58.463570 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_models
[0m20:22:58.466800 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.467687 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_models
[0m20:22:58.471455 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.472250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.472508 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: BEGIN
[0m20:22:58.472742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.485536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m20:22:58.485847 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.486120 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */

  create view "dw"."public"."fct_undocumented_models__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select
        resource_name,
        model_type

    from all_resources
    where not is_described and resource_type = 'model'

)

select * from final



    

    
    

    

    


  );
[0m20:22:58.489701 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:58.492464 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.492735 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */
alter table "dw"."public"."fct_undocumented_models__dbt_tmp" rename to "fct_undocumented_models"
[0m20:22:58.493732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.494642 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: COMMIT
[0m20:22:58.494878 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.495100 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: COMMIT
[0m20:22:58.497673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:58.500709 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_models__dbt_backup"
[0m20:22:58.501226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m20:22:58.501466 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */
drop view if exists "dw"."public"."fct_undocumented_models__dbt_backup" cascade
[0m20:22:58.502499 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:58.503346 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: Close
[0m20:22:58.503771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1eadf0>]}
[0m20:22:58.504232 [info ] [Thread-1  ]: 25 of 78 OK created sql view model public.fct_undocumented_models .............. [[32mCREATE VIEW[0m in 0.04s]
[0m20:22:58.504600 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_models
[0m20:22:58.504854 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m20:22:58.505231 [info ] [Thread-1  ]: 26 of 78 START sql view model public.fct_undocumented_public_models ............ [RUN]
[0m20:22:58.505580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_models, now model.dbt_project_evaluator.fct_undocumented_public_models)
[0m20:22:58.505843 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_public_models
[0m20:22:58.508768 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.512539 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_public_models
[0m20:22:58.515958 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.516821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.517032 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: BEGIN
[0m20:22:58.517223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.525778 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:58.526089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.526310 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */

  create view "dw"."public"."fct_undocumented_public_models__dbt_tmp"
    
    
  as (
    with 

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

final as (
    select 
        resource_name,
        access, 
        is_described, 
        total_defined_columns,
        total_described_columns
    
    from all_resources
    where 
        is_public 
        and (
            -- no model level description
            not is_described
            -- not all columns defined have descriptions
            or total_described_columns < total_defined_columns
            -- no columns defined at all
            or total_defined_columns = 0
        )
)

select * from final



    

    
    

    

    


  );
[0m20:22:58.529638 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:58.532141 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.532420 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */
alter table "dw"."public"."fct_undocumented_public_models__dbt_tmp" rename to "fct_undocumented_public_models"
[0m20:22:58.533798 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.534958 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: COMMIT
[0m20:22:58.535234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.535445 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: COMMIT
[0m20:22:58.537433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:58.539464 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_public_models__dbt_backup"
[0m20:22:58.539970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m20:22:58.540191 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */
drop view if exists "dw"."public"."fct_undocumented_public_models__dbt_backup" cascade
[0m20:22:58.541106 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:58.542034 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: Close
[0m20:22:58.542469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198d4ee0>]}
[0m20:22:58.542876 [info ] [Thread-1  ]: 26 of 78 OK created sql view model public.fct_undocumented_public_models ....... [[32mCREATE VIEW[0m in 0.04s]
[0m20:22:58.543202 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m20:22:58.543431 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m20:22:58.543841 [info ] [Thread-1  ]: 27 of 78 START sql view model public.fct_undocumented_source_tables ............ [RUN]
[0m20:22:58.544125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_public_models, now model.dbt_project_evaluator.fct_undocumented_source_tables)
[0m20:22:58.544334 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m20:22:58.546971 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.547695 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m20:22:58.551844 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.552543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.552746 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: BEGIN
[0m20:22:58.552932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.561230 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:58.561522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.561732 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */

  create view "dw"."public"."fct_undocumented_source_tables__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select
        resource_name

    from all_resources
    where not is_described and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m20:22:58.564542 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:58.566780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.566996 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */
alter table "dw"."public"."fct_undocumented_source_tables__dbt_tmp" rename to "fct_undocumented_source_tables"
[0m20:22:58.567738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.568504 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: COMMIT
[0m20:22:58.568700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.568878 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: COMMIT
[0m20:22:58.570150 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:58.571740 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_source_tables__dbt_backup"
[0m20:22:58.572152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m20:22:58.572343 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */
drop view if exists "dw"."public"."fct_undocumented_source_tables__dbt_backup" cascade
[0m20:22:58.572930 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:58.573581 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: Close
[0m20:22:58.573940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a303df0>]}
[0m20:22:58.574298 [info ] [Thread-1  ]: 27 of 78 OK created sql view model public.fct_undocumented_source_tables ....... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.574597 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m20:22:58.574807 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_sources
[0m20:22:58.575147 [info ] [Thread-1  ]: 28 of 78 START sql view model public.fct_undocumented_sources .................. [RUN]
[0m20:22:58.575475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_source_tables, now model.dbt_project_evaluator.fct_undocumented_sources)
[0m20:22:58.575679 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_sources
[0m20:22:58.578026 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.578701 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_sources
[0m20:22:58.581500 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.582093 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.582273 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: BEGIN
[0m20:22:58.582442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.594729 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m20:22:58.595036 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.595229 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */

  create view "dw"."public"."fct_undocumented_sources__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select distinct
        source_name

    from all_resources
    where not is_source_described and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m20:22:58.599002 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:22:58.601986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.602236 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */
alter table "dw"."public"."fct_undocumented_sources__dbt_tmp" rename to "fct_undocumented_sources"
[0m20:22:58.603039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.603809 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: COMMIT
[0m20:22:58.604003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.604182 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: COMMIT
[0m20:22:58.606166 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:58.607738 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_sources__dbt_backup"
[0m20:22:58.608150 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m20:22:58.608344 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */
drop view if exists "dw"."public"."fct_undocumented_sources__dbt_backup" cascade
[0m20:22:58.608967 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:58.609624 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: Close
[0m20:22:58.609970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1ce130>]}
[0m20:22:58.610319 [info ] [Thread-1  ]: 28 of 78 OK created sql view model public.fct_undocumented_sources ............. [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.610625 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_sources
[0m20:22:58.610832 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_direct_relationships
[0m20:22:58.611112 [info ] [Thread-1  ]: 29 of 78 START sql view model public.int_direct_relationships .................. [RUN]
[0m20:22:58.611428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_sources, now model.dbt_project_evaluator.int_direct_relationships)
[0m20:22:58.611672 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_direct_relationships
[0m20:22:58.614872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.615651 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_direct_relationships
[0m20:22:58.618297 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.618830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.619010 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: BEGIN
[0m20:22:58.619176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.626989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:58.627245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.627502 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */

  create view "dw"."public"."int_direct_relationships__dbt_tmp"
    
    
  as (
    -- one record for each resource in the graph and its direct parent
with 

all_graph_resources as (
    select
        resource_id,
        resource_name,
        resource_type,
        file_path,
        directory_path, 
        file_name,
        model_type,
        materialized,
        is_public, 
        access, 
        source_name,
        is_excluded
    from "dw"."public"."int_all_graph_resources"
),

direct_model_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dw"."public"."stg_node_relationships"
),

direct_exposure_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dw"."public"."stg_exposure_relationships"
),

direct_metrics_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dw"."public"."stg_metric_relationships"
),

-- for all resources in the graph, find their direct parent
direct_relationships as (
    select
        all_graph_resources.resource_id,
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.file_path,
        all_graph_resources.directory_path, 
        all_graph_resources.file_name,
        all_graph_resources.model_type,
        all_graph_resources.materialized,
        all_graph_resources.is_public, 
        all_graph_resources.access, 
        all_graph_resources.source_name,
        all_graph_resources.is_excluded,
        case 
            when all_graph_resources.resource_type = 'source' then null
            when all_graph_resources.resource_type = 'exposure' then exposures.direct_parent_id
            when all_graph_resources.resource_type = 'metric' then metrics.direct_parent_id
            when all_graph_resources.resource_type in ('model', 'snapshot', 'test') then models.direct_parent_id
            else null
        end as direct_parent_id,
        (
            all_graph_resources.resource_type = 'test'
            and models.is_primary_relationship
        ) as is_primary_test_relationship
    from all_graph_resources
    left join direct_model_relationships as models
        on all_graph_resources.resource_id = models.resource_id
    left join direct_exposure_relationships as exposures
        on all_graph_resources.resource_id = exposures.resource_id
    left join direct_metrics_relationships as metrics
        on all_graph_resources.resource_id = metrics.resource_id
),

final as (
    select
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id,
        *
    from direct_relationships
)

select * from final
  );
[0m20:22:58.631095 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:58.633150 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.633341 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */
alter table "dw"."public"."int_direct_relationships__dbt_tmp" rename to "int_direct_relationships"
[0m20:22:58.634159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.634932 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: COMMIT
[0m20:22:58.635116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.635282 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: COMMIT
[0m20:22:58.636098 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:58.638305 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_direct_relationships__dbt_backup"
[0m20:22:58.638678 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m20:22:58.638855 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */
drop view if exists "dw"."public"."int_direct_relationships__dbt_backup" cascade
[0m20:22:58.639455 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:58.640166 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: Close
[0m20:22:58.640534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a094490>]}
[0m20:22:58.640885 [info ] [Thread-1  ]: 29 of 78 OK created sql view model public.int_direct_relationships ............. [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.641167 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_direct_relationships
[0m20:22:58.641369 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m20:22:58.641560 [info ] [Thread-1  ]: 30 of 78 START test valid_documentation_coverage ............................... [RUN]
[0m20:22:58.641922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_direct_relationships, now test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7)
[0m20:22:58.642118 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m20:22:58.645173 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m20:22:58.645995 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m20:22:58.654888 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m20:22:58.655828 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m20:22:58.656004 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: BEGIN
[0m20:22:58.656162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.663581 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.663820 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m20:22:58.664020 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "dw"."public"."fct_documentation_coverage"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not documentation_coverage_pct >= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:22:58.666794 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:58.668726 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: ROLLBACK
[0m20:22:58.669441 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: Close
[0m20:22:58.669831 [warn ] [Thread-1  ]: 30 of 78 WARN 1 valid_documentation_coverage ................................... [[33mWARN 1[0m in 0.03s]
[0m20:22:58.670139 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m20:22:58.670342 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m20:22:58.670562 [info ] [Thread-1  ]: 31 of 78 START test is_empty_fct_duplicate_sources_ ............................ [RUN]
[0m20:22:58.670791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7, now test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31)
[0m20:22:58.670976 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m20:22:58.673550 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m20:22:58.674324 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m20:22:58.675795 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m20:22:58.676555 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m20:22:58.676744 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: BEGIN
[0m20:22:58.677034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.683790 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.684171 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m20:22:58.684377 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_duplicate_sources"


      
    ) dbt_internal_test
[0m20:22:58.685520 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.686431 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: ROLLBACK
[0m20:22:58.687042 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: Close
[0m20:22:58.687426 [info ] [Thread-1  ]: 31 of 78 PASS is_empty_fct_duplicate_sources_ .................................. [[32mPASS[0m in 0.02s]
[0m20:22:58.687740 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m20:22:58.687952 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m20:22:58.688197 [info ] [Thread-1  ]: 32 of 78 START test is_empty_fct_hard_coded_references_ ........................ [RUN]
[0m20:22:58.688477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31, now test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113)
[0m20:22:58.688689 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m20:22:58.691462 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m20:22:58.692079 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m20:22:58.694828 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m20:22:58.695584 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m20:22:58.695784 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: BEGIN
[0m20:22:58.695956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.702822 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.703117 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m20:22:58.703318 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_hard_coded_references"


      
    ) dbt_internal_test
[0m20:22:58.704176 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.704976 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: ROLLBACK
[0m20:22:58.705500 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: Close
[0m20:22:58.705834 [warn ] [Thread-1  ]: 32 of 78 WARN 1 is_empty_fct_hard_coded_references_ ............................ [[33mWARN 1[0m in 0.02s]
[0m20:22:58.706127 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m20:22:58.706328 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m20:22:58.706548 [info ] [Thread-1  ]: 33 of 78 START test is_empty_fct_model_naming_conventions_ ..................... [RUN]
[0m20:22:58.706782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113, now test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2)
[0m20:22:58.706967 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m20:22:58.709498 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m20:22:58.710428 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m20:22:58.711867 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m20:22:58.712587 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m20:22:58.712773 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: BEGIN
[0m20:22:58.712954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.720255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.720531 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m20:22:58.720723 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_model_naming_conventions"


      
    ) dbt_internal_test
[0m20:22:58.722516 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m20:22:58.723349 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: ROLLBACK
[0m20:22:58.723902 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: Close
[0m20:22:58.724228 [warn ] [Thread-1  ]: 33 of 78 WARN 1 is_empty_fct_model_naming_conventions_ ......................... [[33mWARN 1[0m in 0.02s]
[0m20:22:58.724518 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m20:22:58.724714 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m20:22:58.724952 [info ] [Thread-1  ]: 34 of 78 START test is_empty_fct_public_models_without_contract_ ............... [RUN]
[0m20:22:58.725219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2, now test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0)
[0m20:22:58.725394 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m20:22:58.727676 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m20:22:58.728535 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m20:22:58.730157 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m20:22:58.730763 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m20:22:58.730955 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: BEGIN
[0m20:22:58.731116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.737448 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.737716 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m20:22:58.737915 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_public_models_without_contract"


      
    ) dbt_internal_test
[0m20:22:58.739246 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.740198 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: ROLLBACK
[0m20:22:58.741080 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: Close
[0m20:22:58.741440 [info ] [Thread-1  ]: 34 of 78 PASS is_empty_fct_public_models_without_contract_ ..................... [[32mPASS[0m in 0.02s]
[0m20:22:58.741739 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m20:22:58.741946 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m20:22:58.742173 [info ] [Thread-1  ]: 35 of 78 START test is_empty_fct_source_directories_ ........................... [RUN]
[0m20:22:58.742414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0, now test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c)
[0m20:22:58.742598 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m20:22:58.745812 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m20:22:58.746492 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m20:22:58.748309 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m20:22:58.748983 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m20:22:58.749168 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: BEGIN
[0m20:22:58.749347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.756005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.756283 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m20:22:58.756476 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_source_directories"


      
    ) dbt_internal_test
[0m20:22:58.757629 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.758448 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: ROLLBACK
[0m20:22:58.759030 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: Close
[0m20:22:58.759381 [info ] [Thread-1  ]: 35 of 78 PASS is_empty_fct_source_directories_ ................................. [[32mPASS[0m in 0.02s]
[0m20:22:58.759679 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m20:22:58.759891 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m20:22:58.760166 [info ] [Thread-1  ]: 36 of 78 START test is_empty_fct_sources_without_freshness_ .................... [RUN]
[0m20:22:58.760542 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c, now test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283)
[0m20:22:58.760732 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m20:22:58.763643 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m20:22:58.764422 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m20:22:58.766033 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m20:22:58.766768 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m20:22:58.766952 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: BEGIN
[0m20:22:58.767113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.773608 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.773917 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m20:22:58.774121 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_sources_without_freshness"


      
    ) dbt_internal_test
[0m20:22:58.775553 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.776560 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: ROLLBACK
[0m20:22:58.777370 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: Close
[0m20:22:58.777779 [warn ] [Thread-1  ]: 36 of 78 WARN 3 is_empty_fct_sources_without_freshness_ ........................ [[33mWARN 3[0m in 0.02s]
[0m20:22:58.778099 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m20:22:58.778304 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m20:22:58.778532 [info ] [Thread-1  ]: 37 of 78 START test is_empty_fct_undocumented_models_ .......................... [RUN]
[0m20:22:58.778857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283, now test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c)
[0m20:22:58.779047 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m20:22:58.781413 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m20:22:58.782008 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m20:22:58.783386 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m20:22:58.783886 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m20:22:58.784048 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: BEGIN
[0m20:22:58.784199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.790681 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.790957 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m20:22:58.791152 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_models"


      
    ) dbt_internal_test
[0m20:22:58.792429 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.793254 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: ROLLBACK
[0m20:22:58.794093 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: Close
[0m20:22:58.794418 [warn ] [Thread-1  ]: 37 of 78 WARN 7 is_empty_fct_undocumented_models_ .............................. [[33mWARN 7[0m in 0.02s]
[0m20:22:58.794724 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m20:22:58.794928 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m20:22:58.795154 [info ] [Thread-1  ]: 38 of 78 START test is_empty_fct_undocumented_public_models_ ................... [RUN]
[0m20:22:58.795417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c, now test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938)
[0m20:22:58.795592 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m20:22:58.798649 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m20:22:58.799270 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m20:22:58.800840 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m20:22:58.801370 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m20:22:58.801549 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: BEGIN
[0m20:22:58.801699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.807742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.807958 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m20:22:58.808137 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_public_models"


      
    ) dbt_internal_test
[0m20:22:58.809733 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.810482 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: ROLLBACK
[0m20:22:58.810910 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: Close
[0m20:22:58.811233 [info ] [Thread-1  ]: 38 of 78 PASS is_empty_fct_undocumented_public_models_ ......................... [[32mPASS[0m in 0.02s]
[0m20:22:58.811525 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m20:22:58.811726 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m20:22:58.811949 [info ] [Thread-1  ]: 39 of 78 START test is_empty_fct_undocumented_source_tables_ ................... [RUN]
[0m20:22:58.812171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938, now test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166)
[0m20:22:58.812357 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m20:22:58.814978 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m20:22:58.815600 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m20:22:58.817509 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m20:22:58.818098 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m20:22:58.818264 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: BEGIN
[0m20:22:58.818418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.824609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.824830 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m20:22:58.825013 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_source_tables"


      
    ) dbt_internal_test
[0m20:22:58.826445 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.827336 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: ROLLBACK
[0m20:22:58.828044 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: Close
[0m20:22:58.828434 [warn ] [Thread-1  ]: 39 of 78 WARN 3 is_empty_fct_undocumented_source_tables_ ....................... [[33mWARN 3[0m in 0.02s]
[0m20:22:58.828755 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m20:22:58.828964 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m20:22:58.829208 [info ] [Thread-1  ]: 40 of 78 START test is_empty_fct_undocumented_sources_ ......................... [RUN]
[0m20:22:58.829568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166, now test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235)
[0m20:22:58.829859 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m20:22:58.832444 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m20:22:58.832994 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m20:22:58.835195 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m20:22:58.835737 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m20:22:58.835922 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: BEGIN
[0m20:22:58.836094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.842203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.842460 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m20:22:58.842652 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_sources"


      
    ) dbt_internal_test
[0m20:22:58.843879 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:58.844792 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: ROLLBACK
[0m20:22:58.845337 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: Close
[0m20:22:58.845733 [warn ] [Thread-1  ]: 40 of 78 WARN 1 is_empty_fct_undocumented_sources_ ............................. [[33mWARN 1[0m in 0.02s]
[0m20:22:58.846041 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m20:22:58.846252 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_test_directories
[0m20:22:58.846600 [info ] [Thread-1  ]: 41 of 78 START sql view model public.fct_test_directories ...................... [RUN]
[0m20:22:58.846881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235, now model.dbt_project_evaluator.fct_test_directories)
[0m20:22:58.847077 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_test_directories
[0m20:22:58.849804 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.850384 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_test_directories
[0m20:22:58.853026 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.853749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.853960 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: BEGIN
[0m20:22:58.854137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.860233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.860479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.860697 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */

  create view "dw"."public"."fct_test_directories__dbt_tmp"
    
    
  as (
    with

resources as (

    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

relationships as (

    select * from "dw"."public"."int_direct_relationships"

),

models_per_test as (

    select
        resource_name as test_name,
        resource_id as test_id,
        direct_parent_id as parent_model_id
    from relationships
    where resource_type = 'test'
    and is_primary_test_relationship

),

model_file_paths as (

    select
        resources.resource_id as model_id,
        resources.resource_name as model_name,
        resources.directory_path as model_directory_path,
        models_per_test.test_id,
        models_per_test.parent_model_id
    from resources
    inner join models_per_test
    on models_per_test.parent_model_id = resources.resource_id
    where resource_type = 'model'

),

test_file_paths as (

    select
        resource_id as test_id,
        resource_name as test_name,
        file_name as test_yml_name,
        directory_path as test_yml_directory_path
    from resources
    where 
        resource_type = 'test'
        and is_generic_test

),

all_file_paths as (

    select
        test_file_paths.test_id,
        test_file_paths.test_name,
        test_file_paths.test_yml_directory_path,
        test_file_paths.test_yml_name,
        model_file_paths.model_id,
        model_file_paths.model_name,
        model_file_paths.model_directory_path
    from model_file_paths
    inner join test_file_paths
    on model_file_paths.test_id = test_file_paths.test_id

),

different_directories as (

    select
        test_name,
        model_name,
        test_yml_directory_path as current_test_directory,
        model_directory_path as change_test_directory_to
    from all_file_paths
    where model_directory_path != test_yml_directory_path

)

select * from different_directories



    

    
    

    

    


  );
[0m20:22:58.863534 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:58.865755 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.865993 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
alter table "dw"."public"."fct_test_directories__dbt_tmp" rename to "fct_test_directories"
[0m20:22:58.867355 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.868186 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m20:22:58.868386 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.868557 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m20:22:58.870150 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:58.871816 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_test_directories__dbt_backup"
[0m20:22:58.872237 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m20:22:58.872407 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
drop view if exists "dw"."public"."fct_test_directories__dbt_backup" cascade
[0m20:22:58.873200 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:58.873974 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: Close
[0m20:22:58.874341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1ce130>]}
[0m20:22:58.874712 [info ] [Thread-1  ]: 41 of 78 OK created sql view model public.fct_test_directories ................. [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.875005 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_test_directories
[0m20:22:58.875207 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_all_dag_relationships
[0m20:22:58.875519 [info ] [Thread-1  ]: 42 of 78 START sql view model public.int_all_dag_relationships ................. [RUN]
[0m20:22:58.875831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_directories, now model.dbt_project_evaluator.int_all_dag_relationships)
[0m20:22:58.876020 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_all_dag_relationships
[0m20:22:58.878910 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.879625 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_all_dag_relationships
[0m20:22:58.883486 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.884250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.884440 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: BEGIN
[0m20:22:58.884610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.891644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.891900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.892189 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */

  create view "dw"."public"."int_all_dag_relationships__dbt_tmp"
    
    
  as (
    -- creates a cte called all_relationships that will either use "with recursive" or loops depending on the DW


with recursive direct_relationships as (
    select
        *
    from "dw"."public"."int_direct_relationships"
    where resource_type <> 'test'
),

-- should this be a fct_ model?

-- recursive CTE
-- one record for every resource and each of its downstream children (including itself)
all_relationships (
    parent_id,
    parent,
    parent_resource_type,
    parent_model_type,
    parent_materialized,
    parent_access,
    parent_is_public,
    parent_source_name,
    parent_file_path,
    parent_directory_path,
    parent_file_name,
    parent_is_excluded,
    child_id,
    child,
    child_resource_type,
    child_model_type,
    child_materialized,
    child_access,
    child_is_public,
    child_source_name,
    child_file_path,
    child_directory_path,
    child_file_name,
    child_is_excluded,
    distance,
    path,
    is_dependent_on_chain_of_views
) as (
    -- anchor
    select distinct
        resource_id as parent_id,
        resource_name as parent,
        resource_type as parent_resource_type,
        model_type as parent_model_type,
        materialized as parent_materialized,
        access as parent_access,
        is_public as parent_is_public,
        source_name as parent_source_name,
        file_path as parent_file_path,
        directory_path as parent_directory_path,
        file_name as parent_file_name,
        is_excluded as parent_is_excluded,
        resource_id as child_id,
        resource_name as child,
        resource_type as child_resource_type,
        model_type as child_model_type,
        materialized as child_materialized,
        access as child_access,
        is_public as child_is_public,
        source_name as child_source_name,
        file_path as child_file_path,
        directory_path as child_directory_path,
        file_name as child_file_name,
        is_excluded as child_is_excluded,
        0 as distance,
        
    array[ resource_name ]
     as path,
        cast(null as boolean) as is_dependent_on_chain_of_views

    from direct_relationships
    -- where direct_parent_id is null 

    union all

    -- recursive clause
    select
        all_relationships.parent_id as parent_id,
        all_relationships.parent as parent,
        all_relationships.parent_resource_type as parent_resource_type,
        all_relationships.parent_model_type as parent_model_type,
        all_relationships.parent_materialized as parent_materialized,
        all_relationships.parent_access as parent_access,
        all_relationships.parent_is_public as parent_is_public,
        all_relationships.parent_source_name as parent_source_name,
        all_relationships.parent_file_path as parent_file_path,
        all_relationships.parent_directory_path as parent_directory_path,
        all_relationships.parent_file_name as parent_file_name,
        all_relationships.parent_is_excluded as parent_is_excluded,
        direct_relationships.resource_id as child_id,
        direct_relationships.resource_name as child,
        direct_relationships.resource_type as child_resource_type,
        direct_relationships.model_type as child_model_type,
        direct_relationships.materialized as child_materialized,
        direct_relationships.access as child_access,
        direct_relationships.is_public as child_is_public,
        direct_relationships.source_name as child_source_name,
        direct_relationships.file_path as child_file_path,
        direct_relationships.directory_path as child_directory_path,
        direct_relationships.file_name as child_file_name,
        direct_relationships.is_excluded as child_is_excluded,
        all_relationships.distance+1 as distance,
        array_append(all_relationships.path, direct_relationships.resource_name) as path,
        case
            when
                all_relationships.child_materialized in ('view', 'ephemeral')
                and coalesce(all_relationships.is_dependent_on_chain_of_views, true)
                then true
            else false
        end as is_dependent_on_chain_of_views

    from direct_relationships
    inner join all_relationships
        on all_relationships.child_id = direct_relationships.direct_parent_id

    

)



select * from all_relationships
order by parent, distance
  );
[0m20:22:58.895939 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:58.898022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.898233 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
alter table "dw"."public"."int_all_dag_relationships__dbt_tmp" rename to "int_all_dag_relationships"
[0m20:22:58.899402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.900138 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m20:22:58.900304 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.900455 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m20:22:58.901208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:58.902610 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_all_dag_relationships__dbt_backup"
[0m20:22:58.902975 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m20:22:58.903150 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
drop view if exists "dw"."public"."int_all_dag_relationships__dbt_backup" cascade
[0m20:22:58.903714 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:58.904297 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: Close
[0m20:22:58.904599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1ce130>]}
[0m20:22:58.904929 [info ] [Thread-1  ]: 42 of 78 OK created sql view model public.int_all_dag_relationships ............ [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.905210 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_all_dag_relationships
[0m20:22:58.905404 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_model_test_summary
[0m20:22:58.905710 [info ] [Thread-1  ]: 43 of 78 START sql view model public.int_model_test_summary .................... [RUN]
[0m20:22:58.906110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_dag_relationships, now model.dbt_project_evaluator.int_model_test_summary)
[0m20:22:58.906285 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_model_test_summary
[0m20:22:58.910858 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.911723 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_model_test_summary
[0m20:22:58.914953 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.915665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.915835 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: BEGIN
[0m20:22:58.915984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.923505 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.923762 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.924040 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */

  create view "dw"."public"."int_model_test_summary__dbt_tmp"
    
    
  as (
    with 

all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

relationships as (
    select * from "dw"."public"."int_direct_relationships"
),

count_column_tests as (
    
    select 
        relationships.direct_parent_id, 
        all_graph_resources.column_name,
        sum(case
                when all_graph_resources.is_test_unique
                then 1
                else 0
            end
         ) as test_unique_count,count(distinct case when 
                all_graph_resources.is_test_unique or  
                all_graph_resources.is_test_not_null
            then relationships.resource_id else null end
        ) as primary_key_method_1_count,count(distinct case when 
                all_graph_resources.is_test_unique_combination_of_columns
            then relationships.resource_id else null end
        ) as primary_key_method_2_count,
        count(distinct relationships.resource_id) as tests_count
    from all_graph_resources
    left join relationships
        on all_graph_resources.resource_id = relationships.resource_id
    where all_graph_resources.resource_type = 'test'
    and relationships.is_primary_test_relationship
    group by 1,2
),

count_column_constraints as (

    select
        node_unique_id as direct_parent_id,
        name as column_name,
        case
            when has_not_null_constraint
            then 1
            else 0
        end as constraint_not_null_count,
        constraints_count
    from "dw"."public"."base_node_columns"

),

combine_column_counts as (

    select
        count_column_tests.*,
        count_column_tests.test_unique_count + count_column_constraints.constraint_not_null_count as primary_key_mixed_method_count,
        count_column_constraints.constraints_count
    from count_column_tests
    left join count_column_constraints
        on count_column_tests.direct_parent_id = count_column_constraints.direct_parent_id
        and count_column_tests.column_name = count_column_constraints.column_name

),

agg_test_relationships as (

    select 
        direct_parent_id, 
        cast(sum(case 
                when (
                    primary_key_method_1_count >= 2
                        or
                    primary_key_method_2_count >= 1
                        or
                    primary_key_mixed_method_count >= 2
                ) then 1 
                else 0 
            end
        ) >= 1 as boolean) as is_primary_key_tested,
        cast(sum(tests_count) as integer) as number_of_tests_on_model,
        cast(sum(constraints_count) as integer) as number_of_constraints_on_model
    from combine_column_counts
    group by 1

),

final as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        cast(coalesce(agg_test_relationships.is_primary_key_tested, FALSE) as boolean) as is_primary_key_tested,
        cast(coalesce(agg_test_relationships.number_of_tests_on_model, 0) as integer) as number_of_tests_on_model,
        cast(coalesce(agg_test_relationships.number_of_constraints_on_model, 0) as integer) as number_of_constraints_on_model
    from all_graph_resources
    left join agg_test_relationships
        on all_graph_resources.resource_id = agg_test_relationships.direct_parent_id
    where
        all_graph_resources.resource_type in ('model', 'seed', 'source', 'snapshot')
)

select * from final
  );
[0m20:22:58.929483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:22:58.931423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.931604 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
alter table "dw"."public"."int_model_test_summary__dbt_tmp" rename to "int_model_test_summary"
[0m20:22:58.932437 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.933134 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m20:22:58.933302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.933468 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m20:22:58.934778 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:58.936226 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_model_test_summary__dbt_backup"
[0m20:22:58.936586 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m20:22:58.936754 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
drop view if exists "dw"."public"."int_model_test_summary__dbt_backup" cascade
[0m20:22:58.937338 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:58.937980 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: Close
[0m20:22:58.938298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1ce130>]}
[0m20:22:58.938631 [info ] [Thread-1  ]: 43 of 78 OK created sql view model public.int_model_test_summary ............... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.938926 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_model_test_summary
[0m20:22:58.939128 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m20:22:58.939386 [info ] [Thread-1  ]: 44 of 78 START test is_empty_fct_test_directories_ ............................. [RUN]
[0m20:22:58.939718 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_model_test_summary, now test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433)
[0m20:22:58.939913 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m20:22:58.942085 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m20:22:58.942726 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m20:22:58.944100 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m20:22:58.944565 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m20:22:58.944779 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: BEGIN
[0m20:22:58.944983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.951138 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:58.951380 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m20:22:58.951544 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_test_directories"


      
    ) dbt_internal_test
[0m20:22:58.956069 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m20:22:58.956909 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: ROLLBACK
[0m20:22:58.957517 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: Close
[0m20:22:58.957898 [info ] [Thread-1  ]: 44 of 78 PASS is_empty_fct_test_directories_ ................................... [[32mPASS[0m in 0.02s]
[0m20:22:58.958199 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m20:22:58.958391 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m20:22:58.958689 [info ] [Thread-1  ]: 45 of 78 START sql view model public.fct_chained_views_dependencies ............ [RUN]
[0m20:22:58.958970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433, now model.dbt_project_evaluator.fct_chained_views_dependencies)
[0m20:22:58.959143 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m20:22:58.961979 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.962870 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m20:22:58.966323 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.967050 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.967236 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: BEGIN
[0m20:22:58.967406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:58.974428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:58.974787 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.975012 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */

  create view "dw"."public"."fct_chained_views_dependencies__dbt_tmp"
    
    
  as (
    with all_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance <> 0
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent,
        child, -- the model with potentially long run time / compilation time, improve performance by breaking the upstream chain of views
        distance,
        path
    from all_relationships
    where is_dependent_on_chain_of_views
    and child_resource_type = 'model'
    and distance > 5
)

select * from final



    

    
    

    

    



order by distance desc
  );
[0m20:22:58.977262 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:58.979299 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.979498 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
alter table "dw"."public"."fct_chained_views_dependencies__dbt_tmp" rename to "fct_chained_views_dependencies"
[0m20:22:58.980324 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:58.981107 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m20:22:58.981290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.981449 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m20:22:58.982540 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:58.984121 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_chained_views_dependencies__dbt_backup"
[0m20:22:58.984487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m20:22:58.984675 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
drop view if exists "dw"."public"."fct_chained_views_dependencies__dbt_backup" cascade
[0m20:22:58.985285 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:58.985935 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: Close
[0m20:22:58.986283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1f5700>]}
[0m20:22:58.986632 [info ] [Thread-1  ]: 45 of 78 OK created sql view model public.fct_chained_views_dependencies ....... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:58.986990 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m20:22:58.987257 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m20:22:58.987634 [info ] [Thread-1  ]: 46 of 78 START sql table model public.fct_direct_join_to_source ................ [RUN]
[0m20:22:58.987971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_chained_views_dependencies, now model.dbt_project_evaluator.fct_direct_join_to_source)
[0m20:22:58.988175 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_direct_join_to_source
[0m20:22:58.990431 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:58.991121 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_direct_join_to_source
[0m20:22:58.993891 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:58.994538 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:58.994721 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: BEGIN
[0m20:22:58.994891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.001103 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.001339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:59.001560 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */

  
    

  create  table "dw"."public"."fct_direct_join_to_source__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has a reference to both a model and a source

with direct_model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where child_resource_type = 'model'
    and distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),

model_and_source_joined as (
    select
        child,
        case 
            when (
                sum(case when parent_resource_type = 'model' then 1 else 0 end) > 0 
                and sum(case when parent_resource_type = 'source' then 1 else 0 end) > 0
            ) 
            then true
            else false 
        end as keep_row 
    from direct_model_relationships
    group by 1
),

final as (
    select 
        direct_model_relationships.parent,
        direct_model_relationships.parent_resource_type,
        direct_model_relationships.child,
        direct_model_relationships.child_resource_type,
        direct_model_relationships.distance
    from direct_model_relationships
    inner join model_and_source_joined
        on direct_model_relationships.child = model_and_source_joined.child
    where model_and_source_joined.keep_row
    order by direct_model_relationships.child
)

select * from final



    

    
    

    

    


  );
  
[0m20:22:59.006044 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:59.008825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:59.009051 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "dw"."public"."fct_direct_join_to_source__dbt_tmp" rename to "fct_direct_join_to_source"
[0m20:22:59.009827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.010606 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m20:22:59.010787 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:59.010957 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m20:22:59.011750 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.013281 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_direct_join_to_source__dbt_backup"
[0m20:22:59.013703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m20:22:59.013889 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
drop table if exists "dw"."public"."fct_direct_join_to_source__dbt_backup" cascade
[0m20:22:59.014473 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.015130 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: Close
[0m20:22:59.015453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1f1160>]}
[0m20:22:59.015794 [info ] [Thread-1  ]: 46 of 78 OK created sql table model public.fct_direct_join_to_source ........... [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.016083 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m20:22:59.016279 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m20:22:59.016609 [info ] [Thread-1  ]: 47 of 78 START sql view model public.fct_exposure_parents_materializations ..... [RUN]
[0m20:22:59.016945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_direct_join_to_source, now model.dbt_project_evaluator.fct_exposure_parents_materializations)
[0m20:22:59.017145 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m20:22:59.019332 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.019969 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m20:22:59.022581 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.023202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.023438 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: BEGIN
[0m20:22:59.023615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.030869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.031130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.031337 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */

  create view "dw"."public"."fct_exposure_parents_materializations__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "dw"."public"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and ((
                parent_resource_type = 'model'
                and parent_materialized in ('view', 'ephemeral')
            )
            or (
                parent_resource_type = 'source'
            )
        )
        -- no test on child_is_excluded because exposures are never excluded
        and not parent_is_excluded
),

final as (

    select 
        parent_resource_type,
        parent as parent_resource_name,
        child as exposure_name,
        parent_materialized as parent_model_materialization

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m20:22:59.033178 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:59.035327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.035566 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
alter table "dw"."public"."fct_exposure_parents_materializations__dbt_tmp" rename to "fct_exposure_parents_materializations"
[0m20:22:59.036382 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.037130 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m20:22:59.037301 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.037459 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m20:22:59.038253 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.039688 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_exposure_parents_materializations__dbt_backup"
[0m20:22:59.040076 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m20:22:59.040267 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
drop view if exists "dw"."public"."fct_exposure_parents_materializations__dbt_backup" cascade
[0m20:22:59.041038 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:59.041772 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: Close
[0m20:22:59.042115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1f5700>]}
[0m20:22:59.042457 [info ] [Thread-1  ]: 47 of 78 OK created sql view model public.fct_exposure_parents_materializations  [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:59.042743 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m20:22:59.042944 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m20:22:59.043260 [info ] [Thread-1  ]: 48 of 78 START sql view model public.fct_exposures_dependent_on_private_models . [RUN]
[0m20:22:59.043561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposure_parents_materializations, now model.dbt_project_evaluator.fct_exposures_dependent_on_private_models)
[0m20:22:59.043757 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m20:22:59.046565 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.047184 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m20:22:59.049808 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.050371 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.050554 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: BEGIN
[0m20:22:59.050720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.057688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.057983 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.058193 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */

  create view "dw"."public"."fct_exposures_dependent_on_private_models__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "dw"."public"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and not (
                parent_resource_type = 'model'
                and parent_is_public
            )
        and not parent_is_excluded
),

final as (

    select 
        child as exposure_name,
        parent as parent_resource_name,
        parent_access,
        parent_resource_type

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m20:22:59.060037 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:59.062266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.062512 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
alter table "dw"."public"."fct_exposures_dependent_on_private_models__dbt_tmp" rename to "fct_exposures_dependent_on_private_models"
[0m20:22:59.063323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.064131 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m20:22:59.064332 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.064510 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m20:22:59.065479 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.067260 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_exposures_dependent_on_private_models__dbt_backup"
[0m20:22:59.067770 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m20:22:59.067967 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
drop view if exists "dw"."public"."fct_exposures_dependent_on_private_models__dbt_backup" cascade
[0m20:22:59.068742 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:59.069531 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: Close
[0m20:22:59.069902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119970a30>]}
[0m20:22:59.070264 [info ] [Thread-1  ]: 48 of 78 OK created sql view model public.fct_exposures_dependent_on_private_models  [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:59.070563 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m20:22:59.070771 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m20:22:59.071060 [info ] [Thread-1  ]: 49 of 78 START sql table model public.fct_marts_or_intermediate_dependent_on_source  [RUN]
[0m20:22:59.071361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposures_dependent_on_private_models, now model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source)
[0m20:22:59.071556 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m20:22:59.073859 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.074439 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m20:22:59.078179 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.078852 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.079050 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: BEGIN
[0m20:22:59.079227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.087473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:59.087756 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.087968 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */

  
    

  create  table "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp"
  
  
    as
  
  (
    -- cases where a marts/intermediate model directly references a raw source
with direct_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_resource_type,
        child,
        child_model_type
    from direct_relationships
    where parent_resource_type = 'source'
    and child_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m20:22:59.093923 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m20:22:59.095948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.096154 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp" rename to "fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.096867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.097620 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m20:22:59.097790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.097948 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m20:22:59.099178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.100553 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m20:22:59.100919 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m20:22:59.101104 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
drop table if exists "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_backup" cascade
[0m20:22:59.101694 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.102289 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: Close
[0m20:22:59.102594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119904910>]}
[0m20:22:59.102926 [info ] [Thread-1  ]: 49 of 78 OK created sql table model public.fct_marts_or_intermediate_dependent_on_source  [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.103212 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m20:22:59.103407 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_model_directories
[0m20:22:59.103680 [info ] [Thread-1  ]: 50 of 78 START sql view model public.fct_model_directories ..................... [RUN]
[0m20:22:59.104006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source, now model.dbt_project_evaluator.fct_model_directories)
[0m20:22:59.104214 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_model_directories
[0m20:22:59.107240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.107897 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_model_directories
[0m20:22:59.110616 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.111233 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.111425 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: BEGIN
[0m20:22:59.111595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.118273 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.118549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.118803 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */

  create view "dw"."public"."fct_model_directories__dbt_tmp"
    
    
  as (
    -- This model finds all cases where a model is NOT in the appropriate subdirectory:
    -- For staging models: The files should be in nested in the staging folder in a subfolder that matches their source parent's name.
    -- For non-staging models: The files should be nested closest to their appropriate folder.  

 
with all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

folders as (
    select * from "dw"."public"."stg_naming_convention_folders"
), 

all_dag_relationships as (
    select * from "dw"."public"."int_all_dag_relationships"
    where not child_is_excluded
),

staging_models as (
    select  
        child,
        child_resource_type,
        child_model_type,
        child_file_path,
        child_directory_path,
        child_file_name,
        parent_source_name
    from all_dag_relationships
    where parent_resource_type = 'source'
    and child_resource_type = 'model'
    and child_model_type = 'staging'
),

-- find all staging models that are NOT in their source parent's subdirectory
inappropriate_subdirectories_staging as (
    select distinct -- must do distinct to avoid duplicates when staging model has multiple paths to a given source
        child as resource_name,
        child_resource_type as resource_type,
        child_model_type as model_type,
        child_file_path as current_file_path,
        'models/' || 'staging' || '/' || parent_source_name || '/' || child_file_name as change_file_path_to
    from staging_models
    where child_directory_path not like '%' || parent_source_name || '%'
),

-- find all non-staging models that are NOT nested closest to their appropriate folder
innappropriate_subdirectories_non_staging_models as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        all_graph_resources.file_path as current_file_path,
        'models' || '/.../' || folders.folder_name_value || '/.../' || all_graph_resources.file_name as change_file_path_to
    from all_graph_resources
    left join folders 
        on folders.model_type = all_graph_resources.model_type 
    -- either appropriate folder_name is not in the current_directory_path or a inappropriate folder name is closer to the file_name
    where all_graph_resources.model_type <> all_graph_resources.model_type_folder 
),

unioned as (
    select * from inappropriate_subdirectories_staging
    union all
    select * from innappropriate_subdirectories_non_staging_models
)

select * from unioned



    

    
    

    

    


  );
[0m20:22:59.122075 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:22:59.124737 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.124940 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
alter table "dw"."public"."fct_model_directories__dbt_tmp" rename to "fct_model_directories"
[0m20:22:59.125902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.126610 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m20:22:59.126782 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.126943 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m20:22:59.128122 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.129521 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_model_directories__dbt_backup"
[0m20:22:59.129870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m20:22:59.130045 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
drop view if exists "dw"."public"."fct_model_directories__dbt_backup" cascade
[0m20:22:59.130602 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:59.131200 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: Close
[0m20:22:59.131522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119904910>]}
[0m20:22:59.131847 [info ] [Thread-1  ]: 50 of 78 OK created sql view model public.fct_model_directories ................ [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:59.132129 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_model_directories
[0m20:22:59.132325 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_model_fanout
[0m20:22:59.132556 [info ] [Thread-1  ]: 51 of 78 START sql table model public.fct_model_fanout ......................... [RUN]
[0m20:22:59.132921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_directories, now model.dbt_project_evaluator.fct_model_fanout)
[0m20:22:59.133125 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_model_fanout
[0m20:22:59.135855 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.136478 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_model_fanout
[0m20:22:59.138951 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.139542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.139733 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: BEGIN
[0m20:22:59.139899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.167563 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m20:22:59.169685 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.174562 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */

  
    

  create  table "dw"."public"."fct_model_fanout__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where not parent_is_excluded
    and not child_is_excluded
),

-- find all models without children
models_without_children as (
    select
        parent
    from all_dag_relationships
    where parent_resource_type = 'model'
    group by 1
    having max(distance) = 0
),

-- all parents with more direct children than the threshold for fanout (determined by variable models_fanout_threshold, default 3)
    -- Note: only counts "leaf children" - direct chilren that are models AND are child-less (are at the right-most-point in the DAG)
model_fanout as (
    select 
        all_dag_relationships.parent,
        all_dag_relationships.parent_model_type,
        all_dag_relationships.child
    from all_dag_relationships
    inner join models_without_children
        on all_dag_relationships.child = models_without_children.parent
    where all_dag_relationships.distance = 1 and all_dag_relationships.child_resource_type = 'model'
    group by 1, 2, 3
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2, 3
),

model_fanout_agg as (
    select
        parent,
        parent_model_type,
        
    string_agg(
        child,
        ', '
        
        ) as leaf_children
    from model_fanout
    group by 1, 2
    having count(*) >= 3
)

select * from model_fanout_agg



    

    
    

    

    


  );
  
[0m20:22:59.202604 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.026 seconds
[0m20:22:59.206033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.206313 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "dw"."public"."fct_model_fanout__dbt_tmp" rename to "fct_model_fanout"
[0m20:22:59.207246 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.208311 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m20:22:59.208542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.208743 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m20:22:59.210797 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:59.215717 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_model_fanout__dbt_backup"
[0m20:22:59.217032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m20:22:59.217330 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
drop table if exists "dw"."public"."fct_model_fanout__dbt_backup" cascade
[0m20:22:59.218105 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:59.218890 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: Close
[0m20:22:59.219263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a290700>]}
[0m20:22:59.219614 [info ] [Thread-1  ]: 51 of 78 OK created sql table model public.fct_model_fanout .................... [[32mSELECT 0[0m in 0.09s]
[0m20:22:59.219905 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_model_fanout
[0m20:22:59.220106 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m20:22:59.220379 [info ] [Thread-1  ]: 52 of 78 START sql table model public.fct_multiple_sources_joined .............. [RUN]
[0m20:22:59.220711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_fanout, now model.dbt_project_evaluator.fct_multiple_sources_joined)
[0m20:22:59.220924 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m20:22:59.256355 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.257084 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m20:22:59.259661 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.260174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.260360 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: BEGIN
[0m20:22:59.260529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.266927 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.267212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.267422 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */

  
    

  create  table "dw"."public"."fct_multiple_sources_joined__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model references more than one source
with direct_source_relationships as (
    select distinct
        child,
        parent
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

multiple_sources_joined as (
    select
        child,
        
    string_agg(
        parent,
        ', '
        
        ) as source_parents
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from multiple_sources_joined



    

    
    

    

    


  );
  
[0m20:22:59.271863 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:59.273899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.274106 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "dw"."public"."fct_multiple_sources_joined__dbt_tmp" rename to "fct_multiple_sources_joined"
[0m20:22:59.274788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.275576 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m20:22:59.275737 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.275891 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m20:22:59.277055 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.278451 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_multiple_sources_joined__dbt_backup"
[0m20:22:59.278802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m20:22:59.278969 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
drop table if exists "dw"."public"."fct_multiple_sources_joined__dbt_backup" cascade
[0m20:22:59.279539 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.280152 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: Close
[0m20:22:59.280458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2d4eb0>]}
[0m20:22:59.280784 [info ] [Thread-1  ]: 52 of 78 OK created sql table model public.fct_multiple_sources_joined ......... [[32mSELECT 0[0m in 0.06s]
[0m20:22:59.281065 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m20:22:59.281258 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m20:22:59.281564 [info ] [Thread-1  ]: 53 of 78 START sql table model public.fct_rejoining_of_upstream_concepts ....... [RUN]
[0m20:22:59.281874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_multiple_sources_joined, now model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts)
[0m20:22:59.282064 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m20:22:59.284146 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.284746 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m20:22:59.288288 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.288941 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.289124 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: BEGIN
[0m20:22:59.289294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.295962 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.296238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.296491 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */

  
    

  create  table "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_tmp"
  
  
    as
  
  (
    with all_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where parent_resource_type not in ('exposure', 'metric')
    and child_resource_type not in ('exposure', 'metric')
    and not parent_is_excluded
    and not child_is_excluded
),

-- all parent/child relationships where the parent is BOTH the direct parent of the child and the second level parent of the child 
rejoined as (
    select
        parent,
        child
    from all_relationships
    group by 1, 2
    having (sum(case when distance = 1 then 1 else 0 end) >= 1 
        and sum(case when distance = 2 then 1 else 0 end) >= 1)
),

-- resources with only one direct child
single_use_resources as (
    select
        parent
    from all_relationships
    where distance = 1
    group by 1
    having count(*) = 1
),

-- all cases where one of the parent's direct children (child) is ALSO the direct child of ANOTHER one of the parent's direct childen (parent_and_child)
triad_relationships as (
    select 
        rejoined.parent,
        rejoined.child,
        direct_child.parent as parent_and_child
    from rejoined
    left join all_relationships as direct_child
        on rejoined.child = direct_child.child
        and direct_child.distance = 1
    left join all_relationships as direct_parent
        on rejoined.parent = direct_parent.parent
        and direct_parent.distance = 1
    where direct_child.parent = direct_parent.child
),

-- additionally, only includes cases where the model "in between" the parent and parent_and_child has NO other downstream dependencies
-- Note: when the "in between" model DOES have downstream dependencies, it's possible this DAG choice has been made to avoid duplicated code and as such is OKAY
final as (
    select
        triad_relationships.*,
        case 
            when single_use_resources.parent is not null then true 
            else false
        end as is_loop_independent
    from triad_relationships
    left join single_use_resources 
        on triad_relationships.parent_and_child = single_use_resources.parent
),

final_filtered as (
    select * from final
    where is_loop_independent
)

select * from final_filtered



    

    
    

    

    


  );
  
[0m20:22:59.301484 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:59.303504 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.303711 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_tmp" rename to "fct_rejoining_of_upstream_concepts"
[0m20:22:59.304435 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.305231 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m20:22:59.305399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.305555 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m20:22:59.306592 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.308066 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_backup"
[0m20:22:59.308467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m20:22:59.308644 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
drop table if exists "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_backup" cascade
[0m20:22:59.309268 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.309914 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: Close
[0m20:22:59.310259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a18c850>]}
[0m20:22:59.310596 [info ] [Thread-1  ]: 53 of 78 OK created sql table model public.fct_rejoining_of_upstream_concepts .. [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.310890 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m20:22:59.311093 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_root_models
[0m20:22:59.311410 [info ] [Thread-1  ]: 54 of 78 START sql table model public.fct_root_models .......................... [RUN]
[0m20:22:59.311745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts, now model.dbt_project_evaluator.fct_root_models)
[0m20:22:59.311936 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_root_models
[0m20:22:59.314115 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.314777 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_root_models
[0m20:22:59.317583 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.318361 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.318575 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: BEGIN
[0m20:22:59.318743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.325393 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.325646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.325848 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */

  
    

  create  table "dw"."public"."fct_root_models__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has 0 direct parents, likely due to a lack of source or ref function

with model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where child_resource_type = 'model'
    -- only filter out excluded children nodes
        -- filtering parents could result in incorrectly flagging nodes that depend on excluded nodes
    and not child_is_excluded
    -- exclude required time spine
    and child != 'metricflow_time_spine'
),

final as (
    select
        child
    from model_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m20:22:59.329999 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m20:22:59.332666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.332856 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "dw"."public"."fct_root_models__dbt_tmp" rename to "fct_root_models"
[0m20:22:59.333575 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.334414 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m20:22:59.334587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.334741 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m20:22:59.335636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.337084 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_root_models__dbt_backup"
[0m20:22:59.337447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m20:22:59.337611 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
drop table if exists "dw"."public"."fct_root_models__dbt_backup" cascade
[0m20:22:59.338192 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.338809 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: Close
[0m20:22:59.339133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107468130>]}
[0m20:22:59.339462 [info ] [Thread-1  ]: 54 of 78 OK created sql table model public.fct_root_models ..................... [[32mSELECT 1[0m in 0.03s]
[0m20:22:59.339734 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_root_models
[0m20:22:59.339924 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_source_fanout
[0m20:22:59.340239 [info ] [Thread-1  ]: 55 of 78 START sql table model public.fct_source_fanout ........................ [RUN]
[0m20:22:59.340546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_root_models, now model.dbt_project_evaluator.fct_source_fanout)
[0m20:22:59.340724 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_source_fanout
[0m20:22:59.343226 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.343828 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_source_fanout
[0m20:22:59.346586 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.347285 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.347471 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: BEGIN
[0m20:22:59.347642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.353761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.354042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.354233 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */

  
    

  create  table "dw"."public"."fct_source_fanout__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source is used in multiple direct downstream models
with direct_source_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by child
),

source_fanout as (
    select
        parent,
        
    string_agg(
        child,
        ', '
        
        ) as model_children
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from source_fanout



    

    
    

    

    


  );
  
[0m20:22:59.358282 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:59.360427 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.360680 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "dw"."public"."fct_source_fanout__dbt_tmp" rename to "fct_source_fanout"
[0m20:22:59.361339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:59.362165 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m20:22:59.362331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.362498 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m20:22:59.363573 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.364975 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_source_fanout__dbt_backup"
[0m20:22:59.365322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m20:22:59.365482 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
drop table if exists "dw"."public"."fct_source_fanout__dbt_backup" cascade
[0m20:22:59.366014 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.366594 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: Close
[0m20:22:59.366905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a13ad30>]}
[0m20:22:59.367235 [info ] [Thread-1  ]: 55 of 78 OK created sql table model public.fct_source_fanout ................... [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.367510 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_source_fanout
[0m20:22:59.367705 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m20:22:59.367942 [info ] [Thread-1  ]: 56 of 78 START sql table model public.fct_staging_dependent_on_marts_or_intermediate  [RUN]
[0m20:22:59.368247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_fanout, now model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate)
[0m20:22:59.368431 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m20:22:59.371215 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.371863 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m20:22:59.374611 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.375304 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.375497 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: BEGIN
[0m20:22:59.375658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.383564 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:59.383838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.384050 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */

  
    

  create  table "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp"
  
  
    as
  
  (
    -- cases where a staging model depends on a marts/intermediate model
-- data should flow from raw -> staging -> intermediate -> marts
with direct_model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'model'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where child_model_type = 'staging'
    and parent_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m20:22:59.389119 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:59.391039 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.391221 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp" rename to "fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.391956 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.392708 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m20:22:59.392890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.393058 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m20:22:59.393728 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.395099 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m20:22:59.395462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m20:22:59.395642 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
drop table if exists "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup" cascade
[0m20:22:59.396195 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.396767 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: Close
[0m20:22:59.397094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107468130>]}
[0m20:22:59.397429 [info ] [Thread-1  ]: 56 of 78 OK created sql table model public.fct_staging_dependent_on_marts_or_intermediate  [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.397715 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m20:22:59.397914 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m20:22:59.398143 [info ] [Thread-1  ]: 57 of 78 START sql table model public.fct_staging_dependent_on_staging ......... [RUN]
[0m20:22:59.398463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate, now model.dbt_project_evaluator.fct_staging_dependent_on_staging)
[0m20:22:59.398673 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m20:22:59.400804 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.401426 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m20:22:59.405043 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.405653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.405842 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: BEGIN
[0m20:22:59.406012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.412264 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.412499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.412697 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */

  
    

  create  table "dw"."public"."fct_staging_dependent_on_staging__dbt_tmp"
  
  
    as
  
  (
    -- check for cases where models in the staging layer are dependent on each other
with direct_model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where parent_resource_type in ('model', 'snapshot')
    and child_resource_type in ('model', 'snapshot')
    and not parent_is_excluded
    and not child_is_excluded
    and distance = 1
),

bending_connections as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where parent_model_type = 'staging'
    and child_model_type = 'staging'
)

select * from bending_connections



    

    
    

    

    


  );
  
[0m20:22:59.417100 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m20:22:59.419040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.419224 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "dw"."public"."fct_staging_dependent_on_staging__dbt_tmp" rename to "fct_staging_dependent_on_staging"
[0m20:22:59.419816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:59.420569 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m20:22:59.420737 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.420898 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m20:22:59.421558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m20:22:59.422924 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_staging_dependent_on_staging__dbt_backup"
[0m20:22:59.423288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m20:22:59.423455 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
drop table if exists "dw"."public"."fct_staging_dependent_on_staging__dbt_backup" cascade
[0m20:22:59.423949 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.424524 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: Close
[0m20:22:59.424831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a234e20>]}
[0m20:22:59.425160 [info ] [Thread-1  ]: 57 of 78 OK created sql table model public.fct_staging_dependent_on_staging .... [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.425433 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m20:22:59.425623 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_too_many_joins
[0m20:22:59.425850 [info ] [Thread-1  ]: 58 of 78 START sql table model public.fct_too_many_joins ....................... [RUN]
[0m20:22:59.426176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_staging, now model.dbt_project_evaluator.fct_too_many_joins)
[0m20:22:59.426374 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_too_many_joins
[0m20:22:59.428653 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.429163 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_too_many_joins
[0m20:22:59.431793 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.432359 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.432558 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: BEGIN
[0m20:22:59.432729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.439022 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.439269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.439441 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */

  
    

  create  table "dw"."public"."fct_too_many_joins__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select
        *
    from "dw"."public"."int_all_dag_relationships"
    where not child_is_excluded
    and child_resource_type = 'model'
),

final as (
    select
        child as resource_name,
        child_file_path as file_path,
        cast(count(distinct parent) as integer) as join_count
    from all_dag_relationships
    where distance = 1
    group by 1, 2
    having count(distinct parent) >= 7
)

select * from final



    

    
    

    

    


  );
  
[0m20:22:59.444496 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:59.447186 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.447367 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "dw"."public"."fct_too_many_joins__dbt_tmp" rename to "fct_too_many_joins"
[0m20:22:59.448013 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:59.448747 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m20:22:59.448912 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.449062 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m20:22:59.450166 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.451484 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_too_many_joins__dbt_backup"
[0m20:22:59.451826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m20:22:59.452005 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
drop table if exists "dw"."public"."fct_too_many_joins__dbt_backup" cascade
[0m20:22:59.452537 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:59.453123 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: Close
[0m20:22:59.453424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1af730>]}
[0m20:22:59.453756 [info ] [Thread-1  ]: 58 of 78 OK created sql table model public.fct_too_many_joins .................. [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.454036 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_too_many_joins
[0m20:22:59.454230 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_unused_sources
[0m20:22:59.454513 [info ] [Thread-1  ]: 59 of 78 START sql table model public.fct_unused_sources ....................... [RUN]
[0m20:22:59.454799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_too_many_joins, now model.dbt_project_evaluator.fct_unused_sources)
[0m20:22:59.454983 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_unused_sources
[0m20:22:59.457002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.457594 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_unused_sources
[0m20:22:59.460157 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.460616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.460794 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: BEGIN
[0m20:22:59.460962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.467008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.467279 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.467474 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */

  
    

  create  table "dw"."public"."fct_unused_sources__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source has no children

with source_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent
    from source_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m20:22:59.472752 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:59.474965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.475191 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "dw"."public"."fct_unused_sources__dbt_tmp" rename to "fct_unused_sources"
[0m20:22:59.476041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.476950 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m20:22:59.477146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.477308 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m20:22:59.478325 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.479888 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_unused_sources__dbt_backup"
[0m20:22:59.480301 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m20:22:59.480489 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
drop table if exists "dw"."public"."fct_unused_sources__dbt_backup" cascade
[0m20:22:59.481265 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:59.482015 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: Close
[0m20:22:59.482390 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fdb9a0>]}
[0m20:22:59.482738 [info ] [Thread-1  ]: 59 of 78 OK created sql table model public.fct_unused_sources .................. [[32mSELECT 0[0m in 0.03s]
[0m20:22:59.483030 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_unused_sources
[0m20:22:59.483233 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m20:22:59.483466 [info ] [Thread-1  ]: 60 of 78 START sql view model public.fct_missing_primary_key_tests ............. [RUN]
[0m20:22:59.483845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_unused_sources, now model.dbt_project_evaluator.fct_missing_primary_key_tests)
[0m20:22:59.484078 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m20:22:59.487831 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.488412 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m20:22:59.491456 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.492041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.492237 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: BEGIN
[0m20:22:59.492413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.499525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.499816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.500019 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */

  create view "dw"."public"."fct_missing_primary_key_tests__dbt_tmp"
    
    
  as (
    with

tests as (
    select * from "dw"."public"."int_model_test_summary"
    where resource_type in
    (
        'model'
        
    )
),

final as (

    select
        resource_name,
        resource_type,
        model_type,
        is_primary_key_tested,
        number_of_tests_on_model,
        number_of_constraints_on_model
    from tests
    where not(is_primary_key_tested)

)

select * from final



    

    
    

    

    


  );
[0m20:22:59.501783 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:59.503950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.504172 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
alter table "dw"."public"."fct_missing_primary_key_tests__dbt_tmp" rename to "fct_missing_primary_key_tests"
[0m20:22:59.504968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.505755 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m20:22:59.505958 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.506133 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m20:22:59.507286 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.509035 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_missing_primary_key_tests__dbt_backup"
[0m20:22:59.509428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m20:22:59.509597 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
drop view if exists "dw"."public"."fct_missing_primary_key_tests__dbt_backup" cascade
[0m20:22:59.510367 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:59.511131 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: Close
[0m20:22:59.511482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10404b0d0>]}
[0m20:22:59.511831 [info ] [Thread-1  ]: 60 of 78 OK created sql view model public.fct_missing_primary_key_tests ........ [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:59.512120 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m20:22:59.512319 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_test_coverage
[0m20:22:59.512560 [info ] [Thread-1  ]: 61 of 78 START sql view model public.fct_test_coverage ......................... [RUN]
[0m20:22:59.512906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_missing_primary_key_tests, now model.dbt_project_evaluator.fct_test_coverage)
[0m20:22:59.513089 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_test_coverage
[0m20:22:59.517819 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.518539 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_test_coverage
[0m20:22:59.522413 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.523187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.523382 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: BEGIN
[0m20:22:59.523558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.530273 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.530565 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.530823 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */

  create view "dw"."public"."fct_test_coverage__dbt_tmp"
    
    
  as (
    with

test_counts as (
    select * from "dw"."public"."int_model_test_summary"
    where resource_type = 'model'
),

conversion as (
    select
        resource_name,
        cast(case when number_of_tests_on_model > 0 then 1 else 0 end as boolean) as is_tested_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when number_of_tests_on_model > 0 and model_type = 'base' then 1.0 else 0 end as is_tested_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when number_of_tests_on_model > 0 and model_type = 'staging' then 1.0 else 0 end as is_tested_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when number_of_tests_on_model > 0 and model_type = 'intermediate' then 1.0 else 0 end as is_tested_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when number_of_tests_on_model > 0 and model_type = 'marts' then 1.0 else 0 end as is_tested_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when number_of_tests_on_model > 0 and model_type = 'other' then 1.0 else 0 end as is_tested_other_model
        

    from test_counts
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(number_of_tests_on_model) as integer) as total_tests,
        sum(cast(is_tested_model as integer)) as tested_models,
        round(sum(cast(is_tested_model as integer)) * 100.0 / count(*), 2) as test_coverage_pct,
        
            round(
                
    ( sum(is_tested_base_model) * 100.0 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_staging_model) * 100.0 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_intermediate_model) * 100.0 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_marts_model) * 100.0 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_other_model) * 100.0 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_test_coverage_pct,
        
        round(sum(number_of_tests_on_model) * 1.0000 / count(*), 4) as test_to_model_ratio

    from test_counts
    left join conversion
    on test_counts.resource_name = conversion.resource_name
)

select * from final
  );
[0m20:22:59.533606 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:59.535706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.535906 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
alter table "dw"."public"."fct_test_coverage__dbt_tmp" rename to "fct_test_coverage"
[0m20:22:59.536779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:59.537452 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m20:22:59.537623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.537777 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m20:22:59.539058 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:59.540481 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_test_coverage__dbt_backup"
[0m20:22:59.540883 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m20:22:59.541061 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
drop view if exists "dw"."public"."fct_test_coverage__dbt_backup" cascade
[0m20:22:59.541706 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:59.542346 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: Close
[0m20:22:59.542660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f0cf3de-53cc-45ec-9e01-61da4de54585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a199070>]}
[0m20:22:59.543000 [info ] [Thread-1  ]: 61 of 78 OK created sql view model public.fct_test_coverage .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:59.543292 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_test_coverage
[0m20:22:59.543495 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m20:22:59.543682 [info ] [Thread-1  ]: 62 of 78 START test is_empty_fct_chained_views_dependencies_ ................... [RUN]
[0m20:22:59.543991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_coverage, now test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33)
[0m20:22:59.544176 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m20:22:59.546505 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m20:22:59.547335 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m20:22:59.548775 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m20:22:59.549660 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m20:22:59.549877 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: BEGIN
[0m20:22:59.550052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.556563 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.556828 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m20:22:59.557020 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_chained_views_dependencies"


      
    ) dbt_internal_test
[0m20:22:59.560042 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:59.561054 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: ROLLBACK
[0m20:22:59.561667 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: Close
[0m20:22:59.562032 [info ] [Thread-1  ]: 62 of 78 PASS is_empty_fct_chained_views_dependencies_ ......................... [[32mPASS[0m in 0.02s]
[0m20:22:59.562333 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m20:22:59.562542 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m20:22:59.562737 [info ] [Thread-1  ]: 63 of 78 START test is_empty_fct_direct_join_to_source_ ........................ [RUN]
[0m20:22:59.563057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33, now test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028)
[0m20:22:59.563259 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m20:22:59.566476 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m20:22:59.567157 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m20:22:59.568830 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m20:22:59.569532 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m20:22:59.569751 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: BEGIN
[0m20:22:59.569941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.577051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.577333 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m20:22:59.577529 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_direct_join_to_source"


      
    ) dbt_internal_test
[0m20:22:59.578429 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.579189 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: ROLLBACK
[0m20:22:59.579640 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: Close
[0m20:22:59.579965 [info ] [Thread-1  ]: 63 of 78 PASS is_empty_fct_direct_join_to_source_ .............................. [[32mPASS[0m in 0.02s]
[0m20:22:59.580251 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m20:22:59.580452 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m20:22:59.580671 [info ] [Thread-1  ]: 64 of 78 START test is_empty_fct_exposure_parents_materializations_ ............ [RUN]
[0m20:22:59.580971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028, now test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422)
[0m20:22:59.581172 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m20:22:59.583461 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m20:22:59.584042 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m20:22:59.585539 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m20:22:59.586058 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m20:22:59.586259 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: BEGIN
[0m20:22:59.586474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.592524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.592790 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m20:22:59.592989 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_exposure_parents_materializations"


      
    ) dbt_internal_test
[0m20:22:59.597005 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m20:22:59.597913 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: ROLLBACK
[0m20:22:59.599143 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: Close
[0m20:22:59.599494 [info ] [Thread-1  ]: 64 of 78 PASS is_empty_fct_exposure_parents_materializations_ .................. [[32mPASS[0m in 0.02s]
[0m20:22:59.599789 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m20:22:59.599995 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m20:22:59.600219 [info ] [Thread-1  ]: 65 of 78 START test is_empty_fct_exposures_dependent_on_private_models_ ........ [RUN]
[0m20:22:59.600470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422, now test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e)
[0m20:22:59.600664 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m20:22:59.603374 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m20:22:59.603989 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m20:22:59.605705 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m20:22:59.606289 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m20:22:59.606479 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: BEGIN
[0m20:22:59.606641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.613039 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.613258 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m20:22:59.613443 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_exposures_dependent_on_private_models"


      
    ) dbt_internal_test
[0m20:22:59.616798 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:59.617665 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: ROLLBACK
[0m20:22:59.618295 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: Close
[0m20:22:59.618636 [info ] [Thread-1  ]: 65 of 78 PASS is_empty_fct_exposures_dependent_on_private_models_ .............. [[32mPASS[0m in 0.02s]
[0m20:22:59.618939 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m20:22:59.619160 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m20:22:59.619410 [info ] [Thread-1  ]: 66 of 78 START test is_empty_fct_marts_or_intermediate_dependent_on_source_ .... [RUN]
[0m20:22:59.619706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e, now test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f)
[0m20:22:59.619905 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m20:22:59.622986 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m20:22:59.623631 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m20:22:59.625071 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m20:22:59.625582 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m20:22:59.625781 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: BEGIN
[0m20:22:59.625947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.632251 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.632483 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m20:22:59.632653 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_marts_or_intermediate_dependent_on_source"


      
    ) dbt_internal_test
[0m20:22:59.633412 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.634148 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: ROLLBACK
[0m20:22:59.634681 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: Close
[0m20:22:59.634991 [info ] [Thread-1  ]: 66 of 78 PASS is_empty_fct_marts_or_intermediate_dependent_on_source_ .......... [[32mPASS[0m in 0.02s]
[0m20:22:59.635286 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m20:22:59.635496 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m20:22:59.635755 [info ] [Thread-1  ]: 67 of 78 START test is_empty_fct_model_directories_ ............................ [RUN]
[0m20:22:59.636033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f, now test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db)
[0m20:22:59.636240 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m20:22:59.638763 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m20:22:59.639366 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m20:22:59.641151 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m20:22:59.641952 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m20:22:59.642145 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: BEGIN
[0m20:22:59.642314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.648238 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.648490 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m20:22:59.648680 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_model_directories"


      
    ) dbt_internal_test
[0m20:22:59.652515 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m20:22:59.653514 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: ROLLBACK
[0m20:22:59.654236 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: Close
[0m20:22:59.654729 [info ] [Thread-1  ]: 67 of 78 PASS is_empty_fct_model_directories_ .................................. [[32mPASS[0m in 0.02s]
[0m20:22:59.655125 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m20:22:59.655351 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m20:22:59.655599 [info ] [Thread-1  ]: 68 of 78 START test is_empty_fct_model_fanout_ ................................. [RUN]
[0m20:22:59.655885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db, now test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95)
[0m20:22:59.656086 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m20:22:59.658887 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m20:22:59.659527 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m20:22:59.661014 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m20:22:59.661529 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m20:22:59.661695 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: BEGIN
[0m20:22:59.661848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.668811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.669163 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m20:22:59.669368 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_model_fanout"


      
    ) dbt_internal_test
[0m20:22:59.670464 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.672462 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: ROLLBACK
[0m20:22:59.673209 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: Close
[0m20:22:59.673597 [info ] [Thread-1  ]: 68 of 78 PASS is_empty_fct_model_fanout_ ....................................... [[32mPASS[0m in 0.02s]
[0m20:22:59.673897 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m20:22:59.674105 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m20:22:59.674359 [info ] [Thread-1  ]: 69 of 78 START test is_empty_fct_multiple_sources_joined_ ...................... [RUN]
[0m20:22:59.674645 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95, now test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817)
[0m20:22:59.674851 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m20:22:59.677525 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m20:22:59.678207 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m20:22:59.680061 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m20:22:59.680759 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m20:22:59.680976 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: BEGIN
[0m20:22:59.681167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.687588 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.687865 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m20:22:59.699072 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_multiple_sources_joined"


      
    ) dbt_internal_test
[0m20:22:59.700409 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.701309 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: ROLLBACK
[0m20:22:59.701902 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: Close
[0m20:22:59.702237 [info ] [Thread-1  ]: 69 of 78 PASS is_empty_fct_multiple_sources_joined_ ............................ [[32mPASS[0m in 0.03s]
[0m20:22:59.702526 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m20:22:59.702732 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m20:22:59.702995 [info ] [Thread-1  ]: 70 of 78 START test is_empty_fct_rejoining_of_upstream_concepts_ ............... [RUN]
[0m20:22:59.703264 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817, now test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d)
[0m20:22:59.703470 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m20:22:59.705852 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m20:22:59.706646 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m20:22:59.708457 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m20:22:59.708964 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m20:22:59.709134 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: BEGIN
[0m20:22:59.709285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.715495 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.715735 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m20:22:59.715921 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_rejoining_of_upstream_concepts"


      
    ) dbt_internal_test
[0m20:22:59.716665 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.717403 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: ROLLBACK
[0m20:22:59.717882 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: Close
[0m20:22:59.718205 [info ] [Thread-1  ]: 70 of 78 PASS is_empty_fct_rejoining_of_upstream_concepts_ ..................... [[32mPASS[0m in 0.01s]
[0m20:22:59.718491 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m20:22:59.718690 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m20:22:59.718905 [info ] [Thread-1  ]: 71 of 78 START test is_empty_fct_root_models_ .................................. [RUN]
[0m20:22:59.719120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d, now test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1)
[0m20:22:59.719299 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m20:22:59.721729 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m20:22:59.722360 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m20:22:59.724689 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m20:22:59.725304 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m20:22:59.725497 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: BEGIN
[0m20:22:59.725653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.731605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.731856 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m20:22:59.732043 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_root_models"


      
    ) dbt_internal_test
[0m20:22:59.733348 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.734174 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: ROLLBACK
[0m20:22:59.734716 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: Close
[0m20:22:59.735048 [warn ] [Thread-1  ]: 71 of 78 WARN 1 is_empty_fct_root_models_ ...................................... [[33mWARN 1[0m in 0.02s]
[0m20:22:59.735330 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m20:22:59.735525 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m20:22:59.735738 [info ] [Thread-1  ]: 72 of 78 START test is_empty_fct_source_fanout_ ................................ [RUN]
[0m20:22:59.735961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1, now test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722)
[0m20:22:59.736143 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m20:22:59.738519 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m20:22:59.739197 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m20:22:59.740567 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m20:22:59.741109 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m20:22:59.741298 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: BEGIN
[0m20:22:59.741468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.747713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.747938 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m20:22:59.748122 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_source_fanout"


      
    ) dbt_internal_test
[0m20:22:59.749145 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.749874 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: ROLLBACK
[0m20:22:59.750389 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: Close
[0m20:22:59.750767 [info ] [Thread-1  ]: 72 of 78 PASS is_empty_fct_source_fanout_ ...................................... [[32mPASS[0m in 0.01s]
[0m20:22:59.751070 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m20:22:59.751278 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m20:22:59.751505 [info ] [Thread-1  ]: 73 of 78 START test is_empty_fct_staging_dependent_on_marts_or_intermediate_ ... [RUN]
[0m20:22:59.751739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f)
[0m20:22:59.751924 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m20:22:59.754511 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m20:22:59.755138 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m20:22:59.756726 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m20:22:59.757330 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m20:22:59.757511 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: BEGIN
[0m20:22:59.757666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.764245 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.764501 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m20:22:59.764686 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_staging_dependent_on_marts_or_intermediate"


      
    ) dbt_internal_test
[0m20:22:59.765540 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.766336 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: ROLLBACK
[0m20:22:59.766960 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: Close
[0m20:22:59.767359 [info ] [Thread-1  ]: 73 of 78 PASS is_empty_fct_staging_dependent_on_marts_or_intermediate_ ......... [[32mPASS[0m in 0.02s]
[0m20:22:59.767673 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m20:22:59.767880 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m20:22:59.768121 [info ] [Thread-1  ]: 74 of 78 START test is_empty_fct_staging_dependent_on_staging_ ................. [RUN]
[0m20:22:59.768377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca)
[0m20:22:59.768571 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m20:22:59.771344 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m20:22:59.772007 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m20:22:59.774926 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m20:22:59.775670 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m20:22:59.775881 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: BEGIN
[0m20:22:59.776060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.782105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.782353 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m20:22:59.782538 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_staging_dependent_on_staging"


      
    ) dbt_internal_test
[0m20:22:59.783398 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.784199 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: ROLLBACK
[0m20:22:59.784683 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: Close
[0m20:22:59.785063 [info ] [Thread-1  ]: 74 of 78 PASS is_empty_fct_staging_dependent_on_staging_ ....................... [[32mPASS[0m in 0.02s]
[0m20:22:59.785368 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m20:22:59.785579 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m20:22:59.785835 [info ] [Thread-1  ]: 75 of 78 START test is_empty_fct_too_many_joins_ ............................... [RUN]
[0m20:22:59.786126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca, now test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535)
[0m20:22:59.786325 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m20:22:59.789174 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m20:22:59.789876 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m20:22:59.791616 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m20:22:59.792187 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m20:22:59.792382 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: BEGIN
[0m20:22:59.792539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.800001 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.800273 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m20:22:59.800488 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_too_many_joins"


      
    ) dbt_internal_test
[0m20:22:59.801447 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.802275 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: ROLLBACK
[0m20:22:59.803199 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: Close
[0m20:22:59.803665 [info ] [Thread-1  ]: 75 of 78 PASS is_empty_fct_too_many_joins_ ..................................... [[32mPASS[0m in 0.02s]
[0m20:22:59.803975 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m20:22:59.804178 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m20:22:59.804390 [info ] [Thread-1  ]: 76 of 78 START test is_empty_fct_unused_sources_ ............................... [RUN]
[0m20:22:59.804720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535, now test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8)
[0m20:22:59.804933 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m20:22:59.807297 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m20:22:59.807920 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m20:22:59.809280 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m20:22:59.809881 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m20:22:59.810054 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: BEGIN
[0m20:22:59.810205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.816709 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m20:22:59.816947 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m20:22:59.817119 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_unused_sources"


      
    ) dbt_internal_test
[0m20:22:59.817977 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m20:22:59.818702 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: ROLLBACK
[0m20:22:59.819187 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: Close
[0m20:22:59.819508 [info ] [Thread-1  ]: 76 of 78 PASS is_empty_fct_unused_sources_ ..................................... [[32mPASS[0m in 0.01s]
[0m20:22:59.819802 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m20:22:59.820021 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m20:22:59.820258 [info ] [Thread-1  ]: 77 of 78 START test is_empty_fct_missing_primary_key_tests_ .................... [RUN]
[0m20:22:59.820596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8, now test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0)
[0m20:22:59.820792 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m20:22:59.824200 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m20:22:59.824844 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m20:22:59.826362 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m20:22:59.826975 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m20:22:59.827178 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: BEGIN
[0m20:22:59.827338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.835631 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:59.835896 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m20:22:59.836105 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_missing_primary_key_tests"


      
    ) dbt_internal_test
[0m20:22:59.839507 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:59.840360 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: ROLLBACK
[0m20:22:59.840915 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: Close
[0m20:22:59.841310 [warn ] [Thread-1  ]: 77 of 78 WARN 7 is_empty_fct_missing_primary_key_tests_ ........................ [[33mWARN 7[0m in 0.02s]
[0m20:22:59.841615 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m20:22:59.841817 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m20:22:59.842039 [info ] [Thread-1  ]: 78 of 78 START test valid_test_coverage ........................................ [RUN]
[0m20:22:59.842272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0, now test.dbt_project_evaluator.valid_test_coverage.df03f31e09)
[0m20:22:59.842452 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m20:22:59.845376 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m20:22:59.846024 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m20:22:59.847433 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m20:22:59.847923 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m20:22:59.848100 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: BEGIN
[0m20:22:59.848253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:59.856046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:22:59.856359 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m20:22:59.856570 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "dw"."public"."fct_test_coverage"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not test_coverage_pct >= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:22:59.861761 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m20:22:59.862618 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: ROLLBACK
[0m20:22:59.863257 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: Close
[0m20:22:59.863645 [warn ] [Thread-1  ]: 78 of 78 WARN 1 valid_test_coverage ............................................ [[33mWARN 1[0m in 0.02s]
[0m20:22:59.863979 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m20:22:59.864697 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:59.864913 [debug] [MainThread]: On master: BEGIN
[0m20:22:59.865065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:59.871822 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:22:59.872050 [debug] [MainThread]: On master: COMMIT
[0m20:22:59.872201 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:59.872339 [debug] [MainThread]: On master: COMMIT
[0m20:22:59.872880 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:59.873044 [debug] [MainThread]: On master: Close
[0m20:22:59.873283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:59.873445 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' was properly closed.
[0m20:22:59.873741 [info ] [MainThread]: 
[0m20:22:59.873919 [info ] [MainThread]: Finished running 1 seed, 24 table models, 29 data tests, 24 view models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m20:22:59.878649 [debug] [MainThread]: Command end result
[0m20:22:59.906092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m20:22:59.908780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m20:22:59.916621 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m20:22:59.916836 [info ] [MainThread]: 
[0m20:22:59.917034 [info ] [MainThread]: [33mCompleted with 10 warnings:[0m
[0m20:22:59.917195 [info ] [MainThread]: 
[0m20:22:59.917382 [warn ] [MainThread]: [33mWarning in test valid_documentation_coverage (models/marts/documentation/documentation.yml)[0m
[0m20:22:59.917559 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:22:59.917704 [info ] [MainThread]: 
[0m20:22:59.917876 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/valid_documentation_coverage.sql
[0m20:22:59.918027 [info ] [MainThread]: 
[0m20:22:59.918200 [warn ] [MainThread]: [33mWarning in test is_empty_fct_hard_coded_references_ (models/marts/dag/dag.yml)[0m
[0m20:22:59.918371 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:22:59.918514 [info ] [MainThread]: 
[0m20:22:59.918680 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/dag/dag.yml/is_empty_fct_hard_coded_references_.sql
[0m20:22:59.918825 [info ] [MainThread]: 
[0m20:22:59.918997 [warn ] [MainThread]: [33mWarning in test is_empty_fct_model_naming_conventions_ (models/marts/structure/structure.yml)[0m
[0m20:22:59.919168 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:22:59.919302 [info ] [MainThread]: 
[0m20:22:59.919466 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/structure/structure.yml/is_empty_fct_model_naming_conventions_.sql
[0m20:22:59.919613 [info ] [MainThread]: 
[0m20:22:59.919786 [warn ] [MainThread]: [33mWarning in test is_empty_fct_sources_without_freshness_ (models/marts/tests/testing.yml)[0m
[0m20:22:59.919955 [warn ] [MainThread]: Got 3 results, configured to warn if != 0
[0m20:22:59.920094 [info ] [MainThread]: 
[0m20:22:59.920262 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/is_empty_fct_sources_without_freshness_.sql
[0m20:22:59.920408 [info ] [MainThread]: 
[0m20:22:59.920575 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_models_ (models/marts/documentation/documentation.yml)[0m
[0m20:22:59.920744 [warn ] [MainThread]: Got 7 results, configured to warn if != 0
[0m20:22:59.920878 [info ] [MainThread]: 
[0m20:22:59.921042 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_models_.sql
[0m20:22:59.921185 [info ] [MainThread]: 
[0m20:22:59.921354 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_source_tables_ (models/marts/documentation/documentation.yml)[0m
[0m20:22:59.921520 [warn ] [MainThread]: Got 3 results, configured to warn if != 0
[0m20:22:59.921656 [info ] [MainThread]: 
[0m20:22:59.921823 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_source_tables_.sql
[0m20:22:59.921973 [info ] [MainThread]: 
[0m20:22:59.922212 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_sources_ (models/marts/documentation/documentation.yml)[0m
[0m20:22:59.922421 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:22:59.922576 [info ] [MainThread]: 
[0m20:22:59.922755 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_sources_.sql
[0m20:22:59.922911 [info ] [MainThread]: 
[0m20:22:59.923087 [warn ] [MainThread]: [33mWarning in test is_empty_fct_root_models_ (models/marts/dag/dag.yml)[0m
[0m20:22:59.923260 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:22:59.923400 [info ] [MainThread]: 
[0m20:22:59.923566 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/dag/dag.yml/is_empty_fct_root_models_.sql
[0m20:22:59.923710 [info ] [MainThread]: 
[0m20:22:59.923888 [warn ] [MainThread]: [33mWarning in test is_empty_fct_missing_primary_key_tests_ (models/marts/tests/testing.yml)[0m
[0m20:22:59.924063 [warn ] [MainThread]: Got 7 results, configured to warn if != 0
[0m20:22:59.924202 [info ] [MainThread]: 
[0m20:22:59.924370 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/is_empty_fct_missing_primary_key_tests_.sql
[0m20:22:59.924519 [info ] [MainThread]: 
[0m20:22:59.924691 [warn ] [MainThread]: [33mWarning in test valid_test_coverage (models/marts/tests/testing.yml)[0m
[0m20:22:59.924862 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:22:59.925004 [info ] [MainThread]: 
[0m20:22:59.925177 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/valid_test_coverage.sql
[0m20:22:59.925394 [info ] [MainThread]: 
[0m20:22:59.925607 [info ] [MainThread]: Done. PASS=68 WARN=10 ERROR=0 SKIP=0 TOTAL=78
[0m20:22:59.927982 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.078456, "process_in_blocks": "0", "process_kernel_time": 0.400211, "process_mem_max_rss": "140165120", "process_out_blocks": "0", "process_user_time": 4.251766}
[0m20:22:59.928309 [debug] [MainThread]: Command `dbt build` succeeded at 20:22:59.928256 after 7.08 seconds
[0m20:22:59.928522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10285f370>]}
[0m20:22:59.928737 [debug] [MainThread]: Flushing usage events
[0m20:23:00.536743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:20.524376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104886400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5f250>]}


============================== 21:02:20.529074 | cac36385-1a15-4b4b-9dec-459000c6fba6 ==============================
[0m21:02:20.529074 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:02:20.529475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:02:20.638141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f889d0>]}
[0m21:02:20.665165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5fa90>]}
[0m21:02:20.666636 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:02:20.768219 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m21:02:20.840352 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:02:20.840630 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m21:02:20.840826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bcc10>]}
[0m21:02:22.238328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ba820>]}
[0m21:02:22.313180 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:02:22.332262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:02:22.364381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106337190>]}
[0m21:02:22.364779 [info ] [MainThread]: Found 56 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m21:02:22.364988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106596e20>]}
[0m21:02:22.366271 [info ] [MainThread]: 
[0m21:02:22.366506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:22.366699 [info ] [MainThread]: 
[0m21:02:22.366984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:22.367446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:02:22.434723 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:02:22.434948 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:02:22.435098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:22.460956 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m21:02:22.461618 [debug] [ThreadPool]: On list_dw: Close
[0m21:02:22.466259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m21:02:22.469685 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:02:22.469835 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:02:22.469962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:22.479274 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:02:22.479456 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:02:22.479611 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:02:22.484365 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.005 seconds
[0m21:02:22.485516 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:02:22.486386 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:02:22.486664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m21:02:22.491260 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:02:22.491424 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:02:22.491557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:22.501330 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:02:22.501490 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:02:22.501647 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:02:22.505537 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m21:02:22.506247 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:02:22.506854 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:02:22.512895 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:22.513103 [debug] [MainThread]: On master: BEGIN
[0m21:02:22.513243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:22.520529 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:02:22.520741 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:22.520928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:02:22.534939 [debug] [MainThread]: SQL status: SELECT 37 in 0.014 seconds
[0m21:02:22.538564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068214c0>]}
[0m21:02:22.538813 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:22.539611 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:22.539754 [debug] [MainThread]: On master: BEGIN
[0m21:02:22.540711 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:02:22.540840 [debug] [MainThread]: On master: COMMIT
[0m21:02:22.540967 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:22.541087 [debug] [MainThread]: On master: COMMIT
[0m21:02:22.541553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:02:22.541696 [debug] [MainThread]: On master: Close
[0m21:02:22.543786 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_paid_orders
[0m21:02:22.544069 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_paid_orders ............................ [RUN]
[0m21:02:22.544306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_paid_orders)
[0m21:02:22.544491 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_paid_orders
[0m21:02:22.548983 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_paid_orders"
[0m21:02:22.549586 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_paid_orders
[0m21:02:22.570289 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_paid_orders"
[0m21:02:22.571032 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_paid_orders"
[0m21:02:22.571193 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: BEGIN
[0m21:02:22.571337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:22.578225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:02:22.578445 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_paid_orders"
[0m21:02:22.578627 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_paid_orders"} */

  
    

  create  table "dw"."public"."int_paid_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dw"."public"."stg_jaffle_shop__orders"
)
,

customers as (
    select * from "dw"."public"."stg_jaffle_shop__customers"
)
,

payment_orders as (
    select * from "dw"."public"."int_payment_orders"
)
,

paid_orders as (
    select
        o.order_id,
        o.customer_id,
        o.order_date as order_placed_at,
        o.status as order_status,
        p.total_amount_paid,
        p.payment_finalized_date,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name
    from orders as o
    left join payment_orders as p on o.order_id = p.order_id
    left join customers as c on o.customer_id = c.customer_id

)

select * from paid_orders
  );
  
[0m21:02:22.584136 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.005 seconds
[0m21:02:22.587666 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_paid_orders"
[0m21:02:22.587860 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_paid_orders"} */
alter table "dw"."public"."int_paid_orders__dbt_tmp" rename to "int_paid_orders"
[0m21:02:22.588441 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:02:22.596982 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: COMMIT
[0m21:02:22.597159 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_paid_orders"
[0m21:02:22.597307 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: COMMIT
[0m21:02:22.599579 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:02:22.602954 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_paid_orders__dbt_backup"
[0m21:02:22.605142 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_paid_orders"
[0m21:02:22.605315 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_paid_orders"} */
drop table if exists "dw"."public"."int_paid_orders__dbt_backup" cascade
[0m21:02:22.605963 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m21:02:22.607186 [debug] [Thread-1  ]: On model.my_dbt_project.int_paid_orders: Close
[0m21:02:22.611681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cac36385-1a15-4b4b-9dec-459000c6fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106821820>]}
[0m21:02:22.611998 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.int_paid_orders ....................... [[32mSELECT 99[0m in 0.06s]
[0m21:02:22.612272 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_paid_orders
[0m21:02:22.612834 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:22.612972 [debug] [MainThread]: On master: BEGIN
[0m21:02:22.613096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:22.622068 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:02:22.622285 [debug] [MainThread]: On master: COMMIT
[0m21:02:22.622431 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:22.622563 [debug] [MainThread]: On master: COMMIT
[0m21:02:22.623010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:02:22.623146 [debug] [MainThread]: On master: Close
[0m21:02:22.623354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:22.623498 [debug] [MainThread]: Connection 'model.my_dbt_project.int_paid_orders' was properly closed.
[0m21:02:22.623650 [info ] [MainThread]: 
[0m21:02:22.623813 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m21:02:22.624254 [debug] [MainThread]: Command end result
[0m21:02:22.677996 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:02:22.680783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:02:22.692379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m21:02:22.692548 [info ] [MainThread]: 
[0m21:02:22.692768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:22.692921 [info ] [MainThread]: 
[0m21:02:22.693088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:22.699125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3265908, "process_in_blocks": "0", "process_kernel_time": 0.199864, "process_mem_max_rss": "137887744", "process_out_blocks": "0", "process_user_time": 2.39648}
[0m21:02:22.699321 [debug] [MainThread]: Command `cli run` succeeded at 21:02:22.699278 after 2.33 seconds
[0m21:02:22.699505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104886400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f145e0>]}
[0m21:02:22.699700 [debug] [MainThread]: Flushing usage events
[0m21:02:23.206641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:27.055571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66250>]}


============================== 21:02:27.059034 | 1e6514c7-519c-4c20-a557-c93c6e88254c ==============================
[0m21:02:27.059034 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:02:27.059346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:02:27.171465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dc9d0>]}
[0m21:02:27.197825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66a90>]}
[0m21:02:27.198966 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:02:27.265041 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m21:02:27.434222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:27.434464 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:27.469687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a6130>]}
[0m21:02:27.562301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:02:27.565057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:02:27.583727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109893fd0>]}
[0m21:02:27.584049 [info ] [MainThread]: Found 56 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m21:02:27.584237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109928340>]}
[0m21:02:27.585321 [info ] [MainThread]: 
[0m21:02:27.585497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:27.585644 [info ] [MainThread]: 
[0m21:02:27.585899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:27.586332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:02:27.664006 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:02:27.664253 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:02:27.664413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:27.687114 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m21:02:27.687805 [debug] [ThreadPool]: On list_dw: Close
[0m21:02:27.692444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m21:02:27.695718 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:02:27.695872 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:02:27.696038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:27.706110 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:02:27.706304 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:02:27.706457 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:02:27.710068 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m21:02:27.710703 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:02:27.711269 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:02:27.711532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m21:02:27.713686 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:02:27.713911 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:02:27.714052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:27.721705 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:02:27.721924 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:02:27.722098 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:02:27.724654 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.002 seconds
[0m21:02:27.726116 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:02:27.726903 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:02:27.735746 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.735968 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.736110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:27.744967 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.745216 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.745419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:02:27.761366 [debug] [MainThread]: SQL status: SELECT 37 in 0.016 seconds
[0m21:02:27.764952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a99490>]}
[0m21:02:27.765200 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:27.765937 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.766094 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.766962 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:02:27.767184 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.767348 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.767499 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.768049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:02:27.768188 [debug] [MainThread]: On master: Close
[0m21:02:27.769765 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_payment_orders
[0m21:02:27.770064 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_payment_orders ......................... [RUN]
[0m21:02:27.770309 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_payment_orders)
[0m21:02:27.770505 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_payment_orders
[0m21:02:27.775317 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_payment_orders"
[0m21:02:27.778368 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_payment_orders
[0m21:02:27.799255 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_payment_orders"
[0m21:02:27.802407 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m21:02:27.802587 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: BEGIN
[0m21:02:27.802747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:27.811697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.811996 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m21:02:27.812219 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */

  
    

  create  table "dw"."public"."int_payment_orders__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)
,

payment_orders as (
    select
        order_id,
        max(created) as payment_finalized_date,
        sum(amount) / 100.0 as total_amount_paid
    from source
    where status <> 'fail'
    group by 1
)

select * from payment_orders
  );
  
[0m21:02:27.816322 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.004 seconds
[0m21:02:27.820396 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m21:02:27.820635 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
alter table "dw"."public"."int_payment_orders" rename to "int_payment_orders__dbt_backup"
[0m21:02:27.821713 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:27.823538 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m21:02:27.823708 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
alter table "dw"."public"."int_payment_orders__dbt_tmp" rename to "int_payment_orders"
[0m21:02:27.824298 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:02:27.834228 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: COMMIT
[0m21:02:27.834478 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m21:02:27.834641 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: COMMIT
[0m21:02:27.835584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:02:27.839298 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_payment_orders__dbt_backup"
[0m21:02:27.841576 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_payment_orders"
[0m21:02:27.841781 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_payment_orders"} */
drop table if exists "dw"."public"."int_payment_orders__dbt_backup" cascade
[0m21:02:27.844060 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m21:02:27.845396 [debug] [Thread-1  ]: On model.my_dbt_project.int_payment_orders: Close
[0m21:02:27.846622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6514c7-519c-4c20-a557-c93c6e88254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a99490>]}
[0m21:02:27.847027 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.int_payment_orders .................... [[32mSELECT 99[0m in 0.08s]
[0m21:02:27.847325 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_payment_orders
[0m21:02:27.847999 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.848157 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.848295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:27.855705 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:02:27.855994 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.856155 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.856293 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.856751 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:02:27.856919 [debug] [MainThread]: On master: Close
[0m21:02:27.857154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:27.857298 [debug] [MainThread]: Connection 'model.my_dbt_project.int_payment_orders' was properly closed.
[0m21:02:27.857461 [info ] [MainThread]: 
[0m21:02:27.857633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m21:02:27.858099 [debug] [MainThread]: Command end result
[0m21:02:27.884988 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:02:27.887553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:02:27.890989 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m21:02:27.891148 [info ] [MainThread]: 
[0m21:02:27.891353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:27.891511 [info ] [MainThread]: 
[0m21:02:27.891755 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:27.893222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.87437457, "process_in_blocks": "0", "process_kernel_time": 0.17772, "process_mem_max_rss": "128204800", "process_out_blocks": "0", "process_user_time": 1.15048}
[0m21:02:27.893417 [debug] [MainThread]: Command `cli run` succeeded at 21:02:27.893377 after 0.87 seconds
[0m21:02:27.893596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dc9d0>]}
[0m21:02:27.893768 [debug] [MainThread]: Flushing usage events
[0m21:02:28.364897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:31.115120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ee3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9e1f0>]}


============================== 21:02:31.118521 | 67a440be-17e8-4c29-a18c-87a03a2a636b ==============================
[0m21:02:31.118521 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:02:31.118809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:02:31.229205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a74970>]}
[0m21:02:31.255918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5fdf0>]}
[0m21:02:31.256857 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:02:31.322074 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m21:02:31.466512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:31.466755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:31.502343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113de130>]}
[0m21:02:31.594199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:02:31.597084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:02:31.614182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ae970>]}
[0m21:02:31.614466 [info ] [MainThread]: Found 56 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m21:02:31.614650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111460040>]}
[0m21:02:31.615717 [info ] [MainThread]: 
[0m21:02:31.615892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:31.616042 [info ] [MainThread]: 
[0m21:02:31.616288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:31.616699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:02:31.692164 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:02:31.692411 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:02:31.692551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:31.713776 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m21:02:31.714562 [debug] [ThreadPool]: On list_dw: Close
[0m21:02:31.719312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m21:02:31.722470 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:02:31.722641 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:02:31.722812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:31.733197 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:02:31.733394 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:02:31.733554 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:02:31.737937 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m21:02:31.738605 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:02:31.739373 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:02:31.739641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m21:02:31.741568 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:02:31.741718 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:02:31.741845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:31.750186 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:02:31.750340 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:02:31.750488 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:02:31.753959 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.003 seconds
[0m21:02:31.755131 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:02:31.755879 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:02:31.764643 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:31.764880 [debug] [MainThread]: On master: BEGIN
[0m21:02:31.765028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:31.773919 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:02:31.774100 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:31.774285 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:02:31.799719 [debug] [MainThread]: SQL status: SELECT 37 in 0.025 seconds
[0m21:02:31.803662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9d460>]}
[0m21:02:31.803916 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:31.804600 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:31.804758 [debug] [MainThread]: On master: BEGIN
[0m21:02:31.805702 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:02:31.805855 [debug] [MainThread]: On master: COMMIT
[0m21:02:31.806000 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:31.806140 [debug] [MainThread]: On master: COMMIT
[0m21:02:31.806706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:02:31.806883 [debug] [MainThread]: On master: Close
[0m21:02:31.808642 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_customer_orders
[0m21:02:31.808959 [info ] [Thread-1  ]: 1 of 1 START sql table model public.int_customer_orders ........................ [RUN]
[0m21:02:31.809212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_customer_orders)
[0m21:02:31.809409 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_customer_orders
[0m21:02:31.814919 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_customer_orders"
[0m21:02:31.819589 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_customer_orders
[0m21:02:31.840638 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.int_customer_orders"
[0m21:02:31.846704 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m21:02:31.846880 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: BEGIN
[0m21:02:31.847034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:02:31.853768 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:02:31.854012 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m21:02:31.854210 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */

  
    

  create  table "dw"."public"."int_customer_orders__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dw"."public"."stg_jaffle_shop__customers"
)
,

orders as (
    select * from "dw"."public"."stg_jaffle_shop__orders"
)
,

customer_orders as (
    select
        c.customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(o.order_id) as number_of_orders
    from customers as c
    left join orders as o
        on c.customer_id = o.customer_id
    group by 1
)

select * from customer_orders
  );
  
[0m21:02:31.856754 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.002 seconds
[0m21:02:31.860776 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m21:02:31.860984 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */
alter table "dw"."public"."int_customer_orders" rename to "int_customer_orders__dbt_backup"
[0m21:02:31.861697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:31.863397 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m21:02:31.863569 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */
alter table "dw"."public"."int_customer_orders__dbt_tmp" rename to "int_customer_orders"
[0m21:02:31.864131 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:02:31.873911 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: COMMIT
[0m21:02:31.874121 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m21:02:31.874299 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: COMMIT
[0m21:02:31.875678 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:02:31.879237 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_customer_orders__dbt_backup"
[0m21:02:31.881252 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_customer_orders"
[0m21:02:31.881416 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_customer_orders"} */
drop table if exists "dw"."public"."int_customer_orders__dbt_backup" cascade
[0m21:02:31.882503 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:02:31.883713 [debug] [Thread-1  ]: On model.my_dbt_project.int_customer_orders: Close
[0m21:02:31.884746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67a440be-17e8-4c29-a18c-87a03a2a636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9d460>]}
[0m21:02:31.885045 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.int_customer_orders ................... [[32mSELECT 100[0m in 0.07s]
[0m21:02:31.885322 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_customer_orders
[0m21:02:31.885884 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:31.886078 [debug] [MainThread]: On master: BEGIN
[0m21:02:31.886222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:31.892457 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:02:31.892670 [debug] [MainThread]: On master: COMMIT
[0m21:02:31.892822 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:31.892965 [debug] [MainThread]: On master: COMMIT
[0m21:02:31.893384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:02:31.893533 [debug] [MainThread]: On master: Close
[0m21:02:31.893751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:31.893890 [debug] [MainThread]: Connection 'model.my_dbt_project.int_customer_orders' was properly closed.
[0m21:02:31.894041 [info ] [MainThread]: 
[0m21:02:31.894197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m21:02:31.894594 [debug] [MainThread]: Command end result
[0m21:02:31.919981 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:02:31.922749 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:02:31.926063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m21:02:31.926209 [info ] [MainThread]: 
[0m21:02:31.926414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:31.926573 [info ] [MainThread]: 
[0m21:02:31.926797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:31.928431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.849223, "process_in_blocks": "0", "process_kernel_time": 0.166255, "process_mem_max_rss": "127762432", "process_out_blocks": "0", "process_user_time": 1.132183}
[0m21:02:31.928636 [debug] [MainThread]: Command `cli run` succeeded at 21:02:31.928597 after 0.85 seconds
[0m21:02:31.928808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ee3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a929a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539e100>]}
[0m21:02:31.928979 [debug] [MainThread]: Flushing usage events
[0m21:02:32.409230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:58.320542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107145250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083204c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083202e0>]}


============================== 21:21:58.323270 | 73362d06-2ba4-4e65-ba52-012d12c56e48 ==============================
[0m21:21:58.323270 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:21:58.323612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select package:dbt_project_evaluator dbt_project_evaluator_exceptions', 'send_anonymous_usage_stats': 'True'}
[0m21:21:58.445280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fffa0>]}
[0m21:21:58.470992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ebf70>]}
[0m21:21:58.471882 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:21:58.539250 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:21:58.731523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:58.731774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:58.766469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d55130>]}
[0m21:21:58.854466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:21:58.857722 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:21:58.912045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d46df0>]}
[0m21:21:58.912372 [info ] [MainThread]: Found 56 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m21:21:58.915604 [info ] [MainThread]: 
[0m21:21:58.915795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:58.915946 [info ] [MainThread]: 
[0m21:21:58.916195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:58.920371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m21:21:58.991259 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m21:21:58.991496 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:21:58.991639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:59.013910 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m21:21:59.014561 [debug] [ThreadPool]: On list_dw: Close
[0m21:21:59.017442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m21:21:59.020667 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:21:59.020818 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m21:21:59.020950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:59.030525 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:21:59.030689 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m21:21:59.030842 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:21:59.034923 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m21:21:59.036048 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m21:21:59.036827 [debug] [ThreadPool]: On list_dw_public: Close
[0m21:21:59.037078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m21:21:59.041809 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:21:59.041950 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m21:21:59.042076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:59.049552 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:21:59.049730 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m21:21:59.049901 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m21:21:59.052853 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m21:21:59.053533 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m21:21:59.054289 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m21:21:59.059425 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:59.059576 [debug] [MainThread]: On master: BEGIN
[0m21:21:59.059711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:59.067069 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:21:59.067225 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:59.067428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:59.088759 [debug] [MainThread]: SQL status: SELECT 37 in 0.021 seconds
[0m21:21:59.092648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfe4f0>]}
[0m21:21:59.092896 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:59.093495 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:59.093652 [debug] [MainThread]: On master: BEGIN
[0m21:21:59.094595 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:21:59.094807 [debug] [MainThread]: On master: COMMIT
[0m21:21:59.094985 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:59.095142 [debug] [MainThread]: On master: COMMIT
[0m21:21:59.095694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:59.095872 [debug] [MainThread]: On master: Close
[0m21:21:59.099144 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_exposure_relationships
[0m21:21:59.099426 [info ] [Thread-1  ]: 1 of 78 START sql table model public.base_exposure_relationships ............... [RUN]
[0m21:21:59.099684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.dbt_project_evaluator.base_exposure_relationships)
[0m21:21:59.099876 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_exposure_relationships
[0m21:21:59.109181 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.113285 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_exposure_relationships
[0m21:21:59.133392 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.139386 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.139570 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: BEGIN
[0m21:21:59.139727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.145948 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:21:59.146159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.146336 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */

  
    

  create  table "dw"."public"."base_exposure_relationships__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as resource_id,
    cast(null as TEXT) as direct_parent_id,
    cast(True as boolean) as is_primary_relationship

from dummy_cte
where false
  );
  
[0m21:21:59.151010 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m21:21:59.154706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.154897 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */
alter table "dw"."public"."base_exposure_relationships" rename to "base_exposure_relationships__dbt_backup"
[0m21:21:59.155607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.157234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.157405 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */
alter table "dw"."public"."base_exposure_relationships__dbt_tmp" rename to "base_exposure_relationships"
[0m21:21:59.158197 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.177636 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: COMMIT
[0m21:21:59.177832 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.177994 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: COMMIT
[0m21:21:59.180680 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:21:59.183893 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_exposure_relationships__dbt_backup"
[0m21:21:59.185860 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_exposure_relationships"
[0m21:21:59.186030 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_exposure_relationships"} */
drop table if exists "dw"."public"."base_exposure_relationships__dbt_backup" cascade
[0m21:21:59.195961 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m21:21:59.197204 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_exposure_relationships: Close
[0m21:21:59.198534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951ba30>]}
[0m21:21:59.198899 [info ] [Thread-1  ]: 1 of 78 OK created sql table model public.base_exposure_relationships .......... [[32mSELECT 0[0m in 0.10s]
[0m21:21:59.199191 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_exposure_relationships
[0m21:21:59.199388 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_metric_relationships
[0m21:21:59.199670 [info ] [Thread-1  ]: 2 of 78 START sql table model public.base_metric_relationships ................. [RUN]
[0m21:21:59.199958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_exposure_relationships, now model.dbt_project_evaluator.base_metric_relationships)
[0m21:21:59.200165 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_metric_relationships
[0m21:21:59.202794 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.205617 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_metric_relationships
[0m21:21:59.209230 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.214666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.214847 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: BEGIN
[0m21:21:59.215007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.222274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:21:59.222518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.222719 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */

  
    

  create  table "dw"."public"."base_metric_relationships__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as resource_id,
    cast(null as TEXT) as direct_parent_id,
    cast(True as boolean) as is_primary_relationship

from dummy_cte
where false
  );
  
[0m21:21:59.225648 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m21:21:59.227785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.227960 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */
alter table "dw"."public"."base_metric_relationships" rename to "base_metric_relationships__dbt_backup"
[0m21:21:59.228533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.230184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.230360 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */
alter table "dw"."public"."base_metric_relationships__dbt_tmp" rename to "base_metric_relationships"
[0m21:21:59.230871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.232691 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: COMMIT
[0m21:21:59.232882 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.233052 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: COMMIT
[0m21:21:59.234264 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:21:59.235664 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_metric_relationships__dbt_backup"
[0m21:21:59.236017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_metric_relationships"
[0m21:21:59.236181 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_metric_relationships"} */
drop table if exists "dw"."public"."base_metric_relationships__dbt_backup" cascade
[0m21:21:59.237418 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:21:59.238009 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_metric_relationships: Close
[0m21:21:59.238310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd7d00>]}
[0m21:21:59.238641 [info ] [Thread-1  ]: 2 of 78 OK created sql table model public.base_metric_relationships ............ [[32mSELECT 0[0m in 0.04s]
[0m21:21:59.238928 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_metric_relationships
[0m21:21:59.239130 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_node_columns
[0m21:21:59.239397 [info ] [Thread-1  ]: 3 of 78 START sql table model public.base_node_columns ......................... [RUN]
[0m21:21:59.239686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_metric_relationships, now model.dbt_project_evaluator.base_node_columns)
[0m21:21:59.239880 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_node_columns
[0m21:21:59.246262 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.252755 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_node_columns
[0m21:21:59.255306 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.261971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.262157 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: BEGIN
[0m21:21:59.262326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.270797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:21:59.271018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.271221 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */

  
    

  create  table "dw"."public"."base_node_columns__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as node_unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as description,
    cast(null as TEXT) as data_type,
    cast(null as TEXT) as constraints,
    cast(True as boolean) as has_not_null_constraint,
    cast(0 as integer) as constraints_count,
    cast(null as TEXT) as quote

from dummy_cte
where false
  );
  
[0m21:21:59.274634 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m21:21:59.276699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.276879 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
alter table "dw"."public"."base_node_columns" rename to "base_node_columns__dbt_backup"
[0m21:21:59.277453 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.279128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.279302 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
alter table "dw"."public"."base_node_columns__dbt_tmp" rename to "base_node_columns"
[0m21:21:59.279875 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.295625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.295862 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
insert into "dw"."public"."base_node_columns" values 
(
  
    'model.dbt_project_evaluator.fct_documentation_coverage'
  
, 

  
    'documentation_coverage_pct'
  
, 

  
    'the number of models in the project with a description divided by the total number of models in the project'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'model.dbt_project_evaluator.fct_test_coverage'
  
, 

  
    'test_to_model_ratio'
  
, 

  
    'the total number of tests in the project divided by the total number of models in the project'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'model.dbt_project_evaluator.fct_test_coverage'
  
, 

  
    'test_coverage_pct'
  
, 

  
    'the number of models in the project with at least one test configured divided by the total number of models in the project'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'fct_name'
  
, 

  
    'Name of the fact table to define exceptions.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'column_name'
  
, 

  
    'Column name from fct_name to define exceptions.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'id_to_exclude'
  
, 

  
    'Values (or like pattern) to exclude for column_name.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'comment'
  
, 

  
    'Field to document why a given exception is legitimate.'
  
, 

  
    'None'
  
, 

  
    '[]'
  
, 
False, 
0, 

  
    'None'
  
);
[0m21:21:59.297588 [debug] [Thread-1  ]: SQL status: INSERT 0 7 in 0.002 seconds
[0m21:21:59.298332 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: COMMIT
[0m21:21:59.298497 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.298653 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: COMMIT
[0m21:21:59.300427 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:21:59.301872 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_node_columns__dbt_backup"
[0m21:21:59.302217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_columns"
[0m21:21:59.302381 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_columns"} */
drop table if exists "dw"."public"."base_node_columns__dbt_backup" cascade
[0m21:21:59.305670 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m21:21:59.306226 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_columns: Close
[0m21:21:59.306510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd7d00>]}
[0m21:21:59.306808 [info ] [Thread-1  ]: 3 of 78 OK created sql table model public.base_node_columns .................... [[32mSELECT 0[0m in 0.07s]
[0m21:21:59.307096 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_node_columns
[0m21:21:59.307291 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_node_relationships
[0m21:21:59.307557 [info ] [Thread-1  ]: 4 of 78 START sql table model public.base_node_relationships ................... [RUN]
[0m21:21:59.307783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_node_columns, now model.dbt_project_evaluator.base_node_relationships)
[0m21:21:59.307956 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_node_relationships
[0m21:21:59.310509 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.314183 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_node_relationships
[0m21:21:59.317087 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.323015 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.323197 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: BEGIN
[0m21:21:59.323362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.332991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:21:59.333192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.333371 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */

  
    

  create  table "dw"."public"."base_node_relationships__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as resource_id,
    cast(null as TEXT) as direct_parent_id,
    cast(True as boolean) as is_primary_relationship

from dummy_cte
where false
  );
  
[0m21:21:59.337285 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m21:21:59.339523 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.339725 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
alter table "dw"."public"."base_node_relationships" rename to "base_node_relationships__dbt_backup"
[0m21:21:59.340360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.342031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.342203 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
alter table "dw"."public"."base_node_relationships__dbt_tmp" rename to "base_node_relationships"
[0m21:21:59.342736 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.393649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.394347 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
insert into "dw"."public"."base_node_relationships" values 
(cast('model.my_dbt_project.migrate_legacy_code' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.my_dbt_project.stg_jaffle_shop__payments' as TEXT), 
cast('source.my_dbt_project.jaffle_shop.payments' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.stg_jaffle_shop__customers' as TEXT), 
cast('source.my_dbt_project.jaffle_shop.customers' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.stg_jaffle_shop__orders' as TEXT), 
cast('source.my_dbt_project.jaffle_shop.orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_paid_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_paid_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__customers' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_paid_orders' as TEXT), 
cast('model.my_dbt_project.int_payment_orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_customer_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__customers' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_customer_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.int_payment_orders' as TEXT), 
cast('model.my_dbt_project.stg_jaffle_shop__payments' as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_items' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.customers' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_customers' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.orders' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_stores' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.payments' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_orders' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_supplies' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('seed.my_dbt_project.raw_products' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_columns' as TEXT), 
cast('model.dbt_project_evaluator.base_node_columns' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_columns' as TEXT), 
cast('model.dbt_project_evaluator.base_source_columns' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_nodes' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_exposure_relationships' as TEXT), 
cast('model.dbt_project_evaluator.base_exposure_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_node_relationships' as TEXT), 
cast('model.dbt_project_evaluator.base_node_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_sources' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_exposures' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_metric_relationships' as TEXT), 
cast('model.dbt_project_evaluator.base_metric_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_metrics' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_node_relationships' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_source_columns' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_node_columns' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_exposure_relationships' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.base_metric_relationships' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_naming_convention_folders' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.stg_naming_convention_prefixes' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_documentation_coverage' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_sources' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_sources' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_source_tables' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_source_tables' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.stg_node_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.stg_exposure_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
cast('model.dbt_project_evaluator.stg_metric_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_nodes' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_exposures' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_metrics' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_sources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_prefixes' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_folders' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_multiple_sources_joined' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_multiple_sources_joined' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_root_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_root_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_fanout' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_fanout' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_unused_sources' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_unused_sources' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_duplicate_sources' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_duplicate_sources' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_fanout' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_fanout' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_direct_join_to_source' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_direct_join_to_source' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_staging' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_staging' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_too_many_joins' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_too_many_joins' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_hard_coded_references' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_hard_coded_references' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_missing_primary_key_tests' as TEXT), 
cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_missing_primary_key_tests' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_sources_without_freshness' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_sources_without_freshness' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_coverage' as TEXT), 
cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.int_model_test_summary' as TEXT), 
cast('model.dbt_project_evaluator.base_node_columns' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_public_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_undocumented_public_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposures_dependent_on_private_models' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposures_dependent_on_private_models' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_public_models_without_contract' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_public_models_without_contract' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposure_parents_materializations' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_exposure_parents_materializations' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_chained_views_dependencies' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_chained_views_dependencies' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_source_directories' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_direct_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_prefixes' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_graph_resources' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('model.dbt_project_evaluator.stg_naming_convention_folders' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('model.dbt_project_evaluator.int_all_dag_relationships' as TEXT), 
FALSE), 

(cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
FALSE), 

(cast('seed.dbt_project_evaluator.dbt_project_evaluator_exceptions' as TEXT), 
cast(NULL as TEXT), 
FALSE), 

(cast('test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' as TEXT), 
cast('model.dbt_project_evaluator.fct_documentation_coverage' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_source_tables' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_sources' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' as TEXT), 
cast('model.dbt_project_evaluator.fct_direct_join_to_source' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' as TEXT), 
cast('model.dbt_project_evaluator.fct_duplicate_sources' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' as TEXT), 
cast('model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' as TEXT), 
cast('model.dbt_project_evaluator.fct_model_fanout' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' as TEXT), 
cast('model.dbt_project_evaluator.fct_multiple_sources_joined' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' as TEXT), 
cast('model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' as TEXT), 
cast('model.dbt_project_evaluator.fct_root_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' as TEXT), 
cast('model.dbt_project_evaluator.fct_source_fanout' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' as TEXT), 
cast('model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' as TEXT), 
cast('model.dbt_project_evaluator.fct_staging_dependent_on_staging' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' as TEXT), 
cast('model.dbt_project_evaluator.fct_unused_sources' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' as TEXT), 
cast('model.dbt_project_evaluator.fct_exposure_parents_materializations' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' as TEXT), 
cast('model.dbt_project_evaluator.fct_hard_coded_references' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' as TEXT), 
cast('model.dbt_project_evaluator.fct_too_many_joins' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.valid_test_coverage.df03f31e09' as TEXT), 
cast('model.dbt_project_evaluator.fct_test_coverage' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' as TEXT), 
cast('model.dbt_project_evaluator.fct_missing_primary_key_tests' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283' as TEXT), 
cast('model.dbt_project_evaluator.fct_sources_without_freshness' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' as TEXT), 
cast('model.dbt_project_evaluator.fct_public_models_without_contract' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' as TEXT), 
cast('model.dbt_project_evaluator.fct_undocumented_public_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' as TEXT), 
cast('model.dbt_project_evaluator.fct_exposures_dependent_on_private_models' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' as TEXT), 
cast('model.dbt_project_evaluator.fct_chained_views_dependencies' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' as TEXT), 
cast('model.dbt_project_evaluator.fct_model_directories' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' as TEXT), 
cast('model.dbt_project_evaluator.fct_model_naming_conventions' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' as TEXT), 
cast('model.dbt_project_evaluator.fct_source_directories' as TEXT), 
True), 

(cast('test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' as TEXT), 
cast('model.dbt_project_evaluator.fct_test_directories' as TEXT), 
True), 

(cast('model.my_dbt_project.fct_sales' as TEXT), 
cast('model.my_dbt_project.int_customer_orders' as TEXT), 
FALSE), 

(cast('model.my_dbt_project.fct_sales' as TEXT), 
cast('model.my_dbt_project.int_paid_orders' as TEXT), 
FALSE);
[0m21:21:59.399372 [debug] [Thread-1  ]: SQL status: INSERT 0 141 in 0.004 seconds
[0m21:21:59.400313 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: COMMIT
[0m21:21:59.400522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.400685 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: COMMIT
[0m21:21:59.403158 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:21:59.404607 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_node_relationships__dbt_backup"
[0m21:21:59.404962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_node_relationships"
[0m21:21:59.405123 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_node_relationships"} */
drop table if exists "dw"."public"."base_node_relationships__dbt_backup" cascade
[0m21:21:59.409152 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m21:21:59.409720 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_node_relationships: Close
[0m21:21:59.410007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dfd60>]}
[0m21:21:59.410303 [info ] [Thread-1  ]: 4 of 78 OK created sql table model public.base_node_relationships .............. [[32mSELECT 0[0m in 0.10s]
[0m21:21:59.410577 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_node_relationships
[0m21:21:59.410752 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.base_source_columns
[0m21:21:59.411016 [info ] [Thread-1  ]: 5 of 78 START sql table model public.base_source_columns ....................... [RUN]
[0m21:21:59.411302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_node_relationships, now model.dbt_project_evaluator.base_source_columns)
[0m21:21:59.411480 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.base_source_columns
[0m21:21:59.415167 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.417691 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.base_source_columns
[0m21:21:59.420311 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.424518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.424687 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: BEGIN
[0m21:21:59.424841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.433333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:21:59.433511 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.433688 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */

  
    

  create  table "dw"."public"."base_source_columns__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
) 

select 
    cast(null as TEXT) as node_unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as description,
    cast(null as TEXT) as data_type,
    cast(null as TEXT) as constraints,
    cast(True as boolean) as has_not_null_constraint,
    cast(0 as integer) as constraints_count,
    cast(null as TEXT) as quote

from dummy_cte
where false
  );
  
[0m21:21:59.436945 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m21:21:59.438865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.439035 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */
alter table "dw"."public"."base_source_columns" rename to "base_source_columns__dbt_backup"
[0m21:21:59.440110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.441665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.441829 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */
alter table "dw"."public"."base_source_columns__dbt_tmp" rename to "base_source_columns"
[0m21:21:59.442514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.444429 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: COMMIT
[0m21:21:59.444609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.444776 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: COMMIT
[0m21:21:59.446044 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:21:59.447451 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."base_source_columns__dbt_backup"
[0m21:21:59.447801 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.base_source_columns"
[0m21:21:59.447971 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.base_source_columns"} */
drop table if exists "dw"."public"."base_source_columns__dbt_backup" cascade
[0m21:21:59.449740 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m21:21:59.450308 [debug] [Thread-1  ]: On model.dbt_project_evaluator.base_source_columns: Close
[0m21:21:59.450593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd7d00>]}
[0m21:21:59.450887 [info ] [Thread-1  ]: 5 of 78 OK created sql table model public.base_source_columns .................. [[32mSELECT 0[0m in 0.04s]
[0m21:21:59.451168 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.base_source_columns
[0m21:21:59.451354 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_exposures
[0m21:21:59.451611 [info ] [Thread-1  ]: 6 of 78 START sql table model public.stg_exposures ............................. [RUN]
[0m21:21:59.451872 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.base_source_columns, now model.dbt_project_evaluator.stg_exposures)
[0m21:21:59.452051 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_exposures
[0m21:21:59.457408 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.460932 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_exposures
[0m21:21:59.463574 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.467233 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.467397 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: BEGIN
[0m21:21:59.467548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.476657 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:21:59.476846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.477029 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */

  
    

  create  table "dw"."public"."stg_exposures__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT ) as unique_id,
    cast(null as TEXT ) as name,
    cast(null as TEXT ) as resource_type,
    cast(null as TEXT ) as file_path,
    cast(True as boolean) as is_described,
    cast(null as TEXT ) as exposure_type,
    cast(null as TEXT ) as maturity,
    cast(null as TEXT ) as package_name,
    cast(null as TEXT ) as url,
    cast(null as TEXT ) as owner_name,
    cast(null as TEXT ) as owner_email,
    cast(null as TEXT ) as meta

from dummy_cte
where false
  );
  
[0m21:21:59.480566 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m21:21:59.482578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.482765 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */
alter table "dw"."public"."stg_exposures" rename to "stg_exposures__dbt_backup"
[0m21:21:59.483336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.484969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.485135 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */
alter table "dw"."public"."stg_exposures__dbt_tmp" rename to "stg_exposures"
[0m21:21:59.486048 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.490778 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: COMMIT
[0m21:21:59.490950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.491103 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: COMMIT
[0m21:21:59.492606 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:21:59.493918 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_exposures__dbt_backup"
[0m21:21:59.494260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposures"
[0m21:21:59.494419 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposures"} */
drop table if exists "dw"."public"."stg_exposures__dbt_backup" cascade
[0m21:21:59.496626 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m21:21:59.497290 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposures: Close
[0m21:21:59.497600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096adac0>]}
[0m21:21:59.497908 [info ] [Thread-1  ]: 6 of 78 OK created sql table model public.stg_exposures ........................ [[32mSELECT 0[0m in 0.05s]
[0m21:21:59.498200 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_exposures
[0m21:21:59.498390 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_metrics
[0m21:21:59.498642 [info ] [Thread-1  ]: 7 of 78 START sql table model public.stg_metrics ............................... [RUN]
[0m21:21:59.498868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposures, now model.dbt_project_evaluator.stg_metrics)
[0m21:21:59.499038 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_metrics
[0m21:21:59.505600 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.510078 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_metrics
[0m21:21:59.512591 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.515726 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.515898 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: BEGIN
[0m21:21:59.516051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.524901 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:21:59.525101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.525301 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */

  
    

  create  table "dw"."public"."stg_metrics__dbt_tmp"
  
  
    as
  
  (
    


    

/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT) as unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as resource_type,
    cast(null as TEXT) as file_path,
    cast(True as boolean) as is_described,
    cast(null as TEXT) as metric_type,
    cast(null as TEXT) as label,
    cast(null as TEXT) as package_name,
    cast(null as TEXT) as metric_filter,
    cast(null as TEXT) as metric_measure,
    cast(null as TEXT) as metric_measure_alias,
    cast(null as TEXT) as numerator,
    cast(null as TEXT) as denominator,
    cast(null as TEXT) as expr,
    cast(null as TEXT) as metric_window,
    cast(null as TEXT) as grain_to_date,
    cast(null as TEXT) as meta

from dummy_cte
where false
  );
  
[0m21:21:59.528949 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m21:21:59.530942 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.531113 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */
alter table "dw"."public"."stg_metrics" rename to "stg_metrics__dbt_backup"
[0m21:21:59.532001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.533606 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.533772 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */
alter table "dw"."public"."stg_metrics__dbt_tmp" rename to "stg_metrics"
[0m21:21:59.534381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:59.540218 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: COMMIT
[0m21:21:59.540399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.540557 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: COMMIT
[0m21:21:59.542036 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:21:59.543849 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_metrics__dbt_backup"
[0m21:21:59.544199 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metrics"
[0m21:21:59.544375 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metrics"} */
drop table if exists "dw"."public"."stg_metrics__dbt_backup" cascade
[0m21:21:59.546535 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m21:21:59.547105 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metrics: Close
[0m21:21:59.547392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096adac0>]}
[0m21:21:59.547687 [info ] [Thread-1  ]: 7 of 78 OK created sql table model public.stg_metrics .......................... [[32mSELECT 0[0m in 0.05s]
[0m21:21:59.547965 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_metrics
[0m21:21:59.548152 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_naming_convention_folders
[0m21:21:59.548409 [info ] [Thread-1  ]: 8 of 78 START sql view model public.stg_naming_convention_folders .............. [RUN]
[0m21:21:59.548636 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metrics, now model.dbt_project_evaluator.stg_naming_convention_folders)
[0m21:21:59.548806 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_naming_convention_folders
[0m21:21:59.555238 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.571936 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_naming_convention_folders
[0m21:21:59.582310 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.591926 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.592117 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: BEGIN
[0m21:21:59.592290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.603005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:21:59.603184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.603376 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */

  create view "dw"."public"."stg_naming_convention_folders__dbt_tmp"
    
    
  as (
    





  

  

  

  

  


with vars_folders_table as (
    
        select 'base_folder_name' as var_name, 'base' as var_value
        union all
        select 'staging_folder_name' as var_name, 'staging' as var_value
        union all
        select 'intermediate_folder_name' as var_name, 'intermediate' as var_value
        union all
        select 'marts_folder_name' as var_name, 'marts' as var_value
        
)

select
    var_name as folder_name, 
    

    replace(
        var_name,
        
  
    '_folder_name'
  
,
        ''
    )


 as model_type,
    var_value as folder_name_value
from vars_folders_table
  );
[0m21:21:59.606973 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:21:59.609008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.609189 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */
alter table "dw"."public"."stg_naming_convention_folders" rename to "stg_naming_convention_folders__dbt_backup"
[0m21:21:59.610278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.611952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.612138 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */
alter table "dw"."public"."stg_naming_convention_folders__dbt_tmp" rename to "stg_naming_convention_folders"
[0m21:21:59.613025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.613787 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: COMMIT
[0m21:21:59.613963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.614133 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: COMMIT
[0m21:21:59.615648 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:21:59.617667 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_naming_convention_folders__dbt_backup"
[0m21:21:59.618940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_folders"
[0m21:21:59.619124 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_folders"} */
drop view if exists "dw"."public"."stg_naming_convention_folders__dbt_backup" cascade
[0m21:21:59.621023 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:21:59.621602 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_folders: Close
[0m21:21:59.621902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096adac0>]}
[0m21:21:59.622217 [info ] [Thread-1  ]: 8 of 78 OK created sql view model public.stg_naming_convention_folders ......... [[32mCREATE VIEW[0m in 0.07s]
[0m21:21:59.622499 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_naming_convention_folders
[0m21:21:59.622692 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m21:21:59.622956 [info ] [Thread-1  ]: 9 of 78 START sql view model public.stg_naming_convention_prefixes ............. [RUN]
[0m21:21:59.623186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_naming_convention_folders, now model.dbt_project_evaluator.stg_naming_convention_prefixes)
[0m21:21:59.623373 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m21:21:59.631374 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.638909 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m21:21:59.641717 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.649996 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.650188 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: BEGIN
[0m21:21:59.650358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.662303 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m21:21:59.662547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.662760 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */

  create view "dw"."public"."stg_naming_convention_prefixes__dbt_tmp"
    
    
  as (
    





  

  

  

  

  


with vars_prefix_table as (
    
            select 'base_prefixes' as var_name, 'base_' as var_value
            union all
            select 'staging_prefixes' as var_name, 'stg_' as var_value
            union all
            select 'intermediate_prefixes' as var_name, 'int_' as var_value
            union all
            select 'marts_prefixes' as var_name, 'fct_' as var_value
            union all
            select 'marts_prefixes' as var_name, 'dim_' as var_value
            union all
            select 'other_prefixes' as var_name, 'rpt_' as var_value
            
),

parsed as (

select
    var_name as prefix_name, 
    

    replace(
        var_name,
        
  
    '_prefixes'
  
,
        ''
    )


 as model_type,
    var_value as prefix_value
from vars_prefix_table

),

final as (

    select
        md5(cast(coalesce(cast(model_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(prefix_value as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id,
        *
    from parsed

)

select * from final
  );
[0m21:21:59.665712 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:21:59.668040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.668251 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */
alter table "dw"."public"."stg_naming_convention_prefixes" rename to "stg_naming_convention_prefixes__dbt_backup"
[0m21:21:59.669601 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.671437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.671635 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */
alter table "dw"."public"."stg_naming_convention_prefixes__dbt_tmp" rename to "stg_naming_convention_prefixes"
[0m21:21:59.672642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.673443 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: COMMIT
[0m21:21:59.673628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.673799 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: COMMIT
[0m21:21:59.675594 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:21:59.703088 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_naming_convention_prefixes__dbt_backup"
[0m21:21:59.703526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_naming_convention_prefixes"
[0m21:21:59.703709 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_naming_convention_prefixes"} */
drop view if exists "dw"."public"."stg_naming_convention_prefixes__dbt_backup" cascade
[0m21:21:59.707959 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m21:21:59.708595 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_naming_convention_prefixes: Close
[0m21:21:59.708896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109894790>]}
[0m21:21:59.709197 [info ] [Thread-1  ]: 9 of 78 OK created sql view model public.stg_naming_convention_prefixes ........ [[32mCREATE VIEW[0m in 0.09s]
[0m21:21:59.709479 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_naming_convention_prefixes
[0m21:21:59.709657 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_nodes
[0m21:21:59.709896 [info ] [Thread-1  ]: 10 of 78 START sql table model public.stg_nodes ................................ [RUN]
[0m21:21:59.710131 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_naming_convention_prefixes, now model.dbt_project_evaluator.stg_nodes)
[0m21:21:59.710299 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_nodes
[0m21:21:59.720008 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_nodes"
[0m21:21:59.722340 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_nodes
[0m21:21:59.724940 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_nodes"
[0m21:21:59.727536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:21:59.727700 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: BEGIN
[0m21:21:59.727849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:21:59.739941 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m21:21:59.740151 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:21:59.740356 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */

  
    

  create  table "dw"."public"."stg_nodes__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT) as unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as resource_type,
    cast(null as TEXT) as file_path,
    cast(True as boolean) as is_enabled,
    cast(null as TEXT) as materialized,
    cast(null as TEXT) as on_schema_change,
    cast(null as TEXT) as model_group,
    cast(null as TEXT) as access,
    cast(null as TEXT) as latest_version,
    cast(null as TEXT) as version,
    cast(null as TEXT) as deprecation_date,
    cast(True as boolean) as is_contract_enforced,
    cast(0 as integer) as total_defined_columns,
    cast(0 as integer) as total_described_columns,
    cast(null as TEXT) as database,
    cast(null as TEXT) as schema,
    cast(null as TEXT) as package_name,
    cast(null as TEXT) as alias,
    cast(True as boolean) as is_described,
    cast(null as TEXT) as column_name,
    cast(null as TEXT) as meta,
    cast(null as TEXT) as hard_coded_references,
    cast(null as integer) as number_lines,
    cast(null as float) as sql_complexity,
    cast(null as TEXT) as macro_dependencies,
    cast(True as boolean) as is_generic_test,
    cast(True as boolean) as is_excluded

from dummy_cte
where false
  );
  
[0m21:21:59.745019 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m21:21:59.747117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:21:59.747300 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
alter table "dw"."public"."stg_nodes" rename to "stg_nodes__dbt_backup"
[0m21:21:59.748112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:21:59.750327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:21:59.750513 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
alter table "dw"."public"."stg_nodes__dbt_tmp" rename to "stg_nodes"
[0m21:21:59.751141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:00.089778 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:22:00.091638 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
insert into "dw"."public"."stg_nodes" values 
(
  
    'model.my_dbt_project.migrate_legacy_code'
  
, 

  
    'migrate_legacy_code'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/migrate_legacy_code.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'migrate_legacy_code'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    'dw.public_jaffle_shop.customers, dw.public_jaffle_shop.orders, dw.public_jaffle_shop.payments, raw.jaffle_shop.orders'
  
, 
65, 
22.6, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.stg_jaffle_shop__payments'
  
, 

  
    'stg_jaffle_shop__payments'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/stg_jaffle_shop__payments.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'stg_jaffle_shop__payments'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
16, 
3.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.stg_jaffle_shop__customers'
  
, 

  
    'stg_jaffle_shop__customers'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/stg_jaffle_shop__customers.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'stg_jaffle_shop__customers'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
13, 
3.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.stg_jaffle_shop__orders'
  
, 

  
    'stg_jaffle_shop__orders'
  
, 

  
    'model'
  
, 

  
    'models/staging/jaffle_shop/stg_jaffle_shop__orders.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'stg_jaffle_shop__orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
15, 
3.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.int_paid_orders'
  
, 

  
    'int_paid_orders'
  
, 

  
    'model'
  
, 

  
    'models/intermediate/sales/int_paid_orders.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'int_paid_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
31, 
7.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.int_customer_orders'
  
, 

  
    'int_customer_orders'
  
, 

  
    'model'
  
, 

  
    'models/intermediate/sales/int_customer_orders.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'int_customer_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
6.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.int_payment_orders'
  
, 

  
    'int_payment_orders'
  
, 

  
    'model'
  
, 

  
    'models/intermediate/sales/int_payment_orders.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'int_payment_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
15, 
5.0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_items'
  
, 

  
    'raw_items'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_items.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_items'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.customers'
  
, 

  
    'customers'
  
, 

  
    'seed'
  
, 

  
    'seeds/customers.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'customers'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_customers'
  
, 

  
    'raw_customers'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_customers.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_customers'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.orders'
  
, 

  
    'orders'
  
, 

  
    'seed'
  
, 

  
    'seeds/orders.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_stores'
  
, 

  
    'raw_stores'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_stores.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_stores'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.payments'
  
, 

  
    'payments'
  
, 

  
    'seed'
  
, 

  
    'seeds/payments.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'payments'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_orders'
  
, 

  
    'raw_orders'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_orders.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_orders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_supplies'
  
, 

  
    'raw_supplies'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_supplies.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_supplies'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.my_dbt_project.raw_products'
  
, 

  
    'raw_products'
  
, 

  
    'seed'
  
, 

  
    'seeds/raw_products.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    'raw_products'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_columns'
  
, 

  
    'stg_columns'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_columns.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_columns'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
10, 
1.0, 

  
    '["macro.dbt_utils.union_relations"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_nodes'
  
, 

  
    'stg_nodes'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_nodes.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_nodes'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
48, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt.type_int", "macro.dbt.type_float", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_exposure_relationships'
  
, 

  
    'stg_exposure_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_exposure_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_exposure_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
13, 
4.0, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_node_relationships'
  
, 

  
    'stg_node_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_node_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_node_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
14, 
4.0, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_sources'
  
, 

  
    'stg_sources'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_sources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_sources'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
38, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_exposures'
  
, 

  
    'stg_exposures'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_exposures.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_exposures'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
31, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_metric_relationships'
  
, 

  
    'stg_metric_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_metric_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_metric_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
13, 
4.0, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_metrics'
  
, 

  
    'stg_metrics'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/stg_metrics.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_metrics'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
36, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_node_relationships'
  
, 

  
    'base_node_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_node_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_node_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_source_columns'
  
, 

  
    'base_source_columns'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_source_columns.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_source_columns'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
26, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt_project_evaluator.type_large_string", "macro.dbt.type_int", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_node_columns'
  
, 

  
    'base_node_columns'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_node_columns.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_node_columns'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
26, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt_project_evaluator.type_large_string", "macro.dbt.type_boolean", "macro.dbt.type_int", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_exposure_relationships'
  
, 

  
    'base_exposure_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_exposure_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_exposure_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.base_metric_relationships'
  
, 

  
    'base_metric_relationships'
  
, 

  
    'model'
  
, 

  
    'models/staging/graph/base/base_metric_relationships.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'base_metric_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
3.0, 

  
    '["macro.dbt_project_evaluator.type_string_dpe", "macro.dbt.type_boolean", "macro.dbt_project_evaluator.insert_resources_from_graph"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_naming_convention_folders'
  
, 

  
    'stg_naming_convention_folders'
  
, 

  
    'model'
  
, 

  
    'models/staging/variables/stg_naming_convention_folders.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_naming_convention_folders'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
17, 
1.0, 

  
    '["macro.dbt_project_evaluator.loop_vars", "macro.dbt_project_evaluator.wrap_string_with_quotes", "macro.dbt.replace"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.stg_naming_convention_prefixes'
  
, 

  
    'stg_naming_convention_prefixes'
  
, 

  
    'model'
  
, 

  
    'models/staging/variables/stg_naming_convention_prefixes.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'stg_naming_convention_prefixes'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
32, 
3.0, 

  
    '["macro.dbt_project_evaluator.loop_vars", "macro.dbt_project_evaluator.wrap_string_with_quotes", "macro.dbt.replace", "macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_models'
  
, 

  
    'fct_undocumented_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_undocumented_models.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_documentation_coverage'
  
, 

  
    'fct_documentation_coverage'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_documentation_coverage.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
1, 
1, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_documentation_coverage'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
40, 
7.7, 

  
    '["macro.dbt.current_timestamp", "macro.dbt.type_int", "macro.dbt_utils.safe_divide"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_sources'
  
, 

  
    'fct_undocumented_sources'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_undocumented_sources.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_sources'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
20, 
6.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_source_tables'
  
, 

  
    'fct_undocumented_source_tables'
  
, 

  
    'model'
  
, 

  
    'models/marts/documentation/fct_undocumented_source_tables.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_source_tables'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
20, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_direct_relationships'
  
, 

  
    'int_direct_relationships'
  
, 

  
    'model'
  
, 

  
    'models/marts/core/int_direct_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_direct_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
86, 
12.1, 

  
    '["macro.dbt_utils.generate_surrogate_key"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_all_dag_relationships'
  
, 

  
    'int_all_dag_relationships'
  
, 

  
    'model'
  
, 

  
    'models/marts/core/int_all_dag_relationships.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_all_dag_relationships'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
4, 
2.0, 

  
    '["macro.dbt_project_evaluator.recursive_dag"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_all_graph_resources'
  
, 

  
    'int_all_graph_resources'
  
, 

  
    'model'
  
, 

  
    'models/marts/core/int_all_graph_resources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_all_graph_resources'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
156, 
24.7, 

  
    '["macro.dbt_project_evaluator.get_directory_pattern", "macro.dbt_project_evaluator.wrap_string_with_quotes", "macro.dbt_utils.union_relations", "macro.dbt.concat", "macro.dbt.split_part", "macro.dbt_project_evaluator.get_dbtreplace_directory_pattern", "macro.dbt_project_evaluator.get_regexp_directory_pattern", "macro.dbt.position"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_multiple_sources_joined'
  
, 

  
    'fct_multiple_sources_joined'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_multiple_sources_joined.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_multiple_sources_joined'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
29, 
10.3, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_root_models'
  
, 

  
    'fct_root_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_root_models.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_root_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
24, 
7.2, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_model_fanout'
  
, 

  
    'fct_model_fanout'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_model_fanout.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_model_fanout'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
50, 
18.2, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_unused_sources'
  
, 

  
    'fct_unused_sources'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_unused_sources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_unused_sources'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
7.2, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_duplicate_sources'
  
, 

  
    'fct_duplicate_sources'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_duplicate_sources.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_duplicate_sources'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
30, 
9.6, 

  
    '["macro.dbt.concat", "macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_source_fanout'
  
, 

  
    'fct_source_fanout'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_source_fanout.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_source_fanout'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
29, 
9.4, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_direct_join_to_source'
  
, 

  
    'fct_direct_join_to_source'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_direct_join_to_source.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_direct_join_to_source'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
43, 
10.9, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_staging_dependent_on_staging'
  
, 

  
    'fct_staging_dependent_on_staging'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_staging_dependent_on_staging.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_staging_dependent_on_staging'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
25, 
5.5, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_too_many_joins'
  
, 

  
    'fct_too_many_joins'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_too_many_joins.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_too_many_joins'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
10.1, 

  
    '["macro.dbt.type_int", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate'
  
, 

  
    'fct_staging_dependent_on_marts_or_intermediate'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_staging_dependent_on_marts_or_intermediate.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_staging_dependent_on_marts_or_intermediate'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
24, 
5.5, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source'
  
, 

  
    'fct_marts_or_intermediate_dependent_on_source'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_marts_or_intermediate_dependent_on_source.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_marts_or_intermediate_dependent_on_source'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
21, 
5.3, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_hard_coded_references'
  
, 

  
    'fct_hard_coded_references'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_hard_coded_references.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_hard_coded_references'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
18, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts'
  
, 

  
    'fct_rejoining_of_upstream_concepts'
  
, 

  
    'model'
  
, 

  
    'models/marts/dag/fct_rejoining_of_upstream_concepts.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_rejoining_of_upstream_concepts'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
68, 
22.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_missing_primary_key_tests'
  
, 

  
    'fct_missing_primary_key_tests'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/fct_missing_primary_key_tests.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_missing_primary_key_tests'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
27, 
5.0, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_sources_without_freshness'
  
, 

  
    'fct_sources_without_freshness'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/fct_sources_without_freshness.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_sources_without_freshness'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
20, 
6.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_test_coverage'
  
, 

  
    'fct_test_coverage'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/fct_test_coverage.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
2, 
2, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_test_coverage'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
41, 
7.6, 

  
    '["macro.dbt.type_boolean", "macro.dbt.current_timestamp", "macro.dbt.type_int", "macro.dbt_utils.safe_divide"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.int_model_test_summary'
  
, 

  
    'int_model_test_summary'
  
, 

  
    'model'
  
, 

  
    'models/marts/tests/intermediate/int_model_test_summary.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'int_model_test_summary'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
106, 
23.4, 

  
    '["macro.dbt.type_boolean", "macro.dbt.type_int"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_undocumented_public_models'
  
, 

  
    'fct_undocumented_public_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/governance/fct_undocumented_public_models.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_undocumented_public_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
30, 
5.3, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_exposures_dependent_on_private_models'
  
, 

  
    'fct_exposures_dependent_on_private_models'
  
, 

  
    'model'
  
, 

  
    'models/marts/governance/fct_exposures_dependent_on_private_models.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_exposures_dependent_on_private_models'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
28, 
4.4, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_public_models_without_contract'
  
, 

  
    'fct_public_models_without_contract'
  
, 

  
    'model'
  
, 

  
    'models/marts/governance/fct_public_models_without_contract.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_public_models_without_contract'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
22, 
5.1, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_exposure_parents_materializations'
  
, 

  
    'fct_exposure_parents_materializations'
  
, 

  
    'model'
  
, 

  
    'models/marts/performance/fct_exposure_parents_materializations.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_exposure_parents_materializations'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
33, 
4.5, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_chained_views_dependencies'
  
, 

  
    'fct_chained_views_dependencies'
  
, 

  
    'model'
  
, 

  
    'models/marts/performance/fct_chained_views_dependencies.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_chained_views_dependencies'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
25, 
6.4, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_source_directories'
  
, 

  
    'fct_source_directories'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_source_directories.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_source_directories'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
25, 
5.1, 

  
    '["macro.dbt_project_evaluator.get_directory_pattern", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_test_directories'
  
, 

  
    'fct_test_directories'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_test_directories.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_test_directories'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
86, 
15.2, 

  
    '["macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_model_naming_conventions'
  
, 

  
    'fct_model_naming_conventions'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_model_naming_conventions.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_model_naming_conventions'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
56, 
14.2, 

  
    '["macro.dbt.listagg", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'model.dbt_project_evaluator.fct_model_directories'
  
, 

  
    'fct_model_directories'
  
, 

  
    'model'
  
, 

  
    'models/marts/structure/fct_model_directories.sql'
  
, 
cast(True as boolean), 

  
    'view'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'fct_model_directories'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
69, 
16.2, 

  
    '["macro.dbt_project_evaluator.get_directory_pattern", "macro.dbt_project_evaluator.filter_exceptions"]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'seed.dbt_project_evaluator.dbt_project_evaluator_exceptions'
  
, 

  
    'dbt_project_evaluator_exceptions'
  
, 

  
    'seed'
  
, 

  
    'seeds/dbt_project_evaluator_exceptions.csv'
  
, 
cast(True as boolean), 

  
    'seed'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
4, 
4, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'dbt_project_evaluator_exceptions'
  
, 
cast(True as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7'
  
, 

  
    'valid_documentation_coverage'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'valid_documentation_coverage'
  
, 
cast(False as boolean), 

  
    'documentation_coverage_pct'
  
, 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_utils.test_accepted_range", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c'
  
, 

  
    'is_empty_fct_undocumented_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166'
  
, 

  
    'is_empty_fct_undocumented_source_tables_'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_source_tables_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235'
  
, 

  
    'is_empty_fct_undocumented_sources_'
  
, 

  
    'test'
  
, 

  
    'models/marts/documentation/documentation.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_sources_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028'
  
, 

  
    'is_empty_fct_direct_join_to_source_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_direct_join_to_source_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31'
  
, 

  
    'is_empty_fct_duplicate_sources_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_duplicate_sources_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f'
  
, 

  
    'is_empty_fct_marts_or_intermediate_dependent_on_source_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_marts_or_intermediate_dependent_on_source_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95'
  
, 

  
    'is_empty_fct_model_fanout_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_model_fanout_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817'
  
, 

  
    'is_empty_fct_multiple_sources_joined_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_multiple_sources_joined_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d'
  
, 

  
    'is_empty_fct_rejoining_of_upstream_concepts_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_rejoining_of_upstream_concepts_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1'
  
, 

  
    'is_empty_fct_root_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_root_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722'
  
, 

  
    'is_empty_fct_source_fanout_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_source_fanout_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f'
  
, 

  
    'is_empty_fct_staging_dependent_on_marts_or_intermediate_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_staging_dependent_on_marts_or_intermediate_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca'
  
, 

  
    'is_empty_fct_staging_dependent_on_staging_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_staging_dependent_on_staging_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8'
  
, 

  
    'is_empty_fct_unused_sources_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_unused_sources_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422'
  
, 

  
    'is_empty_fct_exposure_parents_materializations_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_exposure_parents_materializations_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113'
  
, 

  
    'is_empty_fct_hard_coded_references_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_hard_coded_references_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535'
  
, 

  
    'is_empty_fct_too_many_joins_'
  
, 

  
    'test'
  
, 

  
    'models/marts/dag/dag.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_too_many_joins_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.valid_test_coverage.df03f31e09'
  
, 

  
    'valid_test_coverage'
  
, 

  
    'test'
  
, 

  
    'models/marts/tests/testing.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'valid_test_coverage'
  
, 
cast(False as boolean), 

  
    'test_coverage_pct'
  
, 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_utils.test_accepted_range", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0'
  
, 

  
    'is_empty_fct_missing_primary_key_tests_'
  
, 

  
    'test'
  
, 

  
    'models/marts/tests/testing.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_missing_primary_key_tests_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283'
  
, 

  
    'is_empty_fct_sources_without_freshness_'
  
, 

  
    'test'
  
, 

  
    'models/marts/tests/testing.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_sources_without_freshness_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0'
  
, 

  
    'is_empty_fct_public_models_without_contract_'
  
, 

  
    'test'
  
, 

  
    'models/marts/governance/governance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_public_models_without_contract_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938'
  
, 

  
    'is_empty_fct_undocumented_public_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/governance/governance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_undocumented_public_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e'
  
, 

  
    'is_empty_fct_exposures_dependent_on_private_models_'
  
, 

  
    'test'
  
, 

  
    'models/marts/governance/governance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_exposures_dependent_on_private_models_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33'
  
, 

  
    'is_empty_fct_chained_views_dependencies_'
  
, 

  
    'test'
  
, 

  
    'models/marts/performance/performance.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_chained_views_dependencies_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db'
  
, 

  
    'is_empty_fct_model_directories_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_model_directories_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2'
  
, 

  
    'is_empty_fct_model_naming_conventions_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_model_naming_conventions_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c'
  
, 

  
    'is_empty_fct_source_directories_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_source_directories_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433'
  
, 

  
    'is_empty_fct_test_directories_'
  
, 

  
    'test'
  
, 

  
    'models/marts/structure/structure.yml'
  
, 
cast(True as boolean), 

  
    'test'
  
, 

  
    ''
  
, 
cast(NULL as TEXT), 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 

  
    ''
  
, 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public_dbt_test__audit'
  
, 

  
    'dbt_project_evaluator'
  
, 

  
    'is_empty_fct_test_directories_'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
0, 
0, 

  
    '["macro.dbt_project_evaluator.test_is_empty", "macro.dbt.get_where_subquery"]'
  
, 
cast(True as boolean), 
cast(False as boolean)), 

(
  
    'model.my_dbt_project.fct_sales'
  
, 

  
    'fct_sales'
  
, 

  
    'model'
  
, 

  
    'models/marts/sales/fct_sales.sql'
  
, 
cast(True as boolean), 

  
    'table'
  
, 

  
    'ignore'
  
, 
cast(NULL as TEXT), 

  
    'protected'
  
, 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(NULL as TEXT), 
cast(False as boolean), 
0, 
0, 

  
    'dw'
  
, 

  
    'public'
  
, 

  
    'my_dbt_project'
  
, 

  
    'fct_sales'
  
, 
cast(False as boolean), 
'', 

  
    '{}'
  
, 

  
    ''
  
, 
32, 
14.5, 

  
    '[]'
  
, 
cast(False as boolean), 
cast(False as boolean));
[0m21:22:00.104300 [debug] [Thread-1  ]: SQL status: INSERT 0 95 in 0.011 seconds
[0m21:22:00.105108 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: COMMIT
[0m21:22:00.105289 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:22:00.105447 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: COMMIT
[0m21:22:00.107708 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:00.109203 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_nodes__dbt_backup"
[0m21:22:00.109555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_nodes"
[0m21:22:00.109721 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_nodes"} */
drop table if exists "dw"."public"."stg_nodes__dbt_backup" cascade
[0m21:22:00.113778 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m21:22:00.114383 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_nodes: Close
[0m21:22:00.114688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109803580>]}
[0m21:22:00.114998 [info ] [Thread-1  ]: 10 of 78 OK created sql table model public.stg_nodes ........................... [[32mSELECT 0[0m in 0.40s]
[0m21:22:00.115283 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_nodes
[0m21:22:00.115470 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_sources
[0m21:22:00.115745 [info ] [Thread-1  ]: 11 of 78 START sql table model public.stg_sources .............................. [RUN]
[0m21:22:00.116015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_nodes, now model.dbt_project_evaluator.stg_sources)
[0m21:22:00.116201 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_sources
[0m21:22:00.122766 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.126849 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_sources
[0m21:22:00.129650 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.133394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.133558 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: BEGIN
[0m21:22:00.133715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.144485 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:22:00.144710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.144918 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */

  
    

  create  table "dw"."public"."stg_sources__dbt_tmp"
  
  
    as
  
  (
    


    


/* Bigquery won't let us `where` without `from` so we use this workaround */
with dummy_cte as (
    select 1 as foo
)

select 

    cast(null as TEXT) as unique_id,
    cast(null as TEXT) as name,
    cast(null as TEXT) as file_path,
    cast(null as TEXT) as alias,
    cast(null as TEXT) as resource_type,
    cast(null as TEXT) as source_name,
    cast(True as boolean) as is_source_described,
    cast(True as boolean) as is_described,
    cast(True as boolean) as is_enabled,
    cast(null as TEXT) as loaded_at_field,
    cast(True as boolean) as is_freshness_enabled,
    cast(null as TEXT) as database,
    cast(null as TEXT) as schema,
    cast(null as TEXT) as package_name,
    cast(null as TEXT) as loader,
    cast(null as TEXT) as identifier,
    cast(null as TEXT)  as meta,
    cast(True as boolean) as is_excluded

from dummy_cte
where false
  );
  
[0m21:22:00.150639 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m21:22:00.152765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.152951 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
alter table "dw"."public"."stg_sources" rename to "stg_sources__dbt_backup"
[0m21:22:00.153897 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.155557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.155730 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
alter table "dw"."public"."stg_sources__dbt_tmp" rename to "stg_sources"
[0m21:22:00.156804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.169603 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.169839 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
insert into "dw"."public"."stg_sources" values 
(
  
    'source.my_dbt_project.jaffle_shop.payments'
  
, 

  
    'payments'
  
, 

  
    'models/staging/jaffle_shop/src_jaffle_shop.yml'
  
, 

  
    ''
  
, 

  
    'source'
  
, 

  
    'jaffle_shop'
  
, 
cast(False as boolean), 
cast(False as boolean), 
cast(True as boolean), 

  
    'None'
  
, 
cast(False as boolean), 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    ''
  
, 

  
    'payments'
  
, 

  
    '{}'
  
, 
cast(False as boolean)), 

(
  
    'source.my_dbt_project.jaffle_shop.customers'
  
, 

  
    'customers'
  
, 

  
    'models/staging/jaffle_shop/src_jaffle_shop.yml'
  
, 

  
    ''
  
, 

  
    'source'
  
, 

  
    'jaffle_shop'
  
, 
cast(False as boolean), 
cast(False as boolean), 
cast(True as boolean), 

  
    'None'
  
, 
cast(False as boolean), 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    ''
  
, 

  
    'customers'
  
, 

  
    '{}'
  
, 
cast(False as boolean)), 

(
  
    'source.my_dbt_project.jaffle_shop.orders'
  
, 

  
    'orders'
  
, 

  
    'models/staging/jaffle_shop/src_jaffle_shop.yml'
  
, 

  
    ''
  
, 

  
    'source'
  
, 

  
    'jaffle_shop'
  
, 
cast(False as boolean), 
cast(False as boolean), 
cast(True as boolean), 

  
    'None'
  
, 
cast(False as boolean), 

  
    'dw'
  
, 

  
    'public_jaffle_shop'
  
, 

  
    'my_dbt_project'
  
, 

  
    ''
  
, 

  
    'orders'
  
, 

  
    '{}'
  
, 
cast(False as boolean));
[0m21:22:00.171558 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.001 seconds
[0m21:22:00.172292 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: COMMIT
[0m21:22:00.172459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.172615 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: COMMIT
[0m21:22:00.174808 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:00.176668 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_sources__dbt_backup"
[0m21:22:00.177018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_sources"
[0m21:22:00.177182 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_sources"} */
drop table if exists "dw"."public"."stg_sources__dbt_backup" cascade
[0m21:22:00.179675 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m21:22:00.180244 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_sources: Close
[0m21:22:00.180538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108838bb0>]}
[0m21:22:00.180839 [info ] [Thread-1  ]: 11 of 78 OK created sql table model public.stg_sources ......................... [[32mSELECT 0[0m in 0.06s]
[0m21:22:00.181125 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_sources
[0m21:22:00.181319 [debug] [Thread-1  ]: Began running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m21:22:00.181591 [info ] [Thread-1  ]: 12 of 78 START seed file public.dbt_project_evaluator_exceptions ............... [RUN]
[0m21:22:00.181825 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_sources, now seed.dbt_project_evaluator.dbt_project_evaluator_exceptions)
[0m21:22:00.182058 [debug] [Thread-1  ]: Began compiling node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m21:22:00.182232 [debug] [Thread-1  ]: Began executing node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m21:22:00.195881 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m21:22:00.196117 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: BEGIN
[0m21:22:00.196277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.206640 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:00.206824 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m21:22:00.206990 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"} */
truncate table "dw"."public"."dbt_project_evaluator_exceptions"
[0m21:22:00.212062 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m21:22:00.220970 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m21:22:00.228914 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: COMMIT
[0m21:22:00.229093 [debug] [Thread-1  ]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m21:22:00.229255 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: COMMIT
[0m21:22:00.231208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:00.231544 [debug] [Thread-1  ]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: Close
[0m21:22:00.231829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108838bb0>]}
[0m21:22:00.232083 [info ] [Thread-1  ]: 12 of 78 OK loaded seed file public.dbt_project_evaluator_exceptions ........... [[32mINSERT 0[0m in 0.05s]
[0m21:22:00.232359 [debug] [Thread-1  ]: Finished running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m21:22:00.232553 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_exposure_relationships
[0m21:22:00.232827 [info ] [Thread-1  ]: 13 of 78 START sql view model public.stg_exposure_relationships ................ [RUN]
[0m21:22:00.233035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_project_evaluator.dbt_project_evaluator_exceptions, now model.dbt_project_evaluator.stg_exposure_relationships)
[0m21:22:00.233212 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_exposure_relationships
[0m21:22:00.235507 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.239954 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_exposure_relationships
[0m21:22:00.243387 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.247609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.247806 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: BEGIN
[0m21:22:00.247969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.260437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m21:22:00.260617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.260801 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */

  create view "dw"."public"."stg_exposure_relationships__dbt_tmp"
    
    
  as (
    with 

_base_exposure_relationships as (
    select * from "dw"."public"."base_exposure_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_exposure_relationships
)

select distinct * from final
  );
[0m21:22:00.264645 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:22:00.266506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.266696 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */
alter table "dw"."public"."stg_exposure_relationships__dbt_tmp" rename to "stg_exposure_relationships"
[0m21:22:00.267806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.268506 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: COMMIT
[0m21:22:00.268686 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.268852 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: COMMIT
[0m21:22:00.270274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.271785 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_exposure_relationships__dbt_backup"
[0m21:22:00.272234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m21:22:00.272415 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */
drop view if exists "dw"."public"."stg_exposure_relationships__dbt_backup" cascade
[0m21:22:00.273408 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:00.274018 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_exposure_relationships: Close
[0m21:22:00.274324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960a610>]}
[0m21:22:00.274640 [info ] [Thread-1  ]: 13 of 78 OK created sql view model public.stg_exposure_relationships ........... [[32mCREATE VIEW[0m in 0.04s]
[0m21:22:00.274920 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_exposure_relationships
[0m21:22:00.275111 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_metric_relationships
[0m21:22:00.275379 [info ] [Thread-1  ]: 14 of 78 START sql view model public.stg_metric_relationships .................. [RUN]
[0m21:22:00.275617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposure_relationships, now model.dbt_project_evaluator.stg_metric_relationships)
[0m21:22:00.275801 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_metric_relationships
[0m21:22:00.278261 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.283230 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_metric_relationships
[0m21:22:00.285936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.289873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.290066 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: BEGIN
[0m21:22:00.290234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.300992 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:22:00.301188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.301382 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */

  create view "dw"."public"."stg_metric_relationships__dbt_tmp"
    
    
  as (
    with 

_base_metric_relationships as (
    select * from "dw"."public"."base_metric_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_metric_relationships
)

select distinct * from final
  );
[0m21:22:00.304868 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:00.307485 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.307676 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */
alter table "dw"."public"."stg_metric_relationships__dbt_tmp" rename to "stg_metric_relationships"
[0m21:22:00.308967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.309660 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: COMMIT
[0m21:22:00.309838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.310008 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: COMMIT
[0m21:22:00.311833 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:00.313336 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_metric_relationships__dbt_backup"
[0m21:22:00.313732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m21:22:00.313922 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */
drop view if exists "dw"."public"."stg_metric_relationships__dbt_backup" cascade
[0m21:22:00.314945 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:00.315559 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_metric_relationships: Close
[0m21:22:00.315871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109481580>]}
[0m21:22:00.316198 [info ] [Thread-1  ]: 14 of 78 OK created sql view model public.stg_metric_relationships ............. [[32mCREATE VIEW[0m in 0.04s]
[0m21:22:00.316493 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_metric_relationships
[0m21:22:00.316693 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_node_relationships
[0m21:22:00.316965 [info ] [Thread-1  ]: 15 of 78 START sql table model public.stg_node_relationships ................... [RUN]
[0m21:22:00.317202 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metric_relationships, now model.dbt_project_evaluator.stg_node_relationships)
[0m21:22:00.317385 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_node_relationships
[0m21:22:00.319818 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.324513 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_node_relationships
[0m21:22:00.327358 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.331513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.331692 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: BEGIN
[0m21:22:00.331860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.343069 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:22:00.343257 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.343463 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */

  
    

  create  table "dw"."public"."stg_node_relationships__dbt_tmp"
  
  
    as
  
  (
    with 

_base_node_relationships as (
    select * from "dw"."public"."base_node_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_node_relationships
)

-- we need distinct as the graph lists relationships multiple times if they are ref'd multiple times
select distinct * from final
  );
  
[0m21:22:00.350184 [debug] [Thread-1  ]: SQL status: SELECT 141 in 0.007 seconds
[0m21:22:00.352369 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.352565 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
alter table "dw"."public"."stg_node_relationships" rename to "stg_node_relationships__dbt_backup"
[0m21:22:00.353528 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.355328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.355522 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
alter table "dw"."public"."stg_node_relationships__dbt_tmp" rename to "stg_node_relationships"
[0m21:22:00.356584 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.357502 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: COMMIT
[0m21:22:00.357692 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.357875 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: COMMIT
[0m21:22:00.360586 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:22:00.362904 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_node_relationships__dbt_backup"
[0m21:22:00.363312 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m21:22:00.363508 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
drop table if exists "dw"."public"."stg_node_relationships__dbt_backup" cascade
[0m21:22:00.366484 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m21:22:00.367108 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_node_relationships: Close
[0m21:22:00.367427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a8190>]}
[0m21:22:00.367764 [info ] [Thread-1  ]: 15 of 78 OK created sql table model public.stg_node_relationships .............. [[32mSELECT 141[0m in 0.05s]
[0m21:22:00.368063 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_node_relationships
[0m21:22:00.368268 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.stg_columns
[0m21:22:00.368547 [info ] [Thread-1  ]: 16 of 78 START sql view model public.stg_columns ............................... [RUN]
[0m21:22:00.368791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_node_relationships, now model.dbt_project_evaluator.stg_columns)
[0m21:22:00.368986 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.stg_columns
[0m21:22:00.392466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.392701 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: BEGIN
[0m21:22:00.392861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.403056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:00.403258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.403443 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'base_node_columns'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:22:00.414049 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.010 seconds
[0m21:22:00.417455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.417663 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'base_source_columns'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:22:00.421575 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m21:22:00.423271 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.429981 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.stg_columns
[0m21:22:00.433669 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.442359 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.442604 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

  create view "dw"."public"."stg_columns__dbt_tmp"
    
    
  as (
    with

final as (

    
    

        (
            select
                cast('"dw"."public"."base_node_columns"' as TEXT) as _dbt_source_relation,

                
                    cast("node_unique_id" as text) as "node_unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("description" as text) as "description" ,
                    cast("data_type" as text) as "data_type" ,
                    cast("constraints" as text) as "constraints" ,
                    cast("has_not_null_constraint" as boolean) as "has_not_null_constraint" ,
                    cast("constraints_count" as integer) as "constraints_count" ,
                    cast("quote" as text) as "quote" 

            from "dw"."public"."base_node_columns"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."base_source_columns"' as TEXT) as _dbt_source_relation,

                
                    cast("node_unique_id" as text) as "node_unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("description" as text) as "description" ,
                    cast("data_type" as text) as "data_type" ,
                    cast("constraints" as text) as "constraints" ,
                    cast("has_not_null_constraint" as boolean) as "has_not_null_constraint" ,
                    cast("constraints_count" as integer) as "constraints_count" ,
                    cast("quote" as text) as "quote" 

            from "dw"."public"."base_source_columns"

            
        )

        
)

select * from final
  );
[0m21:22:00.446275 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:00.448272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.448480 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */
alter table "dw"."public"."stg_columns__dbt_tmp" rename to "stg_columns"
[0m21:22:00.449970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.450744 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: COMMIT
[0m21:22:00.450947 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.451137 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: COMMIT
[0m21:22:00.453480 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:00.455088 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."stg_columns__dbt_backup"
[0m21:22:00.455559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m21:22:00.455760 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */
drop view if exists "dw"."public"."stg_columns__dbt_backup" cascade
[0m21:22:00.456758 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:00.457414 [debug] [Thread-1  ]: On model.dbt_project_evaluator.stg_columns: Close
[0m21:22:00.457761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d7af0>]}
[0m21:22:00.458117 [info ] [Thread-1  ]: 16 of 78 OK created sql view model public.stg_columns .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:22:00.458435 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.stg_columns
[0m21:22:00.458653 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_all_graph_resources
[0m21:22:00.458949 [info ] [Thread-1  ]: 17 of 78 START sql table model public.int_all_graph_resources .................. [RUN]
[0m21:22:00.459209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_columns, now model.dbt_project_evaluator.int_all_graph_resources)
[0m21:22:00.459420 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_all_graph_resources
[0m21:22:00.469629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.469878 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: BEGIN
[0m21:22:00.470059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.479584 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:00.479840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.480038 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_nodes'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:22:00.488187 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0.008 seconds
[0m21:22:00.492061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.492275 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_exposures'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:22:00.495345 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.003 seconds
[0m21:22:00.497755 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.497958 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_metrics'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:22:00.500476 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.002 seconds
[0m21:22:00.503022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.503232 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sources'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:22:00.505219 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.002 seconds
[0m21:22:00.516652 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.534190 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_all_graph_resources
[0m21:22:00.537320 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.549997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.550783 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

  
    

  create  table "dw"."public"."int_all_graph_resources__dbt_tmp"
  
  
    as
  
  (
    -- one row for each resource in the graph



with unioned as (

    
    

        (
            select
                cast('"dw"."public"."stg_nodes"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast("is_enabled" as boolean) as "is_enabled" ,
                    cast("materialized" as text) as "materialized" ,
                    cast("on_schema_change" as text) as "on_schema_change" ,
                    cast("model_group" as text) as "model_group" ,
                    cast("access" as text) as "access" ,
                    cast("latest_version" as text) as "latest_version" ,
                    cast("version" as text) as "version" ,
                    cast("deprecation_date" as text) as "deprecation_date" ,
                    cast("is_contract_enforced" as boolean) as "is_contract_enforced" ,
                    cast("total_defined_columns" as integer) as "total_defined_columns" ,
                    cast("total_described_columns" as integer) as "total_described_columns" ,
                    cast("database" as text) as "database" ,
                    cast("schema" as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast("alias" as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast("column_name" as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast("hard_coded_references" as text) as "hard_coded_references" ,
                    cast("number_lines" as integer) as "number_lines" ,
                    cast("sql_complexity" as double precision) as "sql_complexity" ,
                    cast("macro_dependencies" as text) as "macro_dependencies" ,
                    cast("is_generic_test" as boolean) as "is_generic_test" ,
                    cast("is_excluded" as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dw"."public"."stg_nodes"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."stg_exposures"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast(null as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast(null as text) as "database" ,
                    cast(null as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast(null as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast(null as boolean) as "is_excluded" ,
                    cast("exposure_type" as text) as "exposure_type" ,
                    cast("maturity" as text) as "maturity" ,
                    cast("url" as text) as "url" ,
                    cast("owner_name" as text) as "owner_name" ,
                    cast("owner_email" as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dw"."public"."stg_exposures"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."stg_metrics"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast(null as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast(null as text) as "database" ,
                    cast(null as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast(null as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast(null as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast("metric_type" as text) as "metric_type" ,
                    cast("label" as text) as "label" ,
                    cast("metric_filter" as text) as "metric_filter" ,
                    cast("metric_measure" as text) as "metric_measure" ,
                    cast("metric_measure_alias" as text) as "metric_measure_alias" ,
                    cast("numerator" as text) as "numerator" ,
                    cast("denominator" as text) as "denominator" ,
                    cast("expr" as text) as "expr" ,
                    cast("metric_window" as text) as "metric_window" ,
                    cast("grain_to_date" as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dw"."public"."stg_metrics"

            
        )

        union all
        

        (
            select
                cast('"dw"."public"."stg_sources"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast("is_enabled" as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast("database" as text) as "database" ,
                    cast("schema" as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast("alias" as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast("is_excluded" as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast("source_name" as text) as "source_name" ,
                    cast("is_source_described" as boolean) as "is_source_described" ,
                    cast("loaded_at_field" as text) as "loaded_at_field" ,
                    cast("is_freshness_enabled" as boolean) as "is_freshness_enabled" ,
                    cast("loader" as text) as "loader" ,
                    cast("identifier" as text) as "identifier" 

            from "dw"."public"."stg_sources"

            
        )

        

),

naming_convention_prefixes as (
    select * from "dw"."public"."stg_naming_convention_prefixes"
), 

naming_convention_folders as (
    select * from "dw"."public"."stg_naming_convention_folders"
), 

unioned_with_calc as (
    select 
        *,
        case 
            when resource_type = 'source' then  source_name || '.' || name
            when coalesce(version, '') != '' then name || '.v' || version 
            else name 
        end as resource_name,
        case
            when resource_type = 'source' then null
            else 

  
    

    split_part(
        name,
        '_',
        1
        )


  

||'_' 
        end as prefix,
        
  

    replace(
        file_path,
        regexp_replace(file_path,'.*/',''),
        ''
    )



    
  
 as directory_path,
        regexp_replace(file_path,'.*/','') as file_name
    from unioned
    where coalesce(is_enabled, True) = True and package_name != 'dbt_project_evaluator'
), 

joined as (

    select
        unioned_with_calc.unique_id as resource_id, 
        unioned_with_calc.resource_name, 
        unioned_with_calc.prefix, 
        unioned_with_calc.resource_type, 
        unioned_with_calc.file_path, 
        unioned_with_calc.directory_path,
        unioned_with_calc.is_generic_test,
        unioned_with_calc.file_name,
        case 
            when unioned_with_calc.resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            else nullif(naming_convention_prefixes.model_type, '')
        end as model_type_prefix,
        case 
            when unioned_with_calc.resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            when 

    position(
        
  
    '/'
  
 || naming_convention_folders.folder_name_value || 
  
    '/'
  
 in unioned_with_calc.directory_path
    ) = 0 then null
            else naming_convention_folders.model_type 
        end as model_type_folder,
        

    position(
        
  
    '/'
  
 || naming_convention_folders.folder_name_value || 
  
    '/'
  
 in unioned_with_calc.directory_path
    ) as position_folder,  
        nullif(unioned_with_calc.column_name, '') as column_name,
        
        unioned_with_calc.macro_dependencies like '%macro.dbt_utils.test_unique_combination_of_columns%' and unioned_with_calc.resource_type = 'test' as is_test_unique_combination_of_columns,  
        
        unioned_with_calc.macro_dependencies like '%macro.dbt.test_unique%' and unioned_with_calc.resource_type = 'test' as is_test_unique,  
        
        unioned_with_calc.macro_dependencies like '%macro.dbt.test_not_null%' and unioned_with_calc.resource_type = 'test' as is_test_not_null,  
        
        unioned_with_calc.is_enabled, 
        unioned_with_calc.materialized, 
        unioned_with_calc.on_schema_change, 
        unioned_with_calc.database, 
        unioned_with_calc.schema, 
        unioned_with_calc.package_name, 
        unioned_with_calc.alias, 
        unioned_with_calc.is_described, 
        unioned_with_calc.model_group, 
        unioned_with_calc.access, 
        unioned_with_calc.access = 'public' as is_public, 
        unioned_with_calc.latest_version, 
        unioned_with_calc.version, 
        unioned_with_calc.deprecation_date, 
        unioned_with_calc.is_contract_enforced, 
        unioned_with_calc.total_defined_columns, 
        unioned_with_calc.total_described_columns, 
        unioned_with_calc.exposure_type, 
        unioned_with_calc.maturity, 
        unioned_with_calc.url, 
        unioned_with_calc.owner_name,
        unioned_with_calc.owner_email,
        unioned_with_calc.meta,
        unioned_with_calc.macro_dependencies,
        unioned_with_calc.metric_type, 
        unioned_with_calc.label, 
        unioned_with_calc.metric_filter,
        unioned_with_calc.metric_measure,
        unioned_with_calc.metric_measure_alias,
        unioned_with_calc.numerator,
        unioned_with_calc.denominator,
        unioned_with_calc.expr,
        unioned_with_calc.metric_window,
        unioned_with_calc.grain_to_date,
        unioned_with_calc.source_name, -- NULL for non-source resources
        unioned_with_calc.is_source_described, 
        unioned_with_calc.loaded_at_field, 
        unioned_with_calc.is_freshness_enabled, 
        unioned_with_calc.loader, 
        unioned_with_calc.identifier,
        unioned_with_calc.hard_coded_references, -- NULL for non-model resources
        unioned_with_calc.number_lines, -- NULL for non-model resources
        unioned_with_calc.sql_complexity, -- NULL for non-model resources
        unioned_with_calc.is_excluded -- NULL for metrics and exposures

    from unioned_with_calc
    left join naming_convention_prefixes
        on unioned_with_calc.prefix = naming_convention_prefixes.prefix_value

    cross join naming_convention_folders   

), 

calculate_model_type as (
    select 
        *, 
        case 
            when resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            -- by default we will define the model type based on its prefix in the case prefix and folder types are different
            else coalesce(model_type_prefix, model_type_folder, 'other') 
        end as model_type,
        row_number() over (partition by resource_id order by position_folder desc) as folder_name_rank
    from joined
),

final as (
    select
        *
    from calculate_model_type
    where folder_name_rank = 1
)

select 
    *
from final
  );
  
[0m21:22:00.562887 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.011 seconds
[0m21:22:00.565408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.565634 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
alter table "dw"."public"."int_all_graph_resources" rename to "int_all_graph_resources__dbt_backup"
[0m21:22:00.566519 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.569339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.569562 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
alter table "dw"."public"."int_all_graph_resources__dbt_tmp" rename to "int_all_graph_resources"
[0m21:22:00.570275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:00.571341 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: COMMIT
[0m21:22:00.571549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.571741 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: COMMIT
[0m21:22:00.573396 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.575233 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_all_graph_resources__dbt_backup"
[0m21:22:00.575672 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m21:22:00.575881 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
drop table if exists "dw"."public"."int_all_graph_resources__dbt_backup" cascade
[0m21:22:00.580898 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m21:22:00.581688 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_graph_resources: Close
[0m21:22:00.582096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d7af0>]}
[0m21:22:00.582499 [info ] [Thread-1  ]: 17 of 78 OK created sql table model public.int_all_graph_resources ............. [[32mSELECT 20[0m in 0.12s]
[0m21:22:00.582842 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_all_graph_resources
[0m21:22:00.583516 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_documentation_coverage
[0m21:22:00.583852 [info ] [Thread-1  ]: 18 of 78 START sql view model public.fct_documentation_coverage ................ [RUN]
[0m21:22:00.584135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_graph_resources, now model.dbt_project_evaluator.fct_documentation_coverage)
[0m21:22:00.584361 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_documentation_coverage
[0m21:22:00.591465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.600014 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_documentation_coverage
[0m21:22:00.603194 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.611922 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.612142 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: BEGIN
[0m21:22:00.612352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.620967 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:00.621210 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.621504 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */

  create view "dw"."public"."fct_documentation_coverage__dbt_tmp"
    
    
  as (
    with

models as (
    select * from "dw"."public"."int_all_graph_resources"
    where resource_type = 'model'
    and not is_excluded
),

conversion as (
    select
        resource_id,
        case when is_described then 1 else 0 end as is_described_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when is_described and model_type = 'base' then 1.0 else 0 end as is_described_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when is_described and model_type = 'staging' then 1.0 else 0 end as is_described_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when is_described and model_type = 'intermediate' then 1.0 else 0 end as is_described_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when is_described and model_type = 'marts' then 1.0 else 0 end as is_described_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when is_described and model_type = 'other' then 1.0 else 0 end as is_described_other_model
        

    from models
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(is_described_model) as integer) as documented_models,
        round(sum(is_described_model) * 100.00 / count(*), 2) as documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_base_model) * 100 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_staging_model) * 100 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_intermediate_model) * 100 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_marts_model) * 100 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_other_model) * 100 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_documentation_coverage_pct
        

    from models
    left join conversion
    on models.resource_id = conversion.resource_id
)

select * from final
  );
[0m21:22:00.626097 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:22:00.628426 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.628654 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */
alter table "dw"."public"."fct_documentation_coverage__dbt_tmp" rename to "fct_documentation_coverage"
[0m21:22:00.629625 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.630495 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: COMMIT
[0m21:22:00.630706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.630900 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: COMMIT
[0m21:22:00.632514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.635001 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_documentation_coverage__dbt_backup"
[0m21:22:00.635444 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m21:22:00.635651 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */
drop view if exists "dw"."public"."fct_documentation_coverage__dbt_backup" cascade
[0m21:22:00.636285 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:22:00.636991 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_documentation_coverage: Close
[0m21:22:00.637355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096add60>]}
[0m21:22:00.637729 [info ] [Thread-1  ]: 18 of 78 OK created sql view model public.fct_documentation_coverage ........... [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:00.638053 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_documentation_coverage
[0m21:22:00.638284 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_duplicate_sources
[0m21:22:00.638630 [info ] [Thread-1  ]: 19 of 78 START sql table model public.fct_duplicate_sources .................... [RUN]
[0m21:22:00.639036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_documentation_coverage, now model.dbt_project_evaluator.fct_duplicate_sources)
[0m21:22:00.639271 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_duplicate_sources
[0m21:22:00.649127 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.665521 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_duplicate_sources
[0m21:22:00.668728 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.676003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.676215 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: BEGIN
[0m21:22:00.676404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.685973 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:00.686328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.686568 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */

  
    

  create  table "dw"."public"."fct_duplicate_sources__dbt_tmp"
  
  
    as
  
  (
    with sources as (
    select
        resource_name,
        case 
            -- if you're using databricks but not the unity catalog, database will be null
            when database is NULL then schema || '.' || identifier 
            else database || '.' || schema || '.' || identifier 
        end as source_db_location 
    from "dw"."public"."int_all_graph_resources"
    where resource_type = 'source'
    and not is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

source_duplicates as (
    select
        source_db_location,
        
    string_agg(
        resource_name,
        ', '
        
        ) as source_names
    from sources
    group by source_db_location
    having count(*) > 1
)

select * from source_duplicates



    

    
    

    

    


  );
  
[0m21:22:00.690805 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m21:22:00.693514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.693753 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
alter table "dw"."public"."fct_duplicate_sources" rename to "fct_duplicate_sources__dbt_backup"
[0m21:22:00.694657 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.696793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.697012 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
alter table "dw"."public"."fct_duplicate_sources__dbt_tmp" rename to "fct_duplicate_sources"
[0m21:22:00.697879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.699006 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: COMMIT
[0m21:22:00.699211 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.699395 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: COMMIT
[0m21:22:00.700392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.702923 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_duplicate_sources__dbt_backup"
[0m21:22:00.703385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m21:22:00.703585 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
drop table if exists "dw"."public"."fct_duplicate_sources__dbt_backup" cascade
[0m21:22:00.705137 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:00.705899 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_duplicate_sources: Close
[0m21:22:00.706302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990ef10>]}
[0m21:22:00.706687 [info ] [Thread-1  ]: 19 of 78 OK created sql table model public.fct_duplicate_sources ............... [[32mSELECT 0[0m in 0.07s]
[0m21:22:00.707004 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_duplicate_sources
[0m21:22:00.707229 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_hard_coded_references
[0m21:22:00.707492 [info ] [Thread-1  ]: 20 of 78 START sql table model public.fct_hard_coded_references ................ [RUN]
[0m21:22:00.707788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_duplicate_sources, now model.dbt_project_evaluator.fct_hard_coded_references)
[0m21:22:00.708035 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_hard_coded_references
[0m21:22:00.710512 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.713612 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_hard_coded_references
[0m21:22:00.716725 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.719444 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.719673 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: BEGIN
[0m21:22:00.719857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.727699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:00.728010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.728224 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */

  
    

  create  table "dw"."public"."fct_hard_coded_references__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has hard coded references

with models as (
    select * from "dw"."public"."int_all_graph_resources"
    where resource_type = 'model'
    and not is_excluded
),

final as (
    select
        resource_name as model,
        hard_coded_references
    from models
    where hard_coded_references != ''
)

select * from final



    

    
    

    

    


  );
  
[0m21:22:00.730721 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:22:00.733113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.733318 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
alter table "dw"."public"."fct_hard_coded_references" rename to "fct_hard_coded_references__dbt_backup"
[0m21:22:00.733986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:00.735852 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.736043 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
alter table "dw"."public"."fct_hard_coded_references__dbt_tmp" rename to "fct_hard_coded_references"
[0m21:22:00.736662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:00.737586 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: COMMIT
[0m21:22:00.737776 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.737953 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: COMMIT
[0m21:22:00.739040 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.740581 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_hard_coded_references__dbt_backup"
[0m21:22:00.740981 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m21:22:00.741165 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
drop table if exists "dw"."public"."fct_hard_coded_references__dbt_backup" cascade
[0m21:22:00.742395 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:00.743023 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_hard_coded_references: Close
[0m21:22:00.743378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d7af0>]}
[0m21:22:00.743729 [info ] [Thread-1  ]: 20 of 78 OK created sql table model public.fct_hard_coded_references ........... [[32mSELECT 1[0m in 0.04s]
[0m21:22:00.744029 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_hard_coded_references
[0m21:22:00.744237 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m21:22:00.744691 [info ] [Thread-1  ]: 21 of 78 START sql view model public.fct_model_naming_conventions .............. [RUN]
[0m21:22:00.744985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_hard_coded_references, now model.dbt_project_evaluator.fct_model_naming_conventions)
[0m21:22:00.745188 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_model_naming_conventions
[0m21:22:00.748966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.752632 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_model_naming_conventions
[0m21:22:00.755651 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.759184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.759390 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: BEGIN
[0m21:22:00.759565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.768315 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:00.768506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.768730 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */

  create view "dw"."public"."fct_model_naming_conventions__dbt_tmp"
    
    
  as (
    -- all models with inappropriate (or lack of) pre-fix
-- ensure dbt project has consistent naming conventions

with all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
    -- exclude required metricflow time spine
    and resource_name != 'metricflow_time_spine'
),

naming_convention_prefixes as (
    select * from "dw"."public"."stg_naming_convention_prefixes"
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by prefix_value
), 

appropriate_prefixes as (
    select 
        model_type, 
        
    string_agg(
        prefix_value,
        ', '
        
        ) as appropriate_prefixes
    from naming_convention_prefixes
    group by model_type
), 

models as (
    select
        all_graph_resources.resource_name,
        all_graph_resources.prefix,
        all_graph_resources.model_type,
        naming_convention_prefixes.prefix_value
    from all_graph_resources 
    left join naming_convention_prefixes
        on all_graph_resources.model_type = naming_convention_prefixes.model_type
        and all_graph_resources.prefix = naming_convention_prefixes.prefix_value
    where resource_type = 'model'
),

inappropriate_model_names as (
    select 
        models.resource_name,
        models.prefix,
        models.model_type,
        appropriate_prefixes.appropriate_prefixes
    from models
    left join appropriate_prefixes
        on models.model_type = appropriate_prefixes.model_type
    where nullif(models.prefix_value, '') is null

)

select * from inappropriate_model_names



    

    
    

    

    


  );
[0m21:22:00.772464 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:00.774549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.774754 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */
alter table "dw"."public"."fct_model_naming_conventions__dbt_tmp" rename to "fct_model_naming_conventions"
[0m21:22:00.775691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.776536 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: COMMIT
[0m21:22:00.776744 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.776929 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: COMMIT
[0m21:22:00.777730 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.779309 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_model_naming_conventions__dbt_backup"
[0m21:22:00.779719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m21:22:00.779908 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */
drop view if exists "dw"."public"."fct_model_naming_conventions__dbt_backup" cascade
[0m21:22:00.780522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:22:00.781183 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_naming_conventions: Close
[0m21:22:00.781530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a94c0>]}
[0m21:22:00.781876 [info ] [Thread-1  ]: 21 of 78 OK created sql view model public.fct_model_naming_conventions ......... [[32mCREATE VIEW[0m in 0.04s]
[0m21:22:00.782175 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m21:22:00.782383 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m21:22:00.782719 [info ] [Thread-1  ]: 22 of 78 START sql view model public.fct_public_models_without_contract ........ [RUN]
[0m21:22:00.783008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_naming_conventions, now model.dbt_project_evaluator.fct_public_models_without_contract)
[0m21:22:00.783232 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_public_models_without_contract
[0m21:22:00.785534 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.788459 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_public_models_without_contract
[0m21:22:00.798108 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.808091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.810796 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: BEGIN
[0m21:22:00.811858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.824877 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m21:22:00.825252 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.825470 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */

  create view "dw"."public"."fct_public_models_without_contract__dbt_tmp"
    
    
  as (
    with 

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

final as (

    select 
        resource_name,
        is_public,
        is_contract_enforced
        
    from all_resources
    where 
        is_public 
        and not is_contract_enforced
)

select * from final



    

    
    

    

    


  );
[0m21:22:00.828596 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:00.833238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.833534 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */
alter table "dw"."public"."fct_public_models_without_contract__dbt_tmp" rename to "fct_public_models_without_contract"
[0m21:22:00.834880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.836054 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: COMMIT
[0m21:22:00.836365 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.836555 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: COMMIT
[0m21:22:00.837573 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.839231 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_public_models_without_contract__dbt_backup"
[0m21:22:00.839653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m21:22:00.839873 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */
drop view if exists "dw"."public"."fct_public_models_without_contract__dbt_backup" cascade
[0m21:22:00.840526 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:22:00.841195 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_public_models_without_contract: Close
[0m21:22:00.841508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ffd00>]}
[0m21:22:00.841839 [info ] [Thread-1  ]: 22 of 78 OK created sql view model public.fct_public_models_without_contract ... [[32mCREATE VIEW[0m in 0.06s]
[0m21:22:00.842131 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m21:22:00.842326 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_source_directories
[0m21:22:00.842673 [info ] [Thread-1  ]: 23 of 78 START sql view model public.fct_source_directories .................... [RUN]
[0m21:22:00.842949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_public_models_without_contract, now model.dbt_project_evaluator.fct_source_directories)
[0m21:22:00.843143 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_source_directories
[0m21:22:00.845640 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.848589 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_source_directories
[0m21:22:00.851427 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.854822 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.855018 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: BEGIN
[0m21:22:00.855188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.861742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:00.861962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.862143 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */

  create view "dw"."public"."fct_source_directories__dbt_tmp"
    
    
  as (
    -- Because we often work with multiple data sources, in our staging directory, we create one directory per source.

-- This model finds all cases where a source definition is NOT in the appropriate subdirectory.



with all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

-- find all sources that are definied in a .yml file NOT in their subdirectory
inappropriate_subdirectories_sources as (
    select 
        resource_name,
        resource_type,
        file_path as current_file_path,
        'models/' || 'staging' || '/' || source_name || '/' || file_name as change_file_path_to
    from all_graph_resources
    where resource_type = 'source'
    and directory_path not like '%' || source_name || '%'
)

select * from inappropriate_subdirectories_sources



    

    
    

    

    


  );
[0m21:22:00.864206 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:22:00.866677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.866845 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */
alter table "dw"."public"."fct_source_directories__dbt_tmp" rename to "fct_source_directories"
[0m21:22:00.867541 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.868191 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: COMMIT
[0m21:22:00.868351 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.868499 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: COMMIT
[0m21:22:00.869509 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.895411 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_source_directories__dbt_backup"
[0m21:22:00.895835 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m21:22:00.896009 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */
drop view if exists "dw"."public"."fct_source_directories__dbt_backup" cascade
[0m21:22:00.896988 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:00.897634 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_directories: Close
[0m21:22:00.897956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a77f70>]}
[0m21:22:00.898298 [info ] [Thread-1  ]: 23 of 78 OK created sql view model public.fct_source_directories ............... [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:00.898599 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_source_directories
[0m21:22:00.898790 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m21:22:00.899038 [info ] [Thread-1  ]: 24 of 78 START sql view model public.fct_sources_without_freshness ............. [RUN]
[0m21:22:00.899281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_directories, now model.dbt_project_evaluator.fct_sources_without_freshness)
[0m21:22:00.899499 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_sources_without_freshness
[0m21:22:00.901580 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.905127 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_sources_without_freshness
[0m21:22:00.907755 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.911289 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.911488 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: BEGIN
[0m21:22:00.911661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:00.920269 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:00.920455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.920634 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */

  create view "dw"."public"."fct_sources_without_freshness__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select distinct
        resource_name

    from all_resources
    where not is_freshness_enabled and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m21:22:00.923466 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:00.925309 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.925493 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */
alter table "dw"."public"."fct_sources_without_freshness__dbt_tmp" rename to "fct_sources_without_freshness"
[0m21:22:00.926446 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:00.927116 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: COMMIT
[0m21:22:00.927284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.927439 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: COMMIT
[0m21:22:00.928779 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:00.930111 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_sources_without_freshness__dbt_backup"
[0m21:22:00.930506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m21:22:00.930671 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */
drop view if exists "dw"."public"."fct_sources_without_freshness__dbt_backup" cascade
[0m21:22:00.931585 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:00.932150 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_sources_without_freshness: Close
[0m21:22:00.932438 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a96d90>]}
[0m21:22:01.681350 [debug] [Thread-1  ]: An error was encountered while trying to send an event
[0m21:22:01.684621 [info ] [Thread-1  ]: 24 of 78 OK created sql view model public.fct_sources_without_freshness ........ [[32mCREATE VIEW[0m in 0.03s]
[0m21:22:01.685861 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m21:22:01.686603 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_models
[0m21:22:01.687466 [info ] [Thread-1  ]: 25 of 78 START sql view model public.fct_undocumented_models ................... [RUN]
[0m21:22:01.688616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_sources_without_freshness, now model.dbt_project_evaluator.fct_undocumented_models)
[0m21:22:01.689105 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_models
[0m21:22:01.697062 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.704589 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_models
[0m21:22:01.710612 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.715893 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.716238 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: BEGIN
[0m21:22:01.716556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:01.730982 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m21:22:01.731369 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.731739 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */

  create view "dw"."public"."fct_undocumented_models__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select
        resource_name,
        model_type

    from all_resources
    where not is_described and resource_type = 'model'

)

select * from final



    

    
    

    

    


  );
[0m21:22:01.736748 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:22:01.740202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.740559 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */
alter table "dw"."public"."fct_undocumented_models__dbt_tmp" rename to "fct_undocumented_models"
[0m21:22:01.742295 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:01.743638 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: COMMIT
[0m21:22:01.743982 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.744303 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: COMMIT
[0m21:22:01.746939 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:01.749645 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_models__dbt_backup"
[0m21:22:01.750361 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m21:22:01.750701 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */
drop view if exists "dw"."public"."fct_undocumented_models__dbt_backup" cascade
[0m21:22:01.752112 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:01.753238 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_models: Close
[0m21:22:01.753783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108504dc0>]}
[0m21:22:01.754369 [info ] [Thread-1  ]: 25 of 78 OK created sql view model public.fct_undocumented_models .............. [[32mCREATE VIEW[0m in 0.07s]
[0m21:22:01.754889 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_models
[0m21:22:01.755212 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m21:22:01.755663 [info ] [Thread-1  ]: 26 of 78 START sql view model public.fct_undocumented_public_models ............ [RUN]
[0m21:22:01.756115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_models, now model.dbt_project_evaluator.fct_undocumented_public_models)
[0m21:22:01.756437 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_public_models
[0m21:22:01.759893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.765330 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_public_models
[0m21:22:01.770789 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.779472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.779749 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: BEGIN
[0m21:22:01.779998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:01.792723 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m21:22:01.793030 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.793355 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */

  create view "dw"."public"."fct_undocumented_public_models__dbt_tmp"
    
    
  as (
    with 

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

final as (
    select 
        resource_name,
        access, 
        is_described, 
        total_defined_columns,
        total_described_columns
    
    from all_resources
    where 
        is_public 
        and (
            -- no model level description
            not is_described
            -- not all columns defined have descriptions
            or total_described_columns < total_defined_columns
            -- no columns defined at all
            or total_defined_columns = 0
        )
)

select * from final



    

    
    

    

    


  );
[0m21:22:01.798925 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:22:01.801856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.802150 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */
alter table "dw"."public"."fct_undocumented_public_models__dbt_tmp" rename to "fct_undocumented_public_models"
[0m21:22:01.804226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:22:01.805245 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: COMMIT
[0m21:22:01.805512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.805761 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: COMMIT
[0m21:22:01.808830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m21:22:01.810910 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_public_models__dbt_backup"
[0m21:22:01.811474 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m21:22:01.811744 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */
drop view if exists "dw"."public"."fct_undocumented_public_models__dbt_backup" cascade
[0m21:22:01.813091 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:01.813962 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_public_models: Close
[0m21:22:01.814406 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995e490>]}
[0m21:22:01.814870 [info ] [Thread-1  ]: 26 of 78 OK created sql view model public.fct_undocumented_public_models ....... [[32mCREATE VIEW[0m in 0.06s]
[0m21:22:01.815280 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m21:22:01.815564 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m21:22:01.815960 [info ] [Thread-1  ]: 27 of 78 START sql view model public.fct_undocumented_source_tables ............ [RUN]
[0m21:22:01.816296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_public_models, now model.dbt_project_evaluator.fct_undocumented_source_tables)
[0m21:22:01.816664 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m21:22:01.819728 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.827112 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m21:22:01.830811 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.835646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.835885 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: BEGIN
[0m21:22:01.836104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:01.849828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m21:22:01.850065 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.850303 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */

  create view "dw"."public"."fct_undocumented_source_tables__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select
        resource_name

    from all_resources
    where not is_described and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m21:22:01.854365 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:22:01.857682 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.857921 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */
alter table "dw"."public"."fct_undocumented_source_tables__dbt_tmp" rename to "fct_undocumented_source_tables"
[0m21:22:01.859288 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:01.860170 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: COMMIT
[0m21:22:01.860399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.860613 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: COMMIT
[0m21:22:01.862168 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:01.863988 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_source_tables__dbt_backup"
[0m21:22:01.864470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m21:22:01.864697 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */
drop view if exists "dw"."public"."fct_undocumented_source_tables__dbt_backup" cascade
[0m21:22:01.865599 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:01.866490 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_source_tables: Close
[0m21:22:01.866932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109939430>]}
[0m21:22:01.867386 [info ] [Thread-1  ]: 27 of 78 OK created sql view model public.fct_undocumented_source_tables ....... [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:01.867768 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m21:22:01.868021 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_undocumented_sources
[0m21:22:01.868416 [info ] [Thread-1  ]: 28 of 78 START sql view model public.fct_undocumented_sources .................. [RUN]
[0m21:22:01.868808 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_source_tables, now model.dbt_project_evaluator.fct_undocumented_sources)
[0m21:22:01.869077 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_undocumented_sources
[0m21:22:01.871803 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.877140 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_undocumented_sources
[0m21:22:01.880672 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.888153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.888383 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: BEGIN
[0m21:22:01.888596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:01.897019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:01.897277 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.897507 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */

  create view "dw"."public"."fct_undocumented_sources__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select distinct
        source_name

    from all_resources
    where not is_source_described and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m21:22:01.900484 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:01.903170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.903399 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */
alter table "dw"."public"."fct_undocumented_sources__dbt_tmp" rename to "fct_undocumented_sources"
[0m21:22:01.904239 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:01.905093 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: COMMIT
[0m21:22:01.905314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.905520 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: COMMIT
[0m21:22:01.906999 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:01.908738 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_undocumented_sources__dbt_backup"
[0m21:22:01.909206 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m21:22:01.909430 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */
drop view if exists "dw"."public"."fct_undocumented_sources__dbt_backup" cascade
[0m21:22:01.910158 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:01.910922 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_undocumented_sources: Close
[0m21:22:01.911397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c5e50>]}
[0m21:22:01.911906 [info ] [Thread-1  ]: 28 of 78 OK created sql view model public.fct_undocumented_sources ............. [[32mCREATE VIEW[0m in 0.04s]
[0m21:22:01.912285 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_undocumented_sources
[0m21:22:01.912540 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_direct_relationships
[0m21:22:01.912925 [info ] [Thread-1  ]: 29 of 78 START sql view model public.int_direct_relationships .................. [RUN]
[0m21:22:01.913300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_sources, now model.dbt_project_evaluator.int_direct_relationships)
[0m21:22:01.913547 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_direct_relationships
[0m21:22:01.918742 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.928197 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_direct_relationships
[0m21:22:01.931767 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.938918 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.939143 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: BEGIN
[0m21:22:01.939354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:01.949368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:01.949608 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.949914 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */

  create view "dw"."public"."int_direct_relationships__dbt_tmp"
    
    
  as (
    -- one record for each resource in the graph and its direct parent
with 

all_graph_resources as (
    select
        resource_id,
        resource_name,
        resource_type,
        file_path,
        directory_path, 
        file_name,
        model_type,
        materialized,
        is_public, 
        access, 
        source_name,
        is_excluded
    from "dw"."public"."int_all_graph_resources"
),

direct_model_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dw"."public"."stg_node_relationships"
),

direct_exposure_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dw"."public"."stg_exposure_relationships"
),

direct_metrics_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dw"."public"."stg_metric_relationships"
),

-- for all resources in the graph, find their direct parent
direct_relationships as (
    select
        all_graph_resources.resource_id,
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.file_path,
        all_graph_resources.directory_path, 
        all_graph_resources.file_name,
        all_graph_resources.model_type,
        all_graph_resources.materialized,
        all_graph_resources.is_public, 
        all_graph_resources.access, 
        all_graph_resources.source_name,
        all_graph_resources.is_excluded,
        case 
            when all_graph_resources.resource_type = 'source' then null
            when all_graph_resources.resource_type = 'exposure' then exposures.direct_parent_id
            when all_graph_resources.resource_type = 'metric' then metrics.direct_parent_id
            when all_graph_resources.resource_type in ('model', 'snapshot', 'test') then models.direct_parent_id
            else null
        end as direct_parent_id,
        (
            all_graph_resources.resource_type = 'test'
            and models.is_primary_relationship
        ) as is_primary_test_relationship
    from all_graph_resources
    left join direct_model_relationships as models
        on all_graph_resources.resource_id = models.resource_id
    left join direct_exposure_relationships as exposures
        on all_graph_resources.resource_id = exposures.resource_id
    left join direct_metrics_relationships as metrics
        on all_graph_resources.resource_id = metrics.resource_id
),

final as (
    select
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id,
        *
    from direct_relationships
)

select * from final
  );
[0m21:22:01.953331 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:01.956092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.956334 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */
alter table "dw"."public"."int_direct_relationships__dbt_tmp" rename to "int_direct_relationships"
[0m21:22:01.957922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:01.958916 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: COMMIT
[0m21:22:01.959143 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.959347 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: COMMIT
[0m21:22:01.961163 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:01.963361 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_direct_relationships__dbt_backup"
[0m21:22:01.963920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m21:22:01.964138 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */
drop view if exists "dw"."public"."int_direct_relationships__dbt_backup" cascade
[0m21:22:01.965255 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:01.966198 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_direct_relationships: Close
[0m21:22:01.966701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c8850>]}
[0m21:22:01.967171 [info ] [Thread-1  ]: 29 of 78 OK created sql view model public.int_direct_relationships ............. [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:01.967553 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_direct_relationships
[0m21:22:01.967823 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m21:22:01.968175 [info ] [Thread-1  ]: 30 of 78 START test valid_documentation_coverage ............................... [RUN]
[0m21:22:01.968526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_direct_relationships, now test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7)
[0m21:22:01.968760 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m21:22:01.977854 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m21:22:01.981790 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m21:22:01.992974 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m21:22:01.997156 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m21:22:01.997383 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: BEGIN
[0m21:22:01.997560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.010702 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m21:22:02.010918 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m21:22:02.011122 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "dw"."public"."fct_documentation_coverage"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not documentation_coverage_pct >= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m21:22:02.016205 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m21:22:02.018418 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: ROLLBACK
[0m21:22:02.019329 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: Close
[0m21:22:02.019744 [warn ] [Thread-1  ]: 30 of 78 WARN 1 valid_documentation_coverage ................................... [[33mWARN 1[0m in 0.05s]
[0m21:22:02.020075 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m21:22:02.020296 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m21:22:02.020571 [info ] [Thread-1  ]: 31 of 78 START test is_empty_fct_duplicate_sources_ ............................ [RUN]
[0m21:22:02.020863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7, now test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31)
[0m21:22:02.021080 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m21:22:02.024592 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m21:22:02.028233 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m21:22:02.029933 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m21:22:02.032050 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m21:22:02.032247 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: BEGIN
[0m21:22:02.032423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.039651 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:02.039959 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m21:22:02.040158 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_duplicate_sources"


      
    ) dbt_internal_test
[0m21:22:02.041090 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:02.041988 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: ROLLBACK
[0m21:22:02.042486 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: Close
[0m21:22:02.042840 [info ] [Thread-1  ]: 31 of 78 PASS is_empty_fct_duplicate_sources_ .................................. [[32mPASS[0m in 0.02s]
[0m21:22:02.043143 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m21:22:02.043360 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m21:22:02.043599 [info ] [Thread-1  ]: 32 of 78 START test is_empty_fct_hard_coded_references_ ........................ [RUN]
[0m21:22:02.043836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31, now test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113)
[0m21:22:02.044032 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m21:22:02.046841 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m21:22:02.049524 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m21:22:02.051275 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m21:22:02.053158 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m21:22:02.053350 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: BEGIN
[0m21:22:02.053554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.060438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:02.060702 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m21:22:02.060896 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_hard_coded_references"


      
    ) dbt_internal_test
[0m21:22:02.061927 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:02.062776 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: ROLLBACK
[0m21:22:02.063299 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: Close
[0m21:22:02.063644 [warn ] [Thread-1  ]: 32 of 78 WARN 1 is_empty_fct_hard_coded_references_ ............................ [[33mWARN 1[0m in 0.02s]
[0m21:22:02.063943 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m21:22:02.064157 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m21:22:02.064392 [info ] [Thread-1  ]: 33 of 78 START test is_empty_fct_model_naming_conventions_ ..................... [RUN]
[0m21:22:02.064625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113, now test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2)
[0m21:22:02.064820 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m21:22:02.068433 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m21:22:02.073543 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m21:22:02.075427 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m21:22:02.079392 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m21:22:02.079594 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: BEGIN
[0m21:22:02.079764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.088639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.088964 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m21:22:02.089176 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_model_naming_conventions"


      
    ) dbt_internal_test
[0m21:22:02.092437 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m21:22:02.093381 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: ROLLBACK
[0m21:22:02.094014 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: Close
[0m21:22:02.094435 [warn ] [Thread-1  ]: 33 of 78 WARN 1 is_empty_fct_model_naming_conventions_ ......................... [[33mWARN 1[0m in 0.03s]
[0m21:22:02.094763 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m21:22:02.094979 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m21:22:02.095244 [info ] [Thread-1  ]: 34 of 78 START test is_empty_fct_public_models_without_contract_ ............... [RUN]
[0m21:22:02.095558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2, now test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0)
[0m21:22:02.095769 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m21:22:02.098593 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m21:22:02.102054 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m21:22:02.104110 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m21:22:02.106871 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m21:22:02.107079 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: BEGIN
[0m21:22:02.107259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.116873 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:02.117125 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m21:22:02.117325 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_public_models_without_contract"


      
    ) dbt_internal_test
[0m21:22:02.118609 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:02.119528 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: ROLLBACK
[0m21:22:02.120123 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: Close
[0m21:22:02.120482 [info ] [Thread-1  ]: 34 of 78 PASS is_empty_fct_public_models_without_contract_ ..................... [[32mPASS[0m in 0.02s]
[0m21:22:02.120787 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m21:22:02.120995 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m21:22:02.121239 [info ] [Thread-1  ]: 35 of 78 START test is_empty_fct_source_directories_ ........................... [RUN]
[0m21:22:02.121514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0, now test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c)
[0m21:22:02.121715 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m21:22:02.124335 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m21:22:02.128100 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m21:22:02.129921 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m21:22:02.133055 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m21:22:02.133260 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: BEGIN
[0m21:22:02.133442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.142278 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.142505 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m21:22:02.142711 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_source_directories"


      
    ) dbt_internal_test
[0m21:22:02.144493 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:22:02.146485 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: ROLLBACK
[0m21:22:02.147749 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: Close
[0m21:22:02.148090 [info ] [Thread-1  ]: 35 of 78 PASS is_empty_fct_source_directories_ ................................. [[32mPASS[0m in 0.03s]
[0m21:22:02.148395 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m21:22:02.148605 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m21:22:02.148843 [info ] [Thread-1  ]: 36 of 78 START test is_empty_fct_sources_without_freshness_ .................... [RUN]
[0m21:22:02.149091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c, now test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283)
[0m21:22:02.149291 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m21:22:02.151850 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m21:22:02.154751 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m21:22:02.156731 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m21:22:02.161522 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m21:22:02.161730 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: BEGIN
[0m21:22:02.161917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.171977 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:02.172212 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m21:22:02.172428 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_sources_without_freshness"


      
    ) dbt_internal_test
[0m21:22:02.174375 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:22:02.175264 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: ROLLBACK
[0m21:22:02.175863 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: Close
[0m21:22:02.176231 [warn ] [Thread-1  ]: 36 of 78 WARN 3 is_empty_fct_sources_without_freshness_ ........................ [[33mWARN 3[0m in 0.03s]
[0m21:22:02.176549 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m21:22:02.176767 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m21:22:02.177013 [info ] [Thread-1  ]: 37 of 78 START test is_empty_fct_undocumented_models_ .......................... [RUN]
[0m21:22:02.177269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283, now test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c)
[0m21:22:02.177476 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m21:22:02.180198 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m21:22:02.185549 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m21:22:02.187389 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m21:22:02.191711 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m21:22:02.191916 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: BEGIN
[0m21:22:02.192103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.201360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.201645 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m21:22:02.201850 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_models"


      
    ) dbt_internal_test
[0m21:22:02.203715 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:22:02.204662 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: ROLLBACK
[0m21:22:02.205212 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: Close
[0m21:22:02.205612 [warn ] [Thread-1  ]: 37 of 78 WARN 8 is_empty_fct_undocumented_models_ .............................. [[33mWARN 8[0m in 0.03s]
[0m21:22:02.205959 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m21:22:02.206188 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m21:22:02.206407 [info ] [Thread-1  ]: 38 of 78 START test is_empty_fct_undocumented_public_models_ ................... [RUN]
[0m21:22:02.206731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c, now test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938)
[0m21:22:02.206969 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m21:22:02.209894 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m21:22:02.213245 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m21:22:02.216642 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m21:22:02.219498 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m21:22:02.219727 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: BEGIN
[0m21:22:02.219909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.229024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.229293 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m21:22:02.229508 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_public_models"


      
    ) dbt_internal_test
[0m21:22:02.230924 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:02.231840 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: ROLLBACK
[0m21:22:02.232371 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: Close
[0m21:22:02.232736 [info ] [Thread-1  ]: 38 of 78 PASS is_empty_fct_undocumented_public_models_ ......................... [[32mPASS[0m in 0.03s]
[0m21:22:02.233056 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m21:22:02.233275 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m21:22:02.233527 [info ] [Thread-1  ]: 39 of 78 START test is_empty_fct_undocumented_source_tables_ ................... [RUN]
[0m21:22:02.233811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938, now test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166)
[0m21:22:02.234016 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m21:22:02.236778 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m21:22:02.239732 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m21:22:02.241572 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m21:22:02.244017 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m21:22:02.244212 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: BEGIN
[0m21:22:02.244391 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.253009 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.253308 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m21:22:02.253519 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_source_tables"


      
    ) dbt_internal_test
[0m21:22:02.255130 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:02.256011 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: ROLLBACK
[0m21:22:02.256652 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: Close
[0m21:22:02.257059 [warn ] [Thread-1  ]: 39 of 78 WARN 3 is_empty_fct_undocumented_source_tables_ ....................... [[33mWARN 3[0m in 0.02s]
[0m21:22:02.257392 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m21:22:02.257613 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m21:22:02.257863 [info ] [Thread-1  ]: 40 of 78 START test is_empty_fct_undocumented_sources_ ......................... [RUN]
[0m21:22:02.258153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166, now test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235)
[0m21:22:02.258355 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m21:22:02.261002 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m21:22:02.265142 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m21:22:02.266867 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m21:22:02.271280 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m21:22:02.271543 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: BEGIN
[0m21:22:02.271729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.279600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:02.279820 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m21:22:02.280023 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_undocumented_sources"


      
    ) dbt_internal_test
[0m21:22:02.282720 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m21:22:02.283575 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: ROLLBACK
[0m21:22:02.284276 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: Close
[0m21:22:02.284622 [warn ] [Thread-1  ]: 40 of 78 WARN 1 is_empty_fct_undocumented_sources_ ............................. [[33mWARN 1[0m in 0.03s]
[0m21:22:02.284973 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m21:22:02.285201 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_test_directories
[0m21:22:02.285522 [info ] [Thread-1  ]: 41 of 78 START sql view model public.fct_test_directories ...................... [RUN]
[0m21:22:02.285779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235, now model.dbt_project_evaluator.fct_test_directories)
[0m21:22:02.285978 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_test_directories
[0m21:22:02.288657 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.294085 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_test_directories
[0m21:22:02.298332 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.304007 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.304211 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: BEGIN
[0m21:22:02.304397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.315056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:22:02.315290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.315561 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */

  create view "dw"."public"."fct_test_directories__dbt_tmp"
    
    
  as (
    with

resources as (

    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded

),

relationships as (

    select * from "dw"."public"."int_direct_relationships"

),

models_per_test as (

    select
        resource_name as test_name,
        resource_id as test_id,
        direct_parent_id as parent_model_id
    from relationships
    where resource_type = 'test'
    and is_primary_test_relationship

),

model_file_paths as (

    select
        resources.resource_id as model_id,
        resources.resource_name as model_name,
        resources.directory_path as model_directory_path,
        models_per_test.test_id,
        models_per_test.parent_model_id
    from resources
    inner join models_per_test
    on models_per_test.parent_model_id = resources.resource_id
    where resource_type = 'model'

),

test_file_paths as (

    select
        resource_id as test_id,
        resource_name as test_name,
        file_name as test_yml_name,
        directory_path as test_yml_directory_path
    from resources
    where 
        resource_type = 'test'
        and is_generic_test

),

all_file_paths as (

    select
        test_file_paths.test_id,
        test_file_paths.test_name,
        test_file_paths.test_yml_directory_path,
        test_file_paths.test_yml_name,
        model_file_paths.model_id,
        model_file_paths.model_name,
        model_file_paths.model_directory_path
    from model_file_paths
    inner join test_file_paths
    on model_file_paths.test_id = test_file_paths.test_id

),

different_directories as (

    select
        test_name,
        model_name,
        test_yml_directory_path as current_test_directory,
        model_directory_path as change_test_directory_to
    from all_file_paths
    where model_directory_path != test_yml_directory_path

)

select * from different_directories



    

    
    

    

    


  );
[0m21:22:02.320332 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:22:02.322566 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.322780 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
alter table "dw"."public"."fct_test_directories__dbt_tmp" rename to "fct_test_directories"
[0m21:22:02.324106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.324925 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m21:22:02.325129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.325322 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m21:22:02.327072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:02.328797 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_test_directories__dbt_backup"
[0m21:22:02.329247 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m21:22:02.329454 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
drop view if exists "dw"."public"."fct_test_directories__dbt_backup" cascade
[0m21:22:02.330529 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:02.331262 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_directories: Close
[0m21:22:02.331640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098af4c0>]}
[0m21:22:02.332016 [info ] [Thread-1  ]: 41 of 78 OK created sql view model public.fct_test_directories ................. [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:02.332338 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_test_directories
[0m21:22:02.332559 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_all_dag_relationships
[0m21:22:02.332862 [info ] [Thread-1  ]: 42 of 78 START sql view model public.int_all_dag_relationships ................. [RUN]
[0m21:22:02.333170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_directories, now model.dbt_project_evaluator.int_all_dag_relationships)
[0m21:22:02.333366 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_all_dag_relationships
[0m21:22:02.342657 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.351133 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_all_dag_relationships
[0m21:22:02.355166 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.362769 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.362968 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: BEGIN
[0m21:22:02.363154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.373235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:02.373444 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.373761 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */

  create view "dw"."public"."int_all_dag_relationships__dbt_tmp"
    
    
  as (
    -- creates a cte called all_relationships that will either use "with recursive" or loops depending on the DW


with recursive direct_relationships as (
    select
        *
    from "dw"."public"."int_direct_relationships"
    where resource_type <> 'test'
),

-- should this be a fct_ model?

-- recursive CTE
-- one record for every resource and each of its downstream children (including itself)
all_relationships (
    parent_id,
    parent,
    parent_resource_type,
    parent_model_type,
    parent_materialized,
    parent_access,
    parent_is_public,
    parent_source_name,
    parent_file_path,
    parent_directory_path,
    parent_file_name,
    parent_is_excluded,
    child_id,
    child,
    child_resource_type,
    child_model_type,
    child_materialized,
    child_access,
    child_is_public,
    child_source_name,
    child_file_path,
    child_directory_path,
    child_file_name,
    child_is_excluded,
    distance,
    path,
    is_dependent_on_chain_of_views
) as (
    -- anchor
    select distinct
        resource_id as parent_id,
        resource_name as parent,
        resource_type as parent_resource_type,
        model_type as parent_model_type,
        materialized as parent_materialized,
        access as parent_access,
        is_public as parent_is_public,
        source_name as parent_source_name,
        file_path as parent_file_path,
        directory_path as parent_directory_path,
        file_name as parent_file_name,
        is_excluded as parent_is_excluded,
        resource_id as child_id,
        resource_name as child,
        resource_type as child_resource_type,
        model_type as child_model_type,
        materialized as child_materialized,
        access as child_access,
        is_public as child_is_public,
        source_name as child_source_name,
        file_path as child_file_path,
        directory_path as child_directory_path,
        file_name as child_file_name,
        is_excluded as child_is_excluded,
        0 as distance,
        
    array[ resource_name ]
     as path,
        cast(null as boolean) as is_dependent_on_chain_of_views

    from direct_relationships
    -- where direct_parent_id is null 

    union all

    -- recursive clause
    select
        all_relationships.parent_id as parent_id,
        all_relationships.parent as parent,
        all_relationships.parent_resource_type as parent_resource_type,
        all_relationships.parent_model_type as parent_model_type,
        all_relationships.parent_materialized as parent_materialized,
        all_relationships.parent_access as parent_access,
        all_relationships.parent_is_public as parent_is_public,
        all_relationships.parent_source_name as parent_source_name,
        all_relationships.parent_file_path as parent_file_path,
        all_relationships.parent_directory_path as parent_directory_path,
        all_relationships.parent_file_name as parent_file_name,
        all_relationships.parent_is_excluded as parent_is_excluded,
        direct_relationships.resource_id as child_id,
        direct_relationships.resource_name as child,
        direct_relationships.resource_type as child_resource_type,
        direct_relationships.model_type as child_model_type,
        direct_relationships.materialized as child_materialized,
        direct_relationships.access as child_access,
        direct_relationships.is_public as child_is_public,
        direct_relationships.source_name as child_source_name,
        direct_relationships.file_path as child_file_path,
        direct_relationships.directory_path as child_directory_path,
        direct_relationships.file_name as child_file_name,
        direct_relationships.is_excluded as child_is_excluded,
        all_relationships.distance+1 as distance,
        array_append(all_relationships.path, direct_relationships.resource_name) as path,
        case
            when
                all_relationships.child_materialized in ('view', 'ephemeral')
                and coalesce(all_relationships.is_dependent_on_chain_of_views, true)
                then true
            else false
        end as is_dependent_on_chain_of_views

    from direct_relationships
    inner join all_relationships
        on all_relationships.child_id = direct_relationships.direct_parent_id

    

)



select * from all_relationships
order by parent, distance
  );
[0m21:22:02.379321 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:22:02.381501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.381712 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
alter table "dw"."public"."int_all_dag_relationships__dbt_tmp" rename to "int_all_dag_relationships"
[0m21:22:02.382952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.383716 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m21:22:02.383913 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.384096 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m21:22:02.386057 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:02.387719 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_all_dag_relationships__dbt_backup"
[0m21:22:02.388152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m21:22:02.388346 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
drop view if exists "dw"."public"."int_all_dag_relationships__dbt_backup" cascade
[0m21:22:02.389485 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:02.390148 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_all_dag_relationships: Close
[0m21:22:02.390505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096dde20>]}
[0m21:22:02.390868 [info ] [Thread-1  ]: 42 of 78 OK created sql view model public.int_all_dag_relationships ............ [[32mCREATE VIEW[0m in 0.06s]
[0m21:22:02.391179 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_all_dag_relationships
[0m21:22:02.391393 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.int_model_test_summary
[0m21:22:02.391723 [info ] [Thread-1  ]: 43 of 78 START sql view model public.int_model_test_summary .................... [RUN]
[0m21:22:02.392143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_dag_relationships, now model.dbt_project_evaluator.int_model_test_summary)
[0m21:22:02.392357 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.int_model_test_summary
[0m21:22:02.397609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.405568 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.int_model_test_summary
[0m21:22:02.408790 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.418687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.418892 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: BEGIN
[0m21:22:02.419083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.431121 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m21:22:02.431330 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.431636 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */

  create view "dw"."public"."int_model_test_summary__dbt_tmp"
    
    
  as (
    with 

all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

relationships as (
    select * from "dw"."public"."int_direct_relationships"
),

count_column_tests as (
    
    select 
        relationships.direct_parent_id, 
        all_graph_resources.column_name,
        sum(case
                when all_graph_resources.is_test_unique
                then 1
                else 0
            end
         ) as test_unique_count,count(distinct case when 
                all_graph_resources.is_test_unique or  
                all_graph_resources.is_test_not_null
            then relationships.resource_id else null end
        ) as primary_key_method_1_count,count(distinct case when 
                all_graph_resources.is_test_unique_combination_of_columns
            then relationships.resource_id else null end
        ) as primary_key_method_2_count,
        count(distinct relationships.resource_id) as tests_count
    from all_graph_resources
    left join relationships
        on all_graph_resources.resource_id = relationships.resource_id
    where all_graph_resources.resource_type = 'test'
    and relationships.is_primary_test_relationship
    group by 1,2
),

count_column_constraints as (

    select
        node_unique_id as direct_parent_id,
        name as column_name,
        case
            when has_not_null_constraint
            then 1
            else 0
        end as constraint_not_null_count,
        constraints_count
    from "dw"."public"."base_node_columns"

),

combine_column_counts as (

    select
        count_column_tests.*,
        count_column_tests.test_unique_count + count_column_constraints.constraint_not_null_count as primary_key_mixed_method_count,
        count_column_constraints.constraints_count
    from count_column_tests
    left join count_column_constraints
        on count_column_tests.direct_parent_id = count_column_constraints.direct_parent_id
        and count_column_tests.column_name = count_column_constraints.column_name

),

agg_test_relationships as (

    select 
        direct_parent_id, 
        cast(sum(case 
                when (
                    primary_key_method_1_count >= 2
                        or
                    primary_key_method_2_count >= 1
                        or
                    primary_key_mixed_method_count >= 2
                ) then 1 
                else 0 
            end
        ) >= 1 as boolean) as is_primary_key_tested,
        cast(sum(tests_count) as integer) as number_of_tests_on_model,
        cast(sum(constraints_count) as integer) as number_of_constraints_on_model
    from combine_column_counts
    group by 1

),

final as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        cast(coalesce(agg_test_relationships.is_primary_key_tested, FALSE) as boolean) as is_primary_key_tested,
        cast(coalesce(agg_test_relationships.number_of_tests_on_model, 0) as integer) as number_of_tests_on_model,
        cast(coalesce(agg_test_relationships.number_of_constraints_on_model, 0) as integer) as number_of_constraints_on_model
    from all_graph_resources
    left join agg_test_relationships
        on all_graph_resources.resource_id = agg_test_relationships.direct_parent_id
    where
        all_graph_resources.resource_type in ('model', 'seed', 'source', 'snapshot')
)

select * from final
  );
[0m21:22:02.438789 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:22:02.442392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.442666 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
alter table "dw"."public"."int_model_test_summary__dbt_tmp" rename to "int_model_test_summary"
[0m21:22:02.444145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.445130 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m21:22:02.445339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.445533 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m21:22:02.447293 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:02.449092 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."int_model_test_summary__dbt_backup"
[0m21:22:02.449542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m21:22:02.449745 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
drop view if exists "dw"."public"."int_model_test_summary__dbt_backup" cascade
[0m21:22:02.450533 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:02.451271 [debug] [Thread-1  ]: On model.dbt_project_evaluator.int_model_test_summary: Close
[0m21:22:02.451701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109649370>]}
[0m21:22:02.452112 [info ] [Thread-1  ]: 43 of 78 OK created sql view model public.int_model_test_summary ............... [[32mCREATE VIEW[0m in 0.06s]
[0m21:22:02.452451 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.int_model_test_summary
[0m21:22:02.452686 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m21:22:02.453005 [info ] [Thread-1  ]: 44 of 78 START test is_empty_fct_test_directories_ ............................. [RUN]
[0m21:22:02.453446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_model_test_summary, now test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433)
[0m21:22:02.453695 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m21:22:02.456497 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m21:22:02.466422 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m21:22:02.468576 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m21:22:02.474746 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m21:22:02.474950 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: BEGIN
[0m21:22:02.475130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.485891 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m21:22:02.486134 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m21:22:02.486341 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_test_directories"


      
    ) dbt_internal_test
[0m21:22:02.493931 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.007 seconds
[0m21:22:02.494969 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: ROLLBACK
[0m21:22:02.495602 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: Close
[0m21:22:02.496009 [info ] [Thread-1  ]: 44 of 78 PASS is_empty_fct_test_directories_ ................................... [[32mPASS[0m in 0.04s]
[0m21:22:02.496347 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m21:22:02.496589 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m21:22:02.496977 [info ] [Thread-1  ]: 45 of 78 START sql view model public.fct_chained_views_dependencies ............ [RUN]
[0m21:22:02.497292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433, now model.dbt_project_evaluator.fct_chained_views_dependencies)
[0m21:22:02.497520 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m21:22:02.501014 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.510820 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m21:22:02.514354 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.522753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.522985 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: BEGIN
[0m21:22:02.523191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.532297 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.532611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.532838 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */

  create view "dw"."public"."fct_chained_views_dependencies__dbt_tmp"
    
    
  as (
    with all_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance <> 0
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent,
        child, -- the model with potentially long run time / compilation time, improve performance by breaking the upstream chain of views
        distance,
        path
    from all_relationships
    where is_dependent_on_chain_of_views
    and child_resource_type = 'model'
    and distance > 5
)

select * from final



    

    
    

    

    



order by distance desc
  );
[0m21:22:02.536342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:02.540110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.540330 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
alter table "dw"."public"."fct_chained_views_dependencies__dbt_tmp" rename to "fct_chained_views_dependencies"
[0m21:22:02.541299 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.542164 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m21:22:02.542380 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.542585 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m21:22:02.544387 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:02.546203 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_chained_views_dependencies__dbt_backup"
[0m21:22:02.546677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m21:22:02.546896 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
drop view if exists "dw"."public"."fct_chained_views_dependencies__dbt_backup" cascade
[0m21:22:02.547665 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:02.548450 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_chained_views_dependencies: Close
[0m21:22:02.548902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098df580>]}
[0m21:22:02.549340 [info ] [Thread-1  ]: 45 of 78 OK created sql view model public.fct_chained_views_dependencies ....... [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:02.549699 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m21:22:02.549951 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m21:22:02.550300 [info ] [Thread-1  ]: 46 of 78 START sql table model public.fct_direct_join_to_source ................ [RUN]
[0m21:22:02.550664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_chained_views_dependencies, now model.dbt_project_evaluator.fct_direct_join_to_source)
[0m21:22:02.550891 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_direct_join_to_source
[0m21:22:02.553778 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.563977 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_direct_join_to_source
[0m21:22:02.567757 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.576175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.576401 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: BEGIN
[0m21:22:02.576612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.586784 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:02.587138 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.587439 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */

  
    

  create  table "dw"."public"."fct_direct_join_to_source__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has a reference to both a model and a source

with direct_model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where child_resource_type = 'model'
    and distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),

model_and_source_joined as (
    select
        child,
        case 
            when (
                sum(case when parent_resource_type = 'model' then 1 else 0 end) > 0 
                and sum(case when parent_resource_type = 'source' then 1 else 0 end) > 0
            ) 
            then true
            else false 
        end as keep_row 
    from direct_model_relationships
    group by 1
),

final as (
    select 
        direct_model_relationships.parent,
        direct_model_relationships.parent_resource_type,
        direct_model_relationships.child,
        direct_model_relationships.child_resource_type,
        direct_model_relationships.distance
    from direct_model_relationships
    inner join model_and_source_joined
        on direct_model_relationships.child = model_and_source_joined.child
    where model_and_source_joined.keep_row
    order by direct_model_relationships.child
)

select * from final



    

    
    

    

    


  );
  
[0m21:22:02.596277 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m21:22:02.599537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.599780 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "dw"."public"."fct_direct_join_to_source" rename to "fct_direct_join_to_source__dbt_backup"
[0m21:22:02.600650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.603873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.604105 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "dw"."public"."fct_direct_join_to_source__dbt_tmp" rename to "fct_direct_join_to_source"
[0m21:22:02.604844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.605980 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m21:22:02.606212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.606424 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m21:22:02.607698 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.609626 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_direct_join_to_source__dbt_backup"
[0m21:22:02.610126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m21:22:02.610359 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
drop table if exists "dw"."public"."fct_direct_join_to_source__dbt_backup" cascade
[0m21:22:02.612180 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m21:22:02.613055 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_direct_join_to_source: Close
[0m21:22:02.613535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098df580>]}
[0m21:22:02.613983 [info ] [Thread-1  ]: 46 of 78 OK created sql table model public.fct_direct_join_to_source ........... [[32mSELECT 0[0m in 0.06s]
[0m21:22:02.614344 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m21:22:02.614594 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m21:22:02.615010 [info ] [Thread-1  ]: 47 of 78 START sql view model public.fct_exposure_parents_materializations ..... [RUN]
[0m21:22:02.615393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_direct_join_to_source, now model.dbt_project_evaluator.fct_exposure_parents_materializations)
[0m21:22:02.615644 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m21:22:02.618487 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.626164 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m21:22:02.629855 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.636911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.637134 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: BEGIN
[0m21:22:02.637336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.645705 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:02.646014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.646263 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */

  create view "dw"."public"."fct_exposure_parents_materializations__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "dw"."public"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and ((
                parent_resource_type = 'model'
                and parent_materialized in ('view', 'ephemeral')
            )
            or (
                parent_resource_type = 'source'
            )
        )
        -- no test on child_is_excluded because exposures are never excluded
        and not parent_is_excluded
),

final as (

    select 
        parent_resource_type,
        parent as parent_resource_name,
        child as exposure_name,
        parent_materialized as parent_model_materialization

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m21:22:02.649604 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:02.652262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.652495 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
alter table "dw"."public"."fct_exposure_parents_materializations__dbt_tmp" rename to "fct_exposure_parents_materializations"
[0m21:22:02.653448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.654359 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m21:22:02.654584 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.654787 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m21:22:02.656306 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.658180 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_exposure_parents_materializations__dbt_backup"
[0m21:22:02.658655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m21:22:02.658872 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
drop view if exists "dw"."public"."fct_exposure_parents_materializations__dbt_backup" cascade
[0m21:22:02.659725 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:02.660590 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: Close
[0m21:22:02.661041 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d2ee0>]}
[0m21:22:02.661494 [info ] [Thread-1  ]: 47 of 78 OK created sql view model public.fct_exposure_parents_materializations  [[32mCREATE VIEW[0m in 0.05s]
[0m21:22:02.661860 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m21:22:02.662100 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m21:22:02.662462 [info ] [Thread-1  ]: 48 of 78 START sql view model public.fct_exposures_dependent_on_private_models . [RUN]
[0m21:22:02.662863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposure_parents_materializations, now model.dbt_project_evaluator.fct_exposures_dependent_on_private_models)
[0m21:22:02.663120 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m21:22:02.667350 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.680954 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m21:22:02.684696 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.689911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.690194 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: BEGIN
[0m21:22:02.690386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.703721 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m21:22:02.704274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.704509 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */

  create view "dw"."public"."fct_exposures_dependent_on_private_models__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "dw"."public"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and not (
                parent_resource_type = 'model'
                and parent_is_public
            )
        and not parent_is_excluded
),

final as (

    select 
        child as exposure_name,
        parent as parent_resource_name,
        parent_access,
        parent_resource_type

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m21:22:02.708174 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:02.710983 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.711231 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
alter table "dw"."public"."fct_exposures_dependent_on_private_models__dbt_tmp" rename to "fct_exposures_dependent_on_private_models"
[0m21:22:02.712669 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.713678 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m21:22:02.713899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.714090 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m21:22:02.715823 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m21:22:02.717954 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_exposures_dependent_on_private_models__dbt_backup"
[0m21:22:02.718451 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m21:22:02.718660 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
drop view if exists "dw"."public"."fct_exposures_dependent_on_private_models__dbt_backup" cascade
[0m21:22:02.719862 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:02.720771 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: Close
[0m21:22:02.721224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6e820>]}
[0m21:22:02.721644 [info ] [Thread-1  ]: 48 of 78 OK created sql view model public.fct_exposures_dependent_on_private_models  [[32mCREATE VIEW[0m in 0.06s]
[0m21:22:02.721957 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m21:22:02.722174 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m21:22:02.722494 [info ] [Thread-1  ]: 49 of 78 START sql table model public.fct_marts_or_intermediate_dependent_on_source  [RUN]
[0m21:22:02.722945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposures_dependent_on_private_models, now model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source)
[0m21:22:02.723167 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m21:22:02.725843 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.730427 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m21:22:02.735040 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.738609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.738838 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: BEGIN
[0m21:22:02.739017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.748134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.748443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.748651 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */

  
    

  create  table "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp"
  
  
    as
  
  (
    -- cases where a marts/intermediate model directly references a raw source
with direct_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_resource_type,
        child,
        child_model_type
    from direct_relationships
    where parent_resource_type = 'source'
    and child_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m21:22:02.753660 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m21:22:02.756197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.756405 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "dw"."public"."fct_marts_or_intermediate_dependent_on_source" rename to "fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m21:22:02.757167 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.758987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.759171 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp" rename to "fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.759833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.760733 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m21:22:02.760920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.761081 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m21:22:02.762052 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.763650 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m21:22:02.764024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m21:22:02.764195 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
drop table if exists "dw"."public"."fct_marts_or_intermediate_dependent_on_source__dbt_backup" cascade
[0m21:22:02.765497 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:02.766307 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: Close
[0m21:22:02.766687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096dec10>]}
[0m21:22:02.767057 [info ] [Thread-1  ]: 49 of 78 OK created sql table model public.fct_marts_or_intermediate_dependent_on_source  [[32mSELECT 0[0m in 0.04s]
[0m21:22:02.767363 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m21:22:02.767570 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_model_directories
[0m21:22:02.767907 [info ] [Thread-1  ]: 50 of 78 START sql view model public.fct_model_directories ..................... [RUN]
[0m21:22:02.768164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source, now model.dbt_project_evaluator.fct_model_directories)
[0m21:22:02.768348 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_model_directories
[0m21:22:02.771539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.774895 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_model_directories
[0m21:22:02.778510 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.781816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.782030 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: BEGIN
[0m21:22:02.782183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.790061 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:02.790297 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.790554 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */

  create view "dw"."public"."fct_model_directories__dbt_tmp"
    
    
  as (
    -- This model finds all cases where a model is NOT in the appropriate subdirectory:
    -- For staging models: The files should be in nested in the staging folder in a subfolder that matches their source parent's name.
    -- For non-staging models: The files should be nested closest to their appropriate folder.  

 
with all_graph_resources as (
    select * from "dw"."public"."int_all_graph_resources"
    where not is_excluded
),

folders as (
    select * from "dw"."public"."stg_naming_convention_folders"
), 

all_dag_relationships as (
    select * from "dw"."public"."int_all_dag_relationships"
    where not child_is_excluded
),

staging_models as (
    select  
        child,
        child_resource_type,
        child_model_type,
        child_file_path,
        child_directory_path,
        child_file_name,
        parent_source_name
    from all_dag_relationships
    where parent_resource_type = 'source'
    and child_resource_type = 'model'
    and child_model_type = 'staging'
),

-- find all staging models that are NOT in their source parent's subdirectory
inappropriate_subdirectories_staging as (
    select distinct -- must do distinct to avoid duplicates when staging model has multiple paths to a given source
        child as resource_name,
        child_resource_type as resource_type,
        child_model_type as model_type,
        child_file_path as current_file_path,
        'models/' || 'staging' || '/' || parent_source_name || '/' || child_file_name as change_file_path_to
    from staging_models
    where child_directory_path not like '%' || parent_source_name || '%'
),

-- find all non-staging models that are NOT nested closest to their appropriate folder
innappropriate_subdirectories_non_staging_models as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        all_graph_resources.file_path as current_file_path,
        'models' || '/.../' || folders.folder_name_value || '/.../' || all_graph_resources.file_name as change_file_path_to
    from all_graph_resources
    left join folders 
        on folders.model_type = all_graph_resources.model_type 
    -- either appropriate folder_name is not in the current_directory_path or a inappropriate folder name is closer to the file_name
    where all_graph_resources.model_type <> all_graph_resources.model_type_folder 
),

unioned as (
    select * from inappropriate_subdirectories_staging
    union all
    select * from innappropriate_subdirectories_non_staging_models
)

select * from unioned



    

    
    

    

    


  );
[0m21:22:02.793693 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:22:02.795764 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.795953 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
alter table "dw"."public"."fct_model_directories__dbt_tmp" rename to "fct_model_directories"
[0m21:22:02.796802 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.797513 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m21:22:02.797704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.797869 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m21:22:02.799319 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.800828 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_model_directories__dbt_backup"
[0m21:22:02.801209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m21:22:02.801387 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
drop view if exists "dw"."public"."fct_model_directories__dbt_backup" cascade
[0m21:22:02.801892 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:22:02.802505 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_directories: Close
[0m21:22:02.802861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a59d60>]}
[0m21:22:02.803203 [info ] [Thread-1  ]: 50 of 78 OK created sql view model public.fct_model_directories ................ [[32mCREATE VIEW[0m in 0.03s]
[0m21:22:02.803487 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_model_directories
[0m21:22:02.803688 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_model_fanout
[0m21:22:02.803998 [info ] [Thread-1  ]: 51 of 78 START sql table model public.fct_model_fanout ......................... [RUN]
[0m21:22:02.804333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_directories, now model.dbt_project_evaluator.fct_model_fanout)
[0m21:22:02.804531 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_model_fanout
[0m21:22:02.807494 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.810741 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_model_fanout
[0m21:22:02.813797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.816921 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.817104 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: BEGIN
[0m21:22:02.817271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.826728 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:02.826974 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.827191 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */

  
    

  create  table "dw"."public"."fct_model_fanout__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where not parent_is_excluded
    and not child_is_excluded
),

-- find all models without children
models_without_children as (
    select
        parent
    from all_dag_relationships
    where parent_resource_type = 'model'
    group by 1
    having max(distance) = 0
),

-- all parents with more direct children than the threshold for fanout (determined by variable models_fanout_threshold, default 3)
    -- Note: only counts "leaf children" - direct chilren that are models AND are child-less (are at the right-most-point in the DAG)
model_fanout as (
    select 
        all_dag_relationships.parent,
        all_dag_relationships.parent_model_type,
        all_dag_relationships.child
    from all_dag_relationships
    inner join models_without_children
        on all_dag_relationships.child = models_without_children.parent
    where all_dag_relationships.distance = 1 and all_dag_relationships.child_resource_type = 'model'
    group by 1, 2, 3
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2, 3
),

model_fanout_agg as (
    select
        parent,
        parent_model_type,
        
    string_agg(
        child,
        ', '
        
        ) as leaf_children
    from model_fanout
    group by 1, 2
    having count(*) >= 3
)

select * from model_fanout_agg



    

    
    

    

    


  );
  
[0m21:22:02.834607 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m21:22:02.836978 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.837170 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "dw"."public"."fct_model_fanout" rename to "fct_model_fanout__dbt_backup"
[0m21:22:02.837878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.840411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.840592 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "dw"."public"."fct_model_fanout__dbt_tmp" rename to "fct_model_fanout"
[0m21:22:02.841203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.842067 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m21:22:02.842244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.842408 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m21:22:02.843580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.845059 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_model_fanout__dbt_backup"
[0m21:22:02.845476 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m21:22:02.845655 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
drop table if exists "dw"."public"."fct_model_fanout__dbt_backup" cascade
[0m21:22:02.846912 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:02.847521 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_model_fanout: Close
[0m21:22:02.847860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a59d60>]}
[0m21:22:02.848196 [info ] [Thread-1  ]: 51 of 78 OK created sql table model public.fct_model_fanout .................... [[32mSELECT 0[0m in 0.04s]
[0m21:22:02.848483 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_model_fanout
[0m21:22:02.848684 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m21:22:02.848957 [info ] [Thread-1  ]: 52 of 78 START sql table model public.fct_multiple_sources_joined .............. [RUN]
[0m21:22:02.849273 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_fanout, now model.dbt_project_evaluator.fct_multiple_sources_joined)
[0m21:22:02.849467 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m21:22:02.852293 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.855326 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m21:22:02.858327 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.861154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.861453 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: BEGIN
[0m21:22:02.861640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.868473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:02.868715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.868916 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */

  
    

  create  table "dw"."public"."fct_multiple_sources_joined__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model references more than one source
with direct_source_relationships as (
    select distinct
        child,
        parent
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

multiple_sources_joined as (
    select
        child,
        
    string_agg(
        parent,
        ', '
        
        ) as source_parents
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from multiple_sources_joined



    

    
    

    

    


  );
  
[0m21:22:02.874404 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m21:22:02.876793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.876986 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "dw"."public"."fct_multiple_sources_joined" rename to "fct_multiple_sources_joined__dbt_backup"
[0m21:22:02.877596 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.880066 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.880264 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "dw"."public"."fct_multiple_sources_joined__dbt_tmp" rename to "fct_multiple_sources_joined"
[0m21:22:02.880818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.881753 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m21:22:02.881935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.882102 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m21:22:02.882886 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.884340 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_multiple_sources_joined__dbt_backup"
[0m21:22:02.884723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m21:22:02.884900 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
drop table if exists "dw"."public"."fct_multiple_sources_joined__dbt_backup" cascade
[0m21:22:02.885932 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:02.886531 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_multiple_sources_joined: Close
[0m21:22:02.886869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a59d60>]}
[0m21:22:02.887209 [info ] [Thread-1  ]: 52 of 78 OK created sql table model public.fct_multiple_sources_joined ......... [[32mSELECT 0[0m in 0.04s]
[0m21:22:02.887505 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m21:22:02.887707 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m21:22:02.887984 [info ] [Thread-1  ]: 53 of 78 START sql table model public.fct_rejoining_of_upstream_concepts ....... [RUN]
[0m21:22:02.888281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_multiple_sources_joined, now model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts)
[0m21:22:02.888481 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m21:22:02.890824 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.894041 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m21:22:02.897196 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.899702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.899900 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: BEGIN
[0m21:22:02.900066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.906672 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:02.906896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.907132 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */

  
    

  create  table "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_tmp"
  
  
    as
  
  (
    with all_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where parent_resource_type not in ('exposure', 'metric')
    and child_resource_type not in ('exposure', 'metric')
    and not parent_is_excluded
    and not child_is_excluded
),

-- all parent/child relationships where the parent is BOTH the direct parent of the child and the second level parent of the child 
rejoined as (
    select
        parent,
        child
    from all_relationships
    group by 1, 2
    having (sum(case when distance = 1 then 1 else 0 end) >= 1 
        and sum(case when distance = 2 then 1 else 0 end) >= 1)
),

-- resources with only one direct child
single_use_resources as (
    select
        parent
    from all_relationships
    where distance = 1
    group by 1
    having count(*) = 1
),

-- all cases where one of the parent's direct children (child) is ALSO the direct child of ANOTHER one of the parent's direct childen (parent_and_child)
triad_relationships as (
    select 
        rejoined.parent,
        rejoined.child,
        direct_child.parent as parent_and_child
    from rejoined
    left join all_relationships as direct_child
        on rejoined.child = direct_child.child
        and direct_child.distance = 1
    left join all_relationships as direct_parent
        on rejoined.parent = direct_parent.parent
        and direct_parent.distance = 1
    where direct_child.parent = direct_parent.child
),

-- additionally, only includes cases where the model "in between" the parent and parent_and_child has NO other downstream dependencies
-- Note: when the "in between" model DOES have downstream dependencies, it's possible this DAG choice has been made to avoid duplicated code and as such is OKAY
final as (
    select
        triad_relationships.*,
        case 
            when single_use_resources.parent is not null then true 
            else false
        end as is_loop_independent
    from triad_relationships
    left join single_use_resources 
        on triad_relationships.parent_and_child = single_use_resources.parent
),

final_filtered as (
    select * from final
    where is_loop_independent
)

select * from final_filtered



    

    
    

    

    


  );
  
[0m21:22:02.913424 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m21:22:02.915643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.915832 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "dw"."public"."fct_rejoining_of_upstream_concepts" rename to "fct_rejoining_of_upstream_concepts__dbt_backup"
[0m21:22:02.916556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:02.918939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.919123 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_tmp" rename to "fct_rejoining_of_upstream_concepts"
[0m21:22:02.919697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.920555 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m21:22:02.920738 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.920907 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m21:22:02.922219 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:02.950174 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_backup"
[0m21:22:02.950621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m21:22:02.950797 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
drop table if exists "dw"."public"."fct_rejoining_of_upstream_concepts__dbt_backup" cascade
[0m21:22:02.952352 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:02.953042 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: Close
[0m21:22:02.953348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb6a0>]}
[0m21:22:02.953678 [info ] [Thread-1  ]: 53 of 78 OK created sql table model public.fct_rejoining_of_upstream_concepts .. [[32mSELECT 0[0m in 0.07s]
[0m21:22:02.953953 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m21:22:02.954138 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_root_models
[0m21:22:02.954399 [info ] [Thread-1  ]: 54 of 78 START sql table model public.fct_root_models .......................... [RUN]
[0m21:22:02.954713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts, now model.dbt_project_evaluator.fct_root_models)
[0m21:22:02.954916 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_root_models
[0m21:22:02.956942 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.960643 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_root_models
[0m21:22:02.963437 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.967395 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.967573 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: BEGIN
[0m21:22:02.967729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:02.977437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:02.977682 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.977862 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */

  
    

  create  table "dw"."public"."fct_root_models__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has 0 direct parents, likely due to a lack of source or ref function

with model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where child_resource_type = 'model'
    -- only filter out excluded children nodes
        -- filtering parents could result in incorrectly flagging nodes that depend on excluded nodes
    and not child_is_excluded
    -- exclude required time spine
    and child != 'metricflow_time_spine'
),

final as (
    select
        child
    from model_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m21:22:02.984735 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.007 seconds
[0m21:22:02.986887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.987065 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "dw"."public"."fct_root_models" rename to "fct_root_models__dbt_backup"
[0m21:22:02.987664 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.989280 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.989448 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "dw"."public"."fct_root_models__dbt_tmp" rename to "fct_root_models"
[0m21:22:02.990010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:02.990868 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m21:22:02.991035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.991190 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m21:22:02.991812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m21:22:02.993913 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_root_models__dbt_backup"
[0m21:22:02.994272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m21:22:02.994439 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
drop table if exists "dw"."public"."fct_root_models__dbt_backup" cascade
[0m21:22:02.995399 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:02.996027 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_root_models: Close
[0m21:22:02.996339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109520d90>]}
[0m21:22:02.996667 [info ] [Thread-1  ]: 54 of 78 OK created sql table model public.fct_root_models ..................... [[32mSELECT 1[0m in 0.04s]
[0m21:22:02.996955 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_root_models
[0m21:22:02.997146 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_source_fanout
[0m21:22:02.997470 [info ] [Thread-1  ]: 55 of 78 START sql table model public.fct_source_fanout ........................ [RUN]
[0m21:22:02.997766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_root_models, now model.dbt_project_evaluator.fct_source_fanout)
[0m21:22:02.997944 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_source_fanout
[0m21:22:03.000506 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.006063 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_source_fanout
[0m21:22:03.008775 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.013834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.014008 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: BEGIN
[0m21:22:03.014168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.023156 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:03.023346 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.023535 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */

  
    

  create  table "dw"."public"."fct_source_fanout__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source is used in multiple direct downstream models
with direct_source_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by child
),

source_fanout as (
    select
        parent,
        
    string_agg(
        child,
        ', '
        
        ) as model_children
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from source_fanout



    

    
    

    

    


  );
  
[0m21:22:03.031958 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m21:22:03.034154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.034339 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "dw"."public"."fct_source_fanout" rename to "fct_source_fanout__dbt_backup"
[0m21:22:03.034976 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.036674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.036855 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "dw"."public"."fct_source_fanout__dbt_tmp" rename to "fct_source_fanout"
[0m21:22:03.037471 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.038372 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m21:22:03.038554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.038720 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m21:22:03.039975 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.042178 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_source_fanout__dbt_backup"
[0m21:22:03.042547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m21:22:03.042719 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
drop table if exists "dw"."public"."fct_source_fanout__dbt_backup" cascade
[0m21:22:03.044247 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:03.044865 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_source_fanout: Close
[0m21:22:03.045181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109520d90>]}
[0m21:22:03.045515 [info ] [Thread-1  ]: 55 of 78 OK created sql table model public.fct_source_fanout ................... [[32mSELECT 0[0m in 0.05s]
[0m21:22:03.045803 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_source_fanout
[0m21:22:03.046007 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m21:22:03.046272 [info ] [Thread-1  ]: 56 of 78 START sql table model public.fct_staging_dependent_on_marts_or_intermediate  [RUN]
[0m21:22:03.046567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_fanout, now model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate)
[0m21:22:03.046783 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m21:22:03.048923 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.056773 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m21:22:03.059642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.064267 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.064470 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: BEGIN
[0m21:22:03.064635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.072337 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.072575 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.072782 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */

  
    

  create  table "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp"
  
  
    as
  
  (
    -- cases where a staging model depends on a marts/intermediate model
-- data should flow from raw -> staging -> intermediate -> marts
with direct_model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'model'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where child_model_type = 'staging'
    and parent_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m21:22:03.078745 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m21:22:03.081003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.081202 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "dw"."public"."fct_staging_dependent_on_marts_or_intermediate" rename to "fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m21:22:03.081777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.083515 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.083707 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp" rename to "fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.084503 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:03.085386 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m21:22:03.085567 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.085737 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m21:22:03.086515 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.087987 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m21:22:03.089067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m21:22:03.089252 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
drop table if exists "dw"."public"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup" cascade
[0m21:22:03.090708 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:03.091303 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: Close
[0m21:22:03.091618 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109520d90>]}
[0m21:22:03.091948 [info ] [Thread-1  ]: 56 of 78 OK created sql table model public.fct_staging_dependent_on_marts_or_intermediate  [[32mSELECT 0[0m in 0.05s]
[0m21:22:03.092232 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m21:22:03.092428 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m21:22:03.092657 [info ] [Thread-1  ]: 57 of 78 START sql table model public.fct_staging_dependent_on_staging ......... [RUN]
[0m21:22:03.093002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate, now model.dbt_project_evaluator.fct_staging_dependent_on_staging)
[0m21:22:03.093216 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m21:22:03.095408 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.101967 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m21:22:03.104878 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.109471 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.109653 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: BEGIN
[0m21:22:03.109827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.117706 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.117917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.118125 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */

  
    

  create  table "dw"."public"."fct_staging_dependent_on_staging__dbt_tmp"
  
  
    as
  
  (
    -- check for cases where models in the staging layer are dependent on each other
with direct_model_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where parent_resource_type in ('model', 'snapshot')
    and child_resource_type in ('model', 'snapshot')
    and not parent_is_excluded
    and not child_is_excluded
    and distance = 1
),

bending_connections as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where parent_model_type = 'staging'
    and child_model_type = 'staging'
)

select * from bending_connections



    

    
    

    

    


  );
  
[0m21:22:03.125268 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m21:22:03.127583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.127784 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "dw"."public"."fct_staging_dependent_on_staging" rename to "fct_staging_dependent_on_staging__dbt_backup"
[0m21:22:03.128401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.130273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.130467 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "dw"."public"."fct_staging_dependent_on_staging__dbt_tmp" rename to "fct_staging_dependent_on_staging"
[0m21:22:03.131030 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.131978 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m21:22:03.132168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.132347 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m21:22:03.133165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.134711 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_staging_dependent_on_staging__dbt_backup"
[0m21:22:03.135113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m21:22:03.135300 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
drop table if exists "dw"."public"."fct_staging_dependent_on_staging__dbt_backup" cascade
[0m21:22:03.136314 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:03.136940 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: Close
[0m21:22:03.137273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b0cd0>]}
[0m21:22:03.137614 [info ] [Thread-1  ]: 57 of 78 OK created sql table model public.fct_staging_dependent_on_staging .... [[32mSELECT 0[0m in 0.04s]
[0m21:22:03.137912 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m21:22:03.138113 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_too_many_joins
[0m21:22:03.138453 [info ] [Thread-1  ]: 58 of 78 START sql table model public.fct_too_many_joins ....................... [RUN]
[0m21:22:03.138751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_staging, now model.dbt_project_evaluator.fct_too_many_joins)
[0m21:22:03.138940 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_too_many_joins
[0m21:22:03.142307 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.148553 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_too_many_joins
[0m21:22:03.151523 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.156745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.156940 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: BEGIN
[0m21:22:03.157111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.165295 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.165531 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.165731 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */

  
    

  create  table "dw"."public"."fct_too_many_joins__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select
        *
    from "dw"."public"."int_all_dag_relationships"
    where not child_is_excluded
    and child_resource_type = 'model'
),

final as (
    select
        child as resource_name,
        child_file_path as file_path,
        cast(count(distinct parent) as integer) as join_count
    from all_dag_relationships
    where distance = 1
    group by 1, 2
    having count(distinct parent) >= 7
)

select * from final



    

    
    

    

    


  );
  
[0m21:22:03.172509 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m21:22:03.174917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.175118 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "dw"."public"."fct_too_many_joins" rename to "fct_too_many_joins__dbt_backup"
[0m21:22:03.175818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.177697 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.177893 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "dw"."public"."fct_too_many_joins__dbt_tmp" rename to "fct_too_many_joins"
[0m21:22:03.178477 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.179393 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m21:22:03.179580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.179757 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m21:22:03.180900 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.182432 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_too_many_joins__dbt_backup"
[0m21:22:03.182826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m21:22:03.183011 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
drop table if exists "dw"."public"."fct_too_many_joins__dbt_backup" cascade
[0m21:22:03.184216 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:03.184859 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_too_many_joins: Close
[0m21:22:03.185203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109520d90>]}
[0m21:22:03.185555 [info ] [Thread-1  ]: 58 of 78 OK created sql table model public.fct_too_many_joins .................. [[32mSELECT 0[0m in 0.05s]
[0m21:22:03.185866 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_too_many_joins
[0m21:22:03.186100 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_unused_sources
[0m21:22:03.186455 [info ] [Thread-1  ]: 59 of 78 START sql table model public.fct_unused_sources ....................... [RUN]
[0m21:22:03.186716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_too_many_joins, now model.dbt_project_evaluator.fct_unused_sources)
[0m21:22:03.186913 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_unused_sources
[0m21:22:03.189929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.195646 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_unused_sources
[0m21:22:03.198661 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.206417 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.206626 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: BEGIN
[0m21:22:03.206829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.215128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.215358 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.215566 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */

  
    

  create  table "dw"."public"."fct_unused_sources__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source has no children

with source_relationships as (
    select  
        *
    from "dw"."public"."int_all_dag_relationships"
    where parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent
    from source_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m21:22:03.220780 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m21:22:03.223218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.223419 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "dw"."public"."fct_unused_sources" rename to "fct_unused_sources__dbt_backup"
[0m21:22:03.224038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.225885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.226080 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "dw"."public"."fct_unused_sources__dbt_tmp" rename to "fct_unused_sources"
[0m21:22:03.226640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:22:03.227631 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m21:22:03.227833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.228014 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m21:22:03.228709 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.230371 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_unused_sources__dbt_backup"
[0m21:22:03.230793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m21:22:03.230996 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
drop table if exists "dw"."public"."fct_unused_sources__dbt_backup" cascade
[0m21:22:03.232384 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m21:22:03.233087 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_unused_sources: Close
[0m21:22:03.233446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109809e20>]}
[0m21:22:03.233818 [info ] [Thread-1  ]: 59 of 78 OK created sql table model public.fct_unused_sources .................. [[32mSELECT 0[0m in 0.05s]
[0m21:22:03.234122 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_unused_sources
[0m21:22:03.234339 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m21:22:03.234684 [info ] [Thread-1  ]: 60 of 78 START sql view model public.fct_missing_primary_key_tests ............. [RUN]
[0m21:22:03.235057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_unused_sources, now model.dbt_project_evaluator.fct_missing_primary_key_tests)
[0m21:22:03.235286 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m21:22:03.238345 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.242598 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m21:22:03.247252 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.250121 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.250350 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: BEGIN
[0m21:22:03.250522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.258218 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.258497 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.258699 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */

  create view "dw"."public"."fct_missing_primary_key_tests__dbt_tmp"
    
    
  as (
    with

tests as (
    select * from "dw"."public"."int_model_test_summary"
    where resource_type in
    (
        'model'
        
    )
),

final as (

    select
        resource_name,
        resource_type,
        model_type,
        is_primary_key_tested,
        number_of_tests_on_model,
        number_of_constraints_on_model
    from tests
    where not(is_primary_key_tested)

)

select * from final



    

    
    

    

    


  );
[0m21:22:03.260308 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:22:03.262362 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.262587 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
alter table "dw"."public"."fct_missing_primary_key_tests__dbt_tmp" rename to "fct_missing_primary_key_tests"
[0m21:22:03.263544 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:03.264367 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m21:22:03.264560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.264742 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m21:22:03.265906 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.267557 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_missing_primary_key_tests__dbt_backup"
[0m21:22:03.267955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m21:22:03.268121 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
drop view if exists "dw"."public"."fct_missing_primary_key_tests__dbt_backup" cascade
[0m21:22:03.268817 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:03.269412 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: Close
[0m21:22:03.269718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c2e20>]}
[0m21:22:03.270035 [info ] [Thread-1  ]: 60 of 78 OK created sql view model public.fct_missing_primary_key_tests ........ [[32mCREATE VIEW[0m in 0.03s]
[0m21:22:03.270314 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m21:22:03.270505 [debug] [Thread-1  ]: Began running node model.dbt_project_evaluator.fct_test_coverage
[0m21:22:03.270766 [info ] [Thread-1  ]: 61 of 78 START sql view model public.fct_test_coverage ......................... [RUN]
[0m21:22:03.271049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_missing_primary_key_tests, now model.dbt_project_evaluator.fct_test_coverage)
[0m21:22:03.271239 [debug] [Thread-1  ]: Began compiling node model.dbt_project_evaluator.fct_test_coverage
[0m21:22:03.275795 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.278332 [debug] [Thread-1  ]: Began executing node model.dbt_project_evaluator.fct_test_coverage
[0m21:22:03.281037 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.283204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.283394 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: BEGIN
[0m21:22:03.283547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.292676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:03.292928 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.293171 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */

  create view "dw"."public"."fct_test_coverage__dbt_tmp"
    
    
  as (
    with

test_counts as (
    select * from "dw"."public"."int_model_test_summary"
    where resource_type = 'model'
),

conversion as (
    select
        resource_name,
        cast(case when number_of_tests_on_model > 0 then 1 else 0 end as boolean) as is_tested_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when number_of_tests_on_model > 0 and model_type = 'base' then 1.0 else 0 end as is_tested_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when number_of_tests_on_model > 0 and model_type = 'staging' then 1.0 else 0 end as is_tested_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when number_of_tests_on_model > 0 and model_type = 'intermediate' then 1.0 else 0 end as is_tested_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when number_of_tests_on_model > 0 and model_type = 'marts' then 1.0 else 0 end as is_tested_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when number_of_tests_on_model > 0 and model_type = 'other' then 1.0 else 0 end as is_tested_other_model
        

    from test_counts
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(number_of_tests_on_model) as integer) as total_tests,
        sum(cast(is_tested_model as integer)) as tested_models,
        round(sum(cast(is_tested_model as integer)) * 100.0 / count(*), 2) as test_coverage_pct,
        
            round(
                
    ( sum(is_tested_base_model) * 100.0 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_staging_model) * 100.0 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_intermediate_model) * 100.0 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_marts_model) * 100.0 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_other_model) * 100.0 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_test_coverage_pct,
        
        round(sum(number_of_tests_on_model) * 1.0000 / count(*), 4) as test_to_model_ratio

    from test_counts
    left join conversion
    on test_counts.resource_name = conversion.resource_name
)

select * from final
  );
[0m21:22:03.298125 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:22:03.300935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.301130 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
alter table "dw"."public"."fct_test_coverage__dbt_tmp" rename to "fct_test_coverage"
[0m21:22:03.302292 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:22:03.302968 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m21:22:03.303133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.303289 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m21:22:03.304680 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:22:03.306073 [debug] [Thread-1  ]: Applying DROP to: "dw"."public"."fct_test_coverage__dbt_backup"
[0m21:22:03.306421 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m21:22:03.306583 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
drop view if exists "dw"."public"."fct_test_coverage__dbt_backup" cascade
[0m21:22:03.307349 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:22:03.307906 [debug] [Thread-1  ]: On model.dbt_project_evaluator.fct_test_coverage: Close
[0m21:22:03.308193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73362d06-2ba4-4e65-ba52-012d12c56e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109809e20>]}
[0m21:22:03.308486 [info ] [Thread-1  ]: 61 of 78 OK created sql view model public.fct_test_coverage .................... [[32mCREATE VIEW[0m in 0.04s]
[0m21:22:03.308761 [debug] [Thread-1  ]: Finished running node model.dbt_project_evaluator.fct_test_coverage
[0m21:22:03.308950 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m21:22:03.309186 [info ] [Thread-1  ]: 62 of 78 START test is_empty_fct_chained_views_dependencies_ ................... [RUN]
[0m21:22:03.309491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_coverage, now test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33)
[0m21:22:03.309683 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m21:22:03.312134 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m21:22:03.314220 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m21:22:03.315627 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m21:22:03.317346 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m21:22:03.317548 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: BEGIN
[0m21:22:03.317722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.324791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:03.324960 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m21:22:03.325133 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_chained_views_dependencies"


      
    ) dbt_internal_test
[0m21:22:03.331396 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.006 seconds
[0m21:22:03.332128 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: ROLLBACK
[0m21:22:03.332726 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: Close
[0m21:22:03.333051 [info ] [Thread-1  ]: 62 of 78 PASS is_empty_fct_chained_views_dependencies_ ......................... [[32mPASS[0m in 0.02s]
[0m21:22:03.333338 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m21:22:03.333550 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m21:22:03.333776 [info ] [Thread-1  ]: 63 of 78 START test is_empty_fct_direct_join_to_source_ ........................ [RUN]
[0m21:22:03.334040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33, now test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028)
[0m21:22:03.334230 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m21:22:03.336531 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m21:22:03.339315 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m21:22:03.341889 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m21:22:03.344123 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m21:22:03.344309 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: BEGIN
[0m21:22:03.344473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.350894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:22:03.351134 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m21:22:03.351316 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_direct_join_to_source"


      
    ) dbt_internal_test
[0m21:22:03.352128 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.352932 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: ROLLBACK
[0m21:22:03.353412 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: Close
[0m21:22:03.353723 [info ] [Thread-1  ]: 63 of 78 PASS is_empty_fct_direct_join_to_source_ .............................. [[32mPASS[0m in 0.02s]
[0m21:22:03.354003 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m21:22:03.354203 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m21:22:03.354416 [info ] [Thread-1  ]: 64 of 78 START test is_empty_fct_exposure_parents_materializations_ ............ [RUN]
[0m21:22:03.354634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028, now test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422)
[0m21:22:03.354818 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m21:22:03.357113 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m21:22:03.359303 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m21:22:03.360956 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m21:22:03.362825 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m21:22:03.363022 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: BEGIN
[0m21:22:03.363189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.371059 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.371313 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m21:22:03.371505 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_exposure_parents_materializations"


      
    ) dbt_internal_test
[0m21:22:03.375722 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m21:22:03.376652 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: ROLLBACK
[0m21:22:03.377374 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: Close
[0m21:22:03.377749 [info ] [Thread-1  ]: 64 of 78 PASS is_empty_fct_exposure_parents_materializations_ .................. [[32mPASS[0m in 0.02s]
[0m21:22:03.378070 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m21:22:03.378269 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m21:22:03.378459 [info ] [Thread-1  ]: 65 of 78 START test is_empty_fct_exposures_dependent_on_private_models_ ........ [RUN]
[0m21:22:03.378825 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422, now test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e)
[0m21:22:03.379022 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m21:22:03.381650 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m21:22:03.383816 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m21:22:03.385457 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m21:22:03.387118 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m21:22:03.387297 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: BEGIN
[0m21:22:03.387459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.395109 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.395448 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m21:22:03.395665 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_exposures_dependent_on_private_models"


      
    ) dbt_internal_test
[0m21:22:03.401149 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m21:22:03.401942 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: ROLLBACK
[0m21:22:03.402530 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: Close
[0m21:22:03.402861 [info ] [Thread-1  ]: 65 of 78 PASS is_empty_fct_exposures_dependent_on_private_models_ .............. [[32mPASS[0m in 0.02s]
[0m21:22:03.403160 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m21:22:03.403355 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m21:22:03.403587 [info ] [Thread-1  ]: 66 of 78 START test is_empty_fct_marts_or_intermediate_dependent_on_source_ .... [RUN]
[0m21:22:03.403903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e, now test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f)
[0m21:22:03.404086 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m21:22:03.406578 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m21:22:03.408712 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m21:22:03.411219 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m21:22:03.413115 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m21:22:03.413301 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: BEGIN
[0m21:22:03.413468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.419844 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:22:03.420190 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m21:22:03.420387 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_marts_or_intermediate_dependent_on_source"


      
    ) dbt_internal_test
[0m21:22:03.421264 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.422037 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: ROLLBACK
[0m21:22:03.422564 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: Close
[0m21:22:03.422886 [info ] [Thread-1  ]: 66 of 78 PASS is_empty_fct_marts_or_intermediate_dependent_on_source_ .......... [[32mPASS[0m in 0.02s]
[0m21:22:03.423174 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m21:22:03.423370 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m21:22:03.423582 [info ] [Thread-1  ]: 67 of 78 START test is_empty_fct_model_directories_ ............................ [RUN]
[0m21:22:03.423803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f, now test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db)
[0m21:22:03.423982 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m21:22:03.426370 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m21:22:03.428367 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m21:22:03.429949 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m21:22:03.431548 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m21:22:03.431724 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: BEGIN
[0m21:22:03.431891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.438442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:03.438691 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m21:22:03.438867 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_model_directories"


      
    ) dbt_internal_test
[0m21:22:03.445039 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.006 seconds
[0m21:22:03.445975 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: ROLLBACK
[0m21:22:03.446541 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: Close
[0m21:22:03.446884 [info ] [Thread-1  ]: 67 of 78 PASS is_empty_fct_model_directories_ .................................. [[32mPASS[0m in 0.02s]
[0m21:22:03.447175 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m21:22:03.447370 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m21:22:03.447599 [info ] [Thread-1  ]: 68 of 78 START test is_empty_fct_model_fanout_ ................................. [RUN]
[0m21:22:03.447841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db, now test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95)
[0m21:22:03.448016 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m21:22:03.450336 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m21:22:03.452323 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m21:22:03.453904 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m21:22:03.455572 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m21:22:03.455747 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: BEGIN
[0m21:22:03.455907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.462070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:22:03.462330 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m21:22:03.462526 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_model_fanout"


      
    ) dbt_internal_test
[0m21:22:03.463320 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.464148 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: ROLLBACK
[0m21:22:03.464634 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: Close
[0m21:22:03.464970 [info ] [Thread-1  ]: 68 of 78 PASS is_empty_fct_model_fanout_ ....................................... [[32mPASS[0m in 0.02s]
[0m21:22:03.465267 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m21:22:03.465461 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m21:22:03.465703 [info ] [Thread-1  ]: 69 of 78 START test is_empty_fct_multiple_sources_joined_ ...................... [RUN]
[0m21:22:03.465983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95, now test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817)
[0m21:22:03.466172 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m21:22:03.469391 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m21:22:03.471911 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m21:22:03.473505 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m21:22:03.475162 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m21:22:03.475336 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: BEGIN
[0m21:22:03.475498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.481763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m21:22:03.481978 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m21:22:03.482158 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_multiple_sources_joined"


      
    ) dbt_internal_test
[0m21:22:03.482933 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.483682 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: ROLLBACK
[0m21:22:03.484876 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: Close
[0m21:22:03.485196 [info ] [Thread-1  ]: 69 of 78 PASS is_empty_fct_multiple_sources_joined_ ............................ [[32mPASS[0m in 0.02s]
[0m21:22:03.485562 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m21:22:03.485784 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m21:22:03.486038 [info ] [Thread-1  ]: 70 of 78 START test is_empty_fct_rejoining_of_upstream_concepts_ ............... [RUN]
[0m21:22:03.486302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817, now test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d)
[0m21:22:03.486495 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m21:22:03.489079 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m21:22:03.491837 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m21:22:03.493453 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m21:22:03.495479 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m21:22:03.495674 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: BEGIN
[0m21:22:03.495844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.502708 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:03.502957 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m21:22:03.503140 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_rejoining_of_upstream_concepts"


      
    ) dbt_internal_test
[0m21:22:03.503944 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.504715 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: ROLLBACK
[0m21:22:03.505212 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: Close
[0m21:22:03.505529 [info ] [Thread-1  ]: 70 of 78 PASS is_empty_fct_rejoining_of_upstream_concepts_ ..................... [[32mPASS[0m in 0.02s]
[0m21:22:03.505807 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m21:22:03.506001 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m21:22:03.506217 [info ] [Thread-1  ]: 71 of 78 START test is_empty_fct_root_models_ .................................. [RUN]
[0m21:22:03.506436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d, now test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1)
[0m21:22:03.506618 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m21:22:03.509004 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m21:22:03.511344 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m21:22:03.513068 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m21:22:03.516472 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m21:22:03.516655 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: BEGIN
[0m21:22:03.516816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.524686 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.524909 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m21:22:03.525089 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_root_models"


      
    ) dbt_internal_test
[0m21:22:03.526002 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.526768 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: ROLLBACK
[0m21:22:03.527347 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: Close
[0m21:22:03.527668 [warn ] [Thread-1  ]: 71 of 78 WARN 1 is_empty_fct_root_models_ ...................................... [[33mWARN 1[0m in 0.02s]
[0m21:22:03.527952 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m21:22:03.528148 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m21:22:03.528361 [info ] [Thread-1  ]: 72 of 78 START test is_empty_fct_source_fanout_ ................................ [RUN]
[0m21:22:03.528579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1, now test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722)
[0m21:22:03.528760 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m21:22:03.532033 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m21:22:03.537931 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m21:22:03.539417 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m21:22:03.542650 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m21:22:03.542834 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: BEGIN
[0m21:22:03.542998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.553173 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:03.553382 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m21:22:03.553567 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_source_fanout"


      
    ) dbt_internal_test
[0m21:22:03.554980 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.555740 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: ROLLBACK
[0m21:22:03.556422 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: Close
[0m21:22:03.556728 [info ] [Thread-1  ]: 72 of 78 PASS is_empty_fct_source_fanout_ ...................................... [[32mPASS[0m in 0.03s]
[0m21:22:03.557003 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m21:22:03.557196 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m21:22:03.557413 [info ] [Thread-1  ]: 73 of 78 START test is_empty_fct_staging_dependent_on_marts_or_intermediate_ ... [RUN]
[0m21:22:03.557632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f)
[0m21:22:03.557815 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m21:22:03.560209 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m21:22:03.564660 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m21:22:03.566197 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m21:22:03.569390 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m21:22:03.569585 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: BEGIN
[0m21:22:03.569752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.579923 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:03.580131 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m21:22:03.580320 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_staging_dependent_on_marts_or_intermediate"


      
    ) dbt_internal_test
[0m21:22:03.581816 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.582596 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: ROLLBACK
[0m21:22:03.583364 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: Close
[0m21:22:03.583684 [info ] [Thread-1  ]: 73 of 78 PASS is_empty_fct_staging_dependent_on_marts_or_intermediate_ ......... [[32mPASS[0m in 0.03s]
[0m21:22:03.583974 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m21:22:03.584176 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m21:22:03.584412 [info ] [Thread-1  ]: 74 of 78 START test is_empty_fct_staging_dependent_on_staging_ ................. [RUN]
[0m21:22:03.584685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca)
[0m21:22:03.584892 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m21:22:03.587480 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m21:22:03.594366 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m21:22:03.596109 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m21:22:03.600400 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m21:22:03.600584 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: BEGIN
[0m21:22:03.600751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.609123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.609329 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m21:22:03.609524 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_staging_dependent_on_staging"


      
    ) dbt_internal_test
[0m21:22:03.610809 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.612547 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: ROLLBACK
[0m21:22:03.613712 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: Close
[0m21:22:03.614038 [info ] [Thread-1  ]: 74 of 78 PASS is_empty_fct_staging_dependent_on_staging_ ....................... [[32mPASS[0m in 0.03s]
[0m21:22:03.614333 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m21:22:03.614535 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m21:22:03.614764 [info ] [Thread-1  ]: 75 of 78 START test is_empty_fct_too_many_joins_ ............................... [RUN]
[0m21:22:03.615012 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca, now test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535)
[0m21:22:03.615206 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m21:22:03.617662 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m21:22:03.621381 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m21:22:03.622996 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m21:22:03.626632 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m21:22:03.626820 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: BEGIN
[0m21:22:03.626994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.636741 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:03.636934 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m21:22:03.637128 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_too_many_joins"


      
    ) dbt_internal_test
[0m21:22:03.638277 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.639063 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: ROLLBACK
[0m21:22:03.639576 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: Close
[0m21:22:03.639910 [info ] [Thread-1  ]: 75 of 78 PASS is_empty_fct_too_many_joins_ ..................................... [[32mPASS[0m in 0.02s]
[0m21:22:03.640219 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m21:22:03.640427 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m21:22:03.640628 [info ] [Thread-1  ]: 76 of 78 START test is_empty_fct_unused_sources_ ............................... [RUN]
[0m21:22:03.640876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535, now test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8)
[0m21:22:03.641111 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m21:22:03.643576 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m21:22:03.647314 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m21:22:03.648962 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m21:22:03.652490 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m21:22:03.652688 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: BEGIN
[0m21:22:03.652863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.661442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m21:22:03.661668 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m21:22:03.661866 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_unused_sources"


      
    ) dbt_internal_test
[0m21:22:03.663025 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m21:22:03.663841 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: ROLLBACK
[0m21:22:03.664903 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: Close
[0m21:22:03.665232 [info ] [Thread-1  ]: 76 of 78 PASS is_empty_fct_unused_sources_ ..................................... [[32mPASS[0m in 0.02s]
[0m21:22:03.665522 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m21:22:03.665727 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m21:22:03.665957 [info ] [Thread-1  ]: 77 of 78 START test is_empty_fct_missing_primary_key_tests_ .................... [RUN]
[0m21:22:03.666191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8, now test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0)
[0m21:22:03.666381 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m21:22:03.668849 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m21:22:03.673484 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m21:22:03.676020 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m21:22:03.681609 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m21:22:03.681795 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: BEGIN
[0m21:22:03.681964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.692291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m21:22:03.692556 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m21:22:03.692758 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dw"."public"."fct_missing_primary_key_tests"


      
    ) dbt_internal_test
[0m21:22:03.697827 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m21:22:03.698743 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: ROLLBACK
[0m21:22:03.699399 [debug] [Thread-1  ]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: Close
[0m21:22:03.699756 [warn ] [Thread-1  ]: 77 of 78 WARN 8 is_empty_fct_missing_primary_key_tests_ ........................ [[33mWARN 8[0m in 0.03s]
[0m21:22:03.700068 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m21:22:03.700274 [debug] [Thread-1  ]: Began running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m21:22:03.700520 [info ] [Thread-1  ]: 78 of 78 START test valid_test_coverage ........................................ [RUN]
[0m21:22:03.700807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0, now test.dbt_project_evaluator.valid_test_coverage.df03f31e09)
[0m21:22:03.701009 [debug] [Thread-1  ]: Began compiling node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m21:22:03.704329 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m21:22:03.710334 [debug] [Thread-1  ]: Began executing node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m21:22:03.712119 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m21:22:03.715919 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m21:22:03.716168 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: BEGIN
[0m21:22:03.716353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:22:03.723240 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m21:22:03.723480 [debug] [Thread-1  ]: Using postgres connection "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m21:22:03.723680 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "dw"."public"."fct_test_coverage"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not test_coverage_pct >= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m21:22:03.729351 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m21:22:03.730282 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: ROLLBACK
[0m21:22:03.731330 [debug] [Thread-1  ]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: Close
[0m21:22:03.731764 [warn ] [Thread-1  ]: 78 of 78 WARN 1 valid_test_coverage ............................................ [[33mWARN 1[0m in 0.03s]
[0m21:22:03.732093 [debug] [Thread-1  ]: Finished running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m21:22:03.732823 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:03.733030 [debug] [MainThread]: On master: BEGIN
[0m21:22:03.733191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:03.741323 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m21:22:03.741558 [debug] [MainThread]: On master: COMMIT
[0m21:22:03.741727 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:03.741885 [debug] [MainThread]: On master: COMMIT
[0m21:22:03.742435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:22:03.742605 [debug] [MainThread]: On master: Close
[0m21:22:03.742843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:03.743007 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' was properly closed.
[0m21:22:03.743312 [info ] [MainThread]: 
[0m21:22:03.743506 [info ] [MainThread]: Finished running 1 seed, 24 table models, 29 data tests, 24 view models in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m21:22:03.748956 [debug] [MainThread]: Command end result
[0m21:22:03.777649 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m21:22:03.785304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m21:22:03.791601 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m21:22:03.791822 [info ] [MainThread]: 
[0m21:22:03.792030 [info ] [MainThread]: [33mCompleted with 10 warnings:[0m
[0m21:22:03.792193 [info ] [MainThread]: 
[0m21:22:03.792386 [warn ] [MainThread]: [33mWarning in test valid_documentation_coverage (models/marts/documentation/documentation.yml)[0m
[0m21:22:03.792566 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:22:03.792709 [info ] [MainThread]: 
[0m21:22:03.792883 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/valid_documentation_coverage.sql
[0m21:22:03.793033 [info ] [MainThread]: 
[0m21:22:03.793208 [warn ] [MainThread]: [33mWarning in test is_empty_fct_hard_coded_references_ (models/marts/dag/dag.yml)[0m
[0m21:22:03.793377 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:22:03.793516 [info ] [MainThread]: 
[0m21:22:03.793682 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/dag/dag.yml/is_empty_fct_hard_coded_references_.sql
[0m21:22:03.793827 [info ] [MainThread]: 
[0m21:22:03.793996 [warn ] [MainThread]: [33mWarning in test is_empty_fct_model_naming_conventions_ (models/marts/structure/structure.yml)[0m
[0m21:22:03.794164 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:22:03.794302 [info ] [MainThread]: 
[0m21:22:03.794467 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/structure/structure.yml/is_empty_fct_model_naming_conventions_.sql
[0m21:22:03.794610 [info ] [MainThread]: 
[0m21:22:03.794781 [warn ] [MainThread]: [33mWarning in test is_empty_fct_sources_without_freshness_ (models/marts/tests/testing.yml)[0m
[0m21:22:03.794951 [warn ] [MainThread]: Got 3 results, configured to warn if != 0
[0m21:22:03.795089 [info ] [MainThread]: 
[0m21:22:03.795255 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/is_empty_fct_sources_without_freshness_.sql
[0m21:22:03.795399 [info ] [MainThread]: 
[0m21:22:03.795569 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_models_ (models/marts/documentation/documentation.yml)[0m
[0m21:22:03.795738 [warn ] [MainThread]: Got 8 results, configured to warn if != 0
[0m21:22:03.795872 [info ] [MainThread]: 
[0m21:22:03.796038 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_models_.sql
[0m21:22:03.796182 [info ] [MainThread]: 
[0m21:22:03.796355 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_source_tables_ (models/marts/documentation/documentation.yml)[0m
[0m21:22:03.796522 [warn ] [MainThread]: Got 3 results, configured to warn if != 0
[0m21:22:03.796665 [info ] [MainThread]: 
[0m21:22:03.796977 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_source_tables_.sql
[0m21:22:03.797158 [info ] [MainThread]: 
[0m21:22:03.797391 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_sources_ (models/marts/documentation/documentation.yml)[0m
[0m21:22:03.797587 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:22:03.797735 [info ] [MainThread]: 
[0m21:22:03.797911 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_sources_.sql
[0m21:22:03.798065 [info ] [MainThread]: 
[0m21:22:03.798241 [warn ] [MainThread]: [33mWarning in test is_empty_fct_root_models_ (models/marts/dag/dag.yml)[0m
[0m21:22:03.798413 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:22:03.798558 [info ] [MainThread]: 
[0m21:22:03.798725 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/dag/dag.yml/is_empty_fct_root_models_.sql
[0m21:22:03.798873 [info ] [MainThread]: 
[0m21:22:03.799051 [warn ] [MainThread]: [33mWarning in test is_empty_fct_missing_primary_key_tests_ (models/marts/tests/testing.yml)[0m
[0m21:22:03.799224 [warn ] [MainThread]: Got 8 results, configured to warn if != 0
[0m21:22:03.799363 [info ] [MainThread]: 
[0m21:22:03.799532 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/is_empty_fct_missing_primary_key_tests_.sql
[0m21:22:03.799680 [info ] [MainThread]: 
[0m21:22:03.799851 [warn ] [MainThread]: [33mWarning in test valid_test_coverage (models/marts/tests/testing.yml)[0m
[0m21:22:03.800020 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:22:03.800160 [info ] [MainThread]: 
[0m21:22:03.800345 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/valid_test_coverage.sql
[0m21:22:03.800577 [info ] [MainThread]: 
[0m21:22:03.800776 [info ] [MainThread]: Done. PASS=68 WARN=10 ERROR=0 SKIP=0 TOTAL=78
[0m21:22:03.802854 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.521913, "process_in_blocks": "0", "process_kernel_time": 0.304754, "process_mem_max_rss": "133939200", "process_out_blocks": "0", "process_user_time": 3.198676}
[0m21:22:03.803074 [debug] [MainThread]: Command `dbt build` succeeded at 21:22:03.803033 after 5.52 seconds
[0m21:22:03.803259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107145250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d46400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884ea30>]}
[0m21:22:03.803445 [debug] [MainThread]: Flushing usage events
[0m21:22:04.429961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:41.789468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074df400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074df220>]}


============================== 14:11:41.792444 | 4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f ==============================
[0m14:11:41.792444 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:11:41.792788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:41.903814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e7070>]}
[0m14:11:41.930829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077289a0>]}
[0m14:11:41.931851 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:11:42.041914 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:11:42.114460 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:11:42.114736 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:11:42.114936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747f0d0>]}
[0m14:11:43.516518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183cae80>]}
[0m14:11:43.589479 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:11:43.603916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:11:43.663466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf1880>]}
[0m14:11:43.663796 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:11:43.665591 [info ] [MainThread]: 
[0m14:11:43.665818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:43.665969 [info ] [MainThread]: 
[0m14:11:43.666215 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:43.666653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m14:11:43.731890 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m14:11:43.732120 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:11:43.732259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:43.753011 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m14:11:43.753727 [debug] [ThreadPool]: On list_dw: Close
[0m14:11:43.758923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m14:11:43.762342 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:11:43.762524 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:11:43.762666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:43.771930 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:11:43.772071 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:11:43.772221 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:11:43.776998 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m14:11:43.777649 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:11:43.778411 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:11:43.778674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m14:11:43.780647 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:11:43.780798 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:11:43.780924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:43.788566 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:11:43.788762 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:11:43.788912 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:43.790718 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.002 seconds
[0m14:11:43.792326 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:11:43.792813 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:11:43.800697 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:43.800856 [debug] [MainThread]: On master: BEGIN
[0m14:11:43.800980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:43.807734 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:11:43.807899 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:43.808094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:43.830091 [debug] [MainThread]: SQL status: SELECT 37 in 0.022 seconds
[0m14:11:43.833988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc14c0>]}
[0m14:11:43.834305 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:43.835103 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:43.835305 [debug] [MainThread]: On master: BEGIN
[0m14:11:43.836300 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:11:43.836488 [debug] [MainThread]: On master: COMMIT
[0m14:11:43.836644 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:43.836788 [debug] [MainThread]: On master: COMMIT
[0m14:11:43.837374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:43.837536 [debug] [MainThread]: On master: Close
[0m14:11:43.844830 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:11:43.845174 [info ] [Thread-1  ]: 1 of 1 START sql view model public.jinja_testing ............................... [RUN]
[0m14:11:43.845448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.jinja_testing)
[0m14:11:43.845629 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:11:43.850494 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:11:43.851644 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:11:43.872015 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.jinja_testing"
[0m14:11:43.873046 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.jinja_testing"
[0m14:11:43.873251 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: BEGIN
[0m14:11:43.873420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:43.880340 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:11:43.880619 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.jinja_testing"
[0m14:11:43.880783 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.jinja_testing"} */

  create view "dw"."public"."jinja_testing__dbt_tmp"
    
    
  as (
    

fehmmi
  );
[0m14:11:43.881358 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "fehmmi"
LINE 9: fehmmi
        ^

[0m14:11:43.881593 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: ROLLBACK
[0m14:11:43.882128 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: Close
[0m14:11:43.902391 [debug] [Thread-1  ]: Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql
[0m14:11:43.904560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6184a2-f778-4c81-8f8c-5c5a4eb91a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11803b9a0>]}
[0m14:11:43.904925 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.jinja_testing ...................... [[31mERROR[0m in 0.06s]
[0m14:11:43.905216 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:11:43.905474 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.jinja_testing' to be skipped because of status 'error'.  Reason: Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql.
[0m14:11:43.906043 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:43.906208 [debug] [MainThread]: On master: BEGIN
[0m14:11:43.906343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:43.912474 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:11:43.912667 [debug] [MainThread]: On master: COMMIT
[0m14:11:43.912803 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:43.912929 [debug] [MainThread]: On master: COMMIT
[0m14:11:43.913505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:43.913648 [debug] [MainThread]: On master: Close
[0m14:11:43.913855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:43.914016 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:11:43.914164 [info ] [MainThread]: 
[0m14:11:43.914321 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:11:43.914811 [debug] [MainThread]: Command end result
[0m14:11:43.943030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:11:43.947346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:11:43.956677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:11:43.956941 [info ] [MainThread]: 
[0m14:11:43.957158 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:11:43.957328 [info ] [MainThread]: 
[0m14:11:43.957630 [error] [MainThread]:   Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql
[0m14:11:43.957837 [info ] [MainThread]: 
[0m14:11:43.958112 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:11:43.968034 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.3470392, "process_in_blocks": "0", "process_kernel_time": 0.207553, "process_mem_max_rss": "139837440", "process_out_blocks": "0", "process_user_time": 2.330239}
[0m14:11:43.968456 [debug] [MainThread]: Command `cli build` failed at 14:11:43.968401 after 2.35 seconds
[0m14:11:43.968669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107873430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118422040>]}
[0m14:11:43.968871 [debug] [MainThread]: Flushing usage events
[0m14:11:44.483717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:45.585013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185f220>]}


============================== 14:11:45.587205 | bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3 ==============================
[0m14:11:45.587205 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:11:45.587492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:45.693844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a99580>]}
[0m14:11:45.723964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111820940>]}
[0m14:11:45.724596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:11:45.796212 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:11:45.943190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:45.943432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:45.980343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123deeb0>]}
[0m14:11:46.075199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:11:46.078341 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:11:46.104809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11245cbb0>]}
[0m14:11:46.105147 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:11:46.106780 [info ] [MainThread]: 
[0m14:11:46.106952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:46.107091 [info ] [MainThread]: 
[0m14:11:46.107338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:46.107780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m14:11:46.175341 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m14:11:46.175610 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:11:46.175764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:46.196818 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m14:11:46.197553 [debug] [ThreadPool]: On list_dw: Close
[0m14:11:46.202384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public)
[0m14:11:46.205818 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:11:46.206007 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:11:46.206145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:46.216336 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:11:46.216988 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:11:46.217191 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:46.220695 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.003 seconds
[0m14:11:46.221870 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:11:46.222545 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:11:46.222812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:11:46.227217 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:11:46.227367 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:11:46.227494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:46.236982 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:11:46.237217 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:11:46.237376 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:11:46.240690 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:11:46.241399 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:11:46.242079 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:11:46.248050 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:46.248248 [debug] [MainThread]: On master: BEGIN
[0m14:11:46.248375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:46.257378 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:11:46.257649 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:46.257854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:46.272740 [debug] [MainThread]: SQL status: SELECT 37 in 0.015 seconds
[0m14:11:46.276387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d00c70>]}
[0m14:11:46.276699 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:46.277355 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:46.277491 [debug] [MainThread]: On master: BEGIN
[0m14:11:46.278295 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:11:46.278466 [debug] [MainThread]: On master: COMMIT
[0m14:11:46.278623 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:46.278768 [debug] [MainThread]: On master: COMMIT
[0m14:11:46.279289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:46.279468 [debug] [MainThread]: On master: Close
[0m14:11:46.281243 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:11:46.281522 [info ] [Thread-1  ]: 1 of 1 START sql view model public.jinja_testing ............................... [RUN]
[0m14:11:46.281762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.jinja_testing)
[0m14:11:46.281928 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:11:46.286449 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:11:46.287192 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:11:46.316474 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.jinja_testing"
[0m14:11:46.319089 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.jinja_testing"
[0m14:11:46.320995 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: BEGIN
[0m14:11:46.321855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:46.335846 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m14:11:46.339114 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.jinja_testing"
[0m14:11:46.339773 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.jinja_testing"} */

  create view "dw"."public"."jinja_testing__dbt_tmp"
    
    
  as (
    

fehmmi
  );
[0m14:11:46.341701 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "fehmmi"
LINE 9: fehmmi
        ^

[0m14:11:46.342593 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: ROLLBACK
[0m14:11:46.345106 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: Close
[0m14:11:46.351527 [debug] [Thread-1  ]: Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql
[0m14:11:46.355853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa36eb5-c000-4f28-bdc5-a30e9aa1e4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b05e50>]}
[0m14:11:46.356328 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.jinja_testing ...................... [[31mERROR[0m in 0.07s]
[0m14:11:46.356679 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:11:46.356953 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.jinja_testing' to be skipped because of status 'error'.  Reason: Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql.
[0m14:11:46.357552 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:46.357735 [debug] [MainThread]: On master: BEGIN
[0m14:11:46.357876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:46.371079 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:11:46.371336 [debug] [MainThread]: On master: COMMIT
[0m14:11:46.371500 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:46.371641 [debug] [MainThread]: On master: COMMIT
[0m14:11:46.372418 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:11:46.372552 [debug] [MainThread]: On master: Close
[0m14:11:46.372760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:46.372880 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:11:46.373016 [info ] [MainThread]: 
[0m14:11:46.373172 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:11:46.373550 [debug] [MainThread]: Command end result
[0m14:11:46.398778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:11:46.401547 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:11:46.405410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:11:46.405588 [info ] [MainThread]: 
[0m14:11:46.405791 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:11:46.406019 [info ] [MainThread]: 
[0m14:11:46.406291 [error] [MainThread]:   Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql
[0m14:11:46.406469 [info ] [MainThread]: 
[0m14:11:46.406651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:11:46.408040 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8594602, "process_in_blocks": "0", "process_kernel_time": 0.168465, "process_mem_max_rss": "130596864", "process_out_blocks": "0", "process_user_time": 1.150031}
[0m14:11:46.408228 [debug] [MainThread]: Command `cli build` failed at 14:11:46.408189 after 0.86 seconds
[0m14:11:46.408406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b466a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9cb80>]}
[0m14:11:46.408574 [debug] [MainThread]: Flushing usage events
[0m14:11:46.880052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:53.346919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c363d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac9e20>]}


============================== 14:11:53.350093 | f9029171-9ab3-4339-a136-5ca3ba44291c ==============================
[0m14:11:53.350093 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:11:53.350370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:53.458914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab0970>]}
[0m14:11:53.485107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9bdf0>]}
[0m14:11:53.485866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:11:53.550679 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:11:53.695117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:53.695357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:53.731196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107421fa0>]}
[0m14:11:53.822815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:11:53.826393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:11:53.850185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107405f10>]}
[0m14:11:53.850482 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:11:53.850662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741d7c0>]}
[0m14:11:53.851707 [info ] [MainThread]: 
[0m14:11:53.851881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:53.852093 [info ] [MainThread]: 
[0m14:11:53.852395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:53.852841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw'
[0m14:11:53.928973 [debug] [ThreadPool]: Using postgres connection "list_dw"
[0m14:11:53.929206 [debug] [ThreadPool]: On list_dw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:11:53.929344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:53.989870 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.060 seconds
[0m14:11:53.994364 [debug] [ThreadPool]: On list_dw: Close
[0m14:11:54.009718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw, now list_dw_public_jaffle_shop)
[0m14:11:54.014264 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:11:54.014556 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:11:54.014840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:54.024328 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:11:54.024579 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:11:54.024752 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:11:54.027176 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m14:11:54.028143 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:11:54.028853 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:11:54.029210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m14:11:54.030791 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:11:54.030999 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:11:54.031986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:54.039743 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:11:54.040033 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:11:54.040219 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:54.042301 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.002 seconds
[0m14:11:54.043645 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:11:54.044298 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:11:54.053720 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.053981 [debug] [MainThread]: On master: BEGIN
[0m14:11:54.054139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:54.062816 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:11:54.063048 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.063261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:54.077230 [debug] [MainThread]: SQL status: SELECT 37 in 0.014 seconds
[0m14:11:54.081337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b1cd0>]}
[0m14:11:54.081650 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:54.082372 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.082575 [debug] [MainThread]: On master: BEGIN
[0m14:11:54.083483 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:11:54.083657 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.083806 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.083949 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.084458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:54.084620 [debug] [MainThread]: On master: Close
[0m14:11:54.086692 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:11:54.087040 [info ] [Thread-1  ]: 1 of 1 START sql view model public.jinja_testing ............................... [RUN]
[0m14:11:54.087324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.jinja_testing)
[0m14:11:54.087571 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:11:54.093177 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:11:54.093932 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:11:54.111969 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.jinja_testing"
[0m14:11:54.112646 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.jinja_testing"
[0m14:11:54.112845 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: BEGIN
[0m14:11:54.112995 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:54.120450 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:11:54.120713 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.jinja_testing"
[0m14:11:54.120879 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.jinja_testing"} */

  create view "dw"."public"."jinja_testing__dbt_tmp"
    
    
  as (
    

fehmmi
  );
[0m14:11:54.121515 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "fehmmi"
LINE 9: fehmmi
        ^

[0m14:11:54.121702 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: ROLLBACK
[0m14:11:54.122263 [debug] [Thread-1  ]: On model.my_dbt_project.jinja_testing: Close
[0m14:11:54.124983 [debug] [Thread-1  ]: Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql
[0m14:11:54.126219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9029171-9ab3-4339-a136-5ca3ba44291c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659bc10>]}
[0m14:11:54.126651 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.jinja_testing ...................... [[31mERROR[0m in 0.04s]
[0m14:11:54.126979 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:11:54.127354 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.jinja_testing' to be skipped because of status 'error'.  Reason: Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql.
[0m14:11:54.127991 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.128136 [debug] [MainThread]: On master: BEGIN
[0m14:11:54.128269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:54.134837 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:11:54.135013 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.135190 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.135318 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.135815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:54.135951 [debug] [MainThread]: On master: Close
[0m14:11:54.136151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:54.136306 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:11:54.136459 [info ] [MainThread]: 
[0m14:11:54.136613 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:11:54.136999 [debug] [MainThread]: Command end result
[0m14:11:54.163427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:11:54.165472 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:11:54.169143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:11:54.169343 [info ] [MainThread]: 
[0m14:11:54.169543 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:11:54.169709 [info ] [MainThread]: 
[0m14:11:54.169917 [error] [MainThread]:   Database Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  syntax error at or near "fehmmi"
  LINE 9: fehmmi
          ^
  compiled code at target/run/my_dbt_project/models/staging/jaffle_shop/jinja_testing.sql
[0m14:11:54.170095 [info ] [MainThread]: 
[0m14:11:54.170274 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:11:54.171863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8610394, "process_in_blocks": "0", "process_kernel_time": 0.165311, "process_mem_max_rss": "128253952", "process_out_blocks": "0", "process_user_time": 1.113852}
[0m14:11:54.172059 [debug] [MainThread]: Command `cli run` failed at 14:11:54.172022 after 0.86 seconds
[0m14:11:54.172242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c363d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107405f10>]}
[0m14:11:54.172409 [debug] [MainThread]: Flushing usage events
[0m14:11:54.653552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:05.189767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b06370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ade430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ade250>]}


============================== 14:12:05.193859 | a17d09d0-932b-4700-b3c8-ac4e0ac89469 ==============================
[0m14:12:05.193859 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:05.194229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:05.304661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a17d09d0-932b-4700-b3c8-ac4e0ac89469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10311c610>]}
[0m14:12:05.330975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a17d09d0-932b-4700-b3c8-ac4e0ac89469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105741f70>]}
[0m14:12:05.332501 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:12:05.400389 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:12:05.590175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:05.590407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:05.625459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a17d09d0-932b-4700-b3c8-ac4e0ac89469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155ef40>]}
[0m14:12:05.714833 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:12:05.718091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:12:05.738266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a17d09d0-932b-4700-b3c8-ac4e0ac89469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115dba30>]}
[0m14:12:05.738532 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:12:05.738709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a17d09d0-932b-4700-b3c8-ac4e0ac89469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111178100>]}
[0m14:12:05.739773 [info ] [MainThread]: 
[0m14:12:05.739981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:05.740160 [info ] [MainThread]: 
[0m14:12:05.740474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:05.745022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m14:12:05.816202 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:12:05.816429 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:12:05.816564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:05.836619 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:12:05.836844 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:12:05.837021 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:12:05.841163 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:12:05.841856 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:12:05.842773 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:12:05.843061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m14:12:05.844992 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:12:05.845150 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:12:05.845279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:05.854252 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:12:05.854402 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:12:05.854548 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:12:05.858337 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m14:12:05.859502 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:12:05.860290 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:12:05.868576 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:05.868747 [debug] [MainThread]: On master: BEGIN
[0m14:12:05.868878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:05.877821 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:12:05.877974 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:05.878161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:05.894032 [debug] [MainThread]: SQL status: SELECT 37 in 0.016 seconds
[0m14:12:05.897703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a17d09d0-932b-4700-b3c8-ac4e0ac89469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b1940>]}
[0m14:12:05.897932 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:05.898754 [debug] [MainThread]: On master: Close
[0m14:12:05.900576 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:12:05.900788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.jinja_testing)
[0m14:12:05.900947 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:12:05.905619 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:12:05.906261 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:12:05.906616 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:12:05.907038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:05.907182 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:12:05.907481 [debug] [MainThread]: Command end result
[0m14:12:05.932932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:12:05.935240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:12:05.938761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:12:05.938927 [info ] [MainThread]: Compiled node 'jinja_testing' is:


fehmmi
[0m14:12:05.940759 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.8917549, "process_in_blocks": "0", "process_kernel_time": 0.196676, "process_mem_max_rss": "126353408", "process_out_blocks": "0", "process_user_time": 1.080105}
[0m14:12:05.940958 [debug] [MainThread]: Command `cli compile` succeeded at 14:12:05.940918 after 0.89 seconds
[0m14:12:05.941130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b06370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104086ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111152ee0>]}
[0m14:12:05.941303 [debug] [MainThread]: Flushing usage events
[0m14:12:06.421660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:35.036816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbdf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbdf250>]}


============================== 14:12:35.040355 | 8af734b6-289d-422a-aed0-51a2c378dea7 ==============================
[0m14:12:35.040355 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:35.040651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:35.153370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bba1190>]}
[0m14:12:35.180114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af9d520>]}
[0m14:12:35.181124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:12:35.250675 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:12:35.322234 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:12:35.322520 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:12:35.322723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b556550>]}
[0m14:12:36.696303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c9e3af0>]}
[0m14:12:36.765826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:12:36.768633 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:12:36.786238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c63ed90>]}
[0m14:12:36.786559 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:12:36.786740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c9c0550>]}
[0m14:12:36.787822 [info ] [MainThread]: 
[0m14:12:36.787993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:36.788183 [info ] [MainThread]: 
[0m14:12:36.788472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:36.792895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:12:36.857273 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:12:36.857494 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:12:36.857628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:36.876861 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:12:36.877069 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:12:36.877212 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:12:36.881943 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.005 seconds
[0m14:12:36.883111 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:12:36.884133 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:12:36.884410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:12:36.888989 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:12:36.889159 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:12:36.889289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:36.899216 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:12:36.899358 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:12:36.899503 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:12:36.902916 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:12:36.903534 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:12:36.904346 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:12:36.909632 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:36.909781 [debug] [MainThread]: On master: BEGIN
[0m14:12:36.909907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:36.917952 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:12:36.918168 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:36.918351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:36.938968 [debug] [MainThread]: SQL status: SELECT 37 in 0.020 seconds
[0m14:12:36.943061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8af734b6-289d-422a-aed0-51a2c378dea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2af2b0>]}
[0m14:12:36.943530 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:36.944409 [debug] [MainThread]: On master: Close
[0m14:12:36.946898 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:12:36.947185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.jinja_testing)
[0m14:12:36.947375 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:12:36.951873 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:12:36.953173 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:12:36.953502 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:12:36.953921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:36.954091 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:12:36.954396 [debug] [MainThread]: Command end result
[0m14:12:36.980752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:12:36.983357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:12:36.987059 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:12:36.987216 [info ] [MainThread]: Compiled node 'jinja_testing' is:


fehmmi
[0m14:12:36.989021 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9909105, "process_in_blocks": "0", "process_kernel_time": 0.184291, "process_mem_max_rss": "137396224", "process_out_blocks": "0", "process_user_time": 2.257006}
[0m14:12:36.989223 [debug] [MainThread]: Command `cli compile` succeeded at 14:12:36.989185 after 1.99 seconds
[0m14:12:36.989396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c63ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af36c10>]}
[0m14:12:36.989583 [debug] [MainThread]: Flushing usage events
[0m14:12:37.472229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:14.577449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c996370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5e250>]}


============================== 14:14:14.581469 | 4766fde6-f378-46d9-9a1a-eec675ed4303 ==============================
[0m14:14:14.581469 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:14:14.581766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:14.701766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4766fde6-f378-46d9-9a1a-eec675ed4303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59c610>]}
[0m14:14:14.728313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4766fde6-f378-46d9-9a1a-eec675ed4303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c1f70>]}
[0m14:14:14.729226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:14:14.798436 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:14:14.869863 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:14.870149 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:14:14.870338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4766fde6-f378-46d9-9a1a-eec675ed4303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3de310>]}
[0m14:14:15.557911 [error] [MainThread]: Encountered an error:
Compilation Error in model jinja_testing (models/staging/jaffle_shop/jinja_testing.sql)
  expected token 'end of statement block', got '%'
    line 10
      {% endfor%%}
[0m14:14:15.560906 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.0235027, "process_in_blocks": "0", "process_kernel_time": 0.159981, "process_mem_max_rss": "117604352", "process_out_blocks": "0", "process_user_time": 1.443699}
[0m14:14:15.561123 [debug] [MainThread]: Command `cli compile` failed at 14:14:15.561080 after 1.02 seconds
[0m14:14:15.561301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c996370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b47f0>]}
[0m14:14:15.561480 [debug] [MainThread]: Flushing usage events
[0m14:14:16.061469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:26.401992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ade2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106982430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106982250>]}


============================== 14:14:26.405847 | 42351889-ee1f-41ae-aa21-b5ea9470abe9 ==============================
[0m14:14:26.405847 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:14:26.406140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:26.517573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106946190>]}
[0m14:14:26.543978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4b520>]}
[0m14:14:26.545596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:14:26.614403 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:14:26.702073 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:26.702401 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:14:26.702749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fd550>]}
[0m14:14:28.015376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ca310>]}
[0m14:14:28.083397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:14:28.088656 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:14:28.106718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6040>]}
[0m14:14:28.107057 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:14:28.107244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072abaf0>]}
[0m14:14:28.108380 [info ] [MainThread]: 
[0m14:14:28.108558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:28.108749 [info ] [MainThread]: 
[0m14:14:28.109038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:28.113900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:14:28.174030 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:14:28.174278 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:14:28.174436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:28.193562 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:14:28.193829 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:14:28.194014 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:28.197383 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.003 seconds
[0m14:14:28.198754 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:14:28.199302 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:14:28.199664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:14:28.204551 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:14:28.204721 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:14:28.204859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:28.212710 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:14:28.212926 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:14:28.213078 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:14:28.215775 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:14:28.216455 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:14:28.217057 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:14:28.222552 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:28.222746 [debug] [MainThread]: On master: BEGIN
[0m14:14:28.222882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:28.230647 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:14:28.230918 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:28.231098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:28.245078 [debug] [MainThread]: SQL status: SELECT 37 in 0.014 seconds
[0m14:14:28.248517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42351889-ee1f-41ae-aa21-b5ea9470abe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107053fd0>]}
[0m14:14:28.248734 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:28.249294 [debug] [MainThread]: On master: Close
[0m14:14:28.251051 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:14:28.251373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.jinja_testing)
[0m14:14:28.251590 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:14:28.256617 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:14:28.258246 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:14:28.258623 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:14:28.259026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:28.259175 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:14:28.259473 [debug] [MainThread]: Command end result
[0m14:14:28.286500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:14:28.288450 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:14:28.292613 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:14:28.292812 [info ] [MainThread]: Compiled node 'jinja_testing' is:




    red

    blue

    orange

[0m14:14:28.294606 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9324465, "process_in_blocks": "0", "process_kernel_time": 0.180577, "process_mem_max_rss": "135806976", "process_out_blocks": "0", "process_user_time": 2.256158}
[0m14:14:28.294811 [debug] [MainThread]: Command `cli compile` succeeded at 14:14:28.294768 after 1.93 seconds
[0m14:14:28.294999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ade2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6040>]}
[0m14:14:28.295187 [debug] [MainThread]: Flushing usage events
[0m14:14:28.771231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:49.276569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c06430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdd250>]}


============================== 14:14:49.279467 | 698b3c4d-9bc1-4886-9a80-6f43427b5832 ==============================
[0m14:14:49.279467 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:14:49.279756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:49.382810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edf730>]}
[0m14:14:49.412930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8e80>]}
[0m14:14:49.413606 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:14:49.480473 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:14:49.555050 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:49.555319 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:14:49.555493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066947f0>]}
[0m14:14:50.907087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a47f0>]}
[0m14:14:50.973682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:14:50.976886 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:14:50.993678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d25580>]}
[0m14:14:50.993958 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:14:50.994145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108333dc0>]}
[0m14:14:50.995198 [info ] [MainThread]: 
[0m14:14:50.995370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:50.995520 [info ] [MainThread]: 
[0m14:14:50.995817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:51.000099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m14:14:51.064636 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:14:51.064866 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:14:51.065002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:51.084932 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:14:51.085201 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:14:51.085392 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:14:51.089440 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:14:51.090126 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:14:51.091145 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:14:51.091424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m14:14:51.093622 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:14:51.093775 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:14:51.093904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:51.102802 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:14:51.102976 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:14:51.103126 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:51.106412 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.003 seconds
[0m14:14:51.107562 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:14:51.108282 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:14:51.116980 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:51.117172 [debug] [MainThread]: On master: BEGIN
[0m14:14:51.117317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:51.123915 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:14:51.124106 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:51.124322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:51.142702 [debug] [MainThread]: SQL status: SELECT 37 in 0.018 seconds
[0m14:14:51.146997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698b3c4d-9bc1-4886-9a80-6f43427b5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ad4c0>]}
[0m14:14:51.147372 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:51.148215 [debug] [MainThread]: On master: Close
[0m14:14:51.149749 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:14:51.149983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.jinja_testing)
[0m14:14:51.150149 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:14:51.154809 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:14:51.157835 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:14:51.158150 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:14:51.158590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:51.158746 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:14:51.159034 [debug] [MainThread]: Command end result
[0m14:14:51.184716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:14:51.187903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:14:51.191540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:14:51.191726 [info ] [MainThread]: Compiled node 'jinja_testing' is:




    those are my favorite colors: red

    those are my favorite colors: blue

    those are my favorite colors: orange

[0m14:14:51.193264 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9513929, "process_in_blocks": "0", "process_kernel_time": 0.170361, "process_mem_max_rss": "139509760", "process_out_blocks": "0", "process_user_time": 2.296445}
[0m14:14:51.193467 [debug] [MainThread]: Command `cli compile` succeeded at 14:14:51.193427 after 1.95 seconds
[0m14:14:51.193644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c06430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8e80>]}
[0m14:14:51.193820 [debug] [MainThread]: Flushing usage events
[0m14:14:51.723679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:02.140985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ce400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71250>]}


============================== 14:20:02.144556 | 427e7ebd-2775-4577-8a93-f0dfb2f6f283 ==============================
[0m14:20:02.144556 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:02.144839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:20:02.257128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e89d0>]}
[0m14:20:02.283554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71a90>]}
[0m14:20:02.285229 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:02.352723 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:20:02.424342 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:20:02.424622 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:20:02.424833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d4c10>]}
[0m14:20:03.788756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d76a0>]}
[0m14:20:03.855654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:20:03.859645 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:20:03.881483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ed460>]}
[0m14:20:03.881788 [info ] [MainThread]: Found 57 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:20:03.881966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988de50>]}
[0m14:20:03.883021 [info ] [MainThread]: 
[0m14:20:03.883190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:03.883387 [info ] [MainThread]: 
[0m14:20:03.883659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:03.888002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m14:20:03.952105 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:20:03.952326 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:20:03.952460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:03.973839 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:20:03.974106 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:20:03.974287 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:20:03.977738 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:20:03.978390 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:20:03.979172 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:20:03.979431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m14:20:03.981346 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:20:03.981492 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:20:03.981617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:03.989166 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:20:03.989334 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:20:03.989488 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:20:03.992476 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.003 seconds
[0m14:20:03.993611 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:20:03.995410 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:20:04.003475 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:04.003642 [debug] [MainThread]: On master: BEGIN
[0m14:20:04.003767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:04.011922 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:20:04.012060 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:04.012241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:20:04.029433 [debug] [MainThread]: SQL status: SELECT 37 in 0.017 seconds
[0m14:20:04.034134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427e7ebd-2775-4577-8a93-f0dfb2f6f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109792b50>]}
[0m14:20:04.034446 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:04.035365 [debug] [MainThread]: On master: Close
[0m14:20:04.037867 [debug] [Thread-1  ]: Began running node model.my_dbt_project.jinja_testing
[0m14:20:04.038192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.jinja_testing)
[0m14:20:04.038436 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.jinja_testing
[0m14:20:04.046090 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.jinja_testing"
[0m14:20:04.049556 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.jinja_testing
[0m14:20:04.050034 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.jinja_testing
[0m14:20:04.050717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:04.051153 [debug] [MainThread]: Connection 'model.my_dbt_project.jinja_testing' was properly closed.
[0m14:20:04.051939 [debug] [MainThread]: Command end result
[0m14:20:04.081708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:20:04.084189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:20:04.088144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:20:04.088344 [info ] [MainThread]: Compiled node 'jinja_testing' is:



select
    0 as id
    
        1 as has_red,
    
        1 as has_blue,
    
        1 as has_orange,
    
[0m14:20:04.090382 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9872376, "process_in_blocks": "0", "process_kernel_time": 0.171134, "process_mem_max_rss": "139476992", "process_out_blocks": "0", "process_user_time": 2.266058}
[0m14:20:04.090599 [debug] [MainThread]: Command `cli compile` succeeded at 14:20:04.090559 after 1.99 seconds
[0m14:20:04.090774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ce400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a58d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4bf10>]}
[0m14:20:04.090948 [debug] [MainThread]: Flushing usage events
[0m14:20:04.568175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:24.500528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a86370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5e250>]}


============================== 14:49:24.505301 | 6ca18491-6c7c-4e84-9cb9-03bd75e3b354 ==============================
[0m14:49:24.505301 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:49:24.505788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:24.627781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d58a00>]}
[0m14:49:24.654108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d47640>]}
[0m14:49:24.655163 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:24.756481 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:49:24.829932 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:49:24.830225 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:49:24.830415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055df310>]}
[0m14:49:26.187511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a02130>]}
[0m14:49:26.255149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:49:26.273693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:49:26.297423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7c7c0>]}
[0m14:49:26.297730 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:49:26.297905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b32fd0>]}
[0m14:49:26.299014 [info ] [MainThread]: 
[0m14:49:26.299208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:26.299359 [info ] [MainThread]: 
[0m14:49:26.299613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:26.303974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:49:26.402036 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:49:26.402266 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:49:26.402401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:26.423516 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:49:26.423728 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:49:26.423875 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:49:26.428729 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.005 seconds
[0m14:49:26.429911 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:49:26.430831 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:49:26.431089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:49:26.435507 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:49:26.435657 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:49:26.435782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:26.444923 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:49:26.445115 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:49:26.445258 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:49:26.449111 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:49:26.449954 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:49:26.450760 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:49:26.456917 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:26.457173 [debug] [MainThread]: On master: BEGIN
[0m14:49:26.457324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:26.466463 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:49:26.466739 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:26.466955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:26.482731 [debug] [MainThread]: SQL status: SELECT 37 in 0.016 seconds
[0m14:49:26.486771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca18491-6c7c-4e84-9cb9-03bd75e3b354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad4910>]}
[0m14:49:26.487030 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:26.487705 [debug] [MainThread]: On master: Close
[0m14:49:26.489096 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:49:26.489340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:49:26.489529 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:49:26.499405 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:49:26.499673 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:49:26.499856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:49:26.506852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:49:26.507139 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:49:26.507355 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                payment_method as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by payment_method
            order by count(*) desc

            

        
[0m14:49:26.508166 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "payment_method" does not exist
LINE 3:                 payment_method as value
                        ^
HINT:  Perhaps you meant to reference the column "stg_jaffle_shop__payments.paymentmethod".

[0m14:49:26.508420 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:49:26.511037 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:49:26.554808 [debug] [Thread-1  ]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  column "payment_method" does not exist
  LINE 3:                 payment_method as value
                          ^
  HINT:  Perhaps you meant to reference the column "stg_jaffle_shop__payments.paymentmethod".
[0m14:49:26.555243 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:49:26.555536 [debug] [Thread-4  ]: Marking all children of 'model.my_dbt_project.int_orders__pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  column "payment_method" does not exist
  LINE 3:                 payment_method as value
                          ^
  HINT:  Perhaps you meant to reference the column "stg_jaffle_shop__payments.paymentmethod"..
[0m14:49:26.555843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:26.556082 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:49:26.556380 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
    column "payment_method" does not exist
    LINE 3:                 payment_method as value
                            ^
    HINT:  Perhaps you meant to reference the column "stg_jaffle_shop__payments.paymentmethod".
[0m14:49:26.560339 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 2.225792, "process_in_blocks": "0", "process_kernel_time": 0.187686, "process_mem_max_rss": "139296768", "process_out_blocks": "0", "process_user_time": 2.295417}
[0m14:49:26.560624 [debug] [MainThread]: Command `cli compile` failed at 14:49:26.560571 after 2.23 seconds
[0m14:49:26.560836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a86370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106783ee0>]}
[0m14:49:26.561058 [debug] [MainThread]: Flushing usage events
[0m14:49:27.066974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:52.587193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4a1f0>]}


============================== 14:49:52.590986 | e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd ==============================
[0m14:49:52.590986 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:49:52.591275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:52.704587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1f970>]}
[0m14:49:52.731338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0cdf0>]}
[0m14:49:52.733005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:52.802928 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:49:52.874279 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:49:52.874558 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:49:52.874908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ef3a0>]}
[0m14:49:54.194013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba3f10>]}
[0m14:49:54.262028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:49:54.265480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:49:54.286667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b73550>]}
[0m14:49:54.286962 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:49:54.287136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2fee0>]}
[0m14:49:54.288177 [info ] [MainThread]: 
[0m14:49:54.288373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:54.288579 [info ] [MainThread]: 
[0m14:49:54.288880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:54.293358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m14:49:54.387220 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:49:54.387492 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:49:54.387655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:54.408915 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:49:54.409186 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:49:54.409373 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:49:54.414144 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m14:49:54.415058 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:49:54.416212 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:49:54.416585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m14:49:54.418914 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:49:54.419090 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:49:54.419244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:54.428114 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:49:54.428331 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:49:54.428519 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:49:54.432296 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m14:49:54.433728 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:49:54.434417 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:49:54.444082 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:54.444317 [debug] [MainThread]: On master: BEGIN
[0m14:49:54.444470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:54.453027 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:49:54.453285 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:54.453499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:54.468905 [debug] [MainThread]: SQL status: SELECT 37 in 0.015 seconds
[0m14:49:54.472879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f60b5c-cef5-4a94-bb7d-1692e3af9ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c41a60>]}
[0m14:49:54.473165 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:54.474780 [debug] [MainThread]: On master: Close
[0m14:49:54.476714 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:49:54.477026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_orders__pivoted)
[0m14:49:54.477222 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:49:54.486066 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:49:54.486327 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:49:54.486506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:49:54.493368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:49:54.493668 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:49:54.493860 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:49:54.496304 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m14:49:54.497137 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:49:54.497965 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:49:54.498204 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:49:54.498760 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:49:54.499144 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:49:54.499615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:54.499768 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:49:54.500087 [debug] [MainThread]: Command end result
[0m14:49:54.593945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:49:54.596625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:49:54.602777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:49:54.603025 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:

['credit_card', 'bank_transfer', 'coupon', 'gift_card']

with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select paymentmethod,* from source
[0m14:49:54.604909 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0554302, "process_in_blocks": "0", "process_kernel_time": 0.177785, "process_mem_max_rss": "137625600", "process_out_blocks": "0", "process_user_time": 2.298179}
[0m14:49:54.605121 [debug] [MainThread]: Command `cli compile` succeeded at 14:49:54.605079 after 2.06 seconds
[0m14:49:54.605313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074eeca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611e0a0>]}
[0m14:49:54.605503 [debug] [MainThread]: Flushing usage events
[0m14:49:55.131930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:41.724776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106086340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715f250>]}


============================== 14:54:41.728717 | 75241cbd-162d-49aa-9d41-5abde40f567a ==============================
[0m14:54:41.728717 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:54:41.729004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:54:41.842000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073474f0>]}
[0m14:54:41.868489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130f10>]}
[0m14:54:41.869613 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:54:41.938701 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:54:42.011211 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:54:42.011485 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:54:42.011684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae1b20>]}
[0m14:54:43.356168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110300130>]}
[0m14:54:43.422952 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:54:43.426063 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:54:43.443003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11037b7c0>]}
[0m14:54:43.443328 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:54:43.443511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110433f70>]}
[0m14:54:43.444620 [info ] [MainThread]: 
[0m14:54:43.444791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:43.444983 [info ] [MainThread]: 
[0m14:54:43.445371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:43.450039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:54:43.542450 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:54:43.542688 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:54:43.542828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:43.562913 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:54:43.563144 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:54:43.563302 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:54:43.568116 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.005 seconds
[0m14:54:43.569333 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:54:43.570480 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:54:43.570743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:54:43.575175 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:54:43.575323 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:54:43.575451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:43.583970 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:54:43.584154 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:54:43.584311 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:54:43.587589 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:54:43.588334 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:54:43.588971 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:54:43.594743 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:43.594944 [debug] [MainThread]: On master: BEGIN
[0m14:54:43.595077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:43.602929 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:54:43.603153 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:43.603354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:43.618629 [debug] [MainThread]: SQL status: SELECT 37 in 0.015 seconds
[0m14:54:43.622272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75241cbd-162d-49aa-9d41-5abde40f567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d5e80>]}
[0m14:54:43.622498 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:43.623078 [debug] [MainThread]: On master: Close
[0m14:54:43.624987 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:54:43.625222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:54:43.625400 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:54:43.634349 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:54:43.634570 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:54:43.634724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:54:43.642301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:54:43.642615 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:54:43.642801 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:54:43.643863 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:54:43.644700 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:54:43.645931 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:54:43.646173 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:54:43.646802 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:54:43.647212 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:54:43.647694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:43.647842 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:54:43.648173 [debug] [MainThread]: Command end result
[0m14:54:43.673802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:54:43.676708 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:54:43.680294 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:54:43.680487 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:

['credit_card', 'bank_transfer', 'coupon', 'gift_card']


with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,
    
        sum(case when paymentmethod = 'credit_card' then amount else 0 end) as credit_card_amount
    
        sum(case when paymentmethod = 'bank_transfer' then amount else 0 end) as bank_transfer_amount
    
        sum(case when paymentmethod = 'coupon' then amount else 0 end) as coupon_amount
    
        sum(case when paymentmethod = 'gift_card' then amount else 0 end) as gift_card_amount
    

from source
[0m14:54:43.682333 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.994016, "process_in_blocks": "0", "process_kernel_time": 0.182115, "process_mem_max_rss": "137543680", "process_out_blocks": "0", "process_user_time": 2.285843}
[0m14:54:43.682525 [debug] [MainThread]: Command `cli compile` succeeded at 14:54:43.682487 after 1.99 seconds
[0m14:54:43.682692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106086340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11037b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dd460>]}
[0m14:54:43.682859 [debug] [MainThread]: Flushing usage events
[0m14:54:44.170754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:40.815164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089e250>]}


============================== 14:56:40.822216 | 8448fbe1-0802-48c4-9de4-f094c2b0da4e ==============================
[0m14:56:40.822216 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:56:40.822740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:41.005606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc4610>]}
[0m14:56:41.032451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110201f70>]}
[0m14:56:41.036242 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:56:41.179152 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:56:41.254936 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:56:41.255207 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:56:41.255410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110220310>]}
[0m14:56:42.618053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205deb0>]}
[0m14:56:42.686542 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:56:42.702480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:56:42.794371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120bc1f0>]}
[0m14:56:42.794790 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:56:42.795027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ebb20>]}
[0m14:56:42.796513 [info ] [MainThread]: 
[0m14:56:42.796747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:42.796933 [info ] [MainThread]: 
[0m14:56:42.797273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:42.803259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:56:43.998179 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:56:43.998484 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:56:43.998674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:44.072058 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m14:56:44.072483 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:56:44.072736 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:56:44.081035 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.008 seconds
[0m14:56:44.083393 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:56:44.084966 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:56:44.085474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:56:44.093101 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:56:44.093811 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:56:44.094055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:44.108129 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:56:44.108406 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:56:44.108676 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:56:44.112584 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:56:44.113907 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:56:44.114644 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:56:44.123539 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:44.123875 [debug] [MainThread]: On master: BEGIN
[0m14:56:44.124091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:44.133805 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:56:44.134075 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:44.134350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:44.157517 [debug] [MainThread]: SQL status: SELECT 37 in 0.023 seconds
[0m14:56:44.163341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8448fbe1-0802-48c4-9de4-f094c2b0da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11202d9d0>]}
[0m14:56:44.163734 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:44.164589 [debug] [MainThread]: On master: Close
[0m14:56:44.168547 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:56:44.168907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:56:44.169176 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:56:44.181481 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:56:44.181735 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:56:44.181943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:56:44.191449 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m14:56:44.191745 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:56:44.191966 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:56:44.193621 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:56:44.194623 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:56:44.204661 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:56:44.204964 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:56:44.205807 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:56:44.206408 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:56:44.207038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:44.207231 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:56:44.207658 [debug] [MainThread]: Command end result
[0m14:56:44.240974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:56:44.245207 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:56:44.257408 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:56:44.257680 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,
    
        sum(case when paymentmethod = 'credit_card' then amount else 0 end) as credit_card_amount
        
        ,
        
    
        sum(case when paymentmethod = 'bank_transfer' then amount else 0 end) as bank_transfer_amount
        
        ,
        
    
        sum(case when paymentmethod = 'coupon' then amount else 0 end) as coupon_amount
        
        ,
        
    
        sum(case when paymentmethod = 'gift_card' then amount else 0 end) as gift_card_amount
        
    

from source
[0m14:56:44.264623 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.5978618, "process_in_blocks": "0", "process_kernel_time": 0.359491, "process_mem_max_rss": "137412608", "process_out_blocks": "0", "process_user_time": 2.779269}
[0m14:56:44.264922 [debug] [MainThread]: Command `cli compile` succeeded at 14:56:44.264872 after 3.60 seconds
[0m14:56:44.265163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f42640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f3700>]}
[0m14:56:44.265388 [debug] [MainThread]: Flushing usage events
[0m14:56:44.840227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:10.026876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ff3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ff1f0>]}


============================== 14:58:10.030568 | 1c84e201-721b-4909-944c-618f72f4880b ==============================
[0m14:58:10.030568 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:58:10.030856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:58:10.151248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d3970>]}
[0m14:58:10.177725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c0df0>]}
[0m14:58:10.178745 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:58:10.247605 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:58:10.319035 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:58:10.319331 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:58:10.319537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca43a0>]}
[0m14:58:11.643647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f85f10>]}
[0m14:58:11.710561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:58:11.723920 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:58:11.745237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe4190>]}
[0m14:58:11.745542 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:58:11.745718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f136d0>]}
[0m14:58:11.746773 [info ] [MainThread]: 
[0m14:58:11.746950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:11.747095 [info ] [MainThread]: 
[0m14:58:11.747342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:11.751918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:58:11.848759 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:58:11.848991 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:58:11.849129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:11.865738 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m14:58:11.865979 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:58:11.866145 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:58:11.868630 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.002 seconds
[0m14:58:11.869899 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:58:11.870375 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:58:11.870671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:58:11.875297 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:58:11.875445 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:58:11.875568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:11.884290 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:58:11.884481 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:58:11.884637 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:58:11.888084 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:58:11.889047 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:58:11.889938 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:58:11.895837 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:11.896062 [debug] [MainThread]: On master: BEGIN
[0m14:58:11.896198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:11.903885 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:58:11.904077 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:11.904254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:11.924446 [debug] [MainThread]: SQL status: SELECT 37 in 0.020 seconds
[0m14:58:11.928086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c84e201-721b-4909-944c-618f72f4880b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f65310>]}
[0m14:58:11.928300 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:11.929022 [debug] [MainThread]: On master: Close
[0m14:58:11.931646 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:58:11.931897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:58:11.932080 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:58:11.940582 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:58:11.940773 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:58:11.940926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:58:11.947909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:58:11.948147 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:58:11.948331 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:58:11.949577 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:58:11.950272 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:58:11.954986 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:58:11.955182 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:58:11.955905 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:58:11.956258 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:58:11.956690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:11.956865 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:58:11.957197 [debug] [MainThread]: Command end result
[0m14:58:11.984205 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:58:11.988119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:58:11.991990 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:58:11.992194 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount
        
        ,
        
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount
        
        ,
        
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount
        
        ,
        
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
        
    

from source
group by 1
[0m14:58:11.994200 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0049946, "process_in_blocks": "0", "process_kernel_time": 0.188049, "process_mem_max_rss": "138182656", "process_out_blocks": "0", "process_user_time": 2.284379}
[0m14:58:11.994393 [debug] [MainThread]: Command `cli compile` succeeded at 14:58:11.994353 after 2.01 seconds
[0m14:58:11.994583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463a9a0>]}
[0m14:58:11.994775 [debug] [MainThread]: Flushing usage events
[0m14:58:12.479885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:36.304790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106976340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791f250>]}


============================== 14:58:36.308279 | eb960798-be39-408e-8ebf-ef5e2bd2056c ==============================
[0m14:58:36.308279 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:58:36.308571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:36.422191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3b4f0>]}
[0m14:58:36.448700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f0f10>]}
[0m14:58:36.450456 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:58:36.519406 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:58:36.591906 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:58:36.592178 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:58:36.592371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a1b20>]}
[0m14:58:37.928810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdde80>]}
[0m14:58:38.000701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:58:38.004065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:58:38.025913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c621f0>]}
[0m14:58:38.026276 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:58:38.026469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3c190>]}
[0m14:58:38.027610 [info ] [MainThread]: 
[0m14:58:38.027783 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:38.027972 [info ] [MainThread]: 
[0m14:58:38.028309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:38.033038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:58:38.127785 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:58:38.128015 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:58:38.128149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:38.147414 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:58:38.147650 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:58:38.147802 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:58:38.152406 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m14:58:38.153610 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:58:38.154548 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:58:38.154809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:58:38.159354 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:58:38.159502 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:58:38.159624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:38.169507 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:58:38.169678 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:58:38.169832 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:58:38.172947 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:58:38.173744 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:58:38.174501 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:58:38.180082 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:38.180274 [debug] [MainThread]: On master: BEGIN
[0m14:58:38.180404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:38.188959 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:58:38.189179 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:38.189368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:38.213931 [debug] [MainThread]: SQL status: SELECT 37 in 0.024 seconds
[0m14:58:38.217710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb960798-be39-408e-8ebf-ef5e2bd2056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdd310>]}
[0m14:58:38.217936 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:38.218727 [debug] [MainThread]: On master: Close
[0m14:58:38.220309 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:58:38.220550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:58:38.220732 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:58:38.229507 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:58:38.229722 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:58:38.229890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:58:38.237383 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:58:38.237586 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:58:38.237760 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:58:38.238844 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:58:38.239522 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:58:38.244202 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:58:38.244393 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:58:38.244984 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:58:38.245338 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:58:38.245764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:38.245946 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:58:38.246276 [debug] [MainThread]: Command end result
[0m14:58:38.273767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:58:38.279073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:58:38.282614 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:58:38.282786 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount
        ,
        
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount
        ,
        
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount
        ,
        
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
        
    

from source
group by 1
[0m14:58:38.284806 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.017354, "process_in_blocks": "0", "process_kernel_time": 0.176059, "process_mem_max_rss": "138903552", "process_out_blocks": "0", "process_user_time": 2.302245}
[0m14:58:38.284994 [debug] [MainThread]: Command `cli compile` succeeded at 14:58:38.284953 after 2.02 seconds
[0m14:58:38.285181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106976340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106739970>]}
[0m14:58:38.285367 [debug] [MainThread]: Flushing usage events
[0m14:58:38.778861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:57.301968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a463a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5f220>]}


============================== 14:58:57.305769 | 1ccaa0cc-5413-4d4b-9465-318a5fda7d3e ==============================
[0m14:58:57.305769 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:58:57.306186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:58:57.416045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c30a30>]}
[0m14:58:57.448389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5fee0>]}
[0m14:58:57.449036 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:58:57.523485 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:58:57.600930 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:58:57.601211 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:58:57.601423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e1d00>]}
[0m14:58:58.978007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adddee0>]}
[0m14:58:59.044177 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:58:59.046971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:58:59.062904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad71fa0>]}
[0m14:58:59.063192 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:58:59.063368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3c190>]}
[0m14:58:59.064414 [info ] [MainThread]: 
[0m14:58:59.064583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:59.064725 [info ] [MainThread]: 
[0m14:58:59.065001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:59.069516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:58:59.161233 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:58:59.161462 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:58:59.161604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:59.181766 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:58:59.181983 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:58:59.182131 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:58:59.186464 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m14:58:59.187634 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:58:59.188579 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:58:59.188846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:58:59.193500 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:58:59.193664 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:58:59.193794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:59.202182 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:58:59.202321 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:58:59.202465 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:58:59.205725 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:58:59.206554 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:58:59.207224 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:58:59.212823 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:59.213005 [debug] [MainThread]: On master: BEGIN
[0m14:58:59.213142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:59.221153 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:58:59.221400 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:59.221598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:59.245534 [debug] [MainThread]: SQL status: SELECT 37 in 0.024 seconds
[0m14:58:59.249293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ccaa0cc-5413-4d4b-9465-318a5fda7d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adad040>]}
[0m14:58:59.249528 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:59.250163 [debug] [MainThread]: On master: Close
[0m14:58:59.251727 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:58:59.251997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:58:59.252208 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:58:59.260955 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:58:59.261169 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:58:59.261335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:58:59.268605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:58:59.268824 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:58:59.269003 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:58:59.270074 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:58:59.270775 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:58:59.275048 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:58:59.275247 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:58:59.275886 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:58:59.276264 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:58:59.276698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:59.276848 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:58:59.277181 [debug] [MainThread]: Command end result
[0m14:58:59.304031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:58:59.309912 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:58:59.314118 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:58:59.314320 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,
        
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,
        
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,
        
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
    

from source
group by 1
[0m14:58:59.316436 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1521103, "process_in_blocks": "0", "process_kernel_time": 0.172902, "process_mem_max_rss": "138674176", "process_out_blocks": "0", "process_user_time": 2.35545}
[0m14:58:59.316665 [debug] [MainThread]: Command `cli compile` succeeded at 14:58:59.316623 after 2.15 seconds
[0m14:58:59.316854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a463a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad73610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bcd00>]}
[0m14:58:59.317057 [debug] [MainThread]: Flushing usage events
[0m14:58:59.806260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:15.110223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129e250>]}


============================== 14:59:15.114585 | 586fa003-3afb-4fa8-a34b-e9f0437834d7 ==============================
[0m14:59:15.114585 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:59:15.114932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:15.237588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c49d0>]}
[0m14:59:15.264327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129ea90>]}
[0m14:59:15.265847 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:59:15.334483 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:59:15.407171 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:59:15.407509 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:59:15.407707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afcc10>]}
[0m14:59:16.776310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c5df40>]}
[0m14:59:16.846920 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:59:16.849832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:59:16.867685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bf4610>]}
[0m14:59:16.868027 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:59:16.868209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102eeca0>]}
[0m14:59:16.869308 [info ] [MainThread]: 
[0m14:59:16.869482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:16.869625 [info ] [MainThread]: 
[0m14:59:16.869880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:59:16.874755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:59:16.975106 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:59:16.975341 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:59:16.975479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:16.998029 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m14:59:16.998319 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:59:16.998535 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:59:17.002896 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m14:59:17.004455 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:59:17.005590 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:59:17.006180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:59:17.019045 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:59:17.020204 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:59:17.023225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:17.041386 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m14:59:17.042160 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:59:17.042681 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:59:17.049967 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m14:59:17.053814 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:59:17.056375 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:59:17.070120 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:17.070516 [debug] [MainThread]: On master: BEGIN
[0m14:59:17.070705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:17.083789 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:59:17.084081 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:17.084304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:59:17.106272 [debug] [MainThread]: SQL status: SELECT 37 in 0.022 seconds
[0m14:59:17.110129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586fa003-3afb-4fa8-a34b-e9f0437834d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111257970>]}
[0m14:59:17.110482 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:17.111277 [debug] [MainThread]: On master: Close
[0m14:59:17.113811 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:59:17.114180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:59:17.114380 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:59:17.124164 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:59:17.124461 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:59:17.124650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:59:17.132115 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:59:17.132355 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:59:17.132547 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:59:17.133908 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:59:17.134614 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:59:17.142252 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:59:17.142436 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:59:17.143046 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:59:17.143390 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:59:17.143839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:17.144007 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:59:17.144369 [debug] [MainThread]: Command end result
[0m14:59:17.169893 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:59:17.172355 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:59:17.176311 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:59:17.176496 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
    

from source
group by 1
[0m14:59:17.178369 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1094062, "process_in_blocks": "0", "process_kernel_time": 0.1832, "process_mem_max_rss": "139182080", "process_out_blocks": "0", "process_user_time": 2.359805}
[0m14:59:17.178555 [debug] [MainThread]: Command `cli compile` succeeded at 14:59:17.178517 after 2.11 seconds
[0m14:59:17.178729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110371820>]}
[0m14:59:17.178900 [debug] [MainThread]: Flushing usage events
[0m14:59:17.721475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:40.683087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9e2b0>]}


============================== 14:59:40.685819 | bfa8c023-f2eb-47e3-9d51-f87bfdbd32c3 ==============================
[0m14:59:40.685819 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:59:40.686110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:59:40.796511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa8c023-f2eb-47e3-9d51-f87bfdbd32c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2d1f0>]}
[0m14:59:40.823537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa8c023-f2eb-47e3-9d51-f87bfdbd32c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c73a00>]}
[0m14:59:40.824901 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:59:40.899163 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:59:41.067497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:59:41.067729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:59:41.102741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa8c023-f2eb-47e3-9d51-f87bfdbd32c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991b130>]}
[0m14:59:41.192334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:59:41.195355 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:59:41.248676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa8c023-f2eb-47e3-9d51-f87bfdbd32c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623bb0>]}
[0m14:59:41.248984 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:59:41.249164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa8c023-f2eb-47e3-9d51-f87bfdbd32c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108621b80>]}
[0m14:59:41.250227 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:59:41.251228 [debug] [MainThread]: Command end result
[0m14:59:41.277624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:59:41.279307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:59:41.281083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:59:41.282765 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63968015, "process_in_blocks": "0", "process_kernel_time": 0.139928, "process_mem_max_rss": "118734848", "process_out_blocks": "0", "process_user_time": 1.001746}
[0m14:59:41.282984 [debug] [MainThread]: Command `cli test` succeeded at 14:59:41.282940 after 0.64 seconds
[0m14:59:41.283161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b7bb0>]}
[0m14:59:41.283338 [debug] [MainThread]: Flushing usage events
[0m14:59:41.770111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:48.236473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0963d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b11e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b11e1f0>]}


============================== 14:59:48.240113 | 959d598f-2c9b-4682-9f2e-c8ee74e21194 ==============================
[0m14:59:48.240113 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:59:48.240410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:48.349964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '959d598f-2c9b-4682-9f2e-c8ee74e21194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0f3970>]}
[0m14:59:48.376896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '959d598f-2c9b-4682-9f2e-c8ee74e21194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0dfdf0>]}
[0m14:59:48.378592 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:59:48.447249 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:59:48.609825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:59:48.610076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:59:48.644913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959d598f-2c9b-4682-9f2e-c8ee74e21194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc9b130>]}
[0m14:59:48.736844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:59:48.740565 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:59:48.761347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959d598f-2c9b-4682-9f2e-c8ee74e21194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc9c2e0>]}
[0m14:59:48.761625 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m14:59:48.761807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959d598f-2c9b-4682-9f2e-c8ee74e21194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd1dd00>]}
[0m14:59:48.762840 [info ] [MainThread]: 
[0m14:59:48.763011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:48.763157 [info ] [MainThread]: 
[0m14:59:48.763425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:59:48.767863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m14:59:48.835318 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:59:48.835544 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m14:59:48.835678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:48.851764 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m14:59:48.851992 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m14:59:48.852139 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:59:48.854788 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.002 seconds
[0m14:59:48.855932 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m14:59:48.856834 [debug] [ThreadPool]: On list_dw_public: Close
[0m14:59:48.857099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m14:59:48.861493 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:59:48.861655 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m14:59:48.861782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:48.868728 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:59:48.868930 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m14:59:48.869086 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m14:59:48.870729 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.001 seconds
[0m14:59:48.871406 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m14:59:48.872180 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m14:59:48.878308 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:48.878490 [debug] [MainThread]: On master: BEGIN
[0m14:59:48.878616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:48.885260 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:59:48.885522 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:48.885713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:59:48.903339 [debug] [MainThread]: SQL status: SELECT 37 in 0.017 seconds
[0m14:59:48.907501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959d598f-2c9b-4682-9f2e-c8ee74e21194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a370a60>]}
[0m14:59:48.907751 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:48.908400 [debug] [MainThread]: On master: Close
[0m14:59:48.911203 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m14:59:48.911508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m14:59:48.912006 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m14:59:48.926003 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:59:48.926226 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m14:59:48.926382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:59:48.933624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:59:48.933814 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m14:59:48.933971 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m14:59:48.935233 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:59:48.935922 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m14:59:48.939978 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m14:59:48.940157 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m14:59:48.940732 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m14:59:48.941095 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m14:59:48.941515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:48.941657 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m14:59:48.941989 [debug] [MainThread]: Command end result
[0m14:59:48.967161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m14:59:48.976280 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m14:59:48.980876 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m14:59:48.981086 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
    

from source
group by 1
[0m14:59:48.982741 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7848819, "process_in_blocks": "0", "process_kernel_time": 0.161975, "process_mem_max_rss": "127238144", "process_out_blocks": "0", "process_user_time": 1.08167}
[0m14:59:48.982945 [debug] [MainThread]: Command `cli compile` succeeded at 14:59:48.982907 after 0.79 seconds
[0m14:59:48.983116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0963d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc68340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322100>]}
[0m14:59:48.983310 [debug] [MainThread]: Flushing usage events
[0m14:59:49.455952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:04.629084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106576430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1e250>]}


============================== 15:00:04.633056 | b018464c-d2d9-4105-a0e7-27c3b730a24f ==============================
[0m15:00:04.633056 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:04.633364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:00:04.728672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015f730>]}
[0m15:00:04.758218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110148e80>]}
[0m15:00:04.759668 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:04.829770 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m15:00:04.904846 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:00:04.905118 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m15:00:04.905288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a87f0>]}
[0m15:00:06.321291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130aff70>]}
[0m15:00:06.390012 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:00:06.393293 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:00:06.415022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306a880>]}
[0m15:00:06.415306 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m15:00:06.415482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f7220>]}
[0m15:00:06.416627 [info ] [MainThread]: 
[0m15:00:06.416830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:06.417030 [info ] [MainThread]: 
[0m15:00:06.417326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:06.421731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m15:00:06.520085 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:00:06.520346 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:00:06.520497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:06.539104 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m15:00:06.539358 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:00:06.539509 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:06.544294 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.005 seconds
[0m15:00:06.545473 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:00:06.546411 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:00:06.546674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m15:00:06.551134 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:00:06.551278 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m15:00:06.551397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:06.561208 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:00:06.561419 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:00:06.561579 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m15:00:06.564902 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m15:00:06.565787 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m15:00:06.566493 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m15:00:06.572158 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:06.572369 [debug] [MainThread]: On master: BEGIN
[0m15:00:06.572514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:06.580153 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:00:06.580335 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:06.580519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:06.598194 [debug] [MainThread]: SQL status: SELECT 37 in 0.017 seconds
[0m15:00:06.601855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b018464c-d2d9-4105-a0e7-27c3b730a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130aed00>]}
[0m15:00:06.602080 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:06.602768 [debug] [MainThread]: On master: Close
[0m15:00:06.605300 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m15:00:06.605544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m15:00:06.605719 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m15:00:06.613992 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:00:06.614176 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m15:00:06.614328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:06.621837 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m15:00:06.622047 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:00:06.622221 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m15:00:06.623340 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m15:00:06.624025 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m15:00:06.626558 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m15:00:06.626750 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m15:00:06.627330 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m15:00:06.627700 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m15:00:06.628148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:06.628299 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m15:00:06.628625 [debug] [MainThread]: Command end result
[0m15:00:06.655228 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:00:06.657915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:00:06.661598 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m15:00:06.661790 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
    from source
group by 1
[0m15:00:06.663682 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0751894, "process_in_blocks": "0", "process_kernel_time": 0.186604, "process_mem_max_rss": "139476992", "process_out_blocks": "0", "process_user_time": 2.372343}
[0m15:00:06.663870 [debug] [MainThread]: Command `cli compile` succeeded at 15:00:06.663832 after 2.08 seconds
[0m15:00:06.664043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106576430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110591eb0>]}
[0m15:00:06.664208 [debug] [MainThread]: Flushing usage events
[0m15:00:07.215334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:31.191771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039c6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499e250>]}


============================== 15:00:31.195315 | 695a5e5d-95dc-447e-b654-cb11b69495ef ==============================
[0m15:00:31.195315 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:31.195606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:00:31.306347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdf730>]}
[0m15:00:31.332852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8e80>]}
[0m15:00:31.334476 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:31.402028 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m15:00:31.474678 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:00:31.474950 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m15:00:31.475164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044547f0>]}
[0m15:00:32.811027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2ef70>]}
[0m15:00:32.885411 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:00:32.889085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:00:32.909565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106beb9d0>]}
[0m15:00:32.909849 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m15:00:32.910024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8070>]}
[0m15:00:32.911078 [info ] [MainThread]: 
[0m15:00:32.911243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:32.911389 [info ] [MainThread]: 
[0m15:00:32.911662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:32.915976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m15:00:33.033153 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:00:33.033428 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m15:00:33.033596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:33.054204 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m15:00:33.054508 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:00:33.054703 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m15:00:33.058817 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m15:00:33.059705 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m15:00:33.060701 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m15:00:33.061005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m15:00:33.063130 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:00:33.063299 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:00:33.063440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:33.071665 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:00:33.071914 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:00:33.072080 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:33.075890 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.004 seconds
[0m15:00:33.077228 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:00:33.077965 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:00:33.086867 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:33.087069 [debug] [MainThread]: On master: BEGIN
[0m15:00:33.087209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:33.095085 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:00:33.095320 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:33.095528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:33.110938 [debug] [MainThread]: SQL status: SELECT 37 in 0.015 seconds
[0m15:00:33.114446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '695a5e5d-95dc-447e-b654-cb11b69495ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f62190>]}
[0m15:00:33.114666 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:33.115329 [debug] [MainThread]: On master: Close
[0m15:00:33.117603 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m15:00:33.117819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_orders__pivoted)
[0m15:00:33.117980 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m15:00:33.126294 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:00:33.126505 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m15:00:33.126656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:33.133513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m15:00:33.133763 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:00:33.133934 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m15:00:33.134983 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m15:00:33.135673 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m15:00:33.137801 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m15:00:33.137982 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m15:00:33.138562 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m15:00:33.138964 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m15:00:33.139408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:33.139585 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m15:00:33.139919 [debug] [MainThread]: Command end result
[0m15:00:33.166929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:00:33.168829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:00:33.172386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m15:00:33.172584 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
from source
group by 1
[0m15:00:33.174553 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.021024, "process_in_blocks": "0", "process_kernel_time": 0.19083, "process_mem_max_rss": "137723904", "process_out_blocks": "0", "process_user_time": 2.306999}
[0m15:00:33.174788 [debug] [MainThread]: Command `cli compile` succeeded at 15:00:33.174735 after 2.02 seconds
[0m15:00:33.174971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039c6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106beb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105158ac0>]}
[0m15:00:33.175167 [debug] [MainThread]: Flushing usage events
[0m15:00:33.650974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:55.444197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c89f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c89f220>]}


============================== 15:00:55.447517 | e44ac61b-6d57-4ad2-a1be-86b67f5962e2 ==============================
[0m15:00:55.447517 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:55.447808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:00:55.560200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c868a30>]}
[0m15:00:55.586531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdfee0>]}
[0m15:00:55.588229 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:55.655717 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m15:00:55.727959 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:00:55.728259 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m15:00:55.728460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a921d00>]}
[0m15:00:57.155410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd2eee0>]}
[0m15:00:57.231051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:00:57.234538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:00:57.256555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbc3a0>]}
[0m15:00:57.256835 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m15:00:57.257012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9f3f70>]}
[0m15:00:57.258046 [info ] [MainThread]: 
[0m15:00:57.258211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:57.258357 [info ] [MainThread]: 
[0m15:00:57.258600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:57.263099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m15:00:57.354568 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:00:57.354853 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:00:57.355032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:57.374673 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:00:57.374894 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:00:57.375042 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:57.379782 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.005 seconds
[0m15:00:57.380993 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:00:57.381932 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:00:57.382266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m15:00:57.386776 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:00:57.386929 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m15:00:57.387063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:57.396966 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:00:57.397111 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:00:57.397264 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m15:00:57.401455 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m15:00:57.402183 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m15:00:57.403204 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m15:00:57.409051 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:57.409248 [debug] [MainThread]: On master: BEGIN
[0m15:00:57.409382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:57.418324 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:00:57.418560 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:57.418762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:57.442211 [debug] [MainThread]: SQL status: SELECT 37 in 0.023 seconds
[0m15:00:57.446110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44ac61b-6d57-4ad2-a1be-86b67f5962e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c857850>]}
[0m15:00:57.446350 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:57.447028 [debug] [MainThread]: On master: Close
[0m15:00:57.448835 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m15:00:57.449125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m15:00:57.449312 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m15:00:57.458015 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:00:57.458203 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m15:00:57.458375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:57.465424 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m15:00:57.465631 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:00:57.465801 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m15:00:57.466909 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m15:00:57.467625 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m15:00:57.472520 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m15:00:57.472718 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m15:00:57.473335 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m15:00:57.473725 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m15:00:57.474198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:57.474412 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m15:00:57.474787 [debug] [MainThread]: Command end result
[0m15:00:57.501507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:00:57.504598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:00:57.508307 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m15:00:57.508484 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
from source
group by 1
[0m15:00:57.510651 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1044726, "process_in_blocks": "0", "process_kernel_time": 0.174628, "process_mem_max_rss": "139870208", "process_out_blocks": "0", "process_user_time": 2.380611}
[0m15:00:57.510856 [debug] [MainThread]: Command `cli compile` succeeded at 15:00:57.510815 after 2.10 seconds
[0m15:00:57.511029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084475e0>]}
[0m15:00:57.511204 [debug] [MainThread]: Flushing usage events
[0m15:00:58.047139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:22.121070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042863a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555f220>]}


============================== 15:01:22.125114 | c4c377fa-0f68-4007-b51e-73aef9a660e3 ==============================
[0m15:01:22.125114 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:01:22.125418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:01:22.255632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105528a30>]}
[0m15:01:22.282767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575fee0>]}
[0m15:01:22.284281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:22.351675 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m15:01:22.424520 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:01:22.424793 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m15:01:22.424990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee0d00>]}
[0m15:01:23.750275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106401130>]}
[0m15:01:23.816664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:01:23.819750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:01:23.841489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647c430>]}
[0m15:01:23.841773 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m15:01:23.841947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106533f10>]}
[0m15:01:23.842963 [info ] [MainThread]: 
[0m15:01:23.843126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:23.843312 [info ] [MainThread]: 
[0m15:01:23.843621 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:23.848120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public_jaffle_shop'
[0m15:01:23.940880 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:01:23.941116 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m15:01:23.941256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:23.962615 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m15:01:23.962853 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:01:23.963014 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m15:01:23.967347 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m15:01:23.968045 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m15:01:23.968913 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m15:01:23.969177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now list_dw_public)
[0m15:01:23.971126 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:01:23.971279 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:01:23.971411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:23.980074 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:01:23.980215 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:01:23.980358 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:01:23.983751 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.003 seconds
[0m15:01:23.984904 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:01:23.985771 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:01:23.994689 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:23.994911 [debug] [MainThread]: On master: BEGIN
[0m15:01:23.995045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:24.003687 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:01:24.003891 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:24.004072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:24.027927 [debug] [MainThread]: SQL status: SELECT 37 in 0.024 seconds
[0m15:01:24.031683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4c377fa-0f68-4007-b51e-73aef9a660e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a59430>]}
[0m15:01:24.031915 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:24.032548 [debug] [MainThread]: On master: Close
[0m15:01:24.034216 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m15:01:24.034487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public, now model.my_dbt_project.int_orders__pivoted)
[0m15:01:24.034675 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m15:01:24.043866 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:01:24.044053 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m15:01:24.044222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:24.051436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m15:01:24.051647 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:01:24.051833 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m15:01:24.053069 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m15:01:24.053844 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m15:01:24.056458 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m15:01:24.056653 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m15:01:24.057298 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m15:01:24.057691 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m15:01:24.058150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:24.058288 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m15:01:24.058619 [debug] [MainThread]: Command end result
[0m15:01:24.084501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:01:24.087769 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:01:24.091481 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m15:01:24.091659 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,
    sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
    
from source
group by 1
[0m15:01:24.093727 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0099337, "process_in_blocks": "0", "process_kernel_time": 0.187976, "process_mem_max_rss": "135200768", "process_out_blocks": "0", "process_user_time": 2.2869}
[0m15:01:24.093934 [debug] [MainThread]: Command `cli compile` succeeded at 15:01:24.093892 after 2.01 seconds
[0m15:01:24.094117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042863a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044075e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f93a0>]}
[0m15:01:24.094291 [debug] [MainThread]: Flushing usage events
[0m15:01:24.597561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:54.320295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102363a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111df430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111df250>]}


============================== 15:01:54.324238 | cc9dc91e-a1be-408f-b03b-9998e2d14683 ==============================
[0m15:01:54.324238 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:01:54.324578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/logs', 'profiles_dir': '/Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:54.433030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111197e20>]}
[0m15:01:54.459349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c35fa0>]}
[0m15:01:54.460984 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:54.570666 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m15:01:54.655155 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:01:54.655453 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m15:01:54.655700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c61d00>]}
[0m15:01:56.033586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112271130>]}
[0m15:01:56.099302 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:01:56.103378 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:01:56.122703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223c190>]}
[0m15:01:56.122960 [info ] [MainThread]: Found 58 models, 10 seeds, 29 data tests, 3 sources, 609 macros
[0m15:01:56.123136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f3f70>]}
[0m15:01:56.124147 [info ] [MainThread]: 
[0m15:01:56.124319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:56.124464 [info ] [MainThread]: 
[0m15:01:56.124714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:56.129101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dw_public'
[0m15:01:56.219269 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:01:56.219487 [debug] [ThreadPool]: On list_dw_public: BEGIN
[0m15:01:56.219633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:56.240507 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m15:01:56.240693 [debug] [ThreadPool]: Using postgres connection "list_dw_public"
[0m15:01:56.240839 [debug] [ThreadPool]: On list_dw_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:01:56.247641 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.007 seconds
[0m15:01:56.248813 [debug] [ThreadPool]: On list_dw_public: ROLLBACK
[0m15:01:56.249996 [debug] [ThreadPool]: On list_dw_public: Close
[0m15:01:56.250269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_public, now list_dw_public_jaffle_shop)
[0m15:01:56.254837 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:01:56.254994 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: BEGIN
[0m15:01:56.255125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:56.263501 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:01:56.263643 [debug] [ThreadPool]: Using postgres connection "list_dw_public_jaffle_shop"
[0m15:01:56.263795 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_dw_public_jaffle_shop"} */
select
      'dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_jaffle_shop'
    union all
    select
      'dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_jaffle_shop'
  
[0m15:01:56.267170 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m15:01:56.267888 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: ROLLBACK
[0m15:01:56.268623 [debug] [ThreadPool]: On list_dw_public_jaffle_shop: Close
[0m15:01:56.274398 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:56.274609 [debug] [MainThread]: On master: BEGIN
[0m15:01:56.274750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:56.282919 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:01:56.283194 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:56.283392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:56.308124 [debug] [MainThread]: SQL status: SELECT 37 in 0.025 seconds
[0m15:01:56.311939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc9dc91e-a1be-408f-b03b-9998e2d14683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d13d0>]}
[0m15:01:56.312164 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:56.312823 [debug] [MainThread]: On master: Close
[0m15:01:56.314956 [debug] [Thread-1  ]: Began running node model.my_dbt_project.int_orders__pivoted
[0m15:01:56.315200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_public_jaffle_shop, now model.my_dbt_project.int_orders__pivoted)
[0m15:01:56.315379 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.int_orders__pivoted
[0m15:01:56.324362 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:01:56.324553 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: BEGIN
[0m15:01:56.324710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:56.331793 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m15:01:56.331969 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.int_orders__pivoted"
[0m15:01:56.332133 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.int_orders__pivoted"} */
select
                paymentmethod as value

            from "dw"."public"."stg_jaffle_shop__payments"

            

            group by paymentmethod
            order by count(*) desc

            

        
[0m15:01:56.333473 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m15:01:56.334208 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.int_orders__pivoted"
[0m15:01:56.340069 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.int_orders__pivoted
[0m15:01:56.340252 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: ROLLBACK
[0m15:01:56.340838 [debug] [Thread-1  ]: On model.my_dbt_project.int_orders__pivoted: Close
[0m15:01:56.341180 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.int_orders__pivoted
[0m15:01:56.341594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:56.341733 [debug] [MainThread]: Connection 'model.my_dbt_project.int_orders__pivoted' was properly closed.
[0m15:01:56.342037 [debug] [MainThread]: Command end result
[0m15:01:56.367729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/manifest.json
[0m15:01:56.370936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/semantic_manifest.json
[0m15:01:56.374533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/fehmmialiti/docker_learning/dbt_airflow/dbt_project/target/run_results.json
[0m15:01:56.374699 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:




with source as (
    select * from "dw"."public"."stg_jaffle_shop__payments"
)

select 
    order_id,
    
    sum(case when paymentmethod = 'credit_card' then amount/100 else 0 end) as credit_card_amount,
    sum(case when paymentmethod = 'bank_transfer' then amount/100 else 0 end) as bank_transfer_amount,
    sum(case when paymentmethod = 'coupon' then amount/100 else 0 end) as coupon_amount,
    sum(case when paymentmethod = 'gift_card' then amount/100 else 0 end) as gift_card_amount
    
from source
group by 1
[0m15:01:56.376682 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1989748, "process_in_blocks": "0", "process_kernel_time": 0.180782, "process_mem_max_rss": "133185536", "process_out_blocks": "0", "process_user_time": 2.332587}
[0m15:01:56.376887 [debug] [MainThread]: Command `cli compile` succeeded at 15:01:56.376846 after 2.20 seconds
[0m15:01:56.377081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102363a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ca9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223c190>]}
[0m15:01:56.377262 [debug] [MainThread]: Flushing usage events
[0m15:01:56.845390 [debug] [MainThread]: An error was encountered while trying to flush usage events
